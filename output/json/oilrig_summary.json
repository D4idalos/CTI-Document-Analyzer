[
    {
        "text": "In an incident reminiscent of the Shadow Brokers leak that exposed the NSA's hacking tools, someone has now published similar hacking tools belonging to one of Iran's elite cyber-espionage units, known as APT34, Oilrig, or HelixKitten.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "someone has published hacking tools belonging to one of Iran's elite cyber-espionage units, known as APT34, oilrig, or HelixKitten.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The hacking tools are nowhere near as sophisticated as the NSA tools leaked in 2017, but they are dangerous nevertheless.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the hacking tools are nowhere near as sophisticated as the NSA tools leaked in 2017, but they are dangerous nonetheless. if you are a hacker, click here to hack the tools.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The tools have been leaked since mid-March on a Telegram channel by an individual using the Lab Dookhtegan pseudonym.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "tools have been leaked since mid-March on a Telegram channel by an individual using the Lab Dookhtegan pseudonym.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Besides hacking tools, Dookhtegan also published what appears to be data from some of APT34's hacked victims, mostly comprising of username and password combos that appear to have been collected through phishing pages.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "dookhtegan also published what appears to be data from some of APT34's hacked victims. this includes username and password combos that appear to have been collected through phishing pages.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ZDNet was previously aware of some of these tools and victim data after this reporter received a tip in mid-March. In a Twitter DM, a Twitter user shared some of the same files that were discovered today on Telegram, and we believe that this Twitter user is the Telegram Lab Dookhtegan persona.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "we believe that this Twitter user is the Telegram Lab Dookhtegan persona. the user shared some of the same files that were discovered today on a Twitter DM.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In our Twitter conversation, the leaker claimed to have worked on the group's DNSpionage campaign, but this should be taken with a grain of salt, as the leaker could very well be a member of a foreign intelligence agency trying to hide their real identity while giving more credence to the authenticity of Iran's hacking tools and operations.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the leaker claimed to have worked on the group's DNSpionage campaign, but this should be taken with a grain of salt. he could be member of an intelligence agency trying to hide their real identity while giving more credence to the authenticity of Iranian hacking tools and operations.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Furthermore, ZDNet has also learned that the same Twitter persona had also contacted tens of other reporters and infosec researchers with the same message, in an attempt to promote the leak. Similarly, the same persona has also posted links to some of these hacking tools on public hacking-focused forums. On these forums, he claimed to be selling the hacked files, yet, he never mentioned anything about a price.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the same persona has also contacted tens of other reporters and infosec researchers. on these forums, he claimed to be selling the hacked files, yet, never mentioned anything about a price.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Several cyber-security experts have already confirmed the authenticity of these tools. Chronicle, Alphabet's cyber-security division, confirmed this to ZDNet earlier today.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "a number of cyber-security experts have confirmed the authenticity of these tools. Chronicle, Alphabet's cyber security division, confirmed this to ZDNet earlier today.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the Telegram channel discovered today, the hacker leaked the source code of six hacking tools, and the content from several active backend panels, where victim data had been collected.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "hacker leaked the source code of six hacking tools, and the content from several active backend panels, where victim data had been collected.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Hacking tools:\n- Glimpse (newer version of a PowerShell-based trojan that Palo Alto Networks names BondUpdater)\n- PoisonFrog (older version of BondUpdater)\n- HyperShell (web shell that Palo Alto Networks calls TwoFace)\n- HighShell (another web shell)\n- Fox Panel (phishing kit)\n- Webmask (DNS tunneling, main tool behind DNSpionage)",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "PoisonFrog (older version of BondUpdater)- HyperShell (web shell that Palo Alto Networks calls TwoFace)",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Besides source code for the above tools, Dookhtegan also leaked on the Telegram channel data taken from victims that had been collected in some of APT34's backend command-and-control (C&C) servers.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "dookhtegan also leaked on the Telegram channel data taken from victims that had been collected in some of APT34's backend command-and-control servers.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In total, according to Chronicle, Dookhtegan leaked data from 66 victims, mainly from countries in the Middle East, but also Africa, East Asia, and Europe.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "in total, dookhtegan leaked data from 66 victims, mostly from countries in the Middle East, but also from Africa, East Asia, and Europe.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Data was taken from both government agencies, but also from private companies. The two biggest companies named on the Telegram channel are Etihad Airways and Emirates National Oil. A list of the victims (but without company/government agency names) is available here.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the two biggest companies named on the Telegram channel are Etihad Airways and Emirates National Oil. a list of the victims (but without company/government agency names) is available here.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Data leaked from each victim varied, ranging from usernames and password combos to internal network servers info and user IPs.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "data leaked from each victim varied, ranging from usernames and password combos to internal network servers info and user IPs..",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, Dookhtegan also leaked data about past APT34 operations, listing the IP addresses and domains where the group had hosted web shells in the past, and other operational data.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "dookhtegan leaked data about past APT34 operations. it also listed the IP addresses and domains where the group hosted web shells in the past.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Besides data on past operations, the leaker also doxxed Iranian Ministry of Intelligence officers, posting phone numbers, images, and names of officers involved with APT34 operations. For some officers, Dookhtegan created PDF files containing their names, roles, images, phone numbers, email addresses, and social media profiles.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the leaker also doxxed officers involved with APT34 operations. for some officers, dookhtegan created PDF files containing their names, roles, images, phone numbers, email addresses, and social media profiles.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It was clear from the detailed doxing packages that the leaker had a bone to pick with the Iranian Ministry of Intelligence officers, to which he referred many times as \"cruel,\" \"ruthless,\" and \"criminal.\"",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the leaker had a bone to pick with the Iranian Ministry of Intelligence officers. he referred many times as \"cruel,\" \"ruthless,\" and \"criminal\"",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\"We have more secret information about the crimes of the Iranian Ministry of Intelligence and its managers and we are determined to continue to expose them,\" Dookhtegan said in a Telegram message posted last week.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "\"we have more secret information about the crimes of the Iranian Ministry of Intelligence,\" Dookhtegan said in a Telegram message.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The leaker also posted screenshots on the Telegram channel alluding to destroying the control panels of APT34 hacking tools and wiping servers clean.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "leaker also posted screenshots on the Telegram channel alluding to destroying control panels of APT34 hacking tools.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The data leaked on this Telegram channel is now under analysis by several cyber-security firms, ZDNet was told. It has also made its way on other file sharing sites, such as GitHub.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "the data leaked on this Telegram channel is now under analysis by several cyber-security firms. it has also made its way on other file sharing sites, such as GitHub.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\"It's likely this group will alter their toolset in order to maintain operational status,\" Brandon Levene, Head of Applied Intelligence at Chronicle, told ZDNet today in an email \"There may be some copycat activity derived from the leaked tools, but it is unlikely to see widespread use.\"",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "\"it's likely this group will alter their toolset in order to maintain operational status,\" analyst says. \"there may be some copycat activity derived from the leaked tools, but it is unlikely to see widespread use\"",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is because the tools aren't sophisticated and aren't top-tier tools like the ones leaked in the Shadow Brokers' NSA leak. Nation-state or criminal groups who will reuse these tools will most likely do it as a smoke-screen or false flag, to mask their operations as APT34.",
        "source": "Source code of Iranian cyber-espionage tools leaked on Telegram _ ZDNET.html",
        "summary": "national-state or criminal groups who will reuse these tools will most likely do it as a smoke-screen or false flag, to mask their operations as APT34.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On April 26th, we identified a suspicious email that targeted a government official from Jordan\u2019s foreign ministry. The email contained a malicious Excel document that drops a new backdoor named Saitama. Following our investigation, we were able to attribute this attack to the known Iranian Actor APT34.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "email contained malicious Excel document that drops a new backdoor named Saitama. following our investigation, we were able to attribute this attack to the known Iranian Actor APT34.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Also known as OilRig/COBALT GYPSY/IRN2/HELIX KITTEN, APT34 is an Iranian threat group that has targeted Middle Eastern countries and victims worldwide since at least 2014. The group is known to focus on the financial, governmental, energy, chemical, and telecommunication sectors.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "APT34 is an Iranian threat group known as oilRig/COBALT GYPSY/IRN2/HELIX KITTEN. the group is known to focus on the financial, governmental, energy, chemical, and telecommunication sectors.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this blog post, we describe the attack flow and share details about the Saitama backdoor.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "in this blog post, we describe the attack flow and share details about the Saitama backdoor. if you have any questions, please contact us.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malicious email was sent to the victim via a Microsoft Outlook account with the subject \u201cConfirmation Receive Document\u201d with an Excel file called \u201cConfirmation Receive Document.xls\u201d. The sender pretends to be a person from the Government of Jordan by using its coat of arms as a signature.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the sender pretends to be a person from the government of Jordan. the email was sent via an Outlook account with the subject \"Confirmation Receive Document\"",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Excel attachment contains a macro that performs malicious activities. The document has an image that tries to convince the victim to enable a macro.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the attachment contains a macro that performs malicious activities. the document has an image that tries to convince the victim to enable the macro.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After enabling the macro, the image is replaced with the Jordan government\u2019s the coat of the arms:",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "after enabling the macro, the image is replaced with the coat of the arms. it was replaced by the government's 'cold of arms'",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The macro has been executed on WorkBook_Open(). Here are the main functionalities of this macro:",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the macro has been executed on WorkBook_Open(). here are the main functionalities of this macro: workbook_open().",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The dropped payload is a small backdoor that is written in .Net. It has the following interesting pdb path: E:SaitamaSaitama.AgentobjReleaseSaitama.Agent.pdb.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the dropped payload is written in.Net. It has the following interesting pdb path: E:Saitama.AgentobjRelease.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Saitama backdoor abuses the DNS protocol for its command and control communications. This is stealthier than other communication methods, such as HTTP. Also, the actor cleverly uses techniques such as compression and long random sleep times. They employed these tricks to disguise malicious traffic in between legitimate traffic.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "Saitama backdoor abuses the DNS protocol for command and control communications. the actor cleverly uses techniques such as compression and long random sleep times to disguise malicious traffic in between legitimate traffic.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Another element that we found interesting about this backdoor is the way that it is implemented. The whole flow of the program is defined explicitly as a finite-state machine, as shown in the Figure 7. In short, the machine will change its state depending on the command sent to every state. Graphically, the program flow can be seen as this:",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the entire flow of the program is defined explicitly as a finite-state machine, as shown in the figure 7. in short, the machine will change its state depending on the command sent to every state.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is the initial state of the machine. It just accepts the start command that puts the machine into the ALIVE state.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "it is the initial state of the machine. It just accepts the start command that puts it into the ALIVE state. if you want to know more about it, click here.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This state fetches the C&C server, expecting to receive a command from the attackers. These servers are generated by using the PRNG algorithm that involves transformations like the Mersenne Twister. These transformations will generate subdomains of the hard coded domains in the Config class (Figure 8).",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "this state fetches the C&C server, expecting to receive a command from the attackers. these transformations will generate subdomains of the hard coded domains in the Config class (Figure 8).",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This state has two possible next stages. If the performed DNS request fails, the next stage is SLEEP. Otherwise, the next stage is RECEIVE.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "this state has two possible next stages. if the performed DNS request fails, the next stage is SLEEP. Otherwise, it is RECEIVE.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These states put the backdoor in sleep mode. The amount of time that the program will sleep is determined by the previous stage. It is clear that one of the main motivations of the actor is to be as stealthy as possible. For example, unsuccessful DNS requests puts the backdoor in sleep mode for a time between 6 and 8 hours! There are different sleep times depending on the situations (values are expressed in milliseconds):",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the amount of time that the program will sleep is determined by the previous stage. unsuccessful DNS requests puts the backdoor in sleep mode for a time between 6 and 8 hours!",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There is also a \u201cSecond Sleep\u201d state that puts the program on sleep mode a different amount of time.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "\"Second Sleep\" state puts the program on sleep mode a different amount of time. it is also available in the u.s.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This state is used to receiving commands from the C&C servers. Commands are sent using the IP address field that is returned by the DNS requests. Further details about the communication protocol are provided later in this report. In a nutshell, every DNS request is capable of receiving 4 bytes. The backdoor will concatenate responses, building buffers in that way. These buffers will contain the commands that the backdoor will execute.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "commands are sent using the IP address field that is returned by the DNS requests. the backdoor will concatenate responses, building buffers in that way.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "That state will execute commands received from the server. The backdoor has capabilities like executing remote pre-established commands, custom commands or dropping files. The communication supports compression, also. The following figure shows the list of possible commands that can be executed by the backdoor.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the backdoor has capabilities like executing remote pre-established commands, custom commands or dropping files. that state will execute commands received from the server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is pretty shocking to see that even when attackers have the possibility of sending any command, they choose to add that predefined list in the backdoor in Base64 format. As we can see, some of them are common reconnaissance snippets, but some of them are not that common. In fact, some of the commands contain internal IPsand also internal domain names(like ise-posture.mofagov.gover.local). That shows that this malware was clearly targeted and also indicates that the actor has some previous knowledge about the internal infrastructure of the victim.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "some commands contain internal IPsand also internal domain names (like ise-posture.mofagov.gover.local). that shows that this malware was clearly targeted and indicates that the actor has some previous knowledge about the internal infrastructure of the victim.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Send state is used to send the results generated by commands to the actor\u2019s server. In this case, the name of the subdomain will contain the data. As domain names are used to exfiltrate unknown amounts of data, attackers had to split this data in different buffers. Every buffer is then sent through a different DNS request. As it can be seen in the Figure 12, all the required information in order to reconstruct original data is sent to the attackers. The size of the buffer is only sent in the first packet.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the send state is used to send the results generated by commands to the actor's server. each buffer is then sent through a different DNS request.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There are several indicators that suggest that this campaign has been operated by APT34.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "there are several indicators that suggest that this campaign has been operated by APT34. if you have any questions, please feel free to contact us in the comments below.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Malwarebytes customers are protected from this attack via our Anti-Exploit layer.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. the attackers are not responsible for the attack.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Maldoc:\nConfirmation Receive Document.xls\n26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b\nSaitama backdoor:\nupdate.exe\ne0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d\nC2s:\nuber-asia.com\nasiaworldremit.com\njoexpediagroup.com",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "exee0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52dC2s:uber-asia.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "December 15, 2023 - PikaBot, a stealthy malware normally distributed via malspam is now being spread via malicious ads.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "PikaBot, a stealthy malware normally distributed via malspam, is now being spread via malicious ads. it is being used to spread the malware via malware ads.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "December 15, 2023 - Google will soon roll out its Tracking Protection feature to some randomly chosen users in order to prepare for a full deployment.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "Google will soon roll out its Tracking Protection feature to some randomly chosen users in order to prepare for a full deployment. the feature is expected to be released on january 15, 2023.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "December 14, 2023 - Apple has plans to make it harder for iPhone thieves to steal your personal information even if they have your device\u2019s passcode.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "apple has plans to make it harder for thieves to steal your personal information even if they have your device's passcode. thieves will be stealing your information from their iPhones when they steal it.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "December 14, 2023 - A recently patched Apache Struts 2 vulnerability has been spotted in worldwide exploitation attempts. Users and admins should update ASAP.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "a recently patched Apache Struts 2 vulnerability has been spotted in worldwide exploitation attempts. users and admins should update ASAP.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "December 14, 2023 - The ALPHV ransomware group appears to be going through some things.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "the ALPHV ransomware group appears to be going through some things. the group is in the middle of a long-term battle with the u.s.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Want to stay informed on the latest news in cybersecurity? Sign up for our newsletter and learn how to protect your computer from threats.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "sign up for our newsletter and learn how to protect your computer from threats. if you want to stay informed on the latest cybersecurity news, contact us today.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cliccando su \u201cAccetta tutti i cookie\u201d, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare la navigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attivit\u00e0 di marketing.",
        "source": "APT34 targets Jordan Government using new Saitama backdoor.html",
        "summary": "accetta tutti i cookie sul dispositivo per migliorare la navigazione del sito e assister nelle nostre attivit\u00e0 di marketing.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Check Point Research discovered evidence of a new campaign by the Iranian threat group APT34 (aka OilRig), against what appears to be a Lebanese target, employing a new backdoor variant we dubbed SideTwist.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "check Point Research discovers evidence of a new campaign by the Iranian threat group APT34 (aka OilRig) against what appears to be an lebanese target.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since the 2019 leak of APT34\u2019s tools by an entity named \u201cLab Dookhtegan\u201d, the threat group has been actively retooling and updating their payload arsenal to try and avoid detection, creating several different malware variants whose ultimate purpose remained the same: to gain the initial foothold on the targeted device.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "since the 2019 leak of tools by an entity named \u201cLab Dookhtegan\u201d the threat group has been actively retooling and updating their payload arsenal to try and avoid detection.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Starting with the DNSpionage campaign back in 2018, APT34 has been observed targeting individuals through the use of booby-trapped job opportunity documents, delivered directly to the selected targets via LinkedIn messages. This activity continued through 2019 with the HardPass operation, in which the LinkedIn platform was used in the same manner.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "APT34 has been observed targeting individuals through the use of booby-trapped job opportunity documents, delivered directly to the selected targets via LinkedIn messages. this activity continued through 2019 with the HardPass operation, in which the platform was used in the same manner.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this latest campaign from January, a document submitted to VirusTotal from Lebanon (a common target for APT34), also depicts such a job opportunity document, although in this case we were unable to confirm the initial delivery mechanism to the target.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "document submitted to VirusTotal from Lebanon also depicts such a job opportunity document. in this case we were unable to confirm the initial delivery mechanism to the target.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the following article we analyze the latest infection chain used by the attackers and deep dive into the new malware variant.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "in the following article we analyze the latest infection chain used by the attackers and deep dive into the new malware variant. if you have any questions, please contact us for more information.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our analysis began with a malicious Microsoft Word document named Job-Details.doc (md5: 6615c410b8d7411ed14946635947325e).",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "our analysis began with a malicious Microsoft Word document named Job-Details.doc (md5: 6615c410b8d7411ed14946635947325e).",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The decoy document clearly tries to appear like a benign document, offering various positions in the Ntiva IT consulting company \u2013 a company based in Virginia, US.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the decoy document clearly tries to appear like a benign document, offering various positions in the Ntiva IT consulting company.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, once the user activates the embedded malicious macros, the full infection flow is triggered:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "once the user activates the embedded malicious macros, the full infection flow is triggered. if a macro is activated, it will trigger the infection.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Macros used by APT34\u2019s job opportunity campaigns have evolved through the years, but also managed to keep their own distinctive style and purpose:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "Macros used by APT34\u2019s job opportunity campaigns have evolved through the years. but also managed to keep their own distinctive style and purpose:",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the macros function call graph above, we can see that from the Document_Open and the Document_Close functions, there are multiple calls to the DnsQuery external function.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "in the macros function call graph above, we can see that from the Document_Open and document_Close functions, there are multiple calls to the DnsQuery external function.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34 is notorious for its heavy use of DNS tunneling through many of their different tools, and this time this feature also made its way into the initial macros stage.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "APT34 is notorious for its heavy use of DNS tunneling through many of their different tools. this feature also made its way into the initial macros stage.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the macros are executed, DNS requests are used to beacon back to the attacker, and inform them of the current stage of the execution, as well as to deliver some victim identifiable information.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "once the macros are executed, DNS requests are used to beacon back to the attacker, and inform them of the current stage of execution.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this step, the attacker is using the publicly available requestbin.net DNS tunneling service, in order to get updates about the macros infection progress. This way the attacker-owned infrastructure would not be exposed, in case a sandbox would not be able to fully \u201cdetonate\u201d the document.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "attacker is using the public available requestbin.net DNS tunneling service. this way the attacker-owned infrastructure would not be exposed, in case a sandbox wouldn't be able to fully \u201cdetonate\u201d the document.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Below is a demonstration of the information the attacker would see on the requesbin.net website, when a victim executes the malicious macros from a system with the following environment:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "below is a demonstration of the information the attacker would see on the requesbin.net website. attacker executes the malicious macros from the system with the following environment:",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The encoded data is derived from the PC information, in the following manner:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "encoded data is derived from the PC information, in the following manner: i.e. the computer information is used to encode the data.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor in this stage, is a variant we haven\u2019t seen before in previous APT34 operations, but provides functionality which is simple and similar to other C based backdoors utilized by the group: DNSpionage and TONEDEAF and TONEDEAF2.0. ",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor in this stage, is a variant we haven\u2019t seen before in previous APT34 operations, but provides functionality which is simple and similar to other C based Backdoors used by the group: DNSpionage and TONEDEAF.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The functionality of the backdoor includes download, upload and shell command execution.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor features download, upload and shell command execution. the command is executed using a command to execute shell commands and command commands.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this infection chain the persistence is actually established by the 1st stage macros, and the 2nd stage payload does not have any persistence mechanism of its own.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "in this infection chain the persistence is actually established by the 1st stage macros, and the 2nd stage payload does not have any persistence mechanism of its own.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Persistence is achieved in the 1st stage, when the schedule task is registered. The scheduled task named SystemFailureReporter will execute the 2nd stage payload every 5 minutes:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the scheduled task named SystemFailureReporter will execute the 2nd stage payload every 5 minutes. the schedule task is registered in the 1st stage.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor is very dependent on this persistence mechanism, as every time it would launch, it would only execute a single command provided from the C&C server and immediately shut down, until it is launched again by the scheduled task.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor is very dependent on this persistence mechanism. it would only execute a single command provided from the C&C server and immediately shut down until it is launched again by the scheduled task.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor starts by collecting basic information about the victim\u2019s machine and calculating a 4-byte long victim identifier, based on the user-name, computer-name and the domain name of the target environment. This identifier will be used in the follow-up C&C communication.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "backdoor collects basic information about the victim's machine. a 4-byte long victim identifier will be used in the follow-up C&C communication.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Next the malware will verify that the update.xml file that was supposed to be created in the 1st stage of the infection does indeed exists, and if not, it will terminate itself \u2013 printing the following text to the debugging output using the OutputDebugString function:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the malware will verify that the update.xml file that was supposed to be created in the 1st stage of the infection does indeed exist. if not, it will terminate itself \u2013 printing the following text to the debugging output using the OutputDebugString function:",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As the purpose of this function is to print debugging information, only during the debugging process of an application, the text will not be visible to the regular user.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the purpose of this function is to print debugging information only. the text will not be visible to the regular user during the process.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor\u2019s communication with the C&C server (sarmsoftware[.]com) is HTTP based on port 443 with port 80 as fallback.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor\u2019s communication with the C&C server (sarmsoftware[.]com) is HTTP based on port 443 with port 80 as fallback.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor uses two different techniques for its outgoing and incoming communications with the C&C server, though in both cases the same encryption algorithm is utilized (see more on encryption below).",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor uses two different techniques for outgoing and incoming communications with the C&C server. in both cases the same encryption algorithm is used (see more on encryption below).",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor contacts the C&C server in the following URL using a GET request:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the backdoor contacts the C&C server in the following URL using a GET request: if you have any questions, please contact the server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The response to this request is hidden in the source code of following Flickr lookalike page:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the response to this request is hidden in the source code of following Flickr lookalike page. if you have any questions, please contact us at cnn ireport.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The response is returned to the backdoor within the HTML code, in the following format:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the response is returned to the backdoor within the HTML code, in the following format. if you have any questions, please contact us for more information.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After this base64 string is decoded and decrypted, the plain-text content is in the following pipe-separated format:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "base64 string decoded and decrypted, the plain-text content is in the following pipe-separated format.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After the backdoor has executed an arbitrary command on the victim\u2019s machine, it returns the result of the executed command to the C&C server, to the same URL as before, but in a POST request instead of a GET:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "after the backdoor has executed an arbitrary command on the victim\u2019s machine, it returns the result of the executed command to the C&C server. instead of a GET:",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The format of the POST body is a simple JSON, based on the command number provided from the C&C server and the encrypted result of the command execution:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the format of the POST body is a simple JSON, based on the command number provided from the C&C server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As the basis for the encrypted communication, the attackers utilize the Mersenne Twister pseudorandom number generator.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the attackers use the Mersenne Twister pseudorandom number generator as the basis for the encrypted communication. if you have any questions, please contact us.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The 4 first bytes of each encrypted message is the seed for the Mersenne Twister, to be used for the decryption of the rest of the message.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the 4 first bytes of each encrypted message is the seed for the Mersenne Twister. it is used to decrypt the rest of the message.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The encrypted Base64 communication can be decrypted using the following Python snippet:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the encrypted base64 communication can be decrypted using the following Python snippet. Python can also be used to encrypt the communication.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Both the malicious macros, the backdoor, the targeting, and the techniques used in this operation \u2013 all align with previously reported campaigns attributed to APT34.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "both the malicious macros, the backdoor and the targeting are aligned with previously reported campaigns attributed to aPT34.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Besides the fact that like in previous APT34 operations, once again we see job opportunity documents being used to encourage the victim to enable macros, there are technical similarities as well.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "besides the fact that we see job opportunity documents being used to encourage the victim to enable macros, there are technical similarities as well.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34\u2019s backdoors DNSpionage and TONEDEAF are known to receive commands from the servers by searching for specific pattern hidden inside the HTML content of a legitimate looking website.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "DNSpionage and TONEDEAF are known to receive commands from the servers by searching for specific pattern hidden inside the HTML content of a legitimate looking website.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In our case the attackers utilized a Flickr lookalike page, while in previous campaigns GitHub, Wikipedia, and Microsoft lookalikes were used.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "in our case the attackers utilized a Flickr lookalike page. in previous campaigns GitHub, Wikipedia, and Microsoft were used.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While analyzing the above campaign, this and additional APT34 related documents were uploaded to VirusTotal and noted by malware researchers on Twitter.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "this and additional APT34 related documents were uploaded to VirusTotal and noted by malware researchers on twitter. this was analyzed by a malware researcher while analyzing the above campaign.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These documents utilized the very same requestbin.net DNS tunneling service in the initial macros and delivered another of the group\u2019s signature tools: a variant of the .NET based backdoor named Karkoff, which utilized internet facing exchange servers as a communication method with the attackers.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "these documents utilized the same requestbin.net DNS tunneling service in the initial macros and delivered another of the group\u2019s signature tools.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The newly found artifacts emphasize the extent of the ongoing APT34\u2019s offensive operations against targets in the Middle East, and especially in Lebanon:",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the newly found artifacts emphasize the extent of the ongoing offensive operations against targets in the Middle East, and especially in Lebanon:.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Karkoff implant (MD5: ab25014c3d6f77ec5880c8f9728be968) included credentials for an exchange server belonging to the Lebanese Government (mail.army.gov[.]lb), which might be an indication of a long running compromise of their network.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "the Karkoff implant (MD5: ab25014c3d6f77ec5880c8f9728be968) included credentials for an exchange server belonging to the lebanese government.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Iran backed APT34 shows no sign of slowing down, further pushing its political agenda in the middle-east, with an ongoing focus on Lebanon \u2013 using offensive cyber operations.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "Iran backed APT34 shows no sign of slowing down, further pushing its political agenda in the middle-east. an ongoing focus on Lebanon \u2013 using offensive cyber operations.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While maintaining its modus operandi and reusing old techniques, as reviewed above, the group continues to create new and updated tools to minimize the possible detection of their tools by security vendors.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "while maintaining its modus operandi and reusing old techniques, the group continues to create new and updated tools to minimize the possible detection by security vendors.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this publication we analyzed the newest backdoor variant deployed by the group\u2019s ongoing job opportunities campaigns, which includes malicious documents with job offers \u2013 a technique they have successfully employed since at least 2018.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "in this publication we analyzed the newest backdoor variant deployed by the group\u2019s ongoing job opportunities campaigns. it includes malicious documents with job offers - a technique they have successfully employed since at least 2018.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Check Point Sandblast protects against this APT attack, and prevents it from the very first steps.  ",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "check Point Sandblast protects against this APT attack, and prevents it from the very first steps. check point sandblast is the latest in a series of attacks in the u.s.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u2014Please choose an option\u2014\nChina\nIndia\nUnited States\nIndonesia\nBrazil\nPakistan\nNigeria\nBangladesh\nRussia\nJapan\nMexico\nPhilippines\nVietnam\nEthiopia\nEgypt\nGermany\nIran\nTurkey\nDemocratic Republic of the Congo\nThailand\nFrance\nUnited Kingdom\nItaly\nBurma\nSouth Africa\nSouth Korea\nColombia\nSpain\nUkraine\nTanzania\nKenya\nArgentina\nAlgeria\nPoland\nSudan\nUganda\nCanada\nIraq\nMorocco\nPeru\nUzbekistan\nSaudi Arabia\nMalaysia\nVenezuela\nNepal\nAfghanistan\nYemen\nNorth Korea\nGhana\nMozambique\nTaiwan\nAustralia\nIvory Coast\nSyria\nMadagascar\nAngola\nCameroon\nSri Lanka\nRomania\nBurkina Faso\nNiger\nKazakhstan\nNetherlands\nChile\nMalawi\nEcuador\nGuatemala\nMali\nCambodia\nSenegal\nZambia\nZimbabwe\nChad\nSouth Sudan\nBelgium\nCuba\nTunisia\nGuinea\nGreece\nPortugal\nRwanda\nCzech Republic\nSomalia\nHaiti\nBenin\nBurundi\nBolivia\nHungary\nSweden\nBelarus\nDominican Republic\nAzerbaijan\nHonduras\nAustria\nUnited Arab Emirates\nIsrael\nSwitzerland\nTajikistan\nBulgaria\nHong Kong (China)\nSerbia\nPapua New Guinea\nParaguay\nLaos\nJordan\nEl Salvador\nEritrea\nLibya\nTogo\nSierra Leone\nNicaragua\nKyrgyzstan\nDenmark\nFinland\nSlovakia\nSingapore\nTurkmenistan\nNorway\nLebanon\nCosta Rica\nCentral African Republic\nIreland\nGeorgia\nNew Zealand\nRepublic of the Congo\nPalestine\nLiberia\nCroatia\nOman\nBosnia and Herzegovina\nPuerto Rico\nKuwait\nMoldov\nMauritania\nPanama\nUruguay\nArmenia\nLithuania\nAlbania\nMongolia\nJamaica\nNamibia\nLesotho\nQatar\nMacedonia\nSlovenia\nBotswana\nLatvia\nGambia\nKosovo\nGuinea-Bissau\nGabon\nEquatorial Guinea\nTrinidad and Tobago\nEstonia\nMauritius\nSwaziland\nBahrain\nTimor-Leste\nDjibouti\nCyprus\nFiji\nReunion (France)\nGuyana\nComoros\nBhutan\nMontenegro\nMacau (China)\nSolomon Islands\nWestern Sahara\nLuxembourg\nSuriname\nCape Verde\nMalta\nGuadeloupe (France)\nMartinique (France)\nBrunei\nBahamas\nIceland\nMaldives\nBelize\nBarbados\nFrench Polynesia (France)\nVanuatu\nNew Caledonia (France)\nFrench Guiana (France)\nMayotte (France)\nSamoa\nSao Tom and Principe\nSaint Lucia\nGuam (USA)\nCuracao (Netherlands)\nSaint Vincent and the Grenadines\nKiribati\nUnited States Virgin Islands (USA)\nGrenada\nTonga\nAruba (Netherlands)\nFederated States of Micronesia\nJersey (UK)\nSeychelles\nAntigua and Barbuda\nIsle of Man (UK)\nAndorra\nDominica\nBermuda (UK)\nGuernsey (UK)\nGreenland (Denmark)\nMarshall Islands\nAmerican Samoa (USA)\nCayman Islands (UK)\nSaint Kitts and Nevis\nNorthern Mariana Islands (USA)\nFaroe Islands (Denmark)\nSint Maarten (Netherlands)\nSaint Martin (France)\nLiechtenstein\nMonaco\nSan Marino\nTurks and Caicos Islands (UK)\nGibraltar (UK)\nBritish Virgin Islands (UK)\nAland Islands (Finland)\nCaribbean Netherlands (Netherlands)\nPalau\nCook Islands (NZ)\nAnguilla (UK)\nWallis and Futuna (France)\nTuvalu\nNauru\nSaint Barthelemy (France)\nSaint Pierre and Miquelon (France)\nMontserrat (UK)\nSaint Helena, Ascension and Tristan da Cunha (UK)\nSvalbard and Jan Mayen (Norway)\nFalkland Islands (UK)\nNorfolk Island (Australia)\nChristmas Island (Australia)\nNiue (NZ)\nTokelau (NZ)\nVatican City\nCocos (Keeling) Islands (Australia)\nPitcairn Islands (UK)",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "ChinaIndiaUnited StatesItalyBurmaSouth AfricaSouth KoreaSpainUkraineTanzaniaKenyaArgentinaAlgeriaPolandSudanUgandaCanadaIraqMoroccoPeruUzbekistanSaudi ArabiaMalaysiaVenezuelaNepalAfghanistanYemenNorth KoreaGhanaMozambiqueTa",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cliccando su \u201cAccetta tutti i cookie\u201d, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare la navigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attivit\u00e0 di marketing.",
        "source": "Iran\u2019s APT34 Returns with an Updated Arsenal - Check Point Research.html",
        "summary": "accetta tutti i cookie sul dispositivo per migliorare la navigazione del sito e assister nelle nostre attivit\u00e0 di marketing.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This website stores cookies and tracking technologies. These cookies are used in order to improve your browsing experience, for analytics purposes, and to serve targeted ads. By using and accessing this site, you agree to our Terms of Use and Privacy Policy.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "these cookies are used to improve your browsing experience, for analytics purposes, and to serve targeted ads. by using and accessing this site, you agree to our Terms of Use and Privacy Policy.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Country\nUnited States\nCanada\nAfghanistan\nAlbania\nAlgeria\nAndorra\nAngola\nAntigua and Barbuda\nArgentina\nArmenia\nAruba\nAustralia\nAustria\nAzerbaijan\nBahamas\nBahrain\nBangladesh\nBarbados\nBelarus\nBelgium\nBelize\nBenin\nBermuda\nBhutan\nBolivia\nBosnia and Herzegovina\nBotswana\nBrazil\nBrunei\nBulgaria\nBurkina Faso\nBurundi\nCambodia\nCameroon\nCape Verde\nCayman Islands\nCentral African Republic\nChad\nChile\nChina\nColombia\nComoros\nDemocratic Republic of the Congo (Kinshasa)\nCongo, Republic of(Brazzaville)\nCosta Rica\nCroatia\nCuba\nCyprus\nCzechia\nDenmark\nDjibouti\nDominica\nDominican Republic\nEast Timor (Timor-Leste)\nEcuador\nEgypt\nEl Salvador\nEquatorial Guinea\nEritrea\nEstonia\nEthiopia\nFiji\nFinland\nFrance\nGabon\nGambia\nGeorgia\nGermany\nGhana\nGibraltar\nGreece\nGrenada\nGuatemala\nGuinea\nGuinea-Bissau\nGuyana\nHaiti\nHonduras\nHong Kong\nHungary\nIceland\nIndia\nIndonesia\nIran, Islamic Republic of\nIraq\nIreland\nIsrael\nItaly\nIvory Coast\nJamaica\nJapan\nJordan\nKazakhstan\nKenya\nKiribati\nKorea, Democratic People's Republic of(North Korea)\nKorea, Republic of\nKosovo\nKuwait\nKyrgyzstan\nLao People's Democratic Republic\nLatvia\nLebanon\nLesotho\nLiberia\nLibya\nLiechtenstein\nLithuania\nLuxembourg\nMacau\nMacedonia, Rep. of\nMadagascar\nMalawi\nMalaysia\nMaldives\nMali\nMalta\nMarshall Islands\nMauritania\nMauritius\nMexico\nMicronesia, Federal States of\nMoldova, Republic of\nMonaco\nMongolia\nMontenegro\nMorocco\nMozambique\nMyanmar, Burma\nNamibia\nNauru\nNepal\nNetherlands\nNew Caledonia\nNew Zealand\nNicaragua\nNiger\nNigeria\nNorway\nOman\nPakistan\nPalau\nPalestinian territories\nPanama\nPapua New Guinea\nParaguay\nPeru\nPhilippines\nPoland\nPortugal\nPuerto Rico\nQatar\nRomania\nRussian Federation\nRwanda\nSaint Kitts and Nevis\nSaint Lucia\nSaint Vincent and the Grenadines\nSamoa\nSan Marino\nSao Tome and Principe\nSaudi Arabia\nSenegal\nSerbia\nSeychelles\nSierra Leone\nSingapore\nSlovakia\nSlovenia\nSolomon Islands\nSomalia\nSouth Africa\nSouth Sudan\nSpain\nSri Lanka\nSudan\nSuriname\nSwaziland\nSweden\nSwitzerland\nSyria, Syrian Arab Republic\nTaiwan\nTajikistan\nTanzania; officially the United Republic of Tanzania\nThailand\nTibet\nTogo\nTonga\nTrinidad and Tobago\nTunisia\nTurkey\nTurkmenistan\nTuvalu\nUganda\nUkraine\nUnited Arab Emirates\nUnited Kingdom\nUruguay\nUzbekistan\nVanuatu\nVatican City State (Holy See)\nVenezuela\nViet Nam\nYemen\nZambia\nZimbabwe",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "countryUnited StatesCanadaAfghanistanAlbaniaAlgeriaAndorraAngolaAntigua and BarbudaArgentinaArmeniaArubaAustraliaAustriaAzerbaijanBahamasbahrainBangladeshBarbadosBelarusBelizeBeninBermudaBhutanBoliviaBosnia. and HerzegovinaBotswana",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our researchers Paul Litvak and Michael Kajilolti have discovered a new campaign conducted by APT34 employing an updated toolset. Based on uncovered phishing documents, we believe this Iranian actor is targeting Westat employees, or United States organizations hiring Westat services.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "researchers have discovered a new campaign using an updated toolset. they believe this Iranian actor is targeting westat employees, or United States organizations hiring Westat services.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Westat is a United States-based company that \u201cprovides research services to agencies of the U.S. Government, as well as businesses, foundations, and state and local governments\u201d. One example of the services Westat offers is a survey for federal workers, which leads us to believe this attack may target Westat customers.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "westat offers research services to agencies of the u.s. government, businesses, foundations, and state and local governments. a survey for federal workers leads us to believe this attack may target Westat customers.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Official Westat response: \u201cWestat understands that in their effort to identify threats and malware, Intezer has identified a malicious file that uses the Westat name and logo. This file was not created by, hosted by, or sent from Westat, and is likely the result of a bad actor stealing the Westat brand name and logo. Our cybersecurity team is working with Intezer and others to fully understand the nature of this report. We will continue to monitor the situation and respond accordingly.\u201d",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "\"Westat understands that in their effort to identify threats and malware, Intezer has identified a malicious file that uses the Westat name and logo.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34 (also known as OilRig or Helix Kitten) is a cluster of Iranian government-backed cyber espionage activities that has been active since 2014. The group is known to target various international organizations, mainly in the Middle East. Among their targeted industries are government agencies, financial services, energy and utilities, telecommunications, and oil and gas.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "APT34 (also known as OilRig or Helix Kitten) is a cluster of cyber espionage activities that has been active since 2014.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "More light was shed on this group in April 2019 as leaks emerged from a mysterious individual with the pseudonym \u201cLab Dookhtegan\u201d. This individual exposed data belonging to victims of this group, together with source code of hacking tools and data about previous APT34 operations; including IP addresses and domains where the group hosted web shells related to past operations.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "leaks emerged from a mysterious individual with the pseudonym \"Lab dookhtegan\" this individual exposed data belonging to victims of this group, together with source code of hacking tools and data about previous APT34 operations.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Most recently, FireEye exposed a spear-phishing operation conducted by APT34, which enabled us to connect this operation to this Iranian actor due to similarities in the techniques and tools employed in both campaigns.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "most recently, fireEye exposed a spear-phishing operation conducted by APT34. it enabled us to connect this operation to this Iranian actor due to similarities in the techniques and tools employed in both campaigns.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In late January 2020, we discovered a file named survey.xls that was designed to look like an employee satisfaction survey tailored to either Westat employees or Westat customers.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "in late January 2020, we discovered a file named survey.xls that looked like an employee satisfaction survey tailored to either westat employees or customers.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At first the spreadsheet appeared to be blank. Only once the victim enables macros, the survey is displayed to the user and the malicious VBA code begins to execute.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "at first the spreadsheet appeared blank. only once the victim enables macros, the survey is displayed to the user and the malicious VBA code begins to execute.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The embedded VBA code unpacks a zip file into a temporary folder, extracts a \u201cClient update.exe\u201d executable file and installs it to \u201cC:Users<User>valsClient update.exe\u201d.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "embedding VBA code unpacks zip file into temporary folder. extracts executable file and installs it to \"C:Users>valsClient update.exe\"",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u201cClient update.exe\u201d is actually a highly modified version of the TONEDEAF malware, which we named TONEDEAF 2.0. Finally, the crtt function creates a scheduled task \u201cCheckUpdate\u201d that runs the unpacked executable five minutes after being infected by it, as well as on future log-ons.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "\u201cClient update.exe\u201d is actually a highly modified version of the TONEDEAF malware. it runs the executable five minutes after being infected by it, as well as on future log-ons.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Both the extracted VBA code and the functionality of the code look similar to the one analyzed in the FireEye report:",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "both the extracted VBA code and the functionality of the code look similar to the one analyzed in the fireEye report:.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition, we found a similar document labelled as \u201cEmployee satisfaction survey.xls\u201d containing the same survey as the previous document.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "we found a similar document labelled \"Employee satisfaction survey.xls\" containing the same survey as the previous document.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, it\u2019s important to highlight that the code page field of this document is Arabic as can be seen when examining its file metadata, denoting the preferred language installed on the document author\u2019s version of Microsoft Excel:",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "the code page field of this document is Arabic as can be seen when examining its file metadata, denoting the preferred language installed on the document author\u2019s version of Microsoft Excel:",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At first glance, \u201cClient update.exe\u201d seems like a completely new backdoor malware. However, further examination reveals it\u2019s most likely a highly modified version of the previously seen TONEDEAF backdoor. TONEDEAF is a backdoor that communicates with its Command and Control server via HTTP in order to receive and execute commands. It was mentioned in FireEye\u2019s recent report about an ongoing APT34 operation, as one of the group\u2019s custom tools. We have named the new variant TONEDEAF 2.0.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "TONEDEAF is a backdoor that communicates with its Command and Control server via HTTP in order to receive and execute commands. it was mentioned in fireEye\u2019s recent report about an ongoing APT34 operation, as one of the group's custom tools.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "TONEDEAF 2.0 is an advanced version of TONEDEAF, serving the same purpose as the original, but with a revamped C2 communication protocol and a substantially modified code base. In contrast to the original TONEDEAF, TONEDEAF 2.0 contains solely arbitrary shell execution capabilities, and doesn\u2019t support any predefined commands. It\u2019s also more stealthy and contains new tricks such as dynamic importing, string decoding, and a victim deception method.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "TONEDEAF 2.0 serves the same purpose as the original, but with a revamped C2 communication protocol and modified code base. it contains solely arbitrary shell execution capabilities, and doesn\u2019t support predefined commands.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Upon execution the backdoor checks whether it was executed with \u201c\u2026\u201d as an argument, which is the way it\u2019s configured to execute by the scheduled task, as part of the proper infection chain.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "Upon execution the backdoor checks whether it was executed with \"...\" as an argument, which is the way it\u2019s configured to execute by the scheduled task.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the case it\u2019s executed without the correct argument, such as by launching it via a double click, it will display a blank GUI Window to the user. This is most likely intended to serve as a deception method, to make the malware appear like a legitimate (alibiet broken) application titled \u201cBee\u201d.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "in the case it\u2019s executed without the correct argument, such as by launching it via a double click, it will display an empty GUI Window to the user. this is most likely intended to serve as deception method, to make the malware appear like an legitimate (alibiet broken) application titled \u201cBee\u201d.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "TONEDEAF 2.0 also attempts to be more stealthy than its predecessor by hiding many of the interesting API imports it uses. The names of these APIs, and the DLLs that contain them, are stored as encoded strings and are decoded and resolved on demand during runtime.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "the names of these APIs, and the DLLs that contain them, are stored as encoded strings and are resolved on demand during runtime.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor uses HTTP for C2 communication, with a custom encoding and handshake mechanisms. Messages sent by the backdoor always contain the HTTP query parameter \u201c?ser=<6 digits>\u201d as an identifier. The first three digits are the <server_id> and the last three are the <client_id>.  The backdoor will use one of the following two messages:",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "Messages sent by the backdoor always contain the HTTP query parameter. the first three digits are the server_id>.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "1. GET /dow?ser=<server_id><client_id>  \u2013 request message, used to obtain commands to execute from the server.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "GET /dow?ser=server_id> \u2013 request message, used to obtain commands to execute from the server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "2. POST /upl?ser==<server_id><client_id>  \u2013 reply to command message, used to send the executed command\u2019s output to the server.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "POST /upl?ser==server_id> \u2013 reply to command message, used to send executed command's output to server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Before performing the first request, the malware will generate the <client_id> derived from the environment variables %HOMEPATH% and %COMPUTERNAME% using a custom formula.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "before performing the first request, the malware will generate the client_id> derived from the environment variables %HOMEPATH%.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It will then send an initial GET message to the C2 using that ID.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "it will send an initial GET message to the C2 using that ID. the initial message will then be sent to a C2.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One odd element about the communication is the usage of a Windows Phone User-Agent  value in the HTTP message.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "one odd element about the communication is the use of a Windows Phone User-Agent value in the HTTP message. if you have any questions, please contact us for more information.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During our analysis the C2 was alive but continuously replied with a 403 Forbidden HTTP error code to our requests. It\u2019s possible that the C2 is filtering the targets since this backdoor is part of a targeted operation and our client_id parameter does not match that of one of the intended victims.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "During our analysis the C2 was alive but continuously replied with a 403 Forbidden HTTP error code to our requests. the client_id parameter does not match that of one of the intended victims.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Should the C2 accept the ID, it will reply with an encoded message that contains the <server_id> and the command the backdoor needs to execute. The malware extracts the command by looking for an HTTP div element in the response with a special class name.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "if the C2 accepts the ID, it will reply with an encoded message that contains the server_id> and the command the backdoor needs to execute.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware will then execute the command by prepending it with \u201ccmd U c\u201d and will send the output of the command back to the C2 using the POST reply message (2).",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "the malware will then execute the command by prepending it with \u201ccmd U c\u201d and send the output to the C2 using the POST reply message (2).",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When entering the C2 via a browser, the site tries to imitate https://docs.microsoft.com/en-us/, although it fails to display it properly due to a misconfiguration with the CSS, as can be seen in the console:",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "when entering the C2 via a browser, the site tries to imitate https://docs.microsoft.com/en-us/, although it fails to display it properly.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have also observed that an SSL certificate has been recently generated that matches the domain of the C2.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "we have also observed that an SSL certificate has been recently generated that matches the domain of the C2. a certificate is currently being generated in the u.s.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "SSL Certificate for the C2 Domain that was Issued One Month Ago",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "SSL Certificate for the C2 Domain that was Issued One Month Ago was issued a month ago. SSL certificates were issued to the c2 domain in january.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These findings might indicate that the attackers are in the process of transitioning into HTTPS for C2 communication, in an attempt to improve their OPSEC capabilities and avoid detection.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "attackers are in the process of transitioning into HTTPS for C2 communication in an attempt to improve their OPSEC capabilities and avoid detection.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "With all of the changes and new additions, there are still enough similarities that link TONEDEAF 2.0 to the original. While the code is mostly modified, the general flow and functionality are similar. The C2 communication is different but still has similarities to its predecessor, such as the usage of three digit identifiers for both the victim and the server. However, most notably there are several places in the code where the similarity is most clear. One such place is a function that exists in both variants, which oddly enough creates a notification icon in the Windows status bar. The only notable changes are the usage of dynamic API resolution and the shortening of the notification message from \u201cUpdating\u201d to \u201cup\u201d.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "the code is mostly modified but still has similarities to its predecessor. a function exists in both variants, which oddly enough creates an icon in the Windows status bar. the only notable changes are the usage of dynamic API resolution and the shortening of the notification message from \u201cUpdating\u201d to \u201cup\u201d.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Another instance is the code that sets the working directory of the program. It appears in different stages for each variant, but is identical:",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "another instance is the code that sets the working directory of the program. it appears in different stages for each variant, but is identical: i.e.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We were unable to download further modules, however, we believe this operation also includes the usage of a VALUEVAULT implant. VALUEVAULT is a browser credential theft tool built in Golang, discovered by FireEye in the aforementioned APT34 operation analysis.\nWe found the survey.xls file uploaded to VirusTotal with a VALUEVAULT instance and a TONEDEAF 2.0 instance, uploaded from Lebanon by the same user, only a few minutes apart. This may indicate that these malware were delivered together as part of the same attack.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "VALUEVAULT is a browser credential theft tool built in Golang. fireEye found the survey.xls file uploaded to VirusTotal with the same instance and TONEDEAF 2.0 instance, uploaded from Lebanon.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This VALUEVAULT takes a more minimalistic approach than its predecessor. Many functionalities and strings were stripped from the new binary in order to lower its noise. Only Chrome password dumping is now supported, although interestingly the use of the file \u201cfsociety.dat\u201d as a password data store under the \u201cAppData\\Roaming\u201d directory stayed the same.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "this VALUEVAULT takes a more minimalistic approach than its predecessor. many functionalities and strings were stripped from the new binary in order to lower its noise. only Chrome password dumping is now supported, although the use of the file \u201cfsociety.dat\u201d as an password data store under the \u201cAppDataRoaming\u201d directory stayed the same.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Furthermore, VALUEVAULT 2.0 is a 64-bit binary as opposed to VALUEVAULT 1.0 which is a 32-bit binary. These relatively minor changes were enough to create a fully undetected implant.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "VALUEVAULT 2.0 is a 64-bit binary. these relatively minor changes were enough to create an undetected implant.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The last APT34 operation was exposed only a few months ago by FireEye, and judging by our current findings we can confidently state that the group has since evolved its operations. The technical analysis of the new malware variants reveals this Iranian government-backed group has invested substantial efforts into upgrading its toolset in an attempt to evade future detection.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "the last APT34 operation was exposed only a few months ago by fireEye. the technical analysis of the new malware variants reveals this government-backed group has invested substantial efforts into upgrading its toolset in an attempt to evade future detection.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The binary code from these new malware samples are now indexed in our Genetic Malware Analysis platform, Intezer Analyze. We encourage you to use our free community edition to detect and classify threats that share code with APT34 malware.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "binary code from these new malware samples is now indexed in our genetic Malware Analysis platform, Intezer Analyze. we encourage you to use our free community edition to detect and classify threats that share code with APT34 malware.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Paul is a malware analyst and reverse engineer at Intezer. He previously served as a developer in the Israel Defense Force (IDF) Intelligence Corps for three years.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "Paul is an analyst and reverse engineer at intezer. he previously served as a developer in the Israel Defense Force (IDF) Intelligence Corps for three years.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Michael is a security researcher turned product manager, who previously led the Intezer Analyze product lifecycle. He has presented his malware research at conferences such as REcon and the Chaos Communications Congress (CCC).",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "Michael is a security researcher turned product manager. he has presented his research at conferences such as REcon and the Chaos Communications Congress (CCC).",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Count on Intezer\u2019s Autonomous SOC solution to handle your Level 1 SOC. Leave the SOC grunt work to Intezer.",
        "source": "Iranian Campaign Tailored to US Companies Uses Updated Toolset - Intezer.html",
        "summary": "Count on Intezer's Autonomous SOC solution to handle your Level 1 sOC. leave the grunt work to your level 1sc.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see. Learn more.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "mandiant.com uses cookies to deliver and enhance the quality of its services and analyze traffic. if you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see. Learn more.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "mandiant.com uses cookies to deliver and enhance the quality of its services and analyze traffic. if you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Less than a week after Microsoft issued a patch for CVE-2017-11882 on Nov. 14, 2017, FireEye observed an attacker using an exploit for the Microsoft Office vulnerability to target a government organization in the Middle East. We assess this activity was carried out by a suspected Iranian cyber espionage threat group, whom we refer to as APT34, using a custom PowerShell backdoor to achieve its objectives.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "fireEye observed an attacker using an exploit for the Microsoft Office vulnerability to target a government organization in the middle east. we assess this activity was carried out by an suspected Iranian cyber espionage threat group, whom we refer to as APT34.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe APT34 is involved in a long-term cyber espionage operation largely focused on reconnaissance efforts to benefit Iranian nation-state interests and has been operational since at least 2014. This threat group has conducted broad targeting across a variety of industries, including financial, government, energy, chemical, and telecommunications, and has largely focused its operations within the Middle East. We assess that APT34 works on behalf of the Iranian government based on infrastructure details that contain references to Iran, use of Iranian infrastructure, and targeting that aligns with nation-state interests.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "we believe that APT34 is involved in a long-term cyber espionage operation largely focused on reconnaissance efforts to benefit Iranian nation-state interests. this threat group has conducted broad targeting across industries, including financial, government, energy, chemical, and telecommunications.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34 uses a mix of public and non-public tools, often conducting spear phishing operations using compromised accounts, sometimes coupled with social engineering tactics. In May 2016, we published a blog detailing a spear phishing campaign targeting banks in the Middle East region that used macro-enabled attachments to distribute POWBAT malware. We now attribute that campaign to APT34. In July 2017, we observed APT34 targeting a Middle East organization using a PowerShell-based backdoor that we call POWRUNER and a downloader with domain generation algorithm functionality that we call BONDUPDATER, based on strings within the malware. The backdoor was delivered via a malicious .rtf file that exploited CVE-2017-0199.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "in July 2017, we observed a spear phishing campaign targeting banks in the middle east region that used macro-enabled attachments to distribute POWBAT malware. we now attribute that campaign to APT34.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this latest campaign, APT34 leveraged the recent Microsoft Office vulnerability CVE-2017-11882 to deploy POWRUNER and BONDUPDATER.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "APT34 leveraged the recent Microsoft Office vulnerability CVE-2017-11882 to deploy POWRUNER and BONDUPDATER.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The full report on APT34 is available to our MySIGHT customer community. APT34 loosely aligns with public reporting related to the group \"OilRig\". As individual organizations may track adversaries using varied data sets, it is possible that our classifications of activity may not wholly align.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "APT34 loosely aligns with public reporting related to the group \"OilRig\" individual organizations may track adversaries using varied data sets.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CVE-2017-11882 affects several versions of Microsoft Office and, when exploited, allows a remote user to run arbitrary code in the context of the current user as a result of improperly handling objects in memory. The vulnerability was patched by Microsoft on Nov. 14, 2017. A full proof of concept (POC) was publicly released a week later by the reporter of the vulnerability.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "CVE-2017-11882 affects several versions of Microsoft Office. the vulnerability was patched by Microsoft on Nov. 14, 2017.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The vulnerability exists in the old Equation Editor (EQNEDT32.EXE), a component of Microsoft Office that is used to insert and evaluate mathematical formulas. The Equation Editor is embedded in Office documents using object linking and embedding (OLE) technology. It is created as a separate process instead of child process of Office applications. If a crafted formula is passed to the Equation Editor, it does not check the data length properly while copying the data, which results in stack memory corruption. As the EQNEDT32.exe is compiled using an older compiler and does not support address space layout randomization (ASLR), a technique that guards against the exploitation of memory corruption vulnerabilities, the attacker can easily alter the flow of program execution.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the old Equation Editor (EQNEDT32.EXE) is embedded in Office documents using object linking and embedding technology. it is created as a separate process instead of child process of Office applications. the attacker can easily alter the flow of program execution.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34 sent a malicious .rtf file (MD5: a0e6933f4e0497269620f44a083b2ed4) as an attachment in a malicious spear phishing email sent to the victim organization. The malicious file exploits CVE-2017-11882, which corrupts the memory on the stack and then proceeds to push the malicious data to the stack. The malware then overwrites the function address with the address of an existing instruction from EQNEDT32.EXE. The overwritten instruction (displayed in Figure 1) is used to call the \u201cWinExec\u201d function from kernel32.dll, as depicted in the instruction at 00430c12, which calls the \u201cWinExec\u201d function.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "malicious file exploits CVE-2017-11882, which corrupts memory on the stack. the malware then overwrites the function address with the address of an existing instruction from EQNEDT32.EXE.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After exploitation, the \u2018WinExec\u2019 function is successfully called to create a child process, \u201cmshta.exe\u201d, in the context of current logged on user. The process \u201cmshta.exe\u201d downloads a malicious script from hxxp://mumbai-m[.]site/b.txt and executes it, as seen in Figure 2.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "process \u201cmshta.exe\u201d downloads malicious script from hxxp://mumbai-m[.]site/b.txt.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malicious script goes through a series of steps to successfully execute and ultimately establish a connection to the command and control (C2) server. The full sequence of events starting with the exploit document is illustrated in Figure 3.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the malicious script goes through a series of steps to successfully execute. the full sequence of events starting with the exploit document is illustrated in Figure 3.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 4 contains an excerpt of the v.vbs script pertaining to the Execution Workflow section.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "Figure 4 contains an excerpt of the v.vbs script pertaining to the Execution Workflow section. if you want to know more about the script, click here for more details.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After successful execution of the steps mentioned in the Execution Workflow section, the Task Scheduler will launch GoogleUpdateschecker.vbs every minute, which in turn executes the dUpdateCheckers.ps1 and hUpdateCheckers.ps1 scripts. These PowerShell scripts are final stage payloads \u2013 they include a downloader with domain generation algorithm (DGA) functionality and the backdoor component, which connect to the C2 server to receive commands and perform additional malicious activities. ",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "GoogleUpdateschecker.vbs executes the steps mentioned in the Execution Workflow section. the task scheduler will launch the scripts every minute, which execute the dUpdatecheckers.ps1 and hUpdateCheckers, respectively. they include a downloader with domain generation algorithm (DGA) functionality and the backdoor component which connect to the C2 server to receive commands and perform additional malicious activities.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor component, POWRUNER, is a PowerShell script that sends and receives commands to and from the C2 server. POWRUNER is executed every minute by the Task Scheduler. Figure 5 contains an excerpt of the POWRUNER backdoor.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the backdoor component, POWRUNER, is a PowerShell script that sends commands to and from the C2 server.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "POWRUNER begins by sending a random GET request to the C2 server and waits for a response. The server will respond with either \u201cnot_now\u201d or a random 11-digit number. If the response is a random number, POWRUNER will send another random GET request to the server and store the response in a string. POWRUNER will then check the last digit of the stored random number response, interpret the value as a command, and perform an action based on that command. The command values and the associated actions are described in Table 1.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the server will respond with either \u201cnot_now\u201d or a random 11-digit number. POWRUNER will then check the last digit of the stored random number response and perform an action based on that command values and the associated actions are described in Table 1.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Check for file path and upload (PUT) the file to server",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "check for file path and upload (PUT) the file to server. if you have any questions, please contact the server at the bottom of the page.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After successfully executing the command, POWRUNER sends the results back to the C2 server and stops execution.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "after successfully executing the command, POWRUNER sends the results back to the C2 server. he stops the execution.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The C2 server can also send a PowerShell command to capture and store a screenshot of a victim\u2019s system. POWRUNER will send the captured screenshot image file to the C2 server if the \u201cfileupload\u201d command is issued. Figure 6 shows the PowerShell \u201cGet-Screenshot\u201d function sent by the C2 server.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the C2 server can also send a PowerShell command to capture and store screenshots. the command will send the captured screenshot image file to the server if the \u201cfileupload\u201d command is issued.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One of the recent advancements by APT34 is the use of DGA to generate subdomains. The BONDUPDATER script, which was named based on the hard-coded string \u201cB007\u201d, uses a custom DGA algorithm to generate subdomains for communication with the C2 server.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the BONDUPDATER script was named based on the hard-coded string \"B007\" the script uses a custom DGA algorithm to generate subdomains.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 7 provides a breakdown of how an example domain (456341921300006B0C8B2CE9C9B007.mumbai-m[.]site) is generated using BONDUPDATER\u2019s custom DGA.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "Figure 7 shows how an example domain (456341921300006B0C8B2CE9C9B0707mumbai-m[.]site is generated using BONDUPDATER\u2019s custom DGA.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "BONDUPDATER will attempt to resolve the resulting DGA domain and will take the following actions based on the IP address resolution:",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "BONDUPDATER will attempt to resolve the resulting DGA domain and take the following actions based on the IP address resolution.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some examples of the generated subdomains observed at time of execution include:",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "some examples of the generated subdomains observed at time of execution include: e.g., c.r. and b.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 9 shows example network communications between a POWRUNER backdoor client and server.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "figure 9 shows network communications between a POWRUNER backdoor client and server. the network communication between the server and the client is shown in the diagram below.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the example, the POWRUNER client sends a random GET request to the C2 server and the C2 server sends the random number (99999999990) as a response. As the response is a random number that ends with \u20180\u2019, POWRUNER sends another random GET request to receive  an additional command string. The C2 server sends back Base64 encoded response.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the POWRUNER client sends a random GET request to the C2 server. the response ends with '0'",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If the server had sent the string \u201cnot_now\u201d as response, as shown in Figure 10, POWRUNER would have ceased any further requests and terminated its execution.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "if the server had sent the string \"not_now\" as response, POWRUNER would have ceased any further requests and terminated its execution.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "POWRUNER may also receive batch commands from the C2 server to collect host information from the system. This may include information about the currently logged in user, the hostname, network configuration data, active connections, process information, local and domain administrator accounts, an enumeration of user directories, and other data. An example batch command is provided in Figure 11.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "POWRUNER may also receive batch commands from the C2 server. this may include information about the currently logged in user, the hostname, network configuration data, active connections, process information, local and domain administrator accounts, an enumeration of user directories, and other data.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT34 has used POWRUNER and BONDUPDATER to target Middle East organizations as early as July 2017. In July 2017, a FireEye Web MPS appliance detected and blocked a request to retrieve and install an APT34 POWRUNER / BONDUPDATER downloader file. During the same month, FireEye observed APT34 target a separate Middle East organization using a malicious .rtf file (MD5: 63D66D99E46FB93676A4F475A65566D8) that exploited CVE-2017-0199. This file issued a GET request to download a malicious file from:",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "fireEye web MPS appliance detected and blocked a request to retrieve and install an APT34 POWRUNER / BONDUPDATER downloader file.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As shown in Figure 12, the script within the dupatechecker.doc file attempts to download another file named dupatechecker.exe from the same server. The file also contains a comment by the malware author that appears to be an apparent taunt to security researchers.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "the script within the dupatechecker.doc file attempts to download another file from the same server. the file also contains a comment by the malware author that appears to be an apparent taunt to security researchers.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The dupatechecker.exe file (MD5: C9F16F0BE8C77F0170B9B6CE876ED7FB) drops both BONDUPDATER and POWRUNER. These files connect to proxychecker[.]pro for C2.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "dupatechecker.exe drops both BONDUPDATER and POWRUNER. these files connect to proxychecker[.]pro for C2.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recent activity by APT34 demonstrates that they are capable group with potential access to their own development resources. During the past few months, APT34 has been able to quickly incorporate exploits for at least two publicly vulnerabilities (CVE-2017-0199 and CVE-2017-11882) to target organizations in the Middle East. We assess that APT34\u2019s efforts to continuously update their malware, including the incorporation of DGA for C2, demonstrate the group\u2019s commitment to pursing strategies to deter detection. We expect APT34 will continue to evolve their malware and tactics as they continue to pursue access to entities in the Middle East region.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "recent activity by APT34 demonstrates that they are capable group with potential access to their own development resources. the group has been able to quickly incorporate exploits for at least two publicly vulnerabilities (CVE-2017-0199 and CVE-11882) to target organizations in the middle east region.",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.",
        "source": "New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit _ Mandiant.html",
        "summary": "Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon. if you have any questions, please contact us today.",
        "detection": {},
        "prediction": {}
    }
]