[
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During several recent incident response engagements, FireEye Mandiant investigators uncovered new tools in FIN7\u2019s malware arsenal and kept pace as the global criminal operators attempted new evasion techniques.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this blog, we reveal two of FIN7\u2019s new tools that we have called BOOSTWRITE and RDFSNIFFER.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first of FIN7's new tools is BOOSTWRITE \u2013 an in-memory-only dropper that decrypts embedded payloads using an encryption key retrieved from a remote server at runtime. FIN7 has been observed making small changes to this malware family using multiple methods to avoid traditional antivirus detection, including a BOOSTWRITE sample where the dropper was signed by a valid Certificate Authority.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While CARBANAK has been thoroughly analyzed and has been used maliciously by several financial attackers including FIN7, RDFSNIFFER is a newly-identified tool recovered by Mandiant investigators.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "RDFSNIFFER, a payload of BOOSTWRITE, appears to have been developed to tamper with NCR Corporation's \u201cAloha Command Center\u201d client. NCR Aloha Command Center is a remote administration toolset designed to manage and troubleshoot systems within payment card processing sectors running the Command Center Agent. The malware loads into the same process as the Command Center process by abusing the DLL load order of the legitimate Aloha utility. Mandiant provided this information to NCR.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "BOOSTWRITE is a loader crafted to be launched via abuse of the DLL search order of applications which load the legitimate \u2018Dwrite.dll\u2019 provided by the Microsoft DirectX Typography Services.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The application loads the \u2018gdi\u2019 library, which loads the \u2018gdiplus\u2019 library, which ultimately loads \u2018Dwrite\u2019.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Mandiant identified instances where BOOSTWRITE was placed on the file system alongside the RDFClient binary to force the application to import DWriteCreateFactory from it rather than the legitimate DWrite.dll.\n Once loaded, `DWrite.dll` connects to a hard-coded IP and port from which it retrieves a decryption key and initialization vector (IV) to decrypt two embedded payload DLLs. To accomplish this task, the malware first generates a random file name to be used as a text log under the current user's %TEMP% directory; this filename starts with ~rdf and is followed by a set of random numbers. Next, the malware scans its own image to find the location of a 32-byte long multi-XOR key which is used to decode data inside its body. Part of the decoded data is an IP address and port which are used to retrieve the key and the IV for the decryption of the embedded payloads.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The encryption algorithm uses the ChaCha stream cipher with a 256-bit key and 64-bit IV.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the key and the IV are downloaded the malware decrypts the embedded payloads and performs sanity checks on the results.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The payloads are expected to be PE32.DLLs which, if the tests pass, are loaded into memory without touching the filesystem.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware logs various plaintext messages to the previously created logfile %TEMP%\\~rds<rnd_numbers> which are indicative of the loader\u2019s execution progress.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Starting...\n Init OK\nKey OK\nData: 4606941\nHS: 20\nK:[32] V:[8]\nDCnt: 732642317(ERR)\nBefore exiting, the malware resolves the location of the benign DWrite.dll library and passes the execution control to its DWriteCreateFactory method.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One of the DLLs is an instance of the CARBANAK backdoor; the other DLL is a tool tracked by FireEye as RDFSNIFFER which allows an attacker to hijack instances of the NCR Aloha Command Center Client application and interact with victim systems via existing legitimate 2FA sessions.\n RDFSNIFFER is a module loaded by BOOSTWRITE which allows an attacker to monitor and tamper with legitimate connections made via NCR Corporation\u2019s \u2018Aloha Command Center Client\u2019 (RDFClient), an application designed to provide visibility and system management capabilities to remote IT techs. RDFSNIFFER loads into the same process as the legitimate RDFClient by abusing the utility\u2019s DLL load order, launching each time the \u2018Aloha Command Center Client\u2019 is executed on an impacted system.\n When the RDFSNIFFER module is loaded by BOOSTWRITE it hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-interface (Table 1).",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Furthermore, this enables the malware to alter the user\u2019s last input time to ensure application sessions do not time out.\n Used to hijack the utility's UI\nUsed to hijack the utility's UI\nUsed to hijack the utility's UI\nUsed to hijack the utility's UI\nUsed to change the user's last input time (to avoid timed lock outs)\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Table 1: RDFSNIFFER\u2019s Hooked Win32 API Functions\nThis module also contains a backdoor component that enables it to inject commands into an active RDFClient session. This backdoor allows an attacker to upload, download, execute and/or delete arbitrary files (Table 2).\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Uploads a file to the remote system\nRetrieves a file from the remote system\nExecutes a command on the remote system\nWhile the majority of BOOSTWRITE variants recovered from investigations have been unsigned, Mandiant identified a signed BOOSTWRITE sample used by FIN7 during a recent investigation. Following that discovery, a signed BOOSTWRITE sample was uploaded to VirusTotal on October 3. This executable uses a code signing certificate issued by MANGO ENTERPRISE LIMITED (Table 3).\n 32 7F 8F 10 74 78 42 4A BE B8 2A 85 DC 36 57 03 CC 82 70 5B\nTable 3: Code signing certificate used for BOOSTWRITE\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This indicates the operators may be actively altering this malware to avoid traditional detection mechanisms.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Notably, the signed BOOSTWRITE sample had a 0/68 detection ratio when it was uploaded to VirusTotal, demonstrating the effectiveness of this tactic (Figure 2).\n Use of a code signing certificate for BOOSTWRITE is not a completely new technique for FIN7 as the group has used digital certificates in the past to sign their phishing documents, backdoors, and later stage tools. By exploiting the trust inherently provided by code certificates, FIN7 increases their chances of bypassing various security controls and successfully compromising victims. The full evasion achieved against the detection engines deployed to VirusTotal \u2013 as compared to an unsigned BOOSTWRITE sample with an invalid checksum\u2013 illustrates that FIN7\u2019s methods were effective in subverting both traditional detection and ML binary classification engines.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is a known issue and has been deeply studied since at least 2016\u2019s \u201cChains of Distrust\u201d research and 2017\u2019s \u201cCertified Malware\u201d paper.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since there are plenty of goodware samples with bad or no signatures \u2013 and a growing number of malware samples with good signatures \u2013 there is no easy solution here. The upside is that vendors selectively deploy engines to VirusTotal (including FireEye) and VT detection performance often isn\u2019t a comprehensive representation of encountering full security technology stacks that implement detection-in-depth. Later in this blog we further explore BOOSTWRITE\u2019s PE Authenticode signature, its anomalies, and how code signing can be turned from a detection challenge into detection opportunities.\n While these incidents have also included FIN7\u2019s typical and long-used toolsets, such as CARBANAK and BABYMETAL, the introduction of new tools and techniques provides further evidence FIN7 is continuing to evolve in response to security enhancements. Further, the use of code signing in at least one case highlights the group's judicious use of resources, potentially limiting their use of these certificates to cases where they have been attempting to bypass particular security controls. Barring any further law enforcement actions, we expect at least a portion of the actors who comprise the FIN7 criminal organization to continue conducting campaigns.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As a result, organizations need to remain vigilant and continue to monitor for changes in methods employed by the FIN7 actors.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While FireEye does not release our production detection logic for the code families, this section does contain some identification and hunting concepts that we adopt in our layered detection strategy. Table 4 contains malware samples referenced in this blog that FireEye is able to share from the larger set recovered during active investigations.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The signed BOOSTWRITE sample has a PE Authenticode anomaly that can be detected using yara\u2019s PE signature module. Specifically, the PE linker timestamp is prior to the Authenticode validity period, as seen in Table 5.\n2019-05-22 00:00 UTC\nthrough\n2020-05-21 23:59 UTC\nSigned BOOSTWRITE\u2019s \u201cmango ENTERPRISE LIMITED\u201d certificate validity window\nA public example of a Yara rule covering this particular PE Authenticode timestamp anomaly is available in a blog post from David Cannings, with the key logic shown in Figure 3.\npe.number_of_signatures > 0 and not for all i in (0..pe.number_of_signatures - 1):\n     pe.signatures[i].valid_on(pe.timestamp)\nFigure 3: Excerpt of NCC Group\u2019s research Yara rule\nThere are other PE Authenticode anomalies that can also be represented as Yara rules to surface similarly suspicious files.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Of note, this signed BOOSTWRITE sample has no counter signature and, while the unauthenticated attributes timestamp structure is present, it is empty.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In preparing this blog, FireEye\u2019s Advanced Practices team identified a possible issue with VirusTotal\u2019s parsing of signed executable timestamps as seen in Figure 4.\nFireEye filed a bug report with Google to address the discrepancy in VirusTotal in order to remove confusion for other users.\n To account for the detection weaknesses introduced by techniques like code signing, our Advanced Practices team combines the malicious confidence spectrum that comes from ML detection systems with file oddities and anomalies (weak signals) to surface highly interesting and evasive malware. This technique was recently described in our own Dr. Steven Miller\u2019s Definitive Dossier of Devilish Debug Details.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In fact, the exact same program database (PDB) path-based approach from his blog can be applied to the toolmarks seen in this sample for a quick hunting rule. Figure 5 provides the PDB path of the BOOSTWRITE samples from this blog.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Yara rule template can be applied to result in the quick rule in Figure 6.\nrule ConventionEngine_BOOSTWRITE\n{\n meta:\n     author = \"Nick Carr (@itsreallynick)\"\n     reference = \"https://www.fireeye.com/blog/threat-research/2019/08/definitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"\nstrings:\n     $weetPDB = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]?:?\\\\[\\\\\\s|*\\s]?.{0,250}\\\\DWriteImpl[\\\\\\s|*\\s]?.{0,250}\\.pdb\\x00/ nocase\n condition:\n     (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and $weetPDB and filesize < 6MB\n}\nFigure 6: Applying BOOSTWRITE\u2019s PDB path to a Yara rule\nWe can apply this same concept across other executable traits, such as BOOSTWRITE\u2019s export DLL name (DWriteImpl.dll), to create quick and easy rules that can aid in quick discovery as seen in Figure 7.\nrule Exports_BOOSTWRITE\n{\nmeta:\n     author = \"Steve Miller (@stvemillertime) & Nick Carr (@itsreallynick)\"\nstrings:\n     $exyPants = \"DWriteImpl.dll\" nocase\ncondition:\n     uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $exyPants at pe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address) + 12))",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "and filesize < 6MB\n}\nFigure 7: Applying BOOSTWRITE\u2019s export DLL names to a Yara rule (Note: this rule was updated following publication.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Of course, resilient prevention capabilities are needed and to that end, FireEye detects this activity across our platforms. Table 6 contains several specific detection names from a larger list of detection capabilities that captured this activity natively.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Malware.binary.dll (dynamic detection)\nMalwareGuard ML detection (unsigned variants)\nAPTFIN.Dropper. Win. BOOSTWRITE (network traffic)\nAPTFIN.Backdoor. Win.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "RDFSNIFFER (network traffic)\nFE_APTFIN_Dropper_Win_BOOSTWRITE (static code family detection)\nFE_APTFIN_Backdoor_Win_RDFSNIFFER (static code family detection)\nBOOSTWRITE encodes its payloads using a ChaCha stream cipher with a 256-bit key and 64-bit IV to evade detection\nBOOSTWRITE encodes its payloads using a ChaCha stream cipher with a 256-bit key and 64-bit IV to evade detection\nBOOSTWRITE exploits the applications\u2019 loading of the \u2018gdi\u2019 library, which loads the \u2018gdiplus\u2019 library, which ultimately loads the local \u2018Dwrite\u2019 dll\nBOOSTWRITE variants were observed signed by a valid CA\nBOOSTWRITE exploits the applications\u2019 loading of the \u2018gdi\u2019 library, which loads the \u2018gdiplus\u2019 library, which ultimately loads the local \u2018Dwrite\u2019 dll\nBOOSTWRITE decodes its payloads at runtime using using a ChaCha stream cipher with a 256-bit key and 64-bit IV\nRDFSNIFFER hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-interface\nRDFSNIFFER has the capability of deleting local files\nRDFSNIFFER hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-interface\n ",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The authors want to thank Steve Elovitz, Jeremy Koppen, and the many Mandiant incident responders that go toe-to-toe with FIN7 regularly, quietly evicting them from victim environments.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We appreciate the thorough detection engineering from Ayako Matsuda and the reverse engineering from FLARE\u2019s Dimiter Andonov, Christopher Gardner and Tyler Dean.",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A special thanks to FLARE\u2019s Troy Ross for the development of his PE Signature analysis service and for answering our follow-up questions. Shout out to Steve Miller for his hot fire research and Yara anomaly work. And lastly, the rest of the Advanced Practices team for both the unparalleled front-line FIN7 technical intelligence expertise and MITRE ATT&CK automated mapping project \u2013 with a particular thanks to Regina Elwell and Barry Vengerik.\nGet the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "Mahalo FIN7_ Responding to the Criminal Operators\u2019 New Tools and Techniques _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cybersecurity News, Threat Research, And More From The Team Spearheading The Evolution Of Endpoint Security\nThis blog was co-authored by Alon Groisman.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Just a few months after the well-publicized indictment of three high-ranking members in August, Morphisec has identified a new FIN7 campaign that appears to be targeting the restaurant industry.\nFIN7, also known as Carbanak, is one of the major threat groups tracked by Morphisec and numerous other security entities, and among the top three criminal computer intrusion cases that the FBI is currently working. FIN7 is composed of a very sophisticated network of developers and hackers and brings in an estimated $50 million a month.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They target very specific industries, hospitality \u2013 hotels and restaurants \u2013 being one of them, and are behind a string of high-profile breaches including Red Robin, Chili\u2019s, Arby\u2019s, Burgerville, Omni Hotels and Saks Fifth Avenue, among many others.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the case of Burgerville, malware sat on the company\u2019s network collecting payment data for nearly a year before it was discovered.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this blog post, we present our findings on two campaigns, which occurred in the first and second weeks of November. These campaigns follow patterns similar to those presented by FireEye in August but with just enough variations to bypass many security vendors.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The name of the document translated from Russian is \u201cnew questioner\u201d. It is password-protected with the password: \u201cgoodmorning\u201d.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It uses social engineering to convince the recipient to enable macros through the use of the images, logo and tagline of a newly launched, legitimate VPN tool InvinciBull by cybersecurity company Finjan.\n If the \u201cenable macro\u201d button is activated, the following obfuscated Macro runs and the next stage obfuscated JavaScript is extracted from the form caption, similar to the last several FIN7 campaigns.\n Examining the metadata of the document, it clearly shows that the document was created on the 11.02.2018:\n Following deobfuscation of the macro, we notice known FIN7 patterns of executing JavaScript from VBScript with the slight modification of copying the wscript.exe file and renaming it to mses.exe.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This may allow it to bypass some EDR solutions that are tracing WScript by name.\n Below is the obfuscated JavaScript that is written to the temp directory as error.txt file. The obfuscation pattern is similar to previously seen FIN7 patterns and most probably is a derivation of the same obfuscation toolkit.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The deobfuscated JavaScript is actually a backdoor component that directly communicates to the C2 server (in this case hxxps://bing-cdn[.]com).",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It executes the response which is yet another JavaScript command, which can be evaluated by eval.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although there have been slight modifications in the Macro delivery in the last couple of campaigns, the JavaScript backdoor stays the same, including its communication protocol.\n During the first request, the MAC address and the computer domain are also delivered to the target C2. We believe that the next stage is only delivered to specific targets based on domains as the data that is delivered in the first request is very limited.\n Some additional observations that can be used to create Yara-rules for this campaign are the locations of the loaded VBControl files that are written in clear text as part of the document files:\nAfter this search, we identified more samples that were created just a couple of days ago and point to a known C2 registered to the same entity (hxxps://googleapi-cdn[.]com)\nBelow is a summary of information for one of those documents:\nThe document was submitted from Ukraine (yet another former soviet union country) with the name \u201cdinners.doc\u201d (f5f8ab9863dc12d04731b1932fc3609742de68252c706952f31894fc21746bb8).\n The document again uses the social engineering technique of spoofing a known and trusted entity to convince the victim to enable macros.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on the submission date and creation time, the document is sent to the target within 2-3 days.\n The macro is nearly identical to that described above except that wscript->script, errors->settings, has multiple captions instead of a single one.\n The JavaScript backdoor is decrypted into a similar backdoor:\nLike the Hydra, cutting off one, or even three, heads of FIN7 barely slows it down.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "With the holiday rush nearly upon us, we expect the threat group to step up its activities to take advantage of increased email traffic flow and seasonal staff that may be less security conscious. Workers in any industry should stay vigilant against social engineering methods \u2013 although with today\u2019s highly targeted campaigns this can sometimes be tough to spot.",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "And never enable macros unless you are 100 percent certain that the file is safe. \n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Stay in the loop with industry insight, cyber security trends, and cyber attack information and company updates.\n",
        "source": "FIN7 Not Finished \u2013 Morphisec Spots New Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Despite the arrests of three prominent members of the FIN7 cybercrime gang beginning in January 2018, attacks targeting businesses and customer payment card information did not cease.\n By Joshua Platt and Jason Reaves\nDespite the arrests of three prominent members of the FIN7 cybercrime gang beginning in January 2018, attacks targeting businesses and customer payment card information did not cease.\n The latest evidence involves the discovery of a new administrative panel and previously unseen malware samples that Flashpoint analysts are linking to this notorious group.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Activity from this campaign dates from May to July 2018, but could go back farther to January 2018.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 has been active since at least 2015, targeting more than 100 U.S.-based companies in 47 states, as well as businesses in Europe and Australia.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The U.S. companies affected were operating primarily in the hospitality, restaurant, and gaming industries, according to a U.S. Department of Justice press release last Aug. 1 announcing the arrest of three Ukrainian nationals alleged to be members of FIN7.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Two were arrested in January in Germany and Poland, while the third\u2014an alleged supervisor\u2014was arrested in June in Spain.\n ",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7, which has also used a backdoor linked to Carbanak\u2014another prolific cybercrime outfit responsible for billions in losses in the financial services industry\u2014has stolen more than 15 million payment card records from American businesses. The group, which operated behind a front company called Combi Security, has infiltrated more than 6,500 individual point-of-sale terminals at more than 3,600 business locations, according to the DoJ.\nFlashpoint analysts recently uncovered a new attack panel used by this group in campaigns they have called Astra.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The panel, written in PHP, functions as a script-management system, pushing attack scripts down to compromised computers.\n ",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Analysts discovered references to the FIN7 front company Combi Security in the Astra panel\u2019s backend PHP code, connecting the group to these campaigns.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "According to the DoJ indictments, Combi Security purported itself as a penetration-testing and security services company based in Russia and Israel.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The DoJ alleges FIN7 portrayed Combi Security as a legitimate business in order to recruit other hackers to their operation.\n ",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers gain an initial foothold on targeted machines via phishing emails containing malicious attachments.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The emails are often industry-specific and crafted to entice a victim to open the message and execute the attached document.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One of the documents spreads what analysts are calling SQLRat, previously unseen malware that drops files and executes SQL scripts on the host system. The use of SQL scripts is ingenious in that they don\u2019t leave artifacts behind the way traditional malware does.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once they are deleted by the attackers\u2019 code, there is nothing left to be forensically recovered. This technique has not been observed in previous campaigns associated with FIN7.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The second new malware sample discovered is a multiprotocol backdoor called DNSbot, which is used to exchange commands and push data to and from compromised machines.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Primarily, it operates over DNS traffic, but can also switch to encrypted channels such as HTTPS or SSL, Flashpoint analysts discovered.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The code, meanwhile, is still controlled by the FIN7 actors and may be leveraged in future attacks by the group.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "SQLRat campaigns typically involved a lure document that included an image overlayed by a VB Form trigger.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The documents contained a message asking the user to \u201cUnlock Protected Contents,\u201d below, while showing a message box displaying \u201cUS SEC Unlock document service.\u201d\n Once a user has double-clicked the embedded image, the form executes a VB setup script. The script writes files to the path %appdata%\\Roaming\\Microsoft\\Templates\\, then creates two task entries triggered to run daily.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The scripts are responsible for deobfuscating and executing the main JavaScript file mspromo.dot. The file uses a character insertion obfuscation technique, making it appear to contain Chinese characters.\n After deobfuscating the file, the main JavaScript is easily recognizable.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It contains a number of functions designed to drop files and execute scripts on a host system.\n The SQLRat script is designed to make a direct SQL connection to a Microsoft database controlled by the attackers and execute the contents of various tables. The script retrieves an item from the bindata table and writes the file to disk. This file appears to primarily be a version of TinyMet\u2014an open source Meterpreter stager\u2014but the actors have the option to store and execute any binary loaded into the table.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The files were 32/64-bit versions of a custom-built TinyMet along with a recon.js file. The 32-bit file contained an XOR embedded .exe file.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The file was decoded out using the following:\nThe result is a customized version of TinyMet.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This version has limited usage; it does reverse TCP, XOR decodes the data retrieved for execution of the stager, and looks for TrendMicro processes.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This file calls itself TiniMet:\nAnalysts also uncovered a \u201cTinyPS\u201d stager:\nAfter decoding out the blob, analysts found a PowerShell script. This script was similar to what was previously documented in the Trustwave report \u201cOperation Grand Mars: Defending Against Carbanak Cyber Attacks.\u201d",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The script contained the same XOR key but does not achieve persistence. It is only intended to create the Meterpreter session.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following is the PowerShell version of TiniMet:\nAnalysts also uncovered subsequent campaigns associated with this panel. These campaigns were similar, but leveraged a document containing an embedded JavaScript-based DNSbot. The document contained the same MsgBox display, but this time there was a single file and task. The task name is similar to \u201cMicrosoft update service,\u201d but the obfuscated JS file is dropped in %localappdata%\\Storage:\nAdditionally, the same US SEC Unlock document service is displayed, though the Microsoft update service task is deleted and replaced with the DNSbot.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first variable\u2014a\u2014is an array of obfuscated values. The second line contains a function to deobfuscate the values, while the call to that function is the second variable, b:\nA deobfuscated version of the DNS script is:\nA second deobfuscated testing script also matched components of the JavaScript embedded in the ASTRA docs, demonstrating the script\u2019s multiprotocol use. The domain stats25-google[.]com was included in a report released by FireEye earlier in the year:\n The ASTRA backend was installed on a Windows server with Microsoft SQL. The panel was written in PHP and managed the content in the tables.",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Flashpoint also recommends implementing host-based detections for new files in %appdata%\\Roaming\\Microsoft\\Templates\\ with a dot extension, as well as implementing host-based detections for files in %appdata%\\local\\Storage\\.\nThe indicators of compromise (IOCs) for ASTRA panel, SQLRat, and DNSbot are available for download here.\n",
        "source": "FIN7 Revisited_ Inside Astra Panel and SQLRat Malware _ Flashpoint.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Home \u00bb Security \u00bb Footprints of FIN7: Tracking Actor Patterns (Part 2)\n This is part two of a blog series detailing Gigamon Applied Threat Research\u2019s (ATR) engagements with FIN7 throughout early 2017. Part one focused the network communications and tradecraft involved with FIN7, specifically addressing how patterns in the C2 protocol allowed for Gigamon ATR to gain a deeper understanding of adversary TTPs.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this post, we will break out one of the ways in which FIN7 profits from their victims \u2014 compromise of point-of-sale (POS) environments and theft of cardholder data.\n",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on victimology, internal attacker actions and known data exfiltration, many people have demonstrated FIN7\u2019s clear financial motivations.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "With that said, up until recently, little detail has been shared about the tradecraft employed to accomplish that objective.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During our engagements, Gigamon ATR observed a standalone utility that appeared to be custom in nature and used specifically to target POS systems.\n During post-exploitation, FIN7 would gain access to the POS environment primarily using PSExec, combined with a custom PowerShell script to deploy their payload. The weaponized PowerShell script was built to load an embedded DLL using reflective injection. While the PowerShell code appeared to include several foundational components from PowerSploit\u2019s Invoke-ReflectivePEInjection, it also contained custom modifications that made it unique.\n To perform the exploit, the script executed code from PowerSploit designed to resolve Windows API functions necessary for performing the injection. Next, the script would allocate memory in its current process and use the System.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Marshal class to copy code into the newly allocated memory. With the DLL in memory, the script would then generate custom bootstrap code for binary loading and place that code into memory. Finally, the script would create a thread at the offset of the bootstrap code that will in turn load the malicious payload from memory.\n Once injected, the payload proceeded to write a binary encoded blob into the registry key HKLM\\Software\\Microsoft\\DRM and install persistence using a custom Shim targeting services.exe and adding it to the shim database by executing sdbinst.exe.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When services.exe is executed on boot, the blob, which is primarily composed of a POS scraping capability, is loaded. \n",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on previous public documentation of FIN7 operations, this custom PowerShell loader is a notable divergence from previous FIN7 operational tactics; a shift in techniques possibly to evade detection based on intel reporting.\n Notably, there is an inherent risk of detection that an adversary must evaluate when deploying a persistence mechanism, especially in POS environments that experience relatively little day-to-day changes. This shift identifies a likely desire to maintain longer-term access in order to facilitate ongoing theft from a single target environment over time, rather than performing smash and grab campaigns.\n",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once running, the POS scraping capability will attempt to inject itself into svchost.exe, wuauclt.exe or explorer.exe (in that order).",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Upon successful injection, the scraper enumerates running processes, comparing them to a list provided via a text file on disk.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This tactic of using a targeted set of processes allows the malware to be used flexibly in different environments and shows customization in targeting based on each individual victim.\n ",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the scraping capability has identified a process of interest, the payload will read memory from the process and extract track one and track two data formats.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once extracted, the malware encrypts the data and writes it to disk for later collection by the threat actors.\n ",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While working with customers of all different sizes and across industries, Gigamon ATR has seen a large mix of architectures that have had both successes and failures, largely as a result of decisions made during the design process.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We work with our customers to understand how their individual environment design affects their ability to perform network monitoring, but by the time we are brought in to assist in response it\u2019s too late and the priority is containment, mitigation and remediation with the topic of design being revisited in the wake of the breach.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "With that said, we hope to present some considerations that apply specifically to protecting and monitoring POS environments:\n",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The information-security industry as a whole commonly puts a lot of focus on top tier threats such as nation-state actors.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While very real, these threats are a part of a different model than most organizations should likely consider.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There are serious threats facing the average business and these groups continue to elevate their sophistication and learn from their engagements. With one goal in mind, these actors will continue to attack environments in an effort to profit off of the blindness of their victims.\n While FIN7 is a moderately sophisticated threat, the patterns of their operations and tradecraft decisions can be reliably detected by anyone with good visibility into their environment. Further, early investments in security-focused design and realistic threat modeling will allow organizations to better prepare for the inevitable targeting by one of these groups.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We hope that these posts were insightful and allow you to bring similar defensive tradecraft into your environment.\n",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts.",
        "source": "Footprints of FIN7_ Tracking Actor Patterns (Part 2) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Home \u00bb Security \u00bb Footprints of Fin7: Pushing New Techniques to Evade Detection\n The Gigamon Applied Threat Research (ATR) team actively tracks threat activity associated with FIN7, a financially motivated actor targeting the retail industry.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 has been constantly adapting their phishing documents in order to evade detection \u2014 their latest update has initial detections on VirusTotal of 0/59 and 1/59 for the RTF and DOCX formats, respectively.\n FIN7 leverages a number of targeted phishing techniques to initially exploit victims in the retail sector. Once they have an initial foothold the actor pivots to Point of Sale systems and steals large quantities of protected card data. In August, the Gigamon ATR team released a large set of indicators of compromise (IOCs) for infected document payloads that displayed similar infection characteristics and techniques to each other. Recently, the Gigamon ATR team observed a shift in techniques including a modified payload that uses a new embedded file type.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, FIN7 has modified the obfuscation utilized by their HALFBAKED backdoor \u2014 likely to avoid detection in new or ongoing campaigns.\n While the newly observed malicious documents do not represent a \u201cnew\u201d attack methodology, the change of payload may cause detection issues for legacy signatures and heuristic detections which utilize overly strict detection mechanisms, lacking in durability or layered coverage. This post details the newly observed methods and provides indicators associated with the identified infection documents.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This will enable retail companies to validate their detections and leverage this intelligence to determine if they\u2019ve been impacted by new campaigns.\n",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In past versions of infection documents, the Gigamon ATR team observed the actor primarily utilize malicious shortcut files (LNK) or visual basic scripts (VBS or VBE) to achieve code execution from within their lure. These malicious files are embedded into the infection documents using the Object Linking and Embedding (OLE) framework within Windows, which allows objects from one application to be included in another.\n In the documents released today, FIN7 appears to have pivoted from using OLE embedded LNK files to using OLE embedded CMD files. When executed, the CMD file writes JScript to \u201ctt.txt\u201d under the current user\u2019s home directory. The batch script then copies itself to \u201cpp.txt\u201d, also under the current user\u2019s home directory, before running WScript using the JScript engine on the file. This JScript code will read from the file \u201cpp.txt\u201d, skipping the first four lines (the CMD code itself), but otherwise evaluating anything after the first character for each line in the file.\n Although different in implementation, this is a familiar technique, as FIN7 frequently runs commented out code that they read as a string through the use of JScript\u2019s \u201ceval\u201d function.\n",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Both CMD and LNK file formats result in code execution, but the shift towards using CMD files may indicate a desire to stay ahead of detection authors.\n Over the course of the past year, the actor\u2019s unique backdoor, HALFBAKED, has continued to morph to improve capabilities and reduce detection surface. In the newest observed version, the Gigamon ATR team observed a slight tweak in the obfuscation strategy.\n Previously, different stages of the HALFBAKED codebase utilized base64 encoding, stored in a string array variable called \u201csrcTxt\u201d.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker now obfuscates that name and continues to break up the base64 string into multiple strings within an array as seen in Figure 1.\n",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the HALFBAKED backdoor now includes a built-in command called \u201cgetNK2\u201d, seen here in HALFBAKED\u2019s command list (Figure 2).",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u201cgetNK2\u201d is designed to retrieve the victim\u2019s Microsoft Outlook email client auto-complete list. This may suggest the actor\u2019s desire to obtain new phishing targets within a victim organization. If any of these new targets fell victim to the phishing lure, it would allow FIN7 to increase their foothold within a victim organization\u2019s network and potentially pivot to new areas.\n The command \u201cgetNK2\u201d is likely named after outlook\u2019s NK2 file, which contains a list of auto-complete addresses for Microsoft Outlook 2007 and 2010. Newer versions of outlook no longer use the NK2 file, so FIN7 has also written functionality to handle newer versions of Outlook within the same \u201cgetNK2\u201d command. The command will execute the JScript function in Figure 3 on the victim system.\n Detection authors must make trade-offs to optimize signature performance; narrow signatures lead to high fidelity detections, but risk missing changes in actor behaviors, meanwhile broader detection patterns provide better coverage, at the risk of more false positives. Combatting a well-resourced and adaptive adversary requires a layered approach of both signature styles.\n FIN7 has demonstrated that they are highly adaptable, evading detection mechanisms while impacting a number of large US retail companies over an extended period of time.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Gigamon ATR team will continue to remain vigilant, working to understand FIN7 and empower our customers and affected industries to defend themselves.\n",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Gigamon ThreatINSIGHT\u2122 is a network security analytics solution that offers a SaaS capability that enables customers to gain and utilize widespread network visibility for security operations. As part of its research, the Gigamon ATR team coordinates disclosure of security threats and vulnerabilities with relevant parties in order to maximize both the response and victim remediation efforts as well as working to truly improve the security of customers and other victims prior to publishing blog posts.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To learn more about the Gigamon ATR team, please visit www.gigamon.com/research/applied-threat-research-team.html.\n By clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts.",
        "source": "Footprints of Fin7_ Pushing New Techniques to Evade Detection - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In 2017, Mandiant responded to multiple incidents we attribute to FIN7, a financially motivated threat group associated with malicious operations dating back to 2015. Throughout the various environments, FIN7 leveraged the CARBANAK backdoor, which this group has used in previous operations.\n A unique aspect of the incidents was how the group installed the CARBANAK backdoor for persistent access. Mandiant identified that the group leveraged an application shim database to achieve persistence on systems in multiple environments.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shim injected a malicious in-memory patch into the Services Control Manager (\u201cservices.exe\u201d) process, and then spawned a CARBANAK backdoor process.\n",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Mandiant identified that FIN7 also used this technique to install a payment card harvesting utility for persistent access. This was a departure from FIN7\u2019s previous approach of installing a malicious Windows service for process injection and persistent access.\n According to Microsoft, an application compatibility shim is a small library that transparently intercepts an API (via hooking), changes the parameters passed, handles the operation itself, or redirects the operation elsewhere, such as additional code stored on a system. Today, shims are mainly used for compatibility purposes for legacy applications.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While shims serve a legitimate purpose, they can also be used in a malicious manner.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 1 displays the two registry keys created when a shim is registered with the \u201csdbinst.exe\u201d utility.\n ",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once a shim database has been registered on a system, the shim database file (\u201c.sdb\u201d file extension) will be copied to the \u201cC:\\Windows\\AppPatch\\Custom\u201d directory for 32-bit shims or \u201cC:\\Windows\\AppPatch\\Custom\\Custom64\u201d directory for 64-bit shims.\n ",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To install and register the malicious shim database on a system, FIN7 used a custom Base64 encoded PowerShell script, which ran the \u201csdbinst.exe\u201d utility to register a custom shim database file containing a patch onto a system. Figure 2 provides a decoded excerpt from a recovered FIN7 PowerShell script showing the parameters for this command.\n  FIN7 used various naming conventions for the shim database files that were installed and registered on systems with the \u201csdbinst.exe\u201d utility.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A common observance was the creation of a shim database file with a \u201c.tmp\u201d file extension (Figure 3).\n  Upon registering the custom shim database on a system, a file named with a random GUID and an \u201c.sdb\u201d extension was written to the 64-bit shim database default directory, as shown in Figure 4. The registered shim database file had the same MD5 hash as the file that was initially created in the \u201cC:\\Windows\\Temp\u201d directory.\n ",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The database description used for the shim database registration, \u201cMicrosoft KB2832077\u201d was interesting because this KB number was not a published Microsoft Knowledge Base patch. This description (shown in Figure 6) appeared in the listing of installed programs within the Windows Control Panel on the compromised system.\n During the investigations, Mandiant observed that FIN7 used a custom shim database to patch both the 32-bit and 64-bit versions of \u201cservices.exe\u201d with their CARBANAK payload. This occurred when the \u201cservices.exe\u201d process executed at startup.",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shim database file contained shellcode for a first stage loader that obtained an additional shellcode payload stored in a registry key. The second stage shellcode launched the CARBANAK DLL (stored in a registry key), which spawned an instance of Service Host (\u201csvchost.exe\u201d) and injected itself into that process.  \n Figure 7 shows a parsed shim database file that was leveraged by FIN7.\n",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For the first stage loader, the patch overwrote the \u201cScRegisterTCPEndpoint\u201d function at relative virtual address (RVA) \u201c0x0001407c\u201d within the services.exe process with the malicious shellcode from the shim database file. \n The new \u201cScRegisterTCPEndpoint\u201d function (shellcode) contained a reference to the path of \u201c\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\DRM\u201d, which is a registry location where additional malicious shellcode and the CARBANAK DLL payload was stored on the system.\n Figure 8 provides an excerpt of the parsed patch structure within the recovered shim database file.\n The shellcode stored within the registry path \u201cHKLM\\SOFTWARE\\Microsoft\\DRM\u201d used the API function \u201cRtlDecompressBuffer\u201d to decompress the payload. It then slept for four minutes before calling the CARBANAK DLL payload's entry point on the system. Once loaded in memory, it created a new process named \u201csvchost.exe\u201d that contained the CARBANAK DLL. \n Figure 9 provides a high-level overview of a shim database being leveraged as a persistent mechanism for utilizing an in-memory patch, injecting shellcode into the 64-bit version of \u201cservices.exe\u201d.\n Mandiant recommends the following to detect malicious application shimming in an environment:\nGet the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "To SDB, Or Not To SDB_ FIN7 Leveraging Shim Databases for Persistence _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On August 1, 2018, the US Department of Justice announced that it had arrested several individuals suspected of having ties to the FIN7 cybercrime rig. FIN7 operations are linked to numerous intrusion attempts having targeted hundreds of companies since at least as early as 2015.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Interestingly, this threat actor created fake companies in order to hire remote pentesters, developers and interpreters to participate in their malicious business. The main goal behind its malicious activities was to steal financial assets from companies, such as debit cards, or get access to financial data or computers of finance department employees in order to conduct wire transfers to offshore accounts.\n In 2018-2019, researchers of Kaspersky Lab\u2019s Global Research and Analysis Team analyzed various campaigns that used the same Tactics Tools and Procedures (TTPs) as the historic FIN7, leading the researchers to believe that this threat actor had remained active despite the 2018 arrests. In addition, during the investigation, we discovered certain similarities to other attacker groups that seemed to share or copy the FIN7 TTPs in their own operations.\n The FIN7 intrusion set continued its tailored spear phishing campaigns throughout last year.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Kaspersky Lab has been able to retrieve some of these exchanges from a FIN7 target. The spear phishing campaigns were remarkably sophisticated from a social engineering perspective.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In various cases, the operators exchanged numerous messages with their victims for weeks before sending their malicious documents.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The emails were efficient social-engineering attempts that appealed to a vast number of human emotions (fear, stress, anger, etc.) to elicit a response from their victims. One of the domains used by the attackers in their 2018 campaign of spear phishing contained more than 130 email aliases, leading us to think that more than 130 companies had been targeted by the end of 2018.\n We have seen two types of documents sent to victims in these spear phishing campaigns.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first one exploits the INCLUDEPICTURE feature of Microsoft Word to get context information about the victim\u2019s computer, and the availability and version number of Microsoft Word. The second one, which in many cases is an Office document protected with a trivial password, such as \u201c12345\u201d, \u201c1234\u201d, etc., uses macros to execute a GRIFFON implant on the target\u2019s computer.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In various cases, the associated macro also scheduled tasks to make GRIFFON persistent.\n Interestingly, following some open-source publications about them, the FIN7 operators seems to have developed a homemade builder of malicious Office document using ideas from ThreadKit, which they employed during the summer of 2018. The new builder inserts random values in the Author and Company metadata fields. Moreover, the builder allows these to modify different IOCs, such as the filenames of wscript.exe or sctasks.exe copies, etc.\nIOCs extracted from docs which use sctasks for GRIFFON persistence\nIOCs extracted from regular documents associated to GRIFFON\nThe GRIFFON implant is a lightweight JScript validator-style implant without any persistence mechanism.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware is designed for receiving modules to be executed in-memory and sending the results to C2s.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first module downloaded by the GRIFFON malware to the victim\u2019s computer is an information-gathering JScript, which allows the cybercriminals to understand the context of the infected workstation. This module mainly relies on WMI and Windows objects to deliver results, which will be sent back to the operators.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Interestingly, more than 20 artifacts are retrieved from the system by this implant during the reconnaissance stage, from the date and time of operating system installation and membership in a Windows domain to a list of and the resolutions of the workstation\u2019s monitors.\n The second module is used by the operators to execute an obfuscated PowerShell script, which contains a Meterpreter downloader widely known as \u201cTinymet\u201c. This downloader, seen in past FIN7 campaigns, downloads a one-byte XOR-encrypted (eg.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The third module allows the operators to take a screenshot of the remote system. To do that, it also drops a PowerShell script on the workstation to execute.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The script executes an open-source .NET class used for taking a screenshot. The resulting screenshot is saved at \u201c%TMP%/image.png\u201d, sent back to the attackers by the GRIFFON implant and then deleted.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The last retrieved module is a persistence module. If the victim appears valuable to the attackers, a GRIFFON implant installer is pushed to the victim\u2019s workstation. This module stores another instance of the GRIFFON implant inside the registry to achieve persistence. Here is a PowerLinks-style method used by the attackers to achieve persistence and execute the GRIFFON implant at each user logon. The new GRIFFON implant is written to the hard drive before each execution, limiting the \u201cfile-less\u201d aspect of this method.\n Through its light weight and modular architecture, the GRIFFON implant is the perfect validator.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Even though we have been able to retrieve four different modules, it is possible that the FIN7 operators have more modules in their toolsets for achieving their objectives on the victim\u2019s workstation.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The major error made by its operators allowed us to follow the command and control server of the GRIFFON implant last year. In order to trick blue teams and other DFIR analysts, the operators created fake HTTP 302 redirection to various Google services on their C2s servers.\n Returned headers for most of the GRIFFON C2s servers on port 443\nThis error allowed us to follow the infrastructure week by week, until an individual pushed on Twitter the heuristic to track their C2 at the end of December 2018. A few days after the tweet, in January 2019, the operators changed their landing page in order to prevent this type of tracking against their infrastructure.\n During the investigation related to the GRIFFON infrastructure, we found a strange overlap between the WHOIS record of an old GRIFFON C2 and the website of a fake company.\n According to the website, that domain supposedly belongs to a legitimate security company \u201cfully owned by the Russian Government\u201d (sic.) and having offices in \u201cMoscow, Saint Petersburg and Yekaterinburg\u201d, but the address says the company is located in Trump Tower, in New York.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Given FIN7\u2019s previous use of false security companies, we decided to look deeper into this one.\n As we were looking at the content of the website, it became evident that almost all of the text used was lifted from legitimate security-company websites.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Phrases and sentences were borrowed from at least the following companies/sites:\nThis company seems to have been used by the FIN7 threat actor to hire new people as translators, developers and pentesters. During our research, we found various job advertisements associated with the company on freelance and remote-work websites.\n In addition to that, various individuals have mentioned the company in their resumes.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe that some of these individuals may not even be aware that they are working for a cybercrime business.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While tracking numerous threat actors on a daily basis during the final days of 2018 and at the beginning of 2019, we discovered various activity clusters sharing certain TTPs associated with the FIN7 intrusion set. The link between these threat actors and FIN7 is still weak, but we decided to disclose a few hints regarding these in this blog post.\n In his history, FIN7 has overlapped several times with Cobalt/EmpireMonkey in terms of TTPs. This activity cluster, which Kaspersky Lab has followed for a few years, uses various implants for targeting mainly banks, and developers of banking and money processing software solutions. At the end of 2018, the cluster started to use not only CobaltStrike but also Powershell Empire in order to gain a foothold on the victims\u2019 networks. After a successful penetration, it uses its own backdoors and the CobaltStrike framework or Powershell Empire components to hop to interesting parts of the network, where it can monetize its access.\n FIN7\u2019s last campaigns were targeting banks in Europe and Central America.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This threat actor stole suspected of stealing \u20ac13 million from Bank of Valetta, Malta earlier this year.\n Example of malicious documents used in the end of 2018 to beginning of 2019\nA few interesting overlaps in recent FIN7 campaigns:\nWe have a high level of confidence in a historic association between FIN7 and Cobalt, even though we believe that these two clusters of activity are operated by different teams.\n AveMaria is a new botnet, whose first version we found in September 2018, right after the arrests of the FIN7 members. We have medium confidence that this botnet falls under the FIN7 umbrella.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In fact, AveMaria is a classic infostealer bot that collects all possible credentials from various types of software: browsers, email clients, messengers, etc., and can act as a keylogger.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since the beginning of 2019, we have collected more than 1300 samples and extracted more than 130 C2s.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To deliver their malware, the cyber criminals use spearphishing emails with various types of attachments: MS Office documents or spreadsheet files exploiting some known vulnerability like CVE-2017-11882, or documents with Ole2Link and SCT. They also use AutoIT droppers, password-protected EXE files and even ISO images.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "What is interesting, in some emails, they ask targets to phone them if they have any questions, like the FIN7 guys do.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the investigation into FIN7, our threat-hunting systems found an interesting overlap in between the infrastructure of FIN7 and AveMaria. Basically, two servers in the same IP range and AS14576 (autonomous system) share a non-standard SSH port, which is 222. One of the servers is a Griffon C2, and the other one, an AveMaria C2.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Distribution of targets is another factor suggesting that these two malware families may be connected.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The spearphishing emails were sent to various kinds of businesses only and did not target individuals. Thirty percent of the targets were small and medium-sized companies that were suppliers or service providers for bigger players and 21% were various types of manufacturing companies. We also spotted several typical FIN7 targets, such as retailers and hotels.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At the end of 2018, while searching for new FIN7 campaigns via telemetry, we discovered a set of activity that we temporarily called \u201cCopyPaste\u201d from a previously unknown APT. Interestingly, this actor targeted financial entities and companies in one African country, which lead us to think that CopyPaste was associated with cybermercenaries or a training center.\n This set of activity relied on open-source tools, such as Powershell Empire, and well-documented red teaming techniques, in order to get a foothold within the victim\u2019s networks and avoid detection.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Here are the main similarities between CopyPaste and FIN7:\nThe links between CopyPaste and FIN7 are still very weak. It is possible that the CopyPaste operators were influenced by open-source publications and do not have any ties with FIN7.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During 2018, Europol and DoJ announced the arrest of the leader of the FIN7 and Carbanak/CobaltGoblin cybercrime groups.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It was believed that the arrest of the group leader will have an impact on the group\u2019s operations.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One may say CobaltGoblin and FIN7 have even extended the number of groups operating under their umbrella. We observe, with various level of confidence, that there are several interconnected groups using very similar toolkits and the same infrastructure to conduct their cyberattacks.\n The first of them is the well-known FIN7, which specializes in attacking various companies to get access to financial data or PoS infrastructure.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They rely on a Griffon JS backdoor and Cobalt/Meterpreter, and in recent attacks, Powershell Empire. The second one is CobaltGoblin/Carbanak/EmpireMonkey, which uses the same toolkit, techniques and similar infrastructure but targets only financial institutions and associated software/services providers.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We link the AveMaria botnet to these two groups with medium confidence: AveMaria\u2019s targets are mostly suppliers for big companies, and the way AveMaria manages its infrastructure is very similar to FIN7. The last piece is the newly discovered CopyPaste group, who targeted financial entities and companies in one African country, which lead us to think that CopyPaste was associated with cybermercenaries or a training center.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The links between CopyPaste and FIN7 are still very weak. It is possible that the operators of this cluster of activity were influenced by open-source publications and do not have any ties with FIN7.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All of the aforementioned groups greatly benefit from unpatched systems in corporate environments. They thus continue to use effective spearphishing campaigns in conjunction with well-known MS Office exploits generated by the framework.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7/Cobalt phishing documents may seem basic, but when combined with their extensive social engineering and focused targeting, they are quite successful. As with their previous fake company \u201cCombi Security\u201d, we are confident that they continue to create new personas for use in either targeting or recruiting under a \u201cnew\u201d brand, \u201cIPC\u201d.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "More information about these and related attacks is available to customers of Kaspersky Intelligence Reports.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In order to preserve the privacy of the potential victims, we stripped the targeted entities from the domain names.\n",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7.5: the infamous cybercrime rig \u201cFIN7\u201d continues its activities\nYour email address will not be published.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Required fields are marked *\nThe hottest research right in your inbox\nIn this report Kaspersky researchers provide an analysis of the previously unknown HrServ web shell, which exhibits both APT and crimeware features and has likely been active since 2021.\n Asian APT groups target various organizations from a multitude of regions and industries.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We created this report to provide the cybersecurity community with the best-prepared intelligence data to effectively counteract Asian APT groups.\n We unveil a Lazarus campaign exploiting security company products and examine its intricate connections with other campaigns\nHow Kaspersky researchers obtained all stages of the Operation Triangulation campaign targeting iPhones and iPads, including zero-day exploits, validators, TriangleDB implant and additional modules.\n The hottest research right in your inbox\n\u00a9 2023 AO Kaspersky Lab.",
        "source": "FIN7.5_ the infamous cybercrime rig \u201cFIN7\u201d continues its activities _ Securelist.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On Aug. 1, 2018, the United States District Attorney\u2019s Office for the Western District of Washington unsealed indictments and announced the arrests of three individuals within the leadership ranks of a criminal organization that aligns with activity we have tracked since 2015 as FIN7. These malicious actors are members of one of the most prolific financial threat groups of this decade, having carefully crafted attacks targeted at more than 100 organizations.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 is referred to by many vendors as \u201cCarbanak Group,\u201d although we do not equate all usage of the CARBANAK backdoor with FIN7. This blog explores the range of FIN7's criminal ventures, the technical innovation and social engineering ingenuity that powered their success, a glimpse into their recent campaigns, their apparent use of a security company as a front for criminal operations, and what their success means for the threat landscape moving forward. With this release, FireEye is also providing technical context, historical indicators, and techniques that organizations can use to hunt for FIN7 behavior enterprise-wide.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat group is characterized by their persistent targeting and large-scale theft of payment card data from victim systems, which it has monetized at least a portion of through a prominent card shop.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In some instances, when they encountered and could not obtain payment card data from point of sale (POS) systems secured with end-to-end encryption (E2EE) or point-to-point encryption (P2PE), FIN7 pivoted to target finance departments within their victim organizations.\n Furthermore, in April 2017, FireEye reported that FIN7 sent spear phishing emails to personnel involved with United States Securities and Exchange Commission (SEC) filings at multiple organizations, providing further insight into FIN7\u2019s targeting.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These targeted individuals would likely have access to material non-public information that FIN7 actors could use to gain a competitive advantage in stock trading.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Diversification of their monetization tactics has allowed the group to impact a wide range of industries beyond those solely associated with payment card industry. During campaigns that FireEye associates with FIN7, victims within the following sectors have been targeted within the United States and Europe:\nThroughout FireEye\u2019s tracking of FIN7 campaigns, the attackers have attempted to stay ahead of the game and thwart detection, using novel tactics and displaying characteristics of a well-resourced operation. For example, in April 2017, FireEye blogged about FIN7\u2019s spear phishing emails that leveraged hidden shortcut files (LNK files) to initiate the infection and VBScript functionality launched by mshta.exe to infect the victim.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This was a direct departure from their established use of weaponized Office macros and highlighted the group\u2019s adaptive nature to evade detection.\n  FireEye also previously reported on FIN7\u2019s use of the CARBANAK backdoor as a post-exploitation tool to cement their foothold in a network and maintain access to victim environments.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CARBANAK is well known for its use in highly profitable and sophisticated attacks dating back to 2013, with usage attributable to FIN7 beginning in late 2015, although how interconnected the campaigns employing the malware over this five-year span are is unclear. FIN7\u2019s use of CARBANAK is particularly notable due to their use of creative persistence mechanisms to launch the backdoor.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group leveraged an application shim database that injected a malicious in-memory patch into the Services Control Manager (\"services.exe\") process, and then spawned a CARBANAK backdoor process. FIN7 also used this tactic to install a payment card harvesting utility.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Another notable characteristic of FIN7 has been their heavy use of digital certificates. Unsurprisingly, malicious threat actors have sought to exploit the legitimacy afforded by these certificates. By digitally signing their phishing documents, backdoors and later stage tools, FIN7 was able to bypass many security controls that may limit execution of macros from Office documents and restrict execution of unsigned binaries on trusted systems.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Table 1: Sample FIN7 code signing certificates\nFIN7 developed evasive techniques at a rapid pace. Throughout 2017, FIN7 was observed creating novel obfuscation methods, and in some cases modifying the methods on a daily basis while launching attacks targeting multiple victims.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat group regularly tested malicious DOC, DOCX, and RTF phishing documents against public repositories to check static detection engine coverage. Their development of a payload obfuscation style using the Windows command interpreter's (cmd.exe) native string substitution was so unique that FireEye dubbed it \"FINcoding.\" These methods inspired deep command line obfuscation research and the release of Daniel Bohannon's Invoke-DOSfuscation. Reference Table 2 and Table 3 for a selection of samples and their associated command line obfuscation techniques.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Over the three years of responding to a multitude of compromises and proactively defending against FIN7, FireEye observed unprecedented social engineering prowess. From leveraging web forms for initial contact to targeting and engaging directly with pre-determined store managers, the operators demonstrated a range of capabilities.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FireEye has responded to incidents where FIN7 has called victims prior to lodging digital complaints laden with malicious documents as well as after the phishing documents have been sent, in order to check if they were received \u2013 a crude but effective FIN7 email delivery tracking technique.\n As FIN7 has matured, so did the quality of their phishing lures and templates, which were most often sent from fake but thoroughly disguised individuals and businesses \u2013 and occasionally from sender addresses impersonating legitimate government entities. Their phishing has often exploited urgent, high value business matters tailored to their chosen targets. At individual stores, managers were contacted about lost items or sent a \u201creceipt\u201d claiming overcharging. Other FIN7 phishing emails masqueraded as detailed catering orders or requests for special menus tailored to individuals with dietary restrictions.\n In early 2017, a pattern of complaints emerged and has continued for well over a year, where FIN7 has contacted stores and corporate offices to lodge food poisoning complaints with malicious attachments.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Internally dubbed \u201cFINdigestion\u201d by FireEye, this pattern of detailed complaints eventually expanded beyond individual complaints and into litigious concerns raised on behalf of \u201cthe government\u201d, as shown in Figure 1.\n It is noteworthy that the BATELEUR backdoor activity first identified by Proofpoint in July 2017, which FireEye tracks as a suspected FIN7 subgroup, uses highly-customized graphics for their targets, often created in Adobe Photoshop. In this same phishing campaign, FIN7\u2019s malicious attachment was graphically themed to match, as shown in Figure 2.\nThroughout their operations, the professional design and continued development of phishing elements in parallel to other post-compromise tools indicated to FireEye that FIN7 was most likely a well-resourced criminal operation.\n FireEye has tracked several FIN7 personas throughout their operations by collecting and parsing filetypes of forensic value for juicy metadata. In a previous blog, we shared how LNK files created by FIN7 unintentionally revealed valuable information about their development environment.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "LNK files can contain metadata that reveals attributes about the systems on which the LNKs were created, including original file paths, volume serial numbers, MAC addresses, and hostnames. By studying values within the LNK metadata we often identify \"toolmarks,\" or unique values associated with distinct malware developer and operator personas.\n FIN7 LNK metadata shows that the actors routinely used virtual machines with generic hostnames such as ANDY-PC or USER-PC, and default hostnames with the structure WIN-[A-Z0-9]{11} (e.g. WIN-ABCDEFGH1JK).\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FireEye has tracked several hostname and path toolmarks associated with FIN7\u2019s operations, which we have used to link clusters of threat activity together.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These toolmarks may be linked to FIN7 members who are involved in tool development or the broader criminal operation.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Notable personas from the technical data, which are explored in more detail in the Technical Appendix section, include:\nThis analysis allowed us to understand FIN7\u2019s systems and correlate future attack activity to the different personas. Furthermore, the metadata analysis helped us monitor for files generated by the group and use the established toolmarks to establish detection for other adversary methodologies (such as direct RDP or SMB access) if the group changed TTPs.\n  While responding to multiple FIN7 intrusions, FireEye recovered a custom video recording capability used by FIN7 as a part of their operations. FireEye\u2019s FLARE team reverse engineered the video protocol, which appeared to be custom-written by FIN7 as it has no external library dependencies, contained Cyrillic comments in the code, and required the use of a bespoke video player unique to FIN7.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers most likely leveraged this video recording capability in their arsenal to monitor operations in victim environments to inform later stages of their intrusions.\n  FireEye obtained a version of the criminal developers\u2019 video player from a trusted source and with the knowledge of the reverse engineered protocol, the FLARE team modified the source code to support multiple versions of FIN7\u2019s custom encoding.\u2002  With the patched source code, FireEye can decode and playback FIN7\u2019s video monitoring for affected victims in possession of these files.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Throughout 2018, FireEye has continued to identify multiple domains registered using patterns consistent with prior FIN7 activity, as well as campaigns using disparate TTPs that we have attributed to FIN7 with varying degrees of confidence.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ZIP archives delivering the BIRDDOG backdoor were hosted on a portion of suspected FIN7 domains registered in 2018.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some evidence further characterizing the nature of this campaign suggests these malicious documents were sent to financial institution customers in Eastern Europe and Central Asia as early as September 2017. The targeting of individuals rather than organizations would mark a significant shift in their targeting, although it is also possible that the banks spoofed in these campaigns were FIN7's ultimate targets.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, we have identified similarities between FIN7 activity and BATELEUR campaigns, which began as early as mid-2017 and have been primarily aimed at U.S.-based restaurant chains.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These campaigns leveraged macro-embedded Word documents directly attached to the emails as well as ones hosted on Google Drive.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The documents were meticulously crafted to appear as though they came from legitimate organizations (e.g. restaurant associations and suppliers of POS hardware).",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This suspected FIN7 activity continued past the date of most recent arrest announced by U.S. law enforcement, although the attackers are now leveraging an updated JavaScript backdoor dubbed GRIFFON.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These recent campaigns could be representative of a decisive effort to diversify TTPs to avoid detection or could indicate the formation of FIN7 splinter groups carrying out autonomous campaigns. As a result, organizations need to remain vigilant and continue to monitor for changes in the methods employed by the FIN7 actors.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "According to U.S. law enforcement, at least a portion of FIN7 activity was run out of a front company dubbed Combi Security. A cache of its website reveals that the company purported to be \u201cthe world leaders in the field of comprehensive protection of large information systems from modern cyber threats\u201d with headquarters in Moscow, Haifa, and Odessa. We have identified job advertisements for Combi Security that have been posted on popular Russian, Ukrainian, and Uzbek job recruitment sites, as well as numerous individuals who most likely worked for the company.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Due to the seeming legitimacy of the recruitment postings, some individuals may have been unaware of illicit nature of their work.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While the recruitment of unwitting individuals as puppets has been a common component of at least some criminal schemes \u2013 for example, reshipping mules who are recruited through postings on career sites advertising attractive work-from-home jobs \u2013 FIN7\u2019s veiling of full-scale financial compromises as legitimate offensive security engagements is particularly notable.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The apparent success of Combi Security in recruiting unsuspecting individuals in this manner, may lead to more of this type of technical recruitment by cyber criminals in the future.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The criminal organization behind FIN7 is almost certainly comprised of many additional individuals beyond those already apprehended by law enforcement authorities.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FireEye iSIGHT Intelligence expects that at least a portion of these malicious actors are likely to continue conducting cyber crime activity in some capacity.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although we expect activity to continue, it is extremely common for threat actors to either modify their TTPs or temporarily halt operations following significant developments such as arrests of high-level members and/or public disclosure of TTPs that they employ.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Depending on the organizational and communication structure of the group, it is also plausible that multiple subgroups could form and carry out independent operations in the future.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recent campaigns, as well as those using tactics that were atypical for historical FIN7 campaigns, such as the SEC campaigns with widespread targeting, may be representative of semi-autonomous groups pre-existing within, or cooperating with, the FIN7 criminal organization.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As noted in our CARBANAK overview, certain malware families and techniques transcend strictly defined threat groups, and may be re-used by developers and operators as they transition between organizations and campaigns.\n ",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These recent announcements by U.S. law enforcement highlight the positive impact that can result from synergy between private and public sector organizations in disrupting organized cyber crime operations.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As demonstrated by FIN7, financially-motivated threat actors are becoming extremely advanced and are capable of inflicting significant harm on organizations through vast, but carefully orchestrated campaigns.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As sophisticated threat groups continue to emerge, partnerships, such as those exhibited here, will almost certainly play a key role in combating these threats.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Jordan Nuce, Tom Bennett, Michael Bailey, and Daniel Bohannon\nFireEye has responded to many FIN7 incidents, which has provided us extensive insight into their operations.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As part of this blog post, we are also including numerous indicators that we attribute to FIN7 and an overview of their techniques to aid organizations in identifying malicious activity across their networks.\n In addition to LNK metadata, FIN7 phishing documents consistently contained artifacts detailing the local file system paths of component files used to construct the spear phishing documents. In the following tables, we have also included examples of the myriad of command line obfuscation techniques used by FIN7. Of particular note is the quick turnaround time between documents employing different techniques.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "jscript %TEMP%\\crashpad.ini\nTable 2: Suspected FIN7 spear phishing launch parameters and attacker local system artifacts\n@set w=wsc@ript /b",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "%HOMEPATH%\\pp.txt\n @echo %w:@=%|cmd\nwmic.exe process call create \"cmd start /min cmd /c for /f \\\"usebackq delims=\\\" %x in (`FindStr /R /C:\\\"@#[0-9]#@\\\" \\\"%TEMP%\\unlock.doc.lnk\\\"`) do %x|cmd >nul 2>&1 &\"\ncmd.exe /S /D /c\" echo /*@#8#@*/try{sh =new ActiveXObject(\"Wscript. Shell\");fs=new ActiveXObject(\"Scripting. FileSystemObject\");p=sh. ExpandEnvironmentStrings(\"%TM\"+\"P%\");f=fs.GetFile(p+\"//unlock.doc.lnk\");s=f.OpenAsTextStream(1,0);c=s.Read(2403);c=s.ReadAll();s.Close();this[String.fromCharCode(101)+'va'+'l'](c);}catch(e){} >%HOMEPATH%\\t.txt  & wscript //b",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Application\");this[String.fromCharCode(101)+\\\\'va\\\\'+\\\\'l\\\\'](w. ActiveDocument.Shapes(1).TextFrame. TextRange. Text);}catch(e){};';var fso = new ActiveXObject(\"Scripting. FileSystemObject\");var sh = new ActiveXObject(\"Wscript. Shell\");var p = sh.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Application\");this[String.fromCharCode(101)+'va'+'l'](w. ActiveDocument. Shapes(2).TextFrame. TextRange. Text);}catch(e){}; >%HOMEPATH%\\ttt.txt & echo %x:@=%|cmd\ncmd.exe /C set x=wsc@ript /e: js@cript %HOMEPATH%\\md5.txt & echo try{w=GetObject(\"\",\"Wor\"+\"d.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Application\");this[String.fromCharCode(101)+'va'+'l'](w. ActiveDocument.Shapes(1).TextFrame. TextRange. Text);}catch(e){}; >%HOMEPATH%\\md5.txt & echo %x:@=%|cmd\nC:\\WINDOWS\\system32\\mshta.exe vbscript:Execute(\"On Error Resume Next:set yjdsqjtrn=GetObject(,\"\"Word.Application\"\"):execute yjdsqjtrn. ActiveDocument. Shapes(2).TextFrame. TextRange.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Text:close&quot;)\nTable 3: FIN7 spear phishing launch parameters and attacker local system artifacts\nFireEye is providing insight into FIN7\u2019s notable methodologies across multiple stages of the attack lifecycle and tips for identifying evidence of this activity and similarly suspicious activity in your environment.\n Spear phishing emails sent using PHP Mailer\nInbound emails containing metadata such as \u201cX-Mailer: PHPMailer\u201d\nPersistence using registry Run and Run Once keys\nNew Run and RunOnce registry entries referencing .VBS",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Execution or persistence using Scheduled Tasks\nNew Scheduled Tasks referencing .CMD, .LNK, .VBS, .VBA, .PS1 and other scripting language extensions\nPersistence using Windows Services, Startup Directory\nNew Windows Services, new files in Startup directories\nNew shim database files and modifications of AppCompatFlags registry keys (see FIN7 SDB Persistence)\nOutbound connections with port-protocol mismatches on common ports such as 53,80,443,8080\nOutbound connections or DNS resolutions to \"sketchy\" 2nd level domains with generic 3rd level domains such as mail, www1, www2, dns, ftp (eg.",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "C2 using VPS infrastructure with low reputation\nInbound and outbound connections from and to non-standard IP ranges, especially from international Virtual Private Server (VPS) providers\nC2 using legitimate services including Google Docs, Google Scripts and Pastebin\nC2 using DNS via A, OPT, TXT records\nUnusually long or numerous DNS A, TXT and OPT record queries\nNewly observed domains registered via REG.RU\nNewly observed domains registered via NameCheap\nC2 domains registered with odd format and top-level domains\nUnusually long or numerous DNS queries with the structure [a-zA-Z]{4,5}\\.[pw|us|club|info|site|top] (eg. \u201cpvze[.]club\u201d)\nOutbound connections to newly registered, hyphenated domains\nFireEye is providing these granular technical indicators so that interested parties can better understand the threat actor and search for their historical activity across enterprise networks.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "On the Hunt for FIN7_ Pursuing an Enigmatic and Evasive Global Criminal Operation _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These cookies are used to collect information about how you interact with our website and allow us to remember you. We use this information in order to improve and customize your browsing experience and for analytics and metrics about our visitors both on this website and other media.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The majority of companies in either the Retail or Hospitality industries are [sadly] familiar with FIN7.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This article, while focused on FIN7, is truly applicable to numerous enemies that we face.   This article is aimed at defrocking a particular enemy and arming us all with better tools to defend against them.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is also worth noting that the current syndicate attributed to FIN7 is not the same organizational composition that it once was.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 has been known to be in operation since 2012 (although some estimates put them being active as far back as 2011), when TrustWave SpiderLabs first observed threat behavior that became much more prolific after 2015. Since then FIN7 has been identified by many organizations, including:\nThis group has suspected ties to Russian organized crime and has netted roughly $1 Billion USD in the last half-decade.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The FIN7 group is increasingly adaptable not only to the geopolitical influences around them, but also quite capable in the environments they find themselves in.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the group has strong ties to Ukraine, where 3 members of the FIN7 group were arrested in 2018, though often times Russian cyber operations find their first deployment in Ukraine.\n The FIN7 group began by targeting banks in the Russian Federation, but in 2015 began to transition their targeting to a broader scope to include the Middle East, Europe and the United States.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Currently, the group is known to target auto manufacturers, financial organizations, technology companies and innovators and hospitality, and retail organizations.\n As of 2018, the main targets of this group are in the financial, retail and hospitality sectors.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The US Department of Justice estimates put their intrusions at 6,500 POS terminals at 3,600 separate organizations.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As a group, their targeting is clear, but at the onset of the attack it can seem less so.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Historically the group has targeted individuals who are listed in the organizations SEC filings which can be viewed publicly by looking the business up in the Edgar filing database. Other individuals targeted for attack are customer service representatives who are attempting to resolve an issue they\u2019ve identified from the attack.\n FIN7 begins the attack via malware delivery. This starts as a spear phishing email sent to the initial target. Generally the sentiment of the email is anger and accusations against the target\u2019s organization either due to a policy or a product.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker performs a technique commonly called \u201camygdala hijacking\u201d by eliciting a fear response in the target, and proceeds to reinforce the hijack by making threats and demands of the target which puts the individual on a defensive stance. Once the target responds, the actor then shifts to a deescalation tactics which eases the tension of the situation and causes the target to let their guard down in order to develop a more civil rapport with the target.\n  Additionally, the actor then begins to offer help to assist the target in resolving the issue which they themselves have created, thus \u201chooking\u201d the target by making themselves seem to be the hero.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The actor then begins to use the first name of the target to establish a sense of intimacy, common knowledge and familiarity.\n  The exchange then leads to an initial document delivery that is usually benign but possesses a tracking pixel that allows the actor to verify whether or not the target is opening attachments, and if so can provide initial visibility into the system of the target.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The documents for this phase are often either blank or built for the campaign and correspond to the topic of conversation from the attacker.\n ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This document has either a VBA macro or an embedded OLE which persuades the target to run these in order to drop the first stage loaders. If the first stage loader is not dropped, the attacker resumes the threat tactic and escalates the issue to the target\u2019s supervisor which indicates an extensive amount of OSINT and revealing the extent the attacker is willing to pursue a single individual.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since FIN7 focuses on obtaining financial data, they rely heavily on malware to scrape consumer credit card information from Point Of Sale (POS) systems as well as other account information from databases in the network.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The data stolen is then used to steal funds from victims and commit fraud, which is how the organization funds itself.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There is also a possible connection to the 2016 SWIFT attacks, many of which have since been attributed to North Korea, however evidence of this is limited and open to interpretation.\n The group typically follows a standard sequence of events: Spear phishing a target with a document loaded with a malware payload which as of May 2018 has been the Griffon payload, or a combination of SQLRat and DNSBot historically. These trends, observed by FireEye/Mandiant and Flashpoint respectively, always lead to the loading of an additional payload which is most commonly the Tinymet meterpreter payload to establish a beachhead in the network.\n This begins the beaconing back to the Cobalt Strike servers. To establish persistence, the group then injects a scheduled task to reestablish the C2 connection to Cobalt Strike which historically is run twice a day.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "From there the adversary loads process injection tools or memory scrapers (commonly mimikatz) and pivots using tools like powersploit, RDP services, and PowerAdmin Exec.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A new development was the discovery of the Astra PHP Panel being used in conjunction with SQLRat. This discovery was posted in March 2019 from Flashpoint, was tracked back via the tie in established by the US DOJ; the Combi Security company was acting as a front and recruitment platform for the FIN7 group.\n The malware most commonly associated with FIN7 is the Carbanak family, which the group gained as its common moniker.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Carbanak malware is not, however, exclusive to FIN7, nor do they use it explicitly.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Currently, the group is using macro enabled word documents and spear phishing to deliver initial payloads that pull down second stage loaders like Spy.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Sekur, although recently the Bateleur JavaScript backdoor has come into fashion as of November 2017.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the group heavily targets the following CVEs:\nThe group has begun branching out in using various malware versions and a full listing of the known IOCs for the new SQLRat and DNSBot additionally the Astra PHP panel are included at the end of this document as well as a list of links to the open source projects to allow for greater research.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Due to FIN7\u2019s heavy use of spear phishing to deliver malicious MSFT Office documents to users, the most common exploits are scripts written in PowerShell or VBA and executed as macros in the documents. Blocking macro execution and enabling verbose logging from PowerShell (although storage space is expensive) is an excellent start to defend against this group and others who favor sophisticated phishing attacks.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the usage of honey tokens in the environment can give a high-fidelity alert regarding access. In the case of FIN7, string searches can detect user credentials to a database or a fake credit card number.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Tracking known indicators based on the actor\u2019s activity and setting alarms once IOCs are detected are also effective defense options.\n Many organizations are able to track the activity in their environment, but taking a more proactive stance is optimal.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this case, PCI/DSS scoping can act as an initial point of reference, but knowing where card data and financial data live can create a position of strength for defenders.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Though FIN7 does not actively exploit vulnerabilities at the time of this writing (e.g. CVE\u2019s 2545, 1701, & 0199), they can potentially begin to do so in the future.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Vulnerability Management allows you to take an in depth stock of your IT assets. TTPs posted by intelligence and research groups can help prioritize patches based on exploits available for the vulnerability.   However, it is important to note that many adversaries gain access to an organization not via high and critical vulnerabilities, but by chaining together a number of vulnerabilities considered to have low and medium severity.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Be on the lookout for new scheduled tasks, especially those that use a .js file extension. If possible establish a host based detection for new files in the %appdata%\\Roaming\\Microsoft\\Templates\\ directory, particularly any with a .dot extension as well as new files in %appdata%\\local\\Storage\\.\nEnsuring that your toolsets and configurations are set up properly can not only deter threats, but also cause problems for adversaries. Properly configured EDR, script blocking can prevent things like JavaScript or macros to deploy while OS hardening guidelines modeled after groups like NIST and CIS will also cause more issues for attackers than most tools.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Finally, user education is a key component in every organization. Phishing is a highly used method for an initial foothold in organizations.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Until perfect phishing protection is created, users need to know how to recognize a malicious email, how to respond and what the company policies are for mitigating the risk. Good reporting can prevent a major campaign from being effective and can potentially cause a large portion of attacker infrastructure to be burned if reported correctly and responded to properly.\n Below is a recap of what should be considered minimum Enterprise defense and/or planning goals to reach first.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The higher the number below the greater the impact to defense, however there is typically a corresponding increase to the deployment lifecycle complexity.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "2. Log & Monitor on Enterprise Host Environment\n3. Alert (& Groom) on the Monitored Enterprise Host Environment\n4. Blocking macro execution in application userland with GPO\n5. EDR JS and macro script blocking\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In conclusion, FIN7 is an adversary worthy of concern with compromises resulting in the loss of up to a billion dollars.",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While this adversary is dangerous, basic security hygiene as outlined by both the NIST and CIS frameworks can reduce the actor\u2019s effectiveness in your environment as well as reduce the mean time to detection and mitigation. Additionally, knowledge of the group\u2019s tools, tactics, and processes allow defenders to more effectively predict the actions of the attacker, all of which can reduce your costs and the threats to your organization.\n This tipper, as of late April 2019, contains new TTPs and IOCs that are worth a review by members.  ",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our platform combines comprehensive threat management capabilities, Deepwatch security experts, and precise automated actions to enable cyber resiliency and reduce risk.\n",
        "source": "Profile of an Adversary - FIN7 _ Deepwatch.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following blog post and research was originally published by ICEBRG prior to being acquired by Gigamon on July 24th, 2018.\n The 2017 Verizon DBIR Report states that 73 percent of breaches in 2016 were financially motivated and span a number of different industries and financial targets. Since 2015, a financially motivated threat group known as FIN7 (also referred to as the Carbanak Group) has emerged from the shadows and has been highlighted in a number of different incidents.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In early 2017, Gigamon Applied Threat Research (ATR) detected and observed FIN7 activity and spent some time profiling various aspects of their operations.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This analysis showed that, as many others have reported, FIN7 is not just a capable threat group that utilizes \u201coff the shelf\u201d capabilities to accomplish their objectives, but also adapts to meet the challenges of the environment in which they are operating. It is our hope that this information will help others dealing with the threat actors and also shine light on some recommended capabilities for response teams to better understand the mindset of their adversaries.\n This is part one of a two-part blog series detailing the team\u2019s engagements with FIN7 throughout early 2017. Part one of this series focuses on the network command and control techniques used by the actors.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In these posts, Gigamon ATR will not disclose IOCs from the campaigns, but rather focus on specific patterns that may help identify attacker activity.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While it is widely believed that the use of custom tools is a characteristic of sophisticated threat actor groups, open source and commercially available tools are easily obtained, easy to hide, and, due to their widespread legitimate use, make attribution difficult.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 makes heavy use of these tools, involving a number of techniques throughout their operations.\n Gigamon ATR observed FIN7 using several types of communications to maintain a foothold in their target environment, rotating their infrastructure throughout the operation in order to stay one step ahead of response and remediation efforts. For their primary command and control (C2), FIN7 used Cobalt Strike\u2019s DNS C2 as their method of maintaining access inside target environments. Two separate C2 servers wereused during the observed periods: one used heavily during initial access and a second one used more during post-exploitation activities.\n The authoritative DNS servers for the malicious domains were geographically distributed, but all hosted within the same low-reputation Virtual Private Server (VPS) provider. The secondary C2 method leveraged a different encrypted communication channel. Infrastructure for the secondary C2 method was also hosted on the same geographically disparate low-reputation VPS provider.\n",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the incident, Gigamon ATR observed that the attackers were consistently active between 08:00 and 23:00 GMT, with peak activity at 17:00 GMT and with minimal activity outside of that window. This time window is not intended to perform any sort of attribution but was useful when planning and coordinating phases of the response effort.\n Using these timelines, Gigamon ATR was able to identify FIN7 employing different C2 techniques based on their operational patterns. Before concluding operations for the day, the adversary would set their callback times to one hour, and change the mode of their communications to use A resource records (instead of TXT records). This change appeared to be an attempt by the actors to maintain a lower profile by using more natural queries in the environment. Further, the threat actors would spawn a secondary C2 component during their off-hour periods in an apparent attempt to maintain access should the DNS C2 be detected.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "DNS C2 leverages malicious DNS TXT and A RRs (resource records) queries which traverse standard recursive DNS channels and terminate at an attacker\u2019s authoritative DNS server. The traversal of standard DNS channels make this technique effective for highly controlled environments where restrictive firewall, web filter or proxy policies are enforced; for example, in point of sale (POS) networks in the retail and hospitality sector, as well as other high-security financial transaction environments.\n The specific C2 capabilities of Cobalt Strike are outlined in various blogs on their website. It should be noted that Cobalt Strike allows for modification of several aspects of the DNS C2 channel through the Malleable C2 option. In the observed operations, FIN7 used the default communication settings present in Cobalt Strike without modification.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This decision (or lack thereof) could be indicative of lack of tool knowledge, or a lack of necessity to do anything more to accomplish their objectives.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the initial exploitation, and throughout the lateral spread attack phases, the actors used PowerShell scripts to deploy DNS TXT record stagers into memory. During execution, PowerShell would make iterative DNS TXT queries, which would return encrypted data to be concatenated and then executed in memory.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These queries followed a pattern matching:\nEmerging Threats Pro has a signature for this part of the Cobalt Strike DNS C2 chain (SID 2809850) that should provide basic alerting.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By monitoring for the aaa.stage.[encryptedstage].MaliciousDomain.com pattern, Gigamon ATR was able to detect attacker movement in real time, prior to confirmed control of the victim host, enabling immediate analysis of the new activity.\n  After staging, the attacker would shift to the use of DNS A resource records.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When idle, the malware would make requests to the attacker-controlled domain with a pattern matching [SessionID].MaliciousDomain.com.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By tracking the session IDs in observed requests, Gigamon ATR could uniquely identify compromised hosts, and alert on any possible new compromises by identifying new session IDs, even without direct visibility of hosts in certain network enclaves.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, using these session IDs, Gigamon ATR tracked the volume of activity per ID to determine which hosts appeared central to the operations of the attacker.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By default, the C2 server would respond to the aforementioned A record requests with \u20180.0.0.0\u2019 when the malware should remain inactive.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By tracking DNS responses of \u20180.0.0.0\u2019, Gigamon ATR detected new attacker infrastructure even when not discovered by other heuristics, as well as tracked periods of attacker inactivity to further cement a profile of FIN7\u2019s operational habits.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It should be noted that several non-malicious domains perform similar actions and this monitoring requires additional analysis for verification.\n When tasked with commands by the attackers that had results or output, the A resource record requests would use a pattern matching post.[EncryptedData].[RandomValue].MaliciousDomain.com. By monitoring for this pattern, Gigamon ATR was able to observe data leaving the environment and, although encrypted, make rough determinations on approximate volume of data loss. DNS A record C2 results in a slower data channel due to limitations in the DNS specification and hampers the ability to conduct large scale data exfiltration. \n While the patterns presented above are specific to Cobalt Strike\u2019s default configuration of DNS C2, aspects of this activity can be abstracted to allow for general purpose detection of malware using DNS command and control methods. The following characteristics may identify suspicious DNS behavior (note: multiple legitimate solutions use similar schemes to communicate. These behaviors, like most heuristic-based analytics, will likely have high initial false positive rates, and require tuning to each environment):\nOne unique aspect of the observed FIN7 infrastructure is the configuration pattern of their C2 domain.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The actors use a primary domain that remains parked and setup subdomains with the pattern [random hostname][1-5] (ie. www1) off of the second-level domain. The Cobalt Strike malware will attempt to access these subdomains in a rotational pattern. FIN7 likely uses this structure as a method of surviving mitigation activities in the case their target takes action against a single subdomain.\n In our observations, it is not uncommon for network defense teams to hone in on a specific threat involved in an incident, and tailor detection around known intelligence. This behavior presents a risk by potentially resulting in a failure to identify other unobserved attacker TTPs; as the saying goes, \u201cYou only know what you know.\u201d",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Gigamon ATR uses network-wide visibility to not only detect previously known patterns or IOCs, but also to enable analysts to hunt for new or shifting TTPs.\n",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Outside of FIN7\u2019s operational hours, Gigamon ATR observed the actors spawning additional connections from compromised assets to the same low-reputation VPS provider used for DNS C2.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This encrypted connection used TCP with a destination port of 443, but was not standard TLS or SSL.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This non-standard traffic, when combined with reuse of similar network space, enabled Gigamon ATR to quickly identify and track the activity.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These long-duration connections contained low packet sizes, approximately 90 bytes, likely a simple heartbeat for connection keep alive.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Throughout our engagements with FIN7, Gigamon ATR observed heavy use of compromised credentials, specifically domain administrator accounts, to move throughout the environment.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Notably, FIN7 would frequently use the psexec_psh command within Cobalt Strike, which uses the RPC Service Controller protocol to create a service on a remote host with the binary path set to execute a malicious PowerShell command.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 showed little regard for operational security (OpSec) in their lateral spread, nor caution around key assets in the environment.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While it appeared as though the access to payment information was the key focus of the operations, Gigamon ATR observed the group constantly exploring other enclaves of the target environment. In one instance, Gigamon ATR observed the threat actors pivot from a remote POS environment to compromise a domain controller, then from the domain controller to assets in other corporate subnets.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By monitoring flow data for key assets, Gigamon ATR detected abnormalities originating from compromised remote locations and identified odd directionality involved with credential use.\n",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Throughout our engagements with FIN7, it became clear that while certain components of their operations were automated, the large majority of their activities appeared to be interactive in nature.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When dealing with an interactive adversary such as this, traditional steps of the incident response process can be painstaking and require additional coordination or effort.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In contrast to automated malware infections, interactive threat actors may detect and respond to containment actions, modify TTPs to avoid detection, and work to stay ahead of the response team\u2019s decision-making processes.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In spite of this challenge, profiling and monitoring an interactive adversary allows defenders to gain insight into the attacker\u2019s thought processes, procedures and ultimately the patterns of their behaviors and activity. By modeling and recognizing those patterns, understanding why the adversary performs certain actions, and knowing how to line up response to outperform an interactive actor, responders can complete thorough and effective mitigations of this activity.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is easy to surrender to passive disengaged monitoring when dealing with encrypted command and control protocols, but so much can be gained from black-box analysis of the patterns in the protocol.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In these engagements, Gigamon ATR was able to profile phases of tactical action and track the adversary by understanding the specifics of their C2 protocols.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We hope that this information acts a good resource for those dealing with FIN7, as well as other unknown threats in their environment.\n ",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the second part of the series, Gigamon ATR discusses the end goal of FIN7, and presents technical details of their financial compromise capabilities.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This two-part blog series is a joint research post by Gigamon ATR and PwC. Part two can be found here.\n",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts.",
        "source": "Footprints of Fin7_ Tracking Actor Patterns (Part 1) - Gigamon Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This chain involves a substantial amount of base64 encoded JavaScript files that make up each component of the JavaScript bot. It also contains the reflective DLL injection PowerShell code to inject an information stealing malware variant DLL which will be discussed further.\n",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Before we demonstrate our analysis results, we will explain the values used for plotting and clustering of the JavaScript files.\n This is then evaluated using an obfuscated function invocation, E.G:\nThese base64 decoding steps lead to various execution branches of JavaScript bot functionality, and the injection of a stealer DLL into memory:\nFigure 1: Detailed Document Infection Chain Using JavaScript and DLL Injection\n",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This calculation is done for each JavaScript file and is the X axis of our scatter plots that will be described in the next section.\n ",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 2: Scatter plot using entropy and base64 decoding depth\nThere are a number of conclusions from the scatter plot:\nFigure 3: Scatter plot of PowerShell DLL documents\nThe outliers are the decoded DLLs and XML task files. When these components are removed from the scatter plot (leaving only JavaScript) we see similar clusters to the first generation of documents:\nFigure 4: Modified Plot of PowerShell DLL Documents\nBased on the number of clusters and range of entropy we see that this generation of documents contain more files with varying functionality and depth. This plotting technique also provides a method of identifying new functionality by showing outliers, such as the labeled PS Outlier which contains an array of encoded PowerShell bytes rather than a blob that provides the final PowerShell for DLL injection:\nFigure 5: Identified New PowerShell Functionality Due to Entropy Outlier\nFigure 6: Variables and Path GUID JS Changes\nThis functionality also highlights an interesting obfuscation mechanism that some emulation engines may ignore.",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The function body of the evaluated JavaScript appears to be within a multi-line comment, however, in reality this is evaluated as a multi-line string.",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is again using the comment block evasion technique.\n Figure 20: Document LNK Command Prompt Static Attributes\nFigure 21: Active Document LNK Static Attributes\nThe OLE object can be clicked on within the document during the Threat Grid run using the Open Embedded Object in Word Document playbook, which will automatically execute the embedded object during the Threat Grid run when selected from the submission dropdown menu:\nFigure 22: Selecting Playbook from Submission Menu\nA depiction of this automated user interaction can be seen below:\nFigure 23: Clicking on Document OLE Object Through Playbook\nWhen clicked additional behavioral indicators are triggered based on dynamic behavior:\nFigure 24: Dynamic Activity Caused by Clicking the OLE Object\nTask creations (used by the JavaScript bot for periodic execution of components) can also be observed:\nFigure 25: Task Creation Dynamic Activity\nThe JavaScript content that is periodically executed can be seen the Artifacts section and can be downloaded or resubmitted for further analysis:\nFigure 26: Written JavaScript Artifact Objects\n This intelligence is then integrated back into the AMP cloud protecting all customers who may be targeted by similar attack methodologies.\n",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 27: Captured Command Line Arguments in AMP for Endpoints Device Trajectory\n This triggers an Indicator of Compromise which can then be further investigated:\nFigure 28: Indicator of Compromise from Captured Command Line Arguments\nAdditional ways our customers can detect and block this threat are listed below.\n Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors.\n CWS orWSA web scanning prevents access to malicious websites and detects malware used in these attacks.\n Email Security can block malicious emails sent by threat actors as part of their campaign.\n Network Security appliances such as NGFW, NGIPS, and Meraki MX can detect malicious activity associated with this threat.\n AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products.\n",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network.\n",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our latest findings indicate a definitive shift in the tactics of the North Korean APT group Lazarus Group.\n Cisco Talos recently discovered a malicious campaign that likely started as early as August 2023, delivering a new remote access trojan (RAT) we dubbed \u201cSugarGh0st.\u201d\nKnowing the common scams is an important step in using the platform safely.",
        "source": "FIN7 Group Uses JavaScript and Stealer DLL Variant in New Attacks.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cybersecurity News, Threat Research, And More From The Team Spearheading The Evolution Of Endpoint Security\nOn June 7, 2017, Morphisec Lab identified a new, highly sophisticated fileless attack targeting restaurants across the US.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The ongoing campaign allows hackers to seize system control and install a backdoor to steal financial information at will.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It incorporates some never before seen evasive techniques that allow it to bypass most security solutions \u2013 signature and behavior based.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Aside from these updated techniques, Morphisec\u2019s investigation revealed an almost perfect match to FIN7 attack methods. Past highly successful and damaging attacks on banks, SEC personnel, large restaurant chains and hospitality organizations have all been attributed to the financially-motivated FIN7 group.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7, which is also associated with the Carbanak gang, must be seen as one of the leading threat actor groups operating today.\n Like past attacks, the initial infection vector is a malicious Word document attached to a phishing email that is well-tailored to the targeted business and its day-to-day operations.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Word document executes a fileless attack that uses DNS queries to deliver the next shellcode stage (Meterpreter). However, in this new variant, all the DNS activity is initiated and executed solely from memory \u2013 unlike previous attacks which used PowerShell commands.\n OpenDNS investigate data, shared in coordination with the Cisco Advanced Threat Research & Efficacy Team, shows that this is a large-scale, currently active attack with peaks of more than 10K DNS requests per hour.\n Alarmingly, the detection score on VirusTotal for all of the documents continues to be 0/56 from the time the first documents were uploaded (1.6.2017) up until the date of this publication. This means the attackers successfully bypass static analysis by most of the security solutions.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By contrast, Morphisec\u2019s Moving Target Defense-based technology prevents the attack in its early stages, before any channel to the attacker is opened.\n Below we describe the full technical details, beginning with the initial email through the final Meterpreter session used to hijack the computer.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some of the email attachments are called menu.rtf, others Olive Garden.rtf or Chick Fil A Order.rtf (all the identified hashes are listed at the end).\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "But this attack, instead of activating hta files (mshta.exe) from within the link, executes obfuscated JavaScript code.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All the victim needs to do is double click on the envelope and press OK.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first stage JavaScript copies additional JavaScript code snippets in txt format from the RTF document into a random directory \u201cC:\\Users\\<User Name>\\<Random guid>\\\u201d. The same code snippets are combined into a second stage JavaScript in \u201cC:\\Users\\<User Name>\\\u201d. Additionally, the first stage JavaScript creates a scheduled task that executes the second stage code within a minute \u2013 this delayed execution helps to bypass behavior analysis since the second stage is not directly executed by the first stage.\n In some cases, an additional scheduled task \u201cAdobeFlashSync\u201d is created for persistency.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This task is executed every 25 minutes and will repeat the actions described above \u2013 recreating the JavaScript code which later will create and execute a PowerShell script (described below).\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The second stage JavaScript creates a PowerShell file with the same name in the same directory.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The PowerShell script executes a compressed first stage PowerShell child process, which then performs a second stage PowerShell process. The latter PowerShell injects a shellcode into its own process using well-known CreateThread and VirtualAlloc techniques:\nThe shellcode phase of this attack is unique and demonstrates the constantly advancing abilities of attackers. The shellcode is the primary differentiating technique between this campaign and past attacks by FIN7 and other threat actors.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This shellcode iterates over process environment block and looks immediately for dnsapi.dll name (xor 13) and its DnsQueryA function.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Basically, FIN7 implemented a shellcode that gets the next stage shellcode using the DNS messaging technique directly from memory.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the DNS query pattern, it is very clear to see that alphabetical modification of the subdomain prefix is used:\nEach such DNS query results in an additional snippet of shellcode being appended to a reallocated buffer.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When, finally, the first stage shellcode receives a special \u201cFF\u201d signal, it then executes the delivered shellcode.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The last query is to the subdomain ihc[.]stage[.]12019683[.]ns2[.]true-deals[.]com):\nThe delivered second stage shellcode is encrypted:\n After decryption of the second stage shellcode, the shellcode deletes the \u2018MZ\u2019 prefix from within a very important part of the shellcode.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This prefix indicates it may be a dll, and its deletion helps the attack to evade memory scanning solutions.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Just before this step executed, we extracted the dll from memory and uploaded it to VirusTotal. If this dll was saved on disk, many security solutions would immediately identify it as a CobaltStrike Meterpreter, which is used by many attackers and pen testers. Having a Meterpreter session on a compromised computer allows for full control of the computer and exfiltration of any data, and in some cases lateral movement inside the organization.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 constantly upgrades their attacks and evasion techniques, thus becoming even more dangerous and unpredictable.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The analysis of this attack shows, how easy it is for them to bypass static, dynamic and behavior based solutions.",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These attacks pose a severe risk to enterprises.\n Fileless attacks are on the rise \u2013 Carbon Black reports that researchers found a 33% rise in severe non-malware attacks in Q4 2016 compared to Q1. Defenders will see more attacks on their businesses by hacker groups utilizing memory for evasion while keeping executable artifacts far away from disk.\n In this continuously evolving threat landscape, enterprises need to look for new defenses that are resilient to such changes and are able to prevent fileless attacks. Morphisec Endpoint Threat Prevention specializes in preventing in-memory attacks, using Moving Target Defense to make the target itself unpredictable.\n Stay in the loop with industry insight, cyber security trends, and cyber attack information and company updates.\n",
        "source": "FIN7 Takes Another Bite at the Restaurant Industry.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Vitali Kremez dissecting the \u2018Fin7\u2019 malware chain, which leverages malicious Office Macros and lightweight JS Loader scripts.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since 2015, this group has continued to be extremely successful and formidable targeting various businesses seeking large-scale point-of-sale (PoS) compromises and network intrusion impacting global enterprises. The group is also known and notorious for its stealthy techniques and sophisticated and persistent approach. \n Global corporations impacted by the group are primarily part of the restaurant, gaming, and hospitality industries. Some of the victims of this group include such restaurant chains as Chipotle Mexican Grill, Chili\u2019s, and Arby\u2019s.\n Most interestingly, this group used a front company \u201cCombi Security\u201d (reportedly based in Russia and Israel) to recruit various hackers to join their activities.",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This front company allowed the group to sustain their hacking activities and truly professionalized their hacking approach. \n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Despite the previous arrests of three members of the FIN7 group in January 2018, the group and/or its remnants still remained active on the financial crime landscape.\n It is notable that the group still deploys lightweight JavaScript backdoor with communication over HTTPS mimicking Content Delivery Network (CDN) domains. \n Additionally, they still leverage JavaScript backdoor via renamed wscript.exe with the actual JavaScript code called \u201cerrors.txt,\u201d for example.\n The FIN7 Microsoft document loaders do not rely on any exploits but simply require a social engineering trick to \u201cEnable Content\u201d to activate macros. Notably, to avoid process whitelisting of wscript, the macro logic copies the original JavaScript execution engine wscript.exe in %LOCALAPPDATA% and leverages a possible anti-analysis routine of checking the system drive size via GetDrive. TotalSize of more than 2456 bytes to possibly thwart anti-sandbox check. \n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The actual obfuscated Javascript backdoor is stored in UserForm object, which is also written to a disc as \u201cerrors.txt\u201d in %TEMP%. The final execution of the backdoor is performed via this following command:\nOnce it is done, the document macro runs a message box displaying \u201cDecryption error\u201d via MsgBox(\"Decryption error\").\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "1. Extract the VBA macro via olevba;\n2. Debug in Office VBA to retrieve decoded script;\n3. Extract and prettify obfuscated JavaScript backdoor from userform object;\n4. Modify JS code close to eval() and run script via Internet Explorer debugger, for example; \n5. Debug, extract and beautify the full FIN7 JS backdoor.\n The crypt_controller function accepts two parameters of type and request.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If type parameter equals \u201cdecrypt\u201d, the request is processed via decodeURIComponent splitting the request with separator \")*(\" and then retrieving encryption_key(second element[1]) from split request.",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If there\u2019s no encryption_key split, it pulls it as a random value via (Math.floor(Math.random() * 9000)",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The decoding routine is a simple XOR loop decoding the content as follows joining the result_string via .join command.\nb.",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If type parameter equals \u201cencrypt\u201d,  the result_string is joined with \")*(\" and passed to encodeURIComponent.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the aftermath of the initial call, the group deploys a custom \u201cprofiling\u201d script meant to fingerprint the machine and the network environment more closely.\n The malware checks for the presence of virtual machine, queries active directory, operating system, screen resolution, user account control (UAC) level, and retrieves a process list.\n Finally, it formats the data and appends to \u201caction=add_info\u201d request, which is sent to the server.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Microsoft Office First-Stage VBA Macro \u201c.doc\u201d Documents:\nSHA256: 6e1230088a34678726102353c622445e1f8b8b8c9ce1f025d11bfffd5017ca82\nSHA256: f5f8ab9863dc12d04731b1932fc3609742de68252c706952f31894fc21746bb8\nSHA256: 63ff5d9c9b33512f0d9f8d153c02065c637b7da48d2c0b6f7114deae6f6d88aa\nRecent Microsoft Office First-Stage VBA Macro \u201c.xlsb\u201d Documents:\nSHA256: 5fa5970548b43ae7d93d758a1eef1f12fd76891e36538e3ac170d5ab30906b5c\nSHA256: 60dfe419dcba6dfe16d24f663b3393deeffdedbe4da468be63c63ec4b914d485\nSHA256: 2ce1cfc137c0bcc82577cc77074c82154d81a7370491c85d43622af5186ef058\nGet notified when we post new content.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the era of interconnectivity, when markets, geographies, and jurisdictions merge in the melting pot of the digital domain, the perils of the threat ecosystem become unparalleled. Crimeware families achieve an unparalleled level of technical sophistication, APT groups are competing in fully-fledged cyber warfare, while once decentralized and scattered threat actors are forming adamant alliances of operating as elite corporate espionage teams.\n",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts.",
        "source": "Deep Insight into \u201cFIN7\u201d Malware Chain_ From Office Macro Malware to Lightweight JS Loader - SentinelLabs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cybersecurity News, Threat Research, And More From The Team Spearheading The Evolution Of Endpoint Security\nLike clockwork, FIN7 again unleashed a new attack able to bypass almost every security solution. The attack, which took place between October 8 to 10, 2017, is yet another demonstration of the high-paced innovation by threat actors.\n FIN7 is one of today\u2019s most organized and sophisticated cybercrime groups, primarily known for targeting US businesses to steal payment card data.",
        "source": "FIN7 Dissected_ Hackers Accelerate Pace of Innovation.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They typically use clever, customized spear-phishing lures with malicious attachments. Once an organization is infected, they move laterally across the network, using various anti-forensic techniques to evade detection. The group is closely tied to the notorious Carbanak Gang, responsible for a slew of attacks against financial institutions, although so far evidence falls short of directly equating the two.\n Over the past year, Morphisec has been closely monitoring FIN7 and their targets, publishing several analyses on methods used by this group.",
        "source": "FIN7 Dissected_ Hackers Accelerate Pace of Innovation.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In June 2017 Morphisec identified a highly sophisticated fileless attack targeting restaurants across the US, as discussed on Morphisec\u2019s blog and in a post co-authored with Cisco Talos. The June campaign used a new stealer DLL variant injected into malicious documents.\n In this report we take a broader approach, describing in detail the rapid dynamic changes over the course of the last four months, including the recent October attack, which was first documented by researchers at Icebrg. We examine each of the component modifications in the attack chains, and show how those changes helped FIN7 evade the dynamic behavior patterns and static patterns applied by many security solutions.\n",
        "source": "FIN7 Dissected_ Hackers Accelerate Pace of Innovation.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In fact, a presentation on FIN7 by FireEye at this year\u2019s InfoSecurity Europe  stated that \u201cIn most environments, prevention is not possible.\u201d The presenters, however, did not take into account the effectiveness of Moving Target Defense solutions (e.g. Morphisec Endpoint Threat Prevention solution) against these types of attacks.\n The technical analyses, available for download here, discusses:\nSTAGE 1: LNK FILE \u2013 OLE OBJECT\nLNK FILE \u2013 PROPERTIES CODE CONTENT\nLNK FILE \u2013 FILE DETAILS / BATCH FILE DETAILS\nSTAGE 4 \u2013 NETWORK BASED DETECTION EVASION\nSTAGE 5 - POWERSHELL \u2013 REFLECTIVE DLL INJECTION\nStay in the loop with industry insight, cyber security trends, and cyber attack information and company updates.\n",
        "source": "FIN7 Dissected_ Hackers Accelerate Pace of Innovation.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 is a financially-motivated threat group that has been associated with malicious operations dating back to late 2015.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 is referred to by many vendors as \u201cCarbanak Group\u201d, although we do not equate all usage of the CARBANAK backdoor with FIN7. FireEye recently observed a FIN7 spear phishing campaign targeting personnel involved with United States Securities and Exchange Commission (SEC) filings at various organizations.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In a newly-identified campaign, FIN7 modified their phishing techniques to implement unique infection and persistence mechanisms. FIN7 has moved away from weaponized Microsoft Office macros in order to evade detection. This round of FIN7 phishing lures implements hidden shortcut files (LNK files) to initiate the infection and VBScript functionality launched by mshta.exe to infect the victim.\n In this ongoing campaign, FIN7 is targeting organizations with spear phishing emails containing either a malicious DOCX or RTF file \u2013 two versions of the same LNK file and VBScript technique. These lures originate from external email addresses that the attacker rarely re-used, and they were sent to various locations of large restaurant chains, hospitality, and financial service organizations. The subjects and attachments were themed as complaints, catering orders, or resumes.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As with previous campaigns, and as highlighted in our annual M-Trends 2017 report, FIN7 is calling stores at targeted organizations to ensure they received the email and attempting to walk them through the infection process.\n While FIN7 has embedded VBE as OLE objects for over a year, they continue to update their script launching mechanisms.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the current lures, both the malicious DOCX and RTF attempt to convince the user to double-click on the image in the document, as seen in Figure 1.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This spawns the hidden embedded malicious LNK file in the document. Overall, this is a more effective phishing tactic since the malicious content is embedded in the document content rather than packaged in the OLE object.\n By requiring this unique interaction \u2013 double-clicking on the image and clicking the \u201cOpen\u201d button in the security warning popup \u2013 the phishing lure attempts to evade dynamic detection as many sandboxes are not configured to simulate that specific user action.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The script in the argument combines all the textbox contents in the document and executes them, as seen in Figure 2.\n The combined script from Word textbox drops the following components:\nAlso, the script creates a named schedule task for persistence to launch \u201c58d2a83f7778d5.36783181.vbs\u201d every 25 minutes.\n The dropped script \u201c58d2a83f7778d5.36783181.vbs\u201d acts as a launcher. This VBScript checks if the \u201c58d2a83f777942.26535794.ps1\u201d PowerShell script is running using WMI queries and, if not, launches it.\n \u201c58d2a83f777942.26535794.ps1\u201d is a multilayer obfuscated PowerShell script, which launches shellcode for a Cobalt Strike stager.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shellcode retrieves an additional payload by connecting to the following C2 server using DNS:\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once a successful reply is received from the command and control (C2) server, the PowerShell script executes the embedded Cobalt Strike shellcode.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If unable to contact the C2 server initially, the shellcode is configured to reattempt communication with the C2 server address in the following pattern:\n\u201cmshta.exe\u201d further executes the second VBScript \u201c58d2a83f777908.23270411.vbs\u201d, which creates a folder by GUID name inside \u201cIntel\u201d and drops the VBScript payloads and configuration files:\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777638.60220156.ini\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777688.78384945.ps1\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776b5.64953395.txt\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776e0.72726761.vbs\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777716.48248237.vbs\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777788.86541308.vbs\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\Foxconn.lnk\nThis script then executes \u201c58d2a83f777716.48248237.vbs\u201d, which is a variant of FIN7\u2019s HALFBAKED backdoor.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The HALFBAKED malware family consists of multiple components designed to establish and maintain a foothold in victim networks, with the ultimate goal of gaining access to sensitive financial information. This version of HALFBAKED connects to the following C2 server:\nThis version of HALFBAKED listens for the following commands from the C2 server:\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All communication between the backdoor and attacker C2 are encoded using the following technique, represented in pseudo code:\nFunction send_data(data)\n                random_string = custom_function_to_generate_random_string()\n                encoded_data = URLEncode(SimpleEncrypt(data))\n                post_data(\"POST\u201d, random_string & \"=\" & encoded_data, Hard_coded_c2_url,\nCreate_Random_Url(class_id))\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The FireEye iSIGHT Intelligence MySIGHT Portal contains additional information based on our investigations of a variety of topics discussed in this post, including FIN7 and the HALFBAKED backdoor.\n Figure 3 shows that for persistence, the document creates two scheduled tasks and creates one auto-start registry entry pointing to the LNK file.\n In many cases, attacker-created LNK files can reveal valuable information about the attacker\u2019s development environment. These files can be parsed with lnk-parser to extract all contents.",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "LNK files have been valuable during Mandiant incident response investigations as they include volume serial number, NetBIOS name, and MAC address.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For example, one of these FIN7 LNK files contained the following properties:\nFrom this LNK file, we can see not only what the shortcut launched within the string data, but that the attacker likely generated this file on a VirtualBox system with hostname \u201candy-pc\u201d on March 21, 2017.\n On April 12, in response to FIN7 actively targeting multiple clients, FireEye kicked off a Community Protection Event (CPE) \u2013 a coordinated effort by FireEye as a Service (FaaS), Mandiant, FireEye iSight Intelligence, and our product team \u2013 to secure all clients affected by this campaign.\n Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "FIN7 Evolution and the Phishing LNK _ Mandiant.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Phishing & Calling \nFIN7 typically initiated its cyberattacks by \ndelivering a \u201cphishing\u201d email to a company \nemployee.   Each email included an attached file, \noften an innocuous-appearing Microsoft Word \ndocument, with embedded malware.   The text \nwithin the email simulated a legitimate business-\nrelated message in order to lead the recipient \nemployee to open the attachment and unwittingly \nactivate the malware that would infect the \ncomputer.   For example, when targeting a hotel \nchain, the sender of the phishing email might claim to be interested in making a reservation with \ndetails enclosed in the attachment.   When targeting a restaurant, the phishing email might refer to \nplacing a large catering order or voice a complaint about prior service or food quality, further \ndescribed in an attachment.  ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In many cases, FIN7 would accompany the phishing emails with a telephone call to the \nvictim company employee about the same topic, which was intended to legitimize the phishing \nemail.   The caller often directed the employee to the recently sent phishing email to further \nentice the employee to open the attached file and activate the malware.  \n",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Network Intrusion: Control & Data Exfiltration \nOnce infected, the compromised victim computer \nconnected to one of FIN7\u2019s command and control servers \nlocated throughout the world.   ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Through a specially \ndesigned control panel, FIN7 could download a wide array \nof additional malware to the victim computer, remotely \nsend commands and receive data, and move laterally \nthrough the company\u2019s network.    Among other tools, \nFIN7 incorporated and adapted the notorious Carbanak \nmalware, which was used by other cybercriminals in a \nmassive transnational attack on the banking industry.  \n ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7\u2019s malware allowed its members to conduct surveillance on company employees, including \ntaking screen shots and even video recordings of desktop activity, enabling them to secretly steal \ncredentials and other network information.    FIN7 then used its unauthorized access to the \nvictim\u2019s computer system to locate and extract various information and property of value, such \nas financial information and caches of customer payment card data.  \n ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FIN7 most commonly focused on fast-food and casual dining restaurants, hotels, casinos, \nand businesses with a high frequency of point-of-sale transactions, including businesses with \ndozens of locations operating in Western Washington.   ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "With these and other victims, FIN7 \nsought to steal credit, debit, and in some cases gift card data, used during legitimate customer \npurchases. \n ",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since 2015, FIN7 successfully stole data for more than 16 \nmillion payment cards, many of which have been offered for \nsale through online underground marketplaces for stolen data.  \n",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The purchasers could then use the stolen card numbers to make \nunauthorized charges on accounts belonging to unsuspecting \ncardholders.   Investigators have observed typical retail \npurchases as well as the purchase of gift cards. \n  FIN7 is one of the most sophisticated and \naggressive malware schemes in recent times, \nconsisting of dozens of talented hackers located \noverseas. FIN7 uses an arsenal of constantly \nevolving malware tools and hacking techniques, \nand controls infected computers through a \ncomplex web of servers located throughout the \nworld. The masterminds behind the criminal \nenterprise created a fake computer security \nbusiness called Combi Security, which they used to recruit new members and to add a thin veil \nof legitimacy to the hacking scheme.",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, there was nothing legitimate about the scores of \nattacks FIN7 launched against over 100 unsuspecting victims. \n",
        "source": "fact_sheet_how_fin7_attached_and_stole_data_0.pdf",
        "detection": {},
        "prediction": {}
    }
]