!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["iris-t"]=e():t["iris-t"]=e()}(self,(()=>(()=>{var t={};function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var o,i,a=[],r=!0,s=!1;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(a.push(o.value),!e||a.length!==e);r=!0);}catch(t){s=!0,i=t}finally{try{r||null==n.return||n.return()}finally{if(s)throw i}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}return function(t){var n,o={minXOffset:0,maxXOffset:0,minYOffset:0,maxYOffset:0,numEvents:0};function a(t){var e=!0;return""!==t&&t.includes("?")&&!t.includes("=")&&(e=!1),e&&!0}function r(t){return!(!t.includes("?_sp=")&&!t.includes("&_sp="))}function s(e){return e.indexOf(t.location.hostname)>0}function c(t,e){for(var n=new URL(t.href),o=0;o<e.length;o++){var i=e[o],a=i.substring(1,i.length);if(i.startsWith("*.")&&n.hostname.endsWith(a))return!0;if(n.hostname==i||n.hostname=="www."+i)return!0}return!1}function l(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]+)"));if(e)return e[2]}function u(t){t=t||"_sp_";var e=new RegExp(t+"id\\.[a-f0-9]+=([^;]+);?"),n=document.cookie.match(e);return!(!n||!n[1])&&n[1].split(".")[0]}function f(){var t=[];try{var e=l("_iris_cdl"),n=e?e.split(","):[];n&&n.length>0&&n.forEach((function(e){t.push(atob(e))}))}catch(t){console.log(t)}return t}if(void 0===t.IIRISTracker){t.IIRISTracker=(n={snowplowEnabled:!1,tdEnabled:!1,collectorHost:"",appId:"",td:null,lob:"",domain:"",initConfig:function(e){if(e.config&&e.config.snowplow){this.snowplowEnabled=!0;var n=e.config.snowplow.appId,o=e.config.snowplow.cDomain;o&&function(t){if(!l("_iris_cdl")){var e="https://static.iris.informa.com/widgets/config/cdl/"+btoa(t)+".json";try{fetch(e).then((function(t){return t.json()})).then((function(t){var e=new Date;e.setTime(e.getTime()+864e5),document.cookie="_iris_cdl="+t+"; path=/; expires="+e.toUTCString()+";"})).catch((function(){console.log("CDL is not configured for ::"+t)}))}catch(e){console.log("CDL is not configured for ::"+t)}}}("com-informa-prod1.mini.snplow.net"===o?t.location.hostname:o.substring(2,o.length)),n&&o?this.initSnowplowConfig(e.config.snowplow):console.err("appId and cDomain are required.")}if(e.config&&e.config.td){this.tdEnabled=!0;var i=e.config.td.lob,a=this.getTDDomain(e.config.td.domain);i&&a?this.initTDConfig(i,a):console.err("lob and domain are required.")}var r=location.href;e.config&&e.config.snowplow&&(e.config.snowplow.contentTagEnabled||new MutationObserver((function(){var e=location.href;e!==r&&(console.log("pv evt occurred."),r=e,t.snowplow("trackPageView"))})).observe(document,{subtree:!0,childList:!0})),e.config&&e.config.lytics,this.setEloquaHashEmail()},getTDDomain:function(t){try{return t&&t.indexOf(".")>-1?t.substring(0,t.indexOf(".")):t}catch(e){return t}},setTrackingUID:function(e){this.snowplowEnabled&&(e&&this.setDomainCookie("IRIS_ID",e),t.snowplow("setUserIdFromCookie","IRIS_ID")),this.tdEnabled&&this.setTDCustomData(e)},clearTrackingUID:function(){try{if(this.snowplowEnabled){var e=this.collectorHost,n=e?e.substring(1,e.length):e;e&&e.startsWith("c.")&&t.location.hostname.indexOf(n)>0?document.cookie="IRIS_ID=; Max-Age=-99999999; path=/; domain="+n+";":document.cookie="IRIS_ID=; Max-Age=-99999999; path=/;",t.snowplow("clearUserData")}}catch(t){console.log("Could not clear the cookie")}},trackImpression:function(e){this.snowplowEnabled&&t.snowplow("trackSelfDescribingEvent",{event:{schema:"iglu:com.snowplowanalytics.snowplow/ad_impression/jsonschema/1-0-0",data:e}})},trackUriRedirect:function(e){this.snowplowEnabled&&t.snowplow("trackSelfDescribingEvent",{event:{schema:"iglu:com.snowplowanalytics.snowplow/uri_redirect/jsonschema/1-0-0",data:{uri:e.url}}})},trackStructEvt:function(e){this.snowplowEnabled&&e&&t.snowplow("trackStructEvent",{category:e.cat,action:e.act,label:e.lbl,property:e.prop,value:e.val})},setDomainCookie:function(e,n){try{var o=this.collectorHost,i=o?o.substring(1,o.length):o;o&&o.startsWith("c.")&&t.location.hostname.indexOf(i)>0?document.cookie=e+"="+n+"; path=/; domain="+i+";":document.cookie=e+"="+n+"; path=/;"}catch(t){console.log("Domain cookie is not set")}},trackPageView:function(e){this.snowplowEnabled&&(e&&e.title?t.snowplow("trackPageView",e.title):t.snowplow("trackPageView"))},trackUnloadEvent:function(e){try{e.contentTagEnabled&&e.context?t.snowplow("trackSelfDescribingEvent",{event:{schema:"iglu:com.iiris/page_unload_event/jsonschema/1-0-4",data:this.getUnloadEvtData()},context:this.getContext(e.context)}):t.snowplow("trackSelfDescribingEvent",{event:{schema:"iglu:com.iiris/page_unload_event/jsonschema/1-0-4",data:this.getUnloadEvtData()}})}catch(t){console.log("Error occurred during page_unload event")}},getUnloadEvtData:function(){return{minXOffset:Math.max(0,Math.round(o.minXOffset)),maxXOffset:Math.max(0,Math.round(o.maxXOffset))<=6e5?Math.max(0,Math.round(o.maxXOffset)):6e5,minYOffset:Math.max(0,Math.round(o.minYOffset)),maxYOffset:Math.max(0,Math.round(o.maxYOffset))<=6e5?Math.max(0,Math.round(o.maxYOffset)):6e5,activeSeconds:10*o.numEvents<=604800?10*o.numEvents:604800}},handleCrossDomainLink:function(e){var n=e.detail.url,o=new URL(e.detail.url),i=o.hostname,l=o.pathname,d=o.search,m=u();c(o,f())&&(s(n)||!r(n)&&a(d)&&m&&(d.includes("_sp")||(d=d.includes("?")?d+"&_sp="+m:d+"?_sp="+m)));var h="_blank";e.detail.mode&&"same"==e.detail.mode&&(h="_self"),t.open("https://"+i+l+d,h)},getUserId:function(t){try{return t&&""!==t.trim()?t:l("IRIS_ID")}catch(e){return console.log(e),t}},trackBusinessEvt:function(e,n){this.snowplowEnabled&&e&&t.snowplow("trackSelfDescribingEvent",{event:{schema:"iglu:com.iiris/business_event/jsonschema/1-0-1",data:{timestamp:e.ts,cookieId:this.getDUId()?this.getDUId():"",userId:this.getUserId(e.userId),sessionId:e.sessionId,pageURL:t.location.href,entityId:e.entityId,type:e.type,transactionId:e.transactionId,formId:e.formId,status:e.status}},context:this.getAssetContext(n)})},handleHrefCDLink:function(t){var e=f(),n=new URL(t.href);cdUrlSearch=n.search,t.href;var o=n.hostname,i=n.pathname;if(c(t,e)&&!s(t.href)){if(t.href.includes("javascript:")||t.href.includes("tel:")||t.href.includes("mailto:"))return!1;if(!a(cdUrlSearch)||r(n.href))return!1;if(t.href.indexOf("#")>0)return!1;var l=u();return!!l&&(t.search.includes("?")?t.search=t.search+"&_sp="+l:t.search=t.search+"?_sp="+l,t.href="https://"+o+i+t.search,!0)}},initSnowplowConfig:function(e){!function(t,e,n,o,i,a,r){t[i]||(t.GlobalSnowplowNamespace=t.GlobalSnowplowNamespace||[],t.GlobalSnowplowNamespace.push(i),t[i]=function(){(t[i].q=t[i].q||[]).push(arguments)},t[i].q=t[i].q||[],a=e.createElement(n),r=e.getElementsByTagName(n)[0],a.async=1,a.src=o,r.parentNode.insertBefore(a,r))}(t,document,"script","//static.iris.informa.com/f23io39d.js","snowplow");var n=e.appId,i=e.cDomain,a=e.context,r=t.IIRISTracker?t.IIRISTracker.instCount:0;t.snowplow("newTracker","sp1",i,{appId:n,eventMethod:"beacon",discoverRootDomain:!0,cookieSameSite:"Lax",postPath:this.getPostPath(i),crossDomainLinker:this.handleHrefCDLink,contexts:{performanceTiming:!1}}),t.snowplow("setUserIdFromCookie","IRIS_ID"),snowplow("enableActivityTracking",{minimumVisitLength:30,heartbeatDelay:30}),t.snowplow("enableActivityTrackingCallback",{minimumVisitLength:30,heartbeatDelay:30,callback:function(t){o={minXOffset:o.minXOffset<t.minXOffset?o.minXOffset:t.minXOffset,maxXOffset:o.maxXOffset>t.maxXOffset?o.maxXOffset:t.maxXOffset,minYOffset:o.minYOffset<t.minYOffset?o.minYOffset:t.minYOffset,maxYOffset:o.maxYOffset>t.maxYOffset?o.maxYOffset:t.maxYOffset,numEvents:o.numEvents+1}}}),t.IIRISTracker&&t.IIRISTracker.instCount>0&&t.snowplow("crossDomainLinker",this.handleHrefCDLink);var s=this;document.addEventListener("visibilitychange",(function(){t.IIRISTracker&&r==t.IIRISTracker.instCount&&"hidden"==document.visibilityState&&s.trackUnloadEvent(e)})),t.addEventListener("recommendCTREvent",(function(e){if(t.IIRISTracker&&r==t.IIRISTracker.instCount){var n={};n.url=e.detail.target_url,s.trackUriRedirect(n)}})),t.addEventListener("popstate",(function(){t.IIRISTracker&&r==t.IIRISTracker.instCount&&s.trackUnloadEvent(e)})),t.addEventListener("crossDomainClick",(function(e){t.IIRISTracker&&r==t.IIRISTracker.instCount&&s.handleCrossDomainLink(e)})),t.snowplow("enableLinkClickTracking"),e.contentTagEnabled&&a?t.snowplow("trackPageView",{context:this.getContext(a)}):t.snowplow("trackPageView"),this.collectorHost=i,this.appId=n;var c=u();c&&this.setDomainCookie("_iris_duid",c)},getPageIsSponsored:function(t){var e=t.pageIsSponsored;return"string"==typeof e?"true"==e.toLowerCase():e},getPageDesc:function(t){return t||(document.querySelector('meta[name="description"]')?document.querySelector('meta[name="description"]').content:"")},getSecondaryTerms:function(t){return t&&Array.isArray(t)?t.join(","):t},getContext:function(t){return[{schema:"iglu:com.iiris/content_taxonomy_ctx/jsonschema/1-0-14",data:{byline:t.byline,canonicalUrl:t.canonicalUrl,contentAuthor:t.contentAuthor,contentLabel:t.contentLabel,contentSource:t.contentSource,gatingLevel:t.gatingLevel,contentPubDate:t.contentPubDate,pageID:t.pageID,pageDesc:this.getPageDesc(t.pageDesc),pageIsSponsored:this.getPageIsSponsored(t),pageSponsor:t.pageSponsor,pageTitle:t.pageTitle,pageType:t.pageType,primaryTerm:t.primaryTerm,auxiliaryTerm:this.getSecondaryTerms(t.secondaryTerm)}}]},getAssetContext:function(t){return[{schema:"iglu:com.iiris/asset/jsonschema/2-0-1",data:{id:t.id,name:t.name,type:t.type,created:t.created,lastUpdated:t.lastUpdated,url:t.url,tags:t.tags,metadata:t.metadata}}]},getPostPath:function(t){return"com-informa-prod1.mini.snplow.net"===t?"/com.snowplowanalytics.snowplow/tp2":"/com.iiris/ed0"},initLyticsConfig:function(){!function(){"use strict";var e=t.jstag||(t.jstag={}),n=[];function o(t){e[t]=function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];n.push([t,o])}}o("send"),o("mock"),o("identify"),o("pageView"),o("unblock"),o("getid"),o("setid"),o("loadEntity"),o("getEntity"),o("on"),o("once"),o("call"),e.loadScript=function(t,e,n){var o=document.createElement("script");o.async=!0,o.src=t,o.onload=e,o.onerror=n;var i=document.getElementsByTagName("script")[0],a=i&&i.parentNode||document.head||document.body,r=i||a.lastChild;return null!=r?a.insertBefore(o,r):a.appendChild(o),this},e.init=function t(o){return this.config=o,this.loadScript(o.src,(function(){if(e.init===t)throw new Error("Load error!");e.init(e.config),function(){for(var t=0;t<n.length;t++){var o=n[t][0],i=n[t][1];e[o].apply(e,i)}n=void 0}()})),this}}(),jstag.init({src:"//c.lytics.io/api/tag/45b7a2fa48338cf11ef06bb0386e4843/latest.min.js",loadid:!0})},setUpVICookies:function(){var t=l("IRIS_ID");if(t){var e="iu-"+t;document.cookie="_iris_fpid="+btoa(e)+"; path=/;"}else{var n=this.getDUId();if(n){var o="id-"+n;document.cookie="_iris_fpid="+btoa(o)+"; path=/;"}}},getDUId:function(){var t=document.cookie.split(";").reduce((function(t,n){var o=e(n.split("=").map((function(t){return t.trim()})),2),i=o[0],a=o[1];return t[i]=a,t}),{}),n=Object.getOwnPropertyNames(t),o="";for(i=0;i<n.length;i++)if(n[i].startsWith("_sp_id.")){o=n[i];break}return t[o]?t[o].split(".")[0]:null},initVIConfig:function(){var e,n,o,i,a;e=document,n="script",_ml=t._ml||{},_ml.eid="62439",_ml.cid=l("_iris_fpid"),_ml.fp="",o=e.getElementsByTagName(n)[0],i=new Date,(a=e.createElement(n)).async=1,a.src="https://ml314.com/tag.aspx?"+i.getDate()+i.getMonth(),o.parentNode.insertBefore(a,o)},setEloquaHashEmail:function(){var e=new Proxy(new URLSearchParams(t.location.search),{get:function(t,e){return t.get(e)}}).sp_eh;e&&this.setDomainCookie("_iris_eloqua_em",e)},initTDConfig:function(t,e){!function(){!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var n=["addRecord","blockEvents","fetchServerCookie","fetchGlobalID","fetchUserSegments","resetUUID","ready","setSignedMode","setAnonymousMode","set","trackEvent","trackPageview","trackClicks","unblockEvents"],o=0;o<n.length;o++){var i=n[o];e[t].prototype[i]=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}}(i)}var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/3.0/td.min.js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r)}}("Treasure",this)}(),this.td=new Treasure({database:"webtracking_"+t,writeKey:"100/bb9cbe21de3db7a5428506d7528e45b2c801a48c",host:"eu01.in.treasuredata.com"}),this.td.setSignedMode(),this.td.set("$global","td_global_id","td_global_id");var n=function(t){},o=function(t){console.log(t)};this.lob=t,this.domain=e,this.setTDCustomData(l("IRIS_ID")),this.td.trackPageview("js_pageviews_"+t+"_"+e,(function(){this.td.fetchGlobalID(n,o)}))},setTDCustomData:function(t){var e={};try{void 0!==t&&(e.userid=t)}catch(n){return console.log("Error occurred in setTDCustomData ::"+t),e}console.log("Setting :: "+e.userid),this.td.set("js_pageviews_"+this.lob+"_"+this.domain,e)}},n),t.IIRISTracker.instCount=0;var d=new Event("trackerInitialized");t.dispatchEvent(d)}else t.IIRISTracker&&void 0!==t.IIRISTracker.instCount&&(t.IIRISTracker.instCount=t.IIRISTracker.instCount+1)}(window),t=t.default})()));
//# sourceMappingURL=iris-t.js.map