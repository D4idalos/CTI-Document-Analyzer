define("ad",["module","page","utils","bem","jquery","universal-ad","jquery-utils"],function(e,t,h,_,v){const y={name:e.id,class:"."+e.id},I={sizes:[[300,250],[728,90],[300,600],[970,250],[970,90],[320,50]],positions:{desktop:["alerts_closings","alerts_weather","article_atf","article_flex_btf","article_mid1","article_mid2","article_mid3","article_mid4","article_mid5","article_mid6","article_mid7","article_universal","countdown_clock","front_atf","front_btf","front_countdownclock","front_high_impact","front_leaderboard_btf","front_mid1","front_mid2","front_mid3","front_mid4","front_mid5","front_universal","gallery_companion","leaderboard_atf"],mobile:["alerts_closings","alerts_weather","article_atf","article_btf","article_mid1","article_mid2","article_mid3","article_mid4","article_mid5","article_universal","front_atf","front_btf","front_mid","front_universal"]}};h.broadcast(y.name,"loaded"),h.createModuleNoJQ(y.name,function(s){const o=this,i=new _(s,y.name),r=(this.el=s,this.module=y,this.delay=1e3*parseInt(s.dataset.delay),this.lazy="true"===s.dataset.lazy,this.refresher=null,this.isRefresh=!1,this.refreshCount=0,this.refreshObserver=null,this.init=function(){const t=e=>{window.setTimeout(function(){window.googletag&&window.googletag.pubads?e():t(e)},200)};t(()=>{o.broadcast("init",{position:s.dataset.position}),g();var e=d(),t=window.localStorage.getItem("ope_fpid");0<e&&r("articleNumber",e),r("refresh",!1),null!==t&&r("1plusx_ppid",t),o.broadcast("setup",{position:s.dataset.position,id:o.id,delay:o.delay}),h.listen("_gpt","slotRenderEnded",function(e,t,i){i.request.domId===o.id&&w(i)}),f(function(){m()})}),o.broadcast("ready")},(e,t)=>{var i=h.dashesToCamel("targeting-"+e),a="data-targeting-"+e;null==t?(o.broadcast("removingTargeting",{position:s.dataset.position,target:e}),s.removeAttribute(a)):s.dataset[i]!==t.toString()?(o.broadcast("settingTargeting",{position:s.dataset.position,target:e,value:t.toString()}),s.dataset[i]=t.toString()):o.broadcast("ignoringExistingTargeting",{position:s.dataset.position,target:e,value:t.toString()})});function a(e){o.refresher&&(e||o.broadcast("refreshStopped",{position:s.dataset.position}),window.clearTimeout(o.refresher),window.clearInterval(o.refreshCountdown),o.refresher=null)}function n(){var e;"true"===s.dataset.refreshEnabled&&(e=parseInt(s.dataset.refreshInterval),a(!0),o.refresher=window.setTimeout(()=>{o.refreshCount++,o.isRefresh=!0,r("refresh",!0),function e(){document.hidden?(o.broadcast("refreshBlocked",{position:s.dataset.position}),v(document).one("visibilitychange",()=>{o.broadcast("refreshUnblocked",{position:s.dataset.position}),e()})):m()}()},1e3*e),o.refreshRemaining=e,o.refreshCountdown=window.setInterval(()=>{o.refreshRemaining--,o.refreshRemaining<1?window.clearInterval(o.refreshCountdown):o.broadcast("refreshCountdown",{position:s.dataset.position,remaining:o.refreshRemaining})},1e3),o.broadcast("refreshRestarted",{position:s.dataset.position}),o.broadcast("refreshCountdown",{position:s.dataset.position,remaining:o.refreshRemaining}))}const d=()=>{var e=document.querySelectorAll(".grid__section");const i=s.closest(".grid__section");let a=0,n=0;return e.forEach((e,t)=>{e.querySelector(".article")&&(a++,e===i)&&(n=a)}),n},l=()=>{let e=window.pbjs;return new Promise(t=>{e.que.push(function(){o.isRefresh||(e.setConfig({userSync:{aliasSyncEnabled:!0,filterSettings:{iframe:{bidders:"*",filter:"include",iframeEnabled:!0}},userIds:[{name:"pubCommonId",storage:{type:"cookie",name:"_pubcid",expires:365}}]},newspassid:{singleRequest:!0,enhancedAdserverTargeting:!0},priceGranularity:{buckets:[{precision:2,min:.01,max:3,increment:.01},{precision:2,min:3.05,max:8,increment:.05},{precision:2,min:8.5,max:20,increment:.5},{precision:2,min:20,max:40,increment:1},{precision:2,min:45,max:50,increment:5}]}}),e.addAdUnits([{code:o.id,mediaTypes:{banner:{sizes:JSON.parse(s.dataset.sizes)}},bids:[{bidder:"newspassid",params:{publisherId:s.dataset.ozonePublisherId,siteId:s.dataset.ozoneSiteId,placementId:s.dataset.ozonePlacementId,customData:[{settings:{},targeting:{page_type:s.dataset.pageType}}]}}]}])),e.requestBids({adUnitCodes:[o.id],bidsBackHandler:function(e){e[o.id]&&e[o.id].bids&&e[o.id].bids[0].adserverTargeting&&(e=e[o.id].bids[0].adserverTargeting,Object.entries(e).forEach(e=>{var[e,t]=e;r(e,t)})),t()}})}),setTimeout(function(){t()},1e3)})},c=()=>new Promise(n=>{var e="mobile"===v(".page")[0].dataset.platform?"mobile":"desktop";I.positions[e].includes(s.dataset.position)?(e=function(){var e=JSON.parse(s.dataset.sizes);const i=I.sizes;let a=[];return e.forEach(t=>{i.forEach(e=>{t.join("x")===e.join("x")&&a.push(t)})}),a}(),e=[{code:o.id,divId:o.id,adUnitId:o.id,adUnitIndex:"0",mediaTypes:{banner:{sizes:e}}}],o.broadcast("startingOpenWrapBidding",{position:s.dataset.position,slots:e}),window.PWT&&window.PWT.requestBids?window.PWT.requestBids(e,function(e){o.broadcast("receivedOpenWrapBids",{bids:e,position:s.dataset.position});for(var t=0,i=e.length;t<i;t++){const a=e[t];a.bidData&&a.bidData.kvp&&Object.keys(a.bidData.kvp).forEach(function(e){var t=e,e=a.bidData.kvp[e];r(t,e)})}n()}):n()):(o.broadcast("blockingOpenWrapBidding",{position:s.dataset.position}),n())}),p=()=>new Promise(e=>{o.broadcast("startingA9Bidding",{position:s.dataset.position}),window.apstag.fetchBids({slots:[{slotID:o.id,slotName:s.dataset.path,sizes:JSON.parse(s.dataset.sizes)}]},function(i){0<i.length?(o.broadcast("receivedA9Bids",{bids:i,position:s.dataset.position}),window.googletag&&window.googletag.cmd&&window.googletag.cmd.push(function(){o.broadcast("refreshing",{position:s.dataset.position}),["amznbid","amzniid","amznsz","amznp"].forEach(e=>{var t=i[0][e];r(e,t)})})):window.googletag&&window.googletag.cmd&&window.googletag.cmd.push(function(){o.broadcast("noAmazonBids",{position:s.dataset.position}),o.broadcast("refreshing",{position:s.dataset.position})}),e()})}),u=()=>{let a=!1;return new Promise(i=>{o.broadcast("gettingOnePlusXProfile",{position:s.dataset.position}),window.tegna.getOnePlusXProfileData((e,t)=>{o.broadcast("receivedOnePlusXProfileData",{segments:e,topics:t,position:s.dataset.position}),r("1plusX",e),r("opectx",t),a=!0,i()}),setTimeout(function(){a||(o.broadcast("timedOutOnePlusXProfileData",{position:s.dataset.position}),i())},1e3)})},m=()=>{var e=[{name:"a9",enabled:"apstag"in window&&"fetchBids"in window.apstag,ready:"apstag"in window&&"fetchBids"in window.apstag,request:p},{name:"pubmatic",enabled:"PWT"in window&&"requestBids"in window.PWT,ready:"PWT"in window&&"requestBids"in window.PWT,request:c},{name:"ozone",enabled:"pbjs"in window&&s.dataset.ozonePlacementId,ready:"pbjs"in window&&window.pbjs.libLoaded,request:l},{name:"oneplusxprofile",enabled:"getOnePlusXProfileData"in window.tegna,ready:"getOnePlusXProfileData"in window.tegna,request:u}];let t=[];e.forEach(e=>{e.enabled&&e.ready?t.push(e.request()):o.broadcast(e.name+"BiddingSkipped",{name:e.name,enabled:e.enabled,ready:e.ready})}),Promise.allSettled(t).then(()=>{o.broadcast("refreshing",{position:s.dataset.position}),r("refresh_count",o.refreshCount),r("refresh_delay",parseInt(s.dataset.refreshInterval)),window.tegna.ads.refresh(o.id)})},f=i=>{o.lazy?h.observeIntersections(s,(e,t)=>{e.isIntersecting&&(t.unobserve(e.target),null!==o.timeout)&&(window.clearTimeout(o.timeout),i())}):0<o.delay?(o.timeout=window.setTimeout(function(){o.timeout=null,i()},o.delay),h.observeIntersections(s,(e,t)=>{e.isIntersecting&&(t.unobserve(e.target),null!==o.timeout)&&(window.clearTimeout(o.timeout),i())})):i()},g=()=>{var t=s.dataset.position;if(document.getElementById(t)){let e=1;for(;null!==document.getElementById(t+"_"+e);)e++;t+="_"+e}o.id=t,s.firstElementChild.setAttribute("id",o.id)},t=e=>{"desktop"===document.getElementsByClassName("page")[0].dataset.platform&&1080<=e&&i.selectElements("inner").setModifier("border",!1)},b=(e,t)=>{t<3&&!1===e&&(i.selectElements("inner").setModifier("border",!1),i.selectElements("inner").setModifier("background",!1))},w=e=>{o.broadcast("received",{position:s.dataset.position,payload:e}),"true"===s.dataset.collapse&&e.response.isEmpty?o.el.style.display="none":("true"===s.dataset.refreshEnabled&&(o.refreshObserver?n():h.observeIntersections(s,(e,t)=>{o.refreshObserver=t,(e.isIntersectingThreshold&&!o.viewable?(o.broadcast("viewable",{position:s.dataset.position}),n):(o.viewable=!1,o.broadcast("unviewable",{position:s.dataset.position}),a))()},{threshold:1})),t(e.response.size.width),b(e.response.isEmpty,e.response.size.width))}})});
//# sourceMappingURL=ad_7.7.5.js.map